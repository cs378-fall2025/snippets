{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.0b4", "generated_at": "2025-11-15T18:05:53.822291Z", "invocation_id": "3403a846-df74-4d4b-b9d4-83bbf259145e", "invocation_started_at": "2025-11-15T18:05:51.829707Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.692543Z", "completed_at": "2025-11-15T18:05:53.700736Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.700954Z", "completed_at": "2025-11-15T18:05:53.700968Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010127782821655273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.aircrafts", "compiled": true, "compiled_code": "with stg_aircrafts as (\n    select aircraft_name as name,\n        case iata_code when '\\\\N' then null else iata_code end as iata,\n        case icao_code when '\\\\N' then null else icao_code end as icao,\n        _data_source,\n        _load_time\n  from `cs378-fa2025`.`air_travel_raw`.`aircrafts`\n)\n\nselect * from stg_aircrafts", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.703270Z", "completed_at": "2025-11-15T18:05:53.705147Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.705358Z", "completed_at": "2025-11-15T18:05:53.705363Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036520957946777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.airlines", "compiled": true, "compiled_code": "with stg_airlines as (\n  select airline_id as id,\n    name,\n    case alias\n        when '\\\\N' then null\n        else alias\n        end as alias,\n    case iata\n        when '' then null\n        else iata\n        end as iata,\n    case icao\n        when '' then null\n        else icao\n        end as icao,\n    case callsign\n        when '\\\\N' then null\n        else callsign\n        end as callsign,\n    case country\n        when '\\\\N' then null\n        else country end as country,\n    active, _data_source, _load_time\n  from `cs378-fa2025`.`air_travel_raw`.`airlines`\n)\n\nselect * from stg_airlines", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`airlines`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.707201Z", "completed_at": "2025-11-15T18:05:53.708946Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.709117Z", "completed_at": "2025-11-15T18:05:53.709120Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030951499938964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.airport_maps", "compiled": true, "compiled_code": "with stg_airport_maps as (\n  select airport, terminal, business,\n      case category\n        when 'Airline Services' then 'Airline Service'\n        when 'Airline Services' then 'Airline Service'\n        when 'Cafe' then 'Coffee Shop'\n        when 'Financial Services' then 'Financial Service'\n        when 'Retail/Dining' then 'Retail / Dining'\n        when 'Things To Do' then 'Things to Do'\n        when 'Transportation' then 'Transportation Service'\n        when 'Vending' then 'Vending Machine'\n        when 'Service' then 'Services'\n        else category end as category,\n      location, dining, menu_items, _data_source, _load_time\n    from `cs378-fa2025`.`air_travel_raw`.`airport_maps`\n)\n\nselect * from stg_airport_maps", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.710772Z", "completed_at": "2025-11-15T18:05:53.712160Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.712336Z", "completed_at": "2025-11-15T18:05:53.712338Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002743959426879883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.airport_reviews", "compiled": true, "compiled_code": "with stg_airport_reviews as (\n\tselect id,\n\t    safe_cast(threadRef as INTEGER) as review_thread,\n\t    airportRef as airport_id,\n\t    airportIdent as airport_code,\n\t    safe_cast(split(date, ' ')[0] as DATE) as review_date,\n\t    memberNickname as review_author,\n\t    subject as review_subject,\n\t    body as review_details,\n\t    broad_category,\n        sub_category,\n        sentiment,\n        language,\n\t    _data_source,\n\t    _load_time\n\tfrom `cs378-fa2025`.`air_travel_raw`.`airport_reviews`\n)\n\nselect * from stg_airport_reviews", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.713960Z", "completed_at": "2025-11-15T18:05:53.715501Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.715652Z", "completed_at": "2025-11-15T18:05:53.715655Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002763986587524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.airports", "compiled": true, "compiled_code": "with stg_airports as (\n\tselect safe_cast(airport_id as INTEGER) as id,\n\t    airport_name as name,\n\t    airport_city as city,\n\t    airport_country as country,\n\t    case iata\n\t\t    when '\\\\N' then null\n\t\t    else iata\n\t\t    end as iata,\n\t    case icao\n\t\t    when '\\\\N' then null\n\t\t    else icao\n\t\t    end as icao,\n\t    latitude,\n\t    longitude,\n\t    altitude,\n\t    safe_cast(timezone as INTEGER) as timezone_delta,\n        daylight_savings_time,\n        case tz_database_timezone\n\t\t    when '\\\\N' then null\n\t\t    else tz_database_timezone\n\t\t    end as timezone_name,\n\t    case type\n\t\t    when '\\\\N' then null\n\t\t    else type\n\t\t    end as type,\n\t    case source\n\t\t    when '\\\\N' then null\n\t\t    else source\n\t\t    end as source,\n\t    _data_source,\n\t    _load_time\n\tfrom `cs378-fa2025`.`air_travel_raw`.`airports`    \n)\n\nselect * from stg_airports", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`airports`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.717135Z", "completed_at": "2025-11-15T18:05:53.718335Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.718484Z", "completed_at": "2025-11-15T18:05:53.718487Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023641586303710938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.countries", "compiled": true, "compiled_code": "with stg_countries as (\n    select country_name as name,\n    case iso_code\n      when '\\\\N' then null\n      else iso_code\n      end as iso_code,\n    dafif_code,\n    _data_source,\n    _load_time\n    from `cs378-fa2025`.`air_travel_raw`.`countries`\n)\n\nselect * from stg_countries", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`countries`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.719917Z", "completed_at": "2025-11-15T18:05:53.721171Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.721320Z", "completed_at": "2025-11-15T18:05:53.721323Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023920536041259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.flight_delays", "compiled": true, "compiled_code": "with stg_flight_delays as (\n    select event_month, carrier, carrier_name, airport_code,\n        split(city_state, ',')[0] as airport_city, \n        split(city_state, ',')[1] as airport_state,\n        airport_name, \n        * except (event_month, carrier, carrier_name, airport_code, airport_name, city_state)\n    from\n        (select date(year, month, 01) as event_month, \n            carrier, carrier_name, airport as airport_code,\n            split(airport_name, ':')[0] as city_state, \n            split(airport_name, ':')[1] as airport_name,\n            safe_cast(arr_flights as INTEGER) as arr_total, \n            safe_cast(arr_cancelled as INTEGER) as arr_cancelled,\n            safe_cast(arr_diverted as INTEGER) as arr_diverted, \n            safe_cast(arr_delay as INTEGER) as arr_delay_min,\n            safe_cast(weather_delay as INTEGER) as weather_delay_min, \n            safe_cast(nas_delay as INTEGER) as nas_delay_min,\n            safe_cast(late_aircraft_delay as INTEGER) as late_aircraft_delay_min, \n            _data_source, _load_time\n          from `cs378-fa2025`.`air_travel_raw`.`flight_delays`)\n)\n\nselect * from stg_flight_delays", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.722684Z", "completed_at": "2025-11-15T18:05:53.724088Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.724229Z", "completed_at": "2025-11-15T18:05:53.724231Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002496004104614258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.flight_routes", "compiled": true, "compiled_code": "with stg_flight_routes as (\n  select airline_code,\n    safe_cast(airline_id as INTEGER) as airline_id,\n    source_airport,\n    case source_airport_id\n      when '\\\\N' then null\n      else safe_cast(source_airport_id as INTEGER)\n      end as source_airport_id,\n    dest_airport,\n    case dest_airport_id\n      when '\\\\N' then null\n      else safe_cast(dest_airport_id as INTEGER)\n      end as dest_airport_id,\n    codeshare,\n    stops,\n    equipment,\n    _data_source,\n    _load_time\n  from `cs378-fa2025`.`air_travel_raw`.`flight_routes`\n)\n\nselect * from stg_flight_routes", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.725614Z", "completed_at": "2025-11-15T18:05:53.726554Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.726703Z", "completed_at": "2025-11-15T18:05:53.726706Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002125978469848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_establishment_canonical_categories", "compiled": true, "compiled_code": "with tmp_airport_establishment_canonical_categories as (\n    select 'Quick Service & Grab-and-Go' as broad_category, 'National/International Fast Food Chains' as sub_category\n\tunion all\n    select 'Quick Service & Grab-and-Go' as broad_category, 'Coffee & Beverage Shops' as sub_category\n\tunion all\n    select 'Quick Service & Grab-and-Go' as broad_category, 'Snack Kiosks' as sub_category\n\tunion all\n    select 'Quick Service & Grab-and-Go' as broad_category, 'Pre-Packaged Foods' as sub_category\n\tunion all\n    select 'Fast Casual' as broad_category, 'Gourmet Burgers & Sandwiches' as sub_category\n\tunion all\n    select 'Fast Casual' as broad_category, 'Build-Your-Own Concepts' as sub_category\n\tunion all\n    select 'Fast Casual' as broad_category, 'Pizzerias' as sub_category\n\tunion all\n    select 'Full-Service Dining' as broad_category, 'Casual Dining Restaurants' as sub_category\n\tunion all\n    select 'Full-Service Dining' as broad_category, 'Upscale & Chef-Driven Restaurants' as sub_category\n\tunion all\n    select 'Full-Service Dining' as broad_category, 'Themed Restaurants & Sports Bars' as sub_category\n\tunion all\n    select 'Bars & Lounges' as broad_category, 'Wine Bars' as sub_category\n\tunion all\n    select 'Bars & Lounges' as broad_category, 'Craft Beer Pubs' as sub_category\n\tunion all\n    select 'Bars & Lounges' as broad_category, 'Cocktail Lounges' as sub_category\n\tunion all\n    select 'Travel Essentials & Convenience' as broad_category, 'Newsstands & Bookstores' as sub_category\n\tunion all\n    select 'Travel Essentials & Convenience' as broad_category, 'Pharmacies & Personal Care' as sub_category\n\tunion all\n    select 'Travel Essentials & Convenience' as broad_category, 'Travel Gear & Luggage' as sub_category\n\tunion all\n    select 'Specialty Retail' as broad_category, 'Electronics' as sub_category\n\tunion all\n    select 'Specialty Retail' as broad_category, 'Local Souvenirs & Gifts' as sub_category\n\tunion all\n    select 'Specialty Retail' as broad_category, 'Apparel & Accessories' as sub_category\n\tunion all\n    select 'Luxury & High-End Goods' as broad_category, 'Confectionery & Gourmet Foods' as sub_category\n\tunion all\n    select 'Luxury & High-End Goods' as broad_category, 'Designer Fashion' as sub_category\n\tunion all\n    select 'Luxury & High-End Goods' as broad_category, 'Jewelry & Watches' as sub_category\n\tunion all\n    select 'Luxury & High-End Goods' as broad_category, 'High-End Cosmetics' as sub_category\n\tunion all\n    select 'Duty-Free' as broad_category, 'Liquor & Tobacco' as sub_category\n\tunion all\n    select 'Duty-Free' as broad_category, 'Fragrances & Cosmetics' as sub_category\n\tunion all\n    select 'Duty-Free' as broad_category, 'Luxury Accessories & Confectionery' as sub_category\n\tunion all\n    select 'Passenger Comfort & Wellness' as broad_category, 'Spas & Salons' as sub_category\n\tunion all\n    select 'Passenger Comfort & Wellness' as broad_category, 'Pay-Per-Use Lounges' as sub_category\n\tunion all\n    select 'Passenger Comfort & Wellness' as broad_category, 'Yoga & Meditation Rooms' as sub_category\n\tunion all\n    select 'Passenger Comfort & Wellness' as broad_category, 'Shower Facilities' as sub_category\n\tunion all\n    select 'Financial & Business Services' as broad_category, 'Currency Exchan' as sub_category\n\tunion all\n    select 'Financial & Business Services' as broad_category, 'ATMs & Banking Services' as sub_category\n\tunion all\n    select 'Financial & Business Services' as broad_category, 'Business Centers & Work Pods' as sub_category\n\tunion all\n    select 'Practical & Convenience Services' as broad_category, 'Luggage Storage & Wrapping' as sub_category\n\tunion all\n    select 'Practical & Convenience Services' as broad_category, 'Postal & Shipping Services' as sub_category\n\tunion all\n    select 'Practical & Convenience Services' as broad_category, 'Pet Relief & Care Areas' as sub_category\n\tunion all\n    select 'Practical & Convenience Services' as broad_category, 'Vending Machines (non-F&B)' as sub_category\n)\n\nselect * \nfrom tmp_airport_establishment_canonical_categories", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.728100Z", "completed_at": "2025-11-15T18:05:53.729784Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.729931Z", "completed_at": "2025-11-15T18:05:53.729933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027658939361572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tsa_traffic", "compiled": true, "compiled_code": "with stg_tsa_traffic as (\n  select safe_cast(event_date as DATE format 'MM/DD/YYYY') as event_date,\n    safe_cast(event_hour as INTEGER) as event_hour,\n    airport_code,\n    airport_name,\n    airport_city,\n    airport_state,\n    security_checkpoint,\n    safe_cast(total_traffic as INTEGER) as total_traffic,\n    _data_source,\n    _load_time\n  from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic`\n)\n\nselect * from stg_tsa_traffic", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.731254Z", "completed_at": "2025-11-15T18:05:53.732322Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.732458Z", "completed_at": "2025-11-15T18:05:53.732460Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002117156982421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_aircraft_icao", "compiled": true, "compiled_code": "with tmp_aircraft_icao as (\n    select\n      name as aircraft_name,\n      AI.GENERATE(\n        ('What is the icao code of aircraft ', name, '? If it does not have one, return None.'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'aircraft_icao STRING') as llm_response\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`\n    where icao is null\n  )\nselect aircraft_name, llm_response.aircraft_icao\nfrom tmp_aircraft_icao", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_aircraft_icao`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.733720Z", "completed_at": "2025-11-15T18:05:53.738189Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.738328Z", "completed_at": "2025-11-15T18:05:53.738330Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005540132522583008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`aircrafts` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.739584Z", "completed_at": "2025-11-15T18:05:53.741394Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.741525Z", "completed_at": "2025-11-15T18:05:53.741527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027871131896972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airlines` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.742686Z", "completed_at": "2025-11-15T18:05:53.743800Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.743922Z", "completed_at": "2025-11-15T18:05:53.743924Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023300647735595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_establishment_unique", "compiled": true, "compiled_code": "with tmp_airport_establishment_unique as (\n  select distinct business, category, dining, _data_source, _load_time\n  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`\n  order by category, business\n)\nselect * \nfrom tmp_airport_establishment_unique", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.745401Z", "completed_at": "2025-11-15T18:05:53.747122Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.747243Z", "completed_at": "2025-11-15T18:05:53.747245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026988983154296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_maps` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.748388Z", "completed_at": "2025-11-15T18:05:53.750078Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.750200Z", "completed_at": "2025-11-15T18:05:53.750202Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026199817657470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_reviews` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.751584Z", "completed_at": "2025-11-15T18:05:53.752745Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.752861Z", "completed_at": "2025-11-15T18:05:53.752863Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023298263549804688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_llm", "compiled": true, "compiled_code": "\n\nwith tmp_airport_llm as (\n    select\n      name,\n      country,\n      iata,\n      AI.GENERATE(\n        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'icao STRING, state_prov STRING') as llm_response\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`\n    where iata is not null\n  )\nselect name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov\nfrom tmp_airport_llm", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.754009Z", "completed_at": "2025-11-15T18:05:53.755889Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.756018Z", "completed_at": "2025-11-15T18:05:53.756020Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0028769969940185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airports` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.757188Z", "completed_at": "2025-11-15T18:05:53.758574Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.758697Z", "completed_at": "2025-11-15T18:05:53.758699Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023140907287597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_country_iso_codes", "compiled": true, "compiled_code": "\n\nwith tmp_country_iso_codes as (\n    select\n      name,\n      AI.GENERATE(\n        ('What is the iso code for country ', name, '? If it does not have one, return None.'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'iso_code STRING') as llm_response\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`\n    where iso_code is null\n  )\nselect name, llm_response.iso_code as mapped_iso_code\nfrom tmp_country_iso_codes", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.759815Z", "completed_at": "2025-11-15T18:05:53.761413Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.761529Z", "completed_at": "2025-11-15T18:05:53.761530Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002480030059814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`countries` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.762635Z", "completed_at": "2025-11-15T18:05:53.764474Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.764587Z", "completed_at": "2025-11-15T18:05:53.764589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027589797973632812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_delays` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.765664Z", "completed_at": "2025-11-15T18:05:53.767217Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.767330Z", "completed_at": "2025-11-15T18:05:53.767332Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002418041229248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_routes` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.768371Z", "completed_at": "2025-11-15T18:05:53.770069Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.770182Z", "completed_at": "2025-11-15T18:05:53.770184Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002547740936279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.771211Z", "completed_at": "2025-11-15T18:05:53.772193Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.772300Z", "completed_at": "2025-11-15T18:05:53.772302Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018301010131835938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Aircraft", "compiled": true, "compiled_code": "with Aircraft as (\n    select icao, iata, name, _data_source, _load_time\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`\n    where icao is not null\n    union all\n    select i.aircraft_icao as icao, a.iata, a.name, a._data_source, a._load_time\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_aircraft_icao` i\n    on a.name = i.aircraft_name\n    where a.icao is null\n)\n\nselect *\nfrom Aircraft", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.773326Z", "completed_at": "2025-11-15T18:05:53.774148Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.774264Z", "completed_at": "2025-11-15T18:05:53.774265Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002866029739379883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_establishment_raw_categories", "compiled": true, "compiled_code": "with airport_establishment_raw_categories as (\n  select distinct business, category\n  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`\n  where category not in ('Airline', 'Airline Service', 'Airline Services', 'Airline Check-in', 'Airline Ticketing',\n      'Airline Gate / Check-in', 'Airline Lounge', 'Airport Lounge', 'Airport Service', 'Airport Services', 'Air Freight', 'Car Rental',\n      'Information Kiosk', 'Information Service', 'Parking', 'Transportation Service')\n)\n\nselect * \nfrom airport_establishment_raw_categories", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.776526Z", "completed_at": "2025-11-15T18:05:53.777451Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.777564Z", "completed_at": "2025-11-15T18:05:53.777566Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017957687377929688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_all", "compiled": true, "compiled_code": "with tmp_airport_all as (\n    select distinct al.llm_icao as icao, a.iata, a.name, a.city, al.llm_state_prov as state_prov, \n        a.country, a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, \n        a.timezone_name, a.type, a.source, 'openflights,llm' as _data_source, a._load_time\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm` al\n    on a.name = al.name and a.country = al.country\n    where a.iata is not null\n    and al.llm_icao is not null\n)\n\nselect * from tmp_airport_all", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.778605Z", "completed_at": "2025-11-15T18:05:53.779523Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.779637Z", "completed_at": "2025-11-15T18:05:53.779639Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001764059066772461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Country", "compiled": true, "compiled_code": "with Country as (\n    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` \n    group by iso_code, name, _data_source, _load_time\n)\n\nselect *\nfrom Country\nwhere iso_code is not null \nunion all\nselect t.mapped_iso_code, c.name, c.dafif_codes, c._data_source, c._load_time \nfrom Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes` t \non c.name = t.name\nwhere t.mapped_iso_code is not null\nand c.iso_code is null", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Country`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.780694Z", "completed_at": "2025-11-15T18:05:53.782027Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.782128Z", "completed_at": "2025-11-15T18:05:53.782130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002145051956176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_establishment_broad_categories_mapped", "compiled": true, "compiled_code": "\n\nwith canonical_categories as (\n    select ARRAY_AGG(distinct broad_category) AS broad_categories\n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`\n),\ntmp_airport_establishment_broad_categories_mapped as (\n    select\n      business,\n      category as raw_category,\n      AI.GENERATE(\n        ('Map the business ', business, ' to its most fitting broad category from this canonical category list:',\n          broad_categories),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'broad_category STRING') as llm_response\n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`\n    cross join canonical_categories\n  )\nselect business, raw_category, llm_response.broad_category as broad_category\nfrom tmp_airport_establishment_broad_categories_mapped", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_mapped`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.783136Z", "completed_at": "2025-11-15T18:05:53.784045Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.784158Z", "completed_at": "2025-11-15T18:05:53.784160Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017728805541992188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_duplicates", "compiled": true, "compiled_code": "with tmp_airport_duplicates as (\n    select * \n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`\n    where icao in\n        (select icao\n        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`\n        group by icao\n        having count(*) > 1)\n)\n\nselect * from tmp_airport_duplicates", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.785192Z", "completed_at": "2025-11-15T18:05:53.786351Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.786455Z", "completed_at": "2025-11-15T18:05:53.786457Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002008199691772461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airline_country_mapped", "compiled": true, "compiled_code": "\n\nwith airline_orphan_countries as (\n    select distinct country\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`\n    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)\n),\ntmp_airline_countries_mapped as (\n    select\n      country,\n      AI.GENERATE(\n        ('If ', country, ' is a recognized country, return its iso code. If it is not a recognized country, return None.'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'iso_code STRING') as llm_response\n    from airline_orphan_countries\n  )\n  select country as original_country, llm_response.iso_code as mapped_iso_code\n  from tmp_airline_countries_mapped", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.787485Z", "completed_at": "2025-11-15T18:05:53.788461Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.788562Z", "completed_at": "2025-11-15T18:05:53.788563Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018110275268554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_establishment_sub_categories_mapped", "compiled": true, "compiled_code": "\n\nwith tmp_establishment_categories as (\n    select m.business, m.broad_category,\n      array_agg(distinct c.sub_category) AS sub_categories\n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_mapped` m\n    join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories` c\n    on m.broad_category = c.broad_category\n    where m.broad_category is not null\n    group by m.business, m.broad_category\n),\ntmp_airport_establishment_sub_categories_mapped as (\n    select\n      business,\n      broad_category,\n      AI.GENERATE(\n        ('Map the airport concession ', business, ' with broad category ', broad_category,\n        ' to its most fitting sub category based on this canonical list of subcategories: ', sub_categories),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'sub_category STRING') as llm_response\n    from tmp_establishment_categories\n  )\nselect business, broad_category, llm_response.sub_category as sub_category\nfrom tmp_airport_establishment_sub_categories_mapped", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_sub_categories_mapped`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.789568Z", "completed_at": "2025-11-15T18:05:53.790411Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.790516Z", "completed_at": "2025-11-15T18:05:53.790517Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001847982406616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_duplicates_embeddings", "compiled": true, "compiled_code": "\n  \n  with tmp_airport_duplicates_embeddings as (\n      select icao, iata, name, ml_generate_embedding_result as embedding\n      from\n      ML.GENERATE_EMBEDDING(\n        model air_travel_model.embedding_model,\n        (select icao, iata, name, concat(icao, ',', iata, ',', name) as content\n        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`),\n        struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type)\n      )\n  )\n\n  select * from tmp_airport_duplicates_embeddings", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.791651Z", "completed_at": "2025-11-15T18:05:53.792526Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.792628Z", "completed_at": "2025-11-15T18:05:53.792630Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016291141510009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_inference_results", "compiled": true, "compiled_code": "\n\nwith tmp_airport_inference_results as (\n    select icao,\n      AI.GENERATE(\n        ('What are the iata code and name of the airport that has the icao code of ', icao, '?'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'iata STRING, name STRING') as llm_response\n    from (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)\n)\nselect icao, llm_response.iata as iata, llm_response.name as name\nfrom tmp_airport_inference_results", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.793577Z", "completed_at": "2025-11-15T18:05:53.794485Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.794584Z", "completed_at": "2025-11-15T18:05:53.794586Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016868114471435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Airline", "compiled": true, "compiled_code": "with airline_country_joined as (\n  select a.id, a.name, a.alias, a.icao, a.iata, a.callsign, \n    a.country as country_name, c.iso_code as country_code, a.active, \n    a._data_source, a._load_time\n  from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines` a left join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c\n  on a.country = c.name\n  where c.iso_code is not null \n),\nAirline as (\n    select acj.id, acj.name, acj.alias, acj.icao, acj.iata, acj.callsign, \n        acj.country_name, amc.mapped_iso_code as country_code, \n        acj.active, acj._data_source, acj._load_time \n    from airline_country_joined acj join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped` amc\n    on acj.country_name = amc.original_country\n    where acj.country_code is null\n    and acj.country_name is not null\n)\n\nselect *\nfrom Airline", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Airline`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.795504Z", "completed_at": "2025-11-15T18:05:53.796517Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.796619Z", "completed_at": "2025-11-15T18:05:53.796620Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017681121826171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Airport_Establishment", "compiled": true, "compiled_code": "with Airport_Establishment as\n(\n  select distinct e.business, m.broad_category, m.sub_category,\n    case when m.broad_category in ('Fast Casual', 'Full-Service Dining') then True else False end as dining,\n    'airport.guide,llm' as _data_source, e._load_time\n  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique` e \n  join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_sub_categories_mapped` m\n  on e.business = m.business\n)\n\nselect * from Airport_Establishment", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.797602Z", "completed_at": "2025-11-15T18:05:53.798442Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.798544Z", "completed_at": "2025-11-15T18:05:53.798546Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016317367553710938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_inference_results_embeddings", "compiled": true, "compiled_code": "\n\nwith tmp_airport_inference_results_embeddings as (\n  select icao, iata, name, ml_generate_embedding_result as embedding\n  from\n    ML.GENERATE_EMBEDDING(\n      model air_travel_model.embedding_model,\n      (select icao, iata, name, concat(icao, ',', iata, ',', name) as content\n       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results`\n       where iata is not null\n       and name != 'Unknown'),\n       struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type)\n    )\n)\n\nselect * from tmp_airport_inference_results_embeddings", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results_embeddings`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.799536Z", "completed_at": "2025-11-15T18:05:53.800512Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.800627Z", "completed_at": "2025-11-15T18:05:53.800629Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018019676208496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Food_Beverage", "compiled": true, "compiled_code": "with Food_Beverage as (\n  select distinct business, menu_item\n  from\n    (select e.business, split(m.menu_items, ',') as menu_items\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment` e join `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps` m\n    on e.business = m.business\n    where e.dining = True) t, unnest(t.menu_items) as menu_item\n  order by business\n)\n\nselect * \nfrom Food_Beverage", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.801567Z", "completed_at": "2025-11-15T18:05:53.802509Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.802611Z", "completed_at": "2025-11-15T18:05:53.802614Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017054080963134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_vector_search_results", "compiled": true, "compiled_code": "\n\nwith tmp_airport_vector_search_results as (\n  select base.icao as base_icao, base.iata as base_iata, base.name as base_name,\n    query.icao as query_icao, query.iata as query_iata, query.name as query_name,\n    distance\n  from\n    vector_search(\n      table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`, -- this is the base (i.e what's in the Airport table)\n      'embedding',\n      table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results_embeddings`, -- this is the query (i.e. results from LLM inference)\n      'embedding',\n      top_k => 1,\n      distance_type => 'COSINE')\n  where query.icao = base.icao\n  order by distance\n)\n\nselect * \nfrom tmp_airport_vector_search_results", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.803700Z", "completed_at": "2025-11-15T18:05:53.804649Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.804751Z", "completed_at": "2025-11-15T18:05:53.804753Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017359256744384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_refined", "compiled": true, "compiled_code": "with tmp_airport_refined as (\n    select *\n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`\n    where icao not in (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)\n    union all\n    select * from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`\n    where concat(icao, ',', iata, ',', name) in\n      (select concat(base_icao, ',', base_iata, ',', base_name)\n       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`\n       where distance < 0.08)\n)\n\nselect * from tmp_airport_refined", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.805787Z", "completed_at": "2025-11-15T18:05:53.807131Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.807230Z", "completed_at": "2025-11-15T18:05:53.807232Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0021119117736816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_country_iso_codes", "compiled": true, "compiled_code": "\n\nwith tmp_orphan_country as (\n    select distinct country as airport_country_name\n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`\n    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)\n),\ntmp_airport_country_iso_codes as (\n    select airport_country_name,\n      AI.GENERATE(\n        ('What is the iso code for the country ', airport_country_name, '? If it does not have an iso code, return None.'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'iso_code STRING') as llm_response\n    from tmp_orphan_country\n)\nselect airport_country_name, llm_response.iso_code as mapped_iso_code\nfrom tmp_airport_country_iso_codes", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.808249Z", "completed_at": "2025-11-15T18:05:53.809259Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.809358Z", "completed_at": "2025-11-15T18:05:53.809359Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018160343170166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Airport", "compiled": true, "compiled_code": "with Airport as (\n  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,\n    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,\n    a.type, a.source, a._data_source, a._load_time\n  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c\n  on a.country = c.name\n  where c.iso_code is not null\n  union all\n  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,\n    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,\n    a.type, a.source, a._data_source, a._load_time\n  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c\n  on a.country = c.airport_country_name\n  where c.mapped_iso_code is not null\n)\n\nselect distinct * \nfrom Airport", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Airport`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.810430Z", "completed_at": "2025-11-15T18:05:53.811483Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.811586Z", "completed_at": "2025-11-15T18:05:53.811588Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018200874328613281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Airport_Concessions", "compiled": true, "compiled_code": "with Airport_Concessions as (\n  select distinct a.icao as airport_icao, m.terminal, m.business, m.location, m._data_source, m._load_time\n  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps` m join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a\n  on upper(m.airport) = a.iata\n  where a.country_code = 'US'\n  and m.business not in\n    (select business from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`)\n  order by m.business\n)\n\nselect * \nfrom Airport_Concessions", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.812496Z", "completed_at": "2025-11-15T18:05:53.813288Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.813388Z", "completed_at": "2025-11-15T18:05:53.813389Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0015268325805664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Airport_Reviews", "compiled": true, "compiled_code": "with Airport_Review as (\n    select distinct r.id, r.review_thread, r.review_date, r.review_author,\n      r.review_subject, r.review_details, a.icao as airport_icao, r.broad_category, r.sub_category, r.sentiment,\n      r.language, r._data_source, r._load_time\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews` r join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a\n    on a.icao = r.airport_code\n)\n\nselect * \nfrom Airport_Review", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Airport_Reviews`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.814274Z", "completed_at": "2025-11-15T18:05:53.815298Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.815399Z", "completed_at": "2025-11-15T18:05:53.815400Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017538070678710938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Flight_Delays", "compiled": true, "compiled_code": "with Flight_Delays as (\n  select distinct fd.event_month, al.id as airline_id, ap.icao as airport_icao,\n    fd.arr_total, fd.arr_cancelled, fd.arr_diverted, fd.arr_delay_min,\n    fd.weather_delay_min, fd.nas_delay_min, fd.late_aircraft_delay_min,\n    fd._data_source, fd._load_time\n  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays` fd \n  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap on fd.airport_code = ap.iata\n  join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al on fd.carrier_name = al.name\n  where ap.country_code = 'US'\n  and fd.arr_total is not null\n)\n\nselect *\nfrom Flight_Delays", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.816302Z", "completed_at": "2025-11-15T18:05:53.817188Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.817286Z", "completed_at": "2025-11-15T18:05:53.817287Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0016391277313232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Flight_Routes", "compiled": true, "compiled_code": "with Flight_Routes as (\n  select distinct r.airline_id, a1.icao as source_airport_icao, \n    a2.icao as dest_airport_icao, r.codeshare, r.stops, r.equipment, \n    r._data_source, r._load_time\n  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes` r\n  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a1\n  on r.source_airport = a1.iata\n  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a2\n  on r.dest_airport = a2.iata\n)\n\nselect * \nfrom Flight_Routes", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.818237Z", "completed_at": "2025-11-15T18:05:53.819158Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.819254Z", "completed_at": "2025-11-15T18:05:53.819255Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001672983169555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.TSA_Traffic", "compiled": true, "compiled_code": "with TSA_Traffic as (\n  select distinct t.event_date, t.event_hour, a.icao as airport_icao, \n    t.security_checkpoint, t.total_traffic, t._data_source, t._load_time\n  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a join `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic` t\n  on a.iata = t.airport_code\n  and a.city = t.airport_city\n  where a.country_code = 'US'\n  and t.event_date is not null\n  and t.event_hour is not null\n  and a.icao is not null\n  and t.security_checkpoint is not null\n)\n\nselect * \nfrom TSA_Traffic", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-15T18:05:53.820139Z", "completed_at": "2025-11-15T18:05:53.821068Z"}, {"name": "execute", "started_at": "2025-11-15T18:05:53.821180Z", "completed_at": "2025-11-15T18:05:53.821181Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00167083740234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Route_Equipment", "compiled": true, "compiled_code": "with Route_Equipment as (\n    select airline_id, source_airport_icao, dest_airport_icao, equipment, _data_source, _load_time\n    from (\n        select airline_id, source_airport_icao, dest_airport_icao, split(trim(equipment), ' ') as equipment_array,\n            _data_source, _load_time\n        from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`\n        where equipment is not null) r, unnest(r.equipment_array) as equipment\n)\n\nselect distinct re.airline_id, re.source_airport_icao, re.dest_airport_icao,\n    a.icao as icao_equipment, re._data_source, re._load_time\nfrom Route_Equipment re join air_travel_int.Aircraft a\non re.equipment = a.iata", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`", "batch_results": null}], "elapsed_time": 1.0064630508422852, "args": {"log_format": "default", "log_path": "/Users/scohen/UTCS/378/dbt/air_travel/logs", "require_nested_cumulative_type_params": false, "exclude": [], "profiles_dir": "/Users/scohen/.dbt", "invocation_command": "dbt docs generate", "static": false, "skip_nodes_if_on_run_start_fails": false, "upload_to_artifacts_ingest_api": false, "introspect": true, "vars": {}, "version_check": true, "indirect_selection": "eager", "macro_debugging": false, "require_batched_execution_for_custom_microbatch_strategy": false, "select": [], "log_level": "info", "warn_error_options": {"error": [], "warn": [], "silence": []}, "empty_catalog": false, "use_fast_test_edges": false, "which": "generate", "partial_parse": true, "log_file_max_bytes": 10485760, "compile": true, "validate_macro_args": false, "require_yaml_configuration_for_mf_time_spines": false, "log_level_file": "debug", "favor_state": false, "partial_parse_file_diff": true, "project_dir": "/Users/scohen/UTCS/378/dbt/air_travel", "show_resource_report": false, "strict_mode": false, "use_colors_file": true, "defer": false, "cache_selected_only": false, "populate_cache": true, "write_json": true, "log_format_file": "debug", "state_modified_compare_more_unrendered_values": false, "print": true, "printer_width": 80, "send_anonymous_usage_stats": true, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "require_all_warnings_handled_by_warn_error": false, "source_freshness_run_project_hooks": true, "require_generic_test_arguments_property": true, "static_parser": true, "require_resource_names_without_spaces": true, "show_all_deprecations": false, "state_modified_compare_vars": false, "quiet": false}}