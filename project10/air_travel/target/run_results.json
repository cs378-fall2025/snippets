{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.0b4", "generated_at": "2025-11-22T17:27:39.507155Z", "invocation_id": "c8af0f83-53ea-4435-b583-885b8d532de2", "invocation_started_at": "2025-11-22T17:27:36.863485Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.161241Z", "completed_at": "2025-11-22T17:27:39.169716Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.169950Z", "completed_at": "2025-11-22T17:27:39.169965Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010458946228027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.aircrafts", "compiled": true, "compiled_code": "with stg_aircrafts as (\n    select aircraft_name as name,\n        case iata_code when '\\\\N' then null else iata_code end as iata,\n        case icao_code when '\\\\N' then null else icao_code end as icao,\n        _data_source,\n        _load_time\n  from `cs378-fa2025`.`air_travel_raw`.`aircrafts`\n)\n\nselect * from stg_aircrafts", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.172265Z", "completed_at": "2025-11-22T17:27:39.174819Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.175022Z", "completed_at": "2025-11-22T17:27:39.175027Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00426030158996582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.airlines", "compiled": true, "compiled_code": "with stg_airlines as (\n  select airline_id as id,\n    name,\n    case alias\n        when '\\\\N' then null\n        else alias\n        end as alias,\n    case iata\n        when '' then null\n        else iata\n        end as iata,\n    case icao\n        when '' then null\n        else icao\n        end as icao,\n    case callsign\n        when '\\\\N' then null\n        else callsign\n        end as callsign,\n    case country\n        when '\\\\N' then null\n        else country end as country,\n    active, _data_source, _load_time\n  from `cs378-fa2025`.`air_travel_raw`.`airlines`\n)\n\nselect * from stg_airlines", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`airlines`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.176977Z", "completed_at": "2025-11-22T17:27:39.178718Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.178899Z", "completed_at": "2025-11-22T17:27:39.178903Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0032351016998291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.airport_maps", "compiled": true, "compiled_code": "with stg_airport_maps as (\n  select airport, terminal, business,\n      case category\n        when 'Airline Services' then 'Airline Service'\n        when 'Airline Services' then 'Airline Service'\n        when 'Cafe' then 'Coffee Shop'\n        when 'Financial Services' then 'Financial Service'\n        when 'Retail/Dining' then 'Retail / Dining'\n        when 'Things To Do' then 'Things to Do'\n        when 'Transportation' then 'Transportation Service'\n        when 'Vending' then 'Vending Machine'\n        when 'Service' then 'Services'\n        else category end as category,\n      location, dining, menu_items, _data_source, _load_time\n    from `cs378-fa2025`.`air_travel_raw`.`airport_maps`\n)\n\nselect * from stg_airport_maps", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.180640Z", "completed_at": "2025-11-22T17:27:39.182600Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.182750Z", "completed_at": "2025-11-22T17:27:39.182754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003256082534790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.airport_reviews", "compiled": true, "compiled_code": "with stg_airport_reviews as (\n\tselect id,\n\t    safe_cast(threadRef as INTEGER) as review_thread,\n\t    airportRef as airport_id,\n\t    airportIdent as airport_code,\n\t    safe_cast(split(date, ' ')[0] as DATE) as review_date,\n\t    memberNickname as review_author,\n\t    subject as review_subject,\n\t    body as review_details,\n\t    broad_category,\n        sub_category,\n        sentiment,\n        language,\n\t    _data_source,\n\t    _load_time\n\tfrom `cs378-fa2025`.`air_travel_raw`.`airport_reviews`\n)\n\nselect * from stg_airport_reviews", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.184259Z", "completed_at": "2025-11-22T17:27:39.185629Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.185778Z", "completed_at": "2025-11-22T17:27:39.185781Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002565145492553711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.airports", "compiled": true, "compiled_code": "with stg_airports as (\n\tselect safe_cast(airport_id as INTEGER) as id,\n\t    airport_name as name,\n\t    airport_city as city,\n\t    airport_country as country,\n\t    case iata\n\t\t    when '\\\\N' then null\n\t\t    else iata\n\t\t    end as iata,\n\t    case icao\n\t\t    when '\\\\N' then null\n\t\t    else icao\n\t\t    end as icao,\n\t    latitude,\n\t    longitude,\n\t    altitude,\n\t    safe_cast(timezone as INTEGER) as timezone_delta,\n        daylight_savings_time,\n        case tz_database_timezone\n\t\t    when '\\\\N' then null\n\t\t    else tz_database_timezone\n\t\t    end as timezone_name,\n\t    case type\n\t\t    when '\\\\N' then null\n\t\t    else type\n\t\t    end as type,\n\t    case source\n\t\t    when '\\\\N' then null\n\t\t    else source\n\t\t    end as source,\n\t    _data_source,\n\t    _load_time\n\tfrom `cs378-fa2025`.`air_travel_raw`.`airports`    \n)\n\nselect * from stg_airports", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`airports`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.187251Z", "completed_at": "2025-11-22T17:27:39.188925Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.189072Z", "completed_at": "2025-11-22T17:27:39.189074Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002833843231201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.countries", "compiled": true, "compiled_code": "with stg_countries as (\n    select country_name as name,\n    case iso_code\n      when '\\\\N' then null\n      else iso_code\n      end as iso_code,\n    dafif_code,\n    _data_source,\n    _load_time\n    from `cs378-fa2025`.`air_travel_raw`.`countries`\n)\n\nselect * from stg_countries", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`countries`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.190538Z", "completed_at": "2025-11-22T17:27:39.191948Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.192130Z", "completed_at": "2025-11-22T17:27:39.192133Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026350021362304688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.flight_delays", "compiled": true, "compiled_code": "with stg_flight_delays as (\n    select event_month, carrier, carrier_name, airport_code,\n        split(city_state, ',')[0] as airport_city, \n        split(city_state, ',')[1] as airport_state,\n        airport_name, \n        * except (event_month, carrier, carrier_name, airport_code, airport_name, city_state)\n    from\n        (select date(year, month, 01) as event_month, \n            carrier, carrier_name, airport as airport_code,\n            split(airport_name, ':')[0] as city_state, \n            split(airport_name, ':')[1] as airport_name,\n            safe_cast(arr_flights as INTEGER) as arr_total, \n            safe_cast(arr_cancelled as INTEGER) as arr_cancelled,\n            safe_cast(arr_diverted as INTEGER) as arr_diverted, \n            safe_cast(arr_delay as INTEGER) as arr_delay_min,\n            safe_cast(carrier_delay as INTEGER) as carrier_delay_min, \n            safe_cast(weather_delay as INTEGER) as weather_delay_min, \n            safe_cast(nas_delay as INTEGER) as nas_delay_min,\n            safe_cast(late_aircraft_delay as INTEGER) as late_aircraft_delay_min, \n            _data_source, _load_time\n          from `cs378-fa2025`.`air_travel_raw`.`flight_delays`)\n)\n\nselect * from stg_flight_delays", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.193606Z", "completed_at": "2025-11-22T17:27:39.195007Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.195153Z", "completed_at": "2025-11-22T17:27:39.195155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002541065216064453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.flight_routes", "compiled": true, "compiled_code": "with stg_flight_routes as (\n  select airline_code,\n    safe_cast(airline_id as INTEGER) as airline_id,\n    source_airport,\n    case source_airport_id\n      when '\\\\N' then null\n      else safe_cast(source_airport_id as INTEGER)\n      end as source_airport_id,\n    dest_airport,\n    case dest_airport_id\n      when '\\\\N' then null\n      else safe_cast(dest_airport_id as INTEGER)\n      end as dest_airport_id,\n    codeshare,\n    stops,\n    equipment,\n    _data_source,\n    _load_time\n  from `cs378-fa2025`.`air_travel_raw`.`flight_routes`\n)\n\nselect * from stg_flight_routes", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.196506Z", "completed_at": "2025-11-22T17:27:39.197375Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.197518Z", "completed_at": "2025-11-22T17:27:39.197521Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00196075439453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_establishment_canonical_categories", "compiled": true, "compiled_code": "with tmp_airport_establishment_canonical_categories as (\n    select 'Quick Service & Grab-and-Go' as broad_category, 'National/International Fast Food Chains' as sub_category\n\tunion all\n    select 'Quick Service & Grab-and-Go' as broad_category, 'Coffee & Beverage Shops' as sub_category\n\tunion all\n    select 'Quick Service & Grab-and-Go' as broad_category, 'Snack Kiosks' as sub_category\n\tunion all\n    select 'Quick Service & Grab-and-Go' as broad_category, 'Pre-Packaged Foods' as sub_category\n\tunion all\n    select 'Fast Casual' as broad_category, 'Gourmet Burgers & Sandwiches' as sub_category\n\tunion all\n    select 'Fast Casual' as broad_category, 'Build-Your-Own Concepts' as sub_category\n\tunion all\n    select 'Fast Casual' as broad_category, 'Pizzerias' as sub_category\n\tunion all\n    select 'Full-Service Dining' as broad_category, 'Casual Dining Restaurants' as sub_category\n\tunion all\n    select 'Full-Service Dining' as broad_category, 'Upscale & Chef-Driven Restaurants' as sub_category\n\tunion all\n    select 'Full-Service Dining' as broad_category, 'Themed Restaurants & Sports Bars' as sub_category\n\tunion all\n    select 'Bars & Lounges' as broad_category, 'Wine Bars' as sub_category\n\tunion all\n    select 'Bars & Lounges' as broad_category, 'Craft Beer Pubs' as sub_category\n\tunion all\n    select 'Bars & Lounges' as broad_category, 'Cocktail Lounges' as sub_category\n\tunion all\n    select 'Travel Essentials & Convenience' as broad_category, 'Newsstands & Bookstores' as sub_category\n\tunion all\n    select 'Travel Essentials & Convenience' as broad_category, 'Pharmacies & Personal Care' as sub_category\n\tunion all\n    select 'Travel Essentials & Convenience' as broad_category, 'Travel Gear & Luggage' as sub_category\n\tunion all\n    select 'Specialty Retail' as broad_category, 'Electronics' as sub_category\n\tunion all\n    select 'Specialty Retail' as broad_category, 'Local Souvenirs & Gifts' as sub_category\n\tunion all\n    select 'Specialty Retail' as broad_category, 'Apparel & Accessories' as sub_category\n\tunion all\n    select 'Luxury & High-End Goods' as broad_category, 'Confectionery & Gourmet Foods' as sub_category\n\tunion all\n    select 'Luxury & High-End Goods' as broad_category, 'Designer Fashion' as sub_category\n\tunion all\n    select 'Luxury & High-End Goods' as broad_category, 'Jewelry & Watches' as sub_category\n\tunion all\n    select 'Luxury & High-End Goods' as broad_category, 'High-End Cosmetics' as sub_category\n\tunion all\n    select 'Duty-Free' as broad_category, 'Liquor & Tobacco' as sub_category\n\tunion all\n    select 'Duty-Free' as broad_category, 'Fragrances & Cosmetics' as sub_category\n\tunion all\n    select 'Duty-Free' as broad_category, 'Luxury Accessories & Confectionery' as sub_category\n\tunion all\n    select 'Passenger Comfort & Wellness' as broad_category, 'Spas & Salons' as sub_category\n\tunion all\n    select 'Passenger Comfort & Wellness' as broad_category, 'Pay-Per-Use Lounges' as sub_category\n\tunion all\n    select 'Passenger Comfort & Wellness' as broad_category, 'Yoga & Meditation Rooms' as sub_category\n\tunion all\n    select 'Passenger Comfort & Wellness' as broad_category, 'Shower Facilities' as sub_category\n\tunion all\n    select 'Financial & Business Services' as broad_category, 'Currency Exchan' as sub_category\n\tunion all\n    select 'Financial & Business Services' as broad_category, 'ATMs & Banking Services' as sub_category\n\tunion all\n    select 'Financial & Business Services' as broad_category, 'Business Centers & Work Pods' as sub_category\n\tunion all\n    select 'Practical & Convenience Services' as broad_category, 'Luggage Storage & Wrapping' as sub_category\n\tunion all\n    select 'Practical & Convenience Services' as broad_category, 'Postal & Shipping Services' as sub_category\n\tunion all\n    select 'Practical & Convenience Services' as broad_category, 'Pet Relief & Care Areas' as sub_category\n\tunion all\n    select 'Practical & Convenience Services' as broad_category, 'Vending Machines (non-F&B)' as sub_category\n)\n\nselect * \nfrom tmp_airport_establishment_canonical_categories", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.198799Z", "completed_at": "2025-11-22T17:27:39.200205Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.200334Z", "completed_at": "2025-11-22T17:27:39.200336Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002404928207397461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tsa_traffic", "compiled": true, "compiled_code": "with stg_tsa_traffic as (\n  select safe_cast(event_date as DATE format 'MM/DD/YYYY') as event_date,\n    safe_cast(event_hour as INTEGER) as event_hour,\n    airport_code,\n    airport_name,\n    airport_city,\n    airport_state,\n    security_checkpoint,\n    safe_cast(total_traffic as INTEGER) as total_traffic,\n    _data_source,\n    _load_time\n  from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic`\n)\n\nselect * from stg_tsa_traffic", "relation_name": "`cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.201563Z", "completed_at": "2025-11-22T17:27:39.202865Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.202996Z", "completed_at": "2025-11-22T17:27:39.202999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023069381713867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_aircraft_icao", "compiled": true, "compiled_code": "with tmp_aircraft_icao as (\n    select\n      name as aircraft_name,\n      AI.GENERATE(\n        ('What is the icao code of aircraft ', name, '? If it does not have one, return None.'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'aircraft_icao STRING') as llm_response\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`\n    where icao is null\n  )\nselect aircraft_name, llm_response.aircraft_icao\nfrom tmp_aircraft_icao", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_aircraft_icao`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.204275Z", "completed_at": "2025-11-22T17:27:39.209867Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.210007Z", "completed_at": "2025-11-22T17:27:39.210010Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006687164306640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`aircrafts` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.211297Z", "completed_at": "2025-11-22T17:27:39.213114Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.213242Z", "completed_at": "2025-11-22T17:27:39.213244Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002794981002807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airlines` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.214402Z", "completed_at": "2025-11-22T17:27:39.215635Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.215754Z", "completed_at": "2025-11-22T17:27:39.215757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002177000045776367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_establishment_unique", "compiled": true, "compiled_code": "with tmp_airport_establishment_unique as (\n  select distinct business, category, dining, _data_source, _load_time\n  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`\n  order by category, business\n)\nselect * \nfrom tmp_airport_establishment_unique", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.216937Z", "completed_at": "2025-11-22T17:27:39.218758Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.218883Z", "completed_at": "2025-11-22T17:27:39.218885Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002760171890258789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_maps` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.219985Z", "completed_at": "2025-11-22T17:27:39.221943Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.222067Z", "completed_at": "2025-11-22T17:27:39.222069Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002866983413696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_reviews` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.223151Z", "completed_at": "2025-11-22T17:27:39.224229Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.224346Z", "completed_at": "2025-11-22T17:27:39.224347Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019500255584716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_llm", "compiled": true, "compiled_code": "\n\nwith tmp_airport_llm as (\n    select\n      name,\n      country,\n      iata,\n      AI.GENERATE(\n        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'icao STRING, state_prov STRING') as llm_response\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`\n    where iata is not null\n  )\nselect name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov\nfrom tmp_airport_llm", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.225414Z", "completed_at": "2025-11-22T17:27:39.227181Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.227302Z", "completed_at": "2025-11-22T17:27:39.227303Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026428699493408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airports` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.228342Z", "completed_at": "2025-11-22T17:27:39.229481Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.229600Z", "completed_at": "2025-11-22T17:27:39.229602Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0020210742950439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_country_iso_codes", "compiled": true, "compiled_code": "\n\nwith tmp_country_iso_codes as (\n    select\n      name,\n      AI.GENERATE(\n        ('What is the iso code for country ', name, '? If it does not have one, return None.'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'iso_code STRING') as llm_response\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`\n    where iso_code is null\n  )\nselect name, llm_response.iso_code as mapped_iso_code\nfrom tmp_country_iso_codes", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.230702Z", "completed_at": "2025-11-22T17:27:39.232582Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.232700Z", "completed_at": "2025-11-22T17:27:39.232703Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027799606323242188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`countries` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.233758Z", "completed_at": "2025-11-22T17:27:39.235408Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.235522Z", "completed_at": "2025-11-22T17:27:39.235524Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025031566619873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_delays` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.236553Z", "completed_at": "2025-11-22T17:27:39.238316Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.238433Z", "completed_at": "2025-11-22T17:27:39.238435Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026280879974365234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_routes` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.239468Z", "completed_at": "2025-11-22T17:27:39.241025Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.241140Z", "completed_at": "2025-11-22T17:27:39.241142Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002392292022705078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee", "compiled": true, "compiled_code": "\n        select\n            row_count\n        from (\n            select\n                count(*) AS row_count\n            from `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`\n        )\n        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic` )\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.242168Z", "completed_at": "2025-11-22T17:27:39.243589Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.243698Z", "completed_at": "2025-11-22T17:27:39.243700Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002276182174682617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Aircraft", "compiled": true, "compiled_code": "with Aircraft as (\n    select icao, iata, name, _data_source, _load_time\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`\n    where icao is not null\n    union all\n    select i.aircraft_icao as icao, a.iata, a.name, a._data_source, a._load_time\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_aircraft_icao` i\n    on a.name = i.aircraft_name\n    where a.icao is null\n)\n\nselect *\nfrom Aircraft", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.244750Z", "completed_at": "2025-11-22T17:27:39.245735Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.245845Z", "completed_at": "2025-11-22T17:27:39.245847Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018570423126220703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_establishment_raw_categories", "compiled": true, "compiled_code": "with airport_establishment_raw_categories as (\n  select distinct business, category\n  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`\n  where category not in ('Airline', 'Airline Service', 'Airline Services', 'Airline Check-in', 'Airline Ticketing',\n      'Airline Gate / Check-in', 'Airline Lounge', 'Airport Lounge', 'Airport Service', 'Airport Services', 'Air Freight', 'Car Rental',\n      'Information Kiosk', 'Information Service', 'Parking', 'Transportation Service')\n)\n\nselect * \nfrom airport_establishment_raw_categories", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.246921Z", "completed_at": "2025-11-22T17:27:39.248210Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.248325Z", "completed_at": "2025-11-22T17:27:39.248327Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0021882057189941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_all", "compiled": true, "compiled_code": "with tmp_airport_all as (\n    select distinct al.llm_icao as icao, a.iata, a.name, a.city, al.llm_state_prov as state_prov, \n        a.country, a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, \n        a.timezone_name, a.type, a.source, 'openflights,llm' as _data_source, a._load_time\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm` al\n    on a.name = al.name and a.country = al.country\n    where a.iata is not null\n    and al.llm_icao is not null\n)\n\nselect * from tmp_airport_all", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.249388Z", "completed_at": "2025-11-22T17:27:39.250482Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.250590Z", "completed_at": "2025-11-22T17:27:39.250592Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019636154174804688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Country", "compiled": true, "compiled_code": "with Country as (\n    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` \n    group by iso_code, name, _data_source, _load_time\n)\n\nselect *\nfrom Country\nwhere iso_code is not null \nunion all\nselect t.mapped_iso_code, c.name, c.dafif_codes, c._data_source, c._load_time \nfrom Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes` t \non c.name = t.name\nwhere t.mapped_iso_code is not null\nand c.iso_code is null", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Country`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.251647Z", "completed_at": "2025-11-22T17:27:39.255314Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.255430Z", "completed_at": "2025-11-22T17:27:39.255433Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004535675048828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        icao, iata, name\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`\n    group by icao, iata, name\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.256419Z", "completed_at": "2025-11-22T17:27:39.257512Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.257623Z", "completed_at": "2025-11-22T17:27:39.257625Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001882791519165039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_establishment_broad_categories_mapped", "compiled": true, "compiled_code": "\n\nwith canonical_categories as (\n    select ARRAY_AGG(distinct broad_category) AS broad_categories\n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`\n),\ntmp_airport_establishment_broad_categories_mapped as (\n    select\n      business,\n      category as raw_category,\n      AI.GENERATE(\n        ('Map the business ', business, ' to its most fitting broad category from this canonical category list:',\n          broad_categories),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'broad_category STRING') as llm_response\n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`\n    cross join canonical_categories\n  )\nselect business, raw_category, llm_response.broad_category as broad_category\nfrom tmp_airport_establishment_broad_categories_mapped", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_mapped`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.258585Z", "completed_at": "2025-11-22T17:27:39.259751Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.259859Z", "completed_at": "2025-11-22T17:27:39.259861Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0020318031311035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_duplicates", "compiled": true, "compiled_code": "with tmp_airport_duplicates as (\n    select * \n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`\n    where icao in\n        (select icao\n        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`\n        group by icao\n        having count(*) > 1)\n)\n\nselect * from tmp_airport_duplicates", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.260968Z", "completed_at": "2025-11-22T17:27:39.261999Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.262095Z", "completed_at": "2025-11-22T17:27:39.262096Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018680095672607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airline_country_mapped", "compiled": true, "compiled_code": "\n\nwith airline_orphan_countries as (\n    select distinct country\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`\n    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)\n),\ntmp_airline_countries_mapped as (\n    select\n      country,\n      AI.GENERATE(\n        ('If ', country, ' is a recognized country, return its iso code. If it is not a recognized country, return None.'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'iso_code STRING') as llm_response\n    from airline_orphan_countries\n  )\n  select country as original_country, llm_response.iso_code as mapped_iso_code\n  from tmp_airline_countries_mapped", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.263092Z", "completed_at": "2025-11-22T17:27:39.265895Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.265995Z", "completed_at": "2025-11-22T17:27:39.265997Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003633260726928711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iso_code\nfrom `cs378-fa2025`.`dbt_air_travel_int`.`Country`\nwhere iso_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.266946Z", "completed_at": "2025-11-22T17:27:39.269003Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.269108Z", "completed_at": "2025-11-22T17:27:39.269110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0028400421142578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.unique_Country_iso_code.5e9388f08c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select iso_code as unique_field\n  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`\n  where iso_code is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.270108Z", "completed_at": "2025-11-22T17:27:39.271042Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.271154Z", "completed_at": "2025-11-22T17:27:39.271156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017418861389160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_establishment_broad_categories_frequency", "compiled": true, "compiled_code": "with broad_categories_frequency as (\n    select broad_category, count(*) as count\n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_mapped`\n    group by broad_category\n    order by count desc\n)\n\nselect *\nfrom broad_categories_frequency", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_frequency`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.272106Z", "completed_at": "2025-11-22T17:27:39.273276Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.273387Z", "completed_at": "2025-11-22T17:27:39.273388Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003329038619995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_establishment_sub_categories_mapped", "compiled": true, "compiled_code": "\n\nwith tmp_establishment_categories as (\n    select m.business, m.broad_category,\n      array_agg(distinct c.sub_category) AS sub_categories\n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_mapped` m\n    join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories` c\n    on m.broad_category = c.broad_category\n    where m.broad_category is not null\n    group by m.business, m.broad_category\n),\ntmp_airport_establishment_sub_categories_mapped as (\n    select\n      business,\n      broad_category,\n      AI.GENERATE(\n        ('Map the airport concession ', business, ' with broad category ', broad_category,\n        ' to its most fitting sub category based on this canonical list of subcategories: ', sub_categories),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'sub_category STRING') as llm_response\n    from tmp_establishment_categories\n  )\nselect business, broad_category, llm_response.sub_category as sub_category\nfrom tmp_airport_establishment_sub_categories_mapped", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_sub_categories_mapped`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.275802Z", "completed_at": "2025-11-22T17:27:39.276907Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.277021Z", "completed_at": "2025-11-22T17:27:39.277024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019838809967041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_duplicates_embeddings", "compiled": true, "compiled_code": "\n  \n  with tmp_airport_duplicates_embeddings as (\n      select icao, iata, name, ml_generate_embedding_result as embedding\n      from\n      ML.GENERATE_EMBEDDING(\n        model air_travel_model.embedding_model,\n        (select icao, iata, name, concat(icao, ',', iata, ',', name) as content\n        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`),\n        struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type)\n      )\n  )\n\n  select * from tmp_airport_duplicates_embeddings", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.278121Z", "completed_at": "2025-11-22T17:27:39.279544Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.279671Z", "completed_at": "2025-11-22T17:27:39.279674Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002513885498046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_inference_results", "compiled": true, "compiled_code": "\n\nwith tmp_airport_inference_results as (\n    select icao,\n      AI.GENERATE(\n        ('What are the iata code and name of the airport that has the icao code of ', icao, '?'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'iata STRING, name STRING') as llm_response\n    from (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)\n)\nselect icao, llm_response.iata as iata, llm_response.name as name\nfrom tmp_airport_inference_results", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.280935Z", "completed_at": "2025-11-22T17:27:39.368451Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.368590Z", "completed_at": "2025-11-22T17:27:39.368593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08855915069580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Airline", "compiled": true, "compiled_code": "with airline_country_joined as (\n  select a.id, a.name, a.alias, a.icao, a.iata, a.callsign, \n    c.iso_code as country_code, a.active, \n    a._data_source, a._load_time\n  from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c\n  on a.country = c.name\n  where c.iso_code is not null \n),\nairline_country_fuzzy_matches as (\n  select a.id, a.name, a.alias, a.icao, a.iata, a.callsign, \n    c.iso_code as country_code, a.active, \n    a._data_source, a._load_time\n  from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped` amc\n  on a.country = amc.original_country\n  join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c\n  on amc.mapped_iso_code = c.iso_code\n  where c.iso_code is not null\n)\n\nselect *\nfrom airline_country_joined\nunion distinct\nselect * \nfrom airline_country_fuzzy_matches", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Airline`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.369937Z", "completed_at": "2025-11-22T17:27:39.371222Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.371334Z", "completed_at": "2025-11-22T17:27:39.371336Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0022890567779541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Airport_Establishment", "compiled": true, "compiled_code": "with airport_establishment_joined as (\n  select distinct e.business, m.broad_category, m.sub_category,\n    case when m.broad_category in ('Fast Casual', 'Full-Service Dining') then True else False end as dining,\n    'airport.guide,llm' as _data_source, e._load_time\n  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique` e \n  join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_sub_categories_mapped` m\n  on e.business = m.business\n),\nAirport_Establishment as (\n  select *, rank() over (\n      partition by business\n      order by \n        (select count \n        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_frequency` \n        where broad_category = ae.broad_category)\n  ) as business_rank\n  from airport_establishment_joined ae\n)\n\nselect * except(business_rank)\nfrom Airport_Establishment\nwhere business_rank = 1", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.372426Z", "completed_at": "2025-11-22T17:27:39.373530Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.373682Z", "completed_at": "2025-11-22T17:27:39.373684Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00203704833984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_inference_results_embeddings", "compiled": true, "compiled_code": "\n\nwith tmp_airport_inference_results_embeddings as (\n  select icao, iata, name, ml_generate_embedding_result as embedding\n  from\n    ML.GENERATE_EMBEDDING(\n      model air_travel_model.embedding_model,\n      (select icao, iata, name, concat(icao, ',', iata, ',', name) as content\n       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results`\n       where iata is not null\n       and name != 'Unknown'),\n       struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type)\n    )\n)\n\nselect * from tmp_airport_inference_results_embeddings", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results_embeddings`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.374747Z", "completed_at": "2025-11-22T17:27:39.376305Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.376430Z", "completed_at": "2025-11-22T17:27:39.376432Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024330615997314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.not_null_Airline_id.b0e38ad347", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `cs378-fa2025`.`dbt_air_travel_int`.`Airline`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.377420Z", "completed_at": "2025-11-22T17:27:39.379968Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.380080Z", "completed_at": "2025-11-22T17:27:39.380082Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034019947052001953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select country_code as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`\n    where country_code is not null\n),\n\nparent as (\n    select iso_code as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.381169Z", "completed_at": "2025-11-22T17:27:39.382587Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.382696Z", "completed_at": "2025-11-22T17:27:39.382698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002249002456665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.unique_Airline_id.cb196c2622", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.383699Z", "completed_at": "2025-11-22T17:27:39.384599Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.384699Z", "completed_at": "2025-11-22T17:27:39.384701Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017428398132324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Food_Beverage", "compiled": true, "compiled_code": "with Food_Beverage as (\n  select distinct business, menu_item\n  from\n    (select e.business, split(m.menu_items, ',') as menu_items\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment` e join `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps` m\n    on e.business = m.business\n    where e.dining = True) t, unnest(t.menu_items) as menu_item\n  order by business\n)\n\nselect * \nfrom Food_Beverage", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.385769Z", "completed_at": "2025-11-22T17:27:39.387053Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.387177Z", "completed_at": "2025-11-22T17:27:39.387179Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0021419525146484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect business\nfrom `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`\nwhere business is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.388157Z", "completed_at": "2025-11-22T17:27:39.389245Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.389344Z", "completed_at": "2025-11-22T17:27:39.389346Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001882791519165039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select business as unique_field\n  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`\n  where business is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.390298Z", "completed_at": "2025-11-22T17:27:39.391546Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.391659Z", "completed_at": "2025-11-22T17:27:39.391660Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002084970474243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_vector_search_results", "compiled": true, "compiled_code": "\n\nwith tmp_airport_vector_search_results as (\n  select base.icao as base_icao, base.iata as base_iata, base.name as base_name,\n    query.icao as query_icao, query.iata as query_iata, query.name as query_name,\n    distance\n  from\n    vector_search(\n      table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`, -- this is the base (i.e what's in the Airport table)\n      'embedding',\n      table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results_embeddings`, -- this is the query (i.e. results from LLM inference)\n      'embedding',\n      top_k => 1,\n      distance_type => 'COSINE')\n  where query.icao = base.icao\n  order by distance\n)\n\nselect * \nfrom tmp_airport_vector_search_results", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.392727Z", "completed_at": "2025-11-22T17:27:39.394360Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.394470Z", "completed_at": "2025-11-22T17:27:39.394472Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024662017822265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        business, menu_item\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`\n    group by business, menu_item\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.395416Z", "completed_at": "2025-11-22T17:27:39.397005Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.397109Z", "completed_at": "2025-11-22T17:27:39.397111Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023660659790039062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select business as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`\n    where business is not null\n),\n\nparent as (\n    select business as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.398088Z", "completed_at": "2025-11-22T17:27:39.399104Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.399211Z", "completed_at": "2025-11-22T17:27:39.399213Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018210411071777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_refined", "compiled": true, "compiled_code": "with tmp_airport_refined as (\n    select *\n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`\n    where icao not in (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)\n    union all\n    select * from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`\n    where concat(icao, ',', iata, ',', name) in\n      (select concat(base_icao, ',', base_iata, ',', base_name)\n       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`\n       where distance < 0.08)\n)\n\nselect * from tmp_airport_refined", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.400327Z", "completed_at": "2025-11-22T17:27:39.401427Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.401534Z", "completed_at": "2025-11-22T17:27:39.401536Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019440650939941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_country_iso_codes", "compiled": true, "compiled_code": "\n\nwith tmp_orphan_country as (\n    select distinct country as airport_country_name\n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`\n    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)\n),\ntmp_airport_country_iso_codes as (\n    select airport_country_name,\n      AI.GENERATE(\n        ('What is the iso code for the country ', airport_country_name, '? If it does not have an iso code, return None.'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'iso_code STRING') as llm_response\n    from tmp_orphan_country\n)\nselect airport_country_name, llm_response.iso_code as mapped_iso_code\nfrom tmp_airport_country_iso_codes", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.402630Z", "completed_at": "2025-11-22T17:27:39.403867Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.404015Z", "completed_at": "2025-11-22T17:27:39.404017Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0022110939025878906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_country_closest_match", "compiled": true, "compiled_code": "with unmatched_country_codes as (\n    select airport_country_name, mapped_iso_code \n    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`\n    where airport_country_name not in \n        (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country` )\n),\nfind_closest_match as (\n    select u.airport_country_name, u.mapped_iso_code as original_iso_code, \n      AI.GENERATE(\n      ('What is the closest match for country ', airport_country_name, 'with iso code ', mapped_iso_code, ' from the reference list below? Return the most suitable matching iso that appears in parenthesis. If there is no suitable match, return None', array_to_string(array_agg(concat(c.name, ' (', c.iso_code, ')')), ', ')),\n      connection_id => 'us-central1.vertex-ai-connection',\n      endpoint => 'gemini-2.5-flash-lite',\n      model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n      output_schema => 'iso_code STRING') as llm_response\n    from unmatched_country_codes u cross join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c\n    group by u.airport_country_name, u.mapped_iso_code\n)\n\nselect airport_country_name, original_iso_code, \n  llm_response.iso_code as mapped_iso_code\nfrom find_closest_match", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_closest_match`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.405220Z", "completed_at": "2025-11-22T17:27:39.406533Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.406633Z", "completed_at": "2025-11-22T17:27:39.406635Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002130270004272461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Airport", "compiled": true, "compiled_code": "with Airport as (\n  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,\n    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,\n    a.type, a.source, a._data_source, a._load_time\n  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c\n  on a.country = c.name\n  where c.iso_code is not null\n  union all\n  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,\n    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,\n    a.type, a.source, a._data_source, a._load_time\n  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_closest_match` c\n  on a.country = c.airport_country_name\n  where c.mapped_iso_code is not null\n)\n\nselect distinct * \nfrom Airport", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Airport`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.407831Z", "completed_at": "2025-11-22T17:27:39.408876Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.408978Z", "completed_at": "2025-11-22T17:27:39.408980Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0018618106842041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Airport_Concessions", "compiled": true, "compiled_code": "with Airport_Concessions as (\n  select distinct a.icao as airport_icao, m.terminal, m.business, m.location, m._data_source, m._load_time\n  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps` m join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a\n  on upper(m.airport) = a.iata\n  where a.country_code = 'US'\n  and m.business not in\n    (select business from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`)\n  order by m.business\n)\n\nselect * \nfrom Airport_Concessions", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.409976Z", "completed_at": "2025-11-22T17:27:39.411202Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.411302Z", "completed_at": "2025-11-22T17:27:39.411304Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00203704833984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Airport_Review", "compiled": true, "compiled_code": "with Airport_Review as (\n    select distinct r.id, r.review_thread, r.review_date, r.review_author,\n      r.review_subject, r.review_details, a.icao as airport_icao, r.broad_category, r.sub_category, r.sentiment,\n      r.language, r._data_source, r._load_time\n    from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews` r join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a\n    on a.icao = r.airport_code\n)\n\nselect * \nfrom Airport_Review", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.412290Z", "completed_at": "2025-11-22T17:27:39.413402Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.413512Z", "completed_at": "2025-11-22T17:27:39.413514Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002012014389038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Flight_Delays", "compiled": true, "compiled_code": "with Flight_Delays as (\n  select distinct fd.event_month, al.id as airline_id, ap.icao as airport_icao,\n    fd.arr_total, fd.arr_cancelled, fd.arr_diverted, fd.arr_delay_min,\n    fd.carrier_delay_min, fd.weather_delay_min, fd.nas_delay_min, \n    fd.late_aircraft_delay_min, fd._data_source, fd._load_time\n  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays` fd \n  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap on fd.airport_code = ap.iata\n  join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al on fd.carrier_name = al.name\n  where ap.country_code = 'US'\n  and fd.arr_total is not null\n)\n\nselect *\nfrom Flight_Delays", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.414578Z", "completed_at": "2025-11-22T17:27:39.415837Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.415933Z", "completed_at": "2025-11-22T17:27:39.415935Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0020689964294433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Flight_Routes", "compiled": true, "compiled_code": "with Flight_Routes as (\n  select distinct r.airline_id, a1.icao as source_airport_icao, \n    a2.icao as dest_airport_icao, r.codeshare, r.stops, r.equipment, \n    r._data_source, r._load_time\n  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes` r\n  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a1\n  on r.source_airport = a1.iata\n  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a2\n  on r.dest_airport = a2.iata\n  join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al\n  on r.airline_id = al.id\n)\n\nselect * \nfrom Flight_Routes", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.416960Z", "completed_at": "2025-11-22T17:27:39.418041Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.418156Z", "completed_at": "2025-11-22T17:27:39.418158Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001984834671020508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.TSA_Traffic", "compiled": true, "compiled_code": "with TSA_Traffic as (\n  select distinct t.event_date, t.event_hour, a.icao as airport_icao, \n    t.security_checkpoint, t.total_traffic, t._data_source, t._load_time\n  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a join `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic` t\n  on a.iata = t.airport_code\n  and a.city = t.airport_city\n  where a.country_code = 'US'\n  and t.event_date is not null\n  and t.event_hour is not null\n  and a.icao is not null\n  and t.security_checkpoint is not null\n)\n\nselect * \nfrom TSA_Traffic", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.419298Z", "completed_at": "2025-11-22T17:27:39.420659Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.420767Z", "completed_at": "2025-11-22T17:27:39.420769Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0022318363189697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.not_null_Airport_icao.8935ba5a96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect icao\nfrom `cs378-fa2025`.`dbt_air_travel_int`.`Airport`\nwhere icao is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.421729Z", "completed_at": "2025-11-22T17:27:39.424595Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.424712Z", "completed_at": "2025-11-22T17:27:39.424714Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037262439727783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select country_code as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`\n    where country_code is not null\n),\n\nparent as (\n    select iso_code as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.425728Z", "completed_at": "2025-11-22T17:27:39.426982Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.427085Z", "completed_at": "2025-11-22T17:27:39.427087Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0020449161529541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.unique_Airport_icao.8928a8a965", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select icao as unique_field\n  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`\n  where icao is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.428042Z", "completed_at": "2025-11-22T17:27:39.430078Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.430200Z", "completed_at": "2025-11-22T17:27:39.430202Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002925872802734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        airport_icao, terminal, business, location\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`\n    group by airport_icao, terminal, business, location\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.431257Z", "completed_at": "2025-11-22T17:27:39.432690Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.432799Z", "completed_at": "2025-11-22T17:27:39.432801Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002246856689453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select airport_icao as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`\n    where airport_icao is not null\n),\n\nparent as (\n    select icao as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.433867Z", "completed_at": "2025-11-22T17:27:39.435387Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.435494Z", "completed_at": "2025-11-22T17:27:39.435496Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002399921417236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.passenger_sentiment_airports_top_kpis", "compiled": true, "compiled_code": "with passenger_sentiment_airports_top_kpis as (\n  select r.sub_category, a.icao, a.name as airport, a.city, \n    a.state_prov, c.name as country, r.sentiment, count(*) as count\n  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review` r\n  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a on r.airport_icao = a.icao\n  join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c on a.country_code = c.iso_code\n  where r.sub_category in ('Wayfinding & Information', 'Airport Staff',\n    'Amenities & Facilities', 'Boarding Process', 'Security Screening',\n    'Food, Beverage & Retail')\n  group by r.sub_category, a.icao, a.name, a.city, a.state_prov, c.name, r.sentiment\n  order by r.sub_category, count(*) desc, a.name\n)\n\nselect *\nfrom passenger_sentiment_airports_top_kpis", "relation_name": "`cs378-fa2025`.`dbt_air_travel_mrt`.`passenger_sentiment_airports_top_kpis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.436497Z", "completed_at": "2025-11-22T17:27:39.437582Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.437703Z", "completed_at": "2025-11-22T17:27:39.437706Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019428730010986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_terminal_mentioned_food_keywords", "compiled": true, "compiled_code": "\n\nwith tmp_airport_terminal_mentioned_food_keywords as (\n  select id as review_id, concat(review_subject, ':', review_details) as review_content,\n  AI.GENERATE(\n    ('If this review mentions food, what food keywords does it mention?',\n      concat(review_subject, ':', review_details), '. Return your answer as a comma-separated list of keywords. If the review does not mention food, return None.'),\n    connection_id => 'us-central1.vertex-ai-connection',\n    endpoint => 'gemini-2.5-flash-lite',\n    model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n    output_schema => 'keywords STRING') as llm_response\n  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`\n  where sentiment != 'Negative'\n)\n\nselect review_id, review_content, llm_response.keywords as keywords\nfrom tmp_airport_terminal_mentioned_food_keywords", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_terminal_mentioned_food_keywords`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.438768Z", "completed_at": "2025-11-22T17:27:39.440214Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.440323Z", "completed_at": "2025-11-22T17:27:39.440326Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002318143844604492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.not_null_Airport_Review_id.715ca7a304", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.441305Z", "completed_at": "2025-11-22T17:27:39.442721Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.442828Z", "completed_at": "2025-11-22T17:27:39.442829Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002222776412963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select airport_icao as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`\n    where airport_icao is not null\n),\n\nparent as (\n    select icao as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.443838Z", "completed_at": "2025-11-22T17:27:39.445143Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.445251Z", "completed_at": "2025-11-22T17:27:39.445253Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002109050750732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.unique_Airport_Review_id.690fe37ba9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.446232Z", "completed_at": "2025-11-22T17:27:39.447497Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.447600Z", "completed_at": "2025-11-22T17:27:39.447602Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0020492076873779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.carrier_flight_delays", "compiled": true, "compiled_code": "with delayed_flights as (\n    select ap.state_prov, ap.icao, ap.name as airport, al.name as airline,\n        count(fd.carrier_delay_min) carrier_delay_count\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays` fd\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al\n        on fd.airline_id = al.id\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap\n        on fd.airport_icao = ap.icao\n    where carrier_delay_min > 0\n    and weather_delay_min = 0\n    group by ap.state_prov, ap.icao, ap.name, al.name\n    order by ap.state_prov, al.name\n),\nall_flights as (\n    select ap.state_prov, ap.icao, ap.name as airport, al.name as airline,\n        count(*) as total_flights\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays` fd\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al\n        on fd.airline_id = al.id\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap\n        on fd.airport_icao = ap.icao\n    group by ap.state_prov, ap.icao, ap.name, al.name\n    order by ap.state_prov, al.name\n)\n\nselect state_prov, icao, airport, airline, carrier_delay_count, total_flights,\n  round(carrier_delay_count / total_flights * 100) as delay_rate_percent\nfrom delayed_flights join all_flights\nusing (state_prov, icao, airport, airline)\norder by delay_rate_percent desc", "relation_name": "`cs378-fa2025`.`dbt_air_travel_mrt`.`carrier_flight_delays`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.448594Z", "completed_at": "2025-11-22T17:27:39.450543Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.450662Z", "completed_at": "2025-11-22T17:27:39.450664Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0028650760650634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        event_month, airline_id, airport_icao\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`\n    group by event_month, airline_id, airport_icao\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.451716Z", "completed_at": "2025-11-22T17:27:39.453428Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.453538Z", "completed_at": "2025-11-22T17:27:39.453540Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002511739730834961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select airline_id as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`\n    where airline_id is not null\n),\n\nparent as (\n    select id as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.454481Z", "completed_at": "2025-11-22T17:27:39.456031Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.456142Z", "completed_at": "2025-11-22T17:27:39.456144Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023660659790039062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select airport_icao as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`\n    where airport_icao is not null\n),\n\nparent as (\n    select icao as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.457120Z", "completed_at": "2025-11-22T17:27:39.458383Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.458495Z", "completed_at": "2025-11-22T17:27:39.458496Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0020360946655273438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.Route_Equipment", "compiled": true, "compiled_code": "with Route_Equipment as (\n    select airline_id, source_airport_icao, dest_airport_icao, equipment, _data_source, _load_time\n    from (\n        select airline_id, source_airport_icao, dest_airport_icao, split(trim(equipment), ' ') as equipment_array,\n            _data_source, _load_time\n        from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`\n        where equipment is not null) r, unnest(r.equipment_array) as equipment\n)\n\nselect distinct re.airline_id, re.source_airport_icao, re.dest_airport_icao,\n    a.icao as icao_equipment, re._data_source, re._load_time\nfrom Route_Equipment re join `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft` a\non re.equipment = a.iata\njoin `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al \non re.airline_id = al.id", "relation_name": "`cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.459507Z", "completed_at": "2025-11-22T17:27:39.461331Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.461443Z", "completed_at": "2025-11-22T17:27:39.461445Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027091503143310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        airline_id, source_airport_icao, dest_airport_icao\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`\n    group by airline_id, source_airport_icao, dest_airport_icao\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.462419Z", "completed_at": "2025-11-22T17:27:39.463783Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.463896Z", "completed_at": "2025-11-22T17:27:39.463898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0022280216217041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select airline_id as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`\n    where airline_id is not null\n),\n\nparent as (\n    select id as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.464967Z", "completed_at": "2025-11-22T17:27:39.466644Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.466755Z", "completed_at": "2025-11-22T17:27:39.466757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002508878707885742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select dest_airport_icao as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`\n    where dest_airport_icao is not null\n),\n\nparent as (\n    select icao as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.467800Z", "completed_at": "2025-11-22T17:27:39.469395Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.469505Z", "completed_at": "2025-11-22T17:27:39.469508Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002473115921020508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select source_airport_icao as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`\n    where source_airport_icao is not null\n),\n\nparent as (\n    select icao as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.470520Z", "completed_at": "2025-11-22T17:27:39.471985Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.472102Z", "completed_at": "2025-11-22T17:27:39.472105Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002354860305786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.foot_traffic_starbucks_airports_monthly", "compiled": true, "compiled_code": "with foot_traffic_starbucks_airports_monthly as (\n    select case month_of_year\n        when 1 then 'January'\n        when 2 then 'February'\n        when 3 then 'March'\n        when 4 then 'April'\n        when 5 then 'May'\n        when 6 then 'June'\n        when 7 then 'July'\n        when 8 then 'August'\n        when 9 then 'September'\n        when 10 then 'October'\n        when 11 then 'November'\n        when 12 then 'December' end as month_long, * except (month_of_year)\n    from\n        (select extract(month from t.event_date) as month_of_year, \n            t.airport_icao, a.name as airport_name,\n            ac.location, round(avg(total_traffic), 2) avg_foot_traffic\n        from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic` t\n        join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a on t.airport_icao = a.icao\n        join `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions` ac on a.icao = ac.airport_icao\n        where ac.business = 'Starbucks'\n        group by extract(month from t.event_date), t.airport_icao, a.name, ac.location\n        order by airport_icao, month_of_year)\n    )\n\nselect * \nfrom foot_traffic_starbucks_airports_monthly", "relation_name": "`cs378-fa2025`.`dbt_air_travel_mrt`.`foot_traffic_starbucks_airports_monthly`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.473157Z", "completed_at": "2025-11-22T17:27:39.474104Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.474217Z", "completed_at": "2025-11-22T17:27:39.474218Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0017409324645996094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_tsa_checkpoint_terminal", "compiled": true, "compiled_code": "\n\nwith tsa_checkpoints as (\n  select distinct security_checkpoint, airport_icao\n  from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`\n),\ntmp_tsa_checkpoint_terminal as (\n    select airport_icao, security_checkpoint,\n    AI.GENERATE(\n      ('What is the terminal for TSA security checkpoint ', security_checkpoint, ' and airport ', airport_icao, '? If you cannot find it, return None.'),\n      connection_id => 'us-central1.vertex-ai-connection',\n      endpoint => 'gemini-2.5-flash-lite',\n      model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n      output_schema => 'terminal STRING') as llm_response\n  from tsa_checkpoints\n)\n\nselect airport_icao, security_checkpoint, llm_response.terminal as mapped_terminal\nfrom tmp_tsa_checkpoint_terminal", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_tsa_checkpoint_terminal`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.475212Z", "completed_at": "2025-11-22T17:27:39.477247Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.477359Z", "completed_at": "2025-11-22T17:27:39.477361Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029158592224121094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        event_date, event_hour, airport_icao, security_checkpoint\n    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`\n    group by event_date, event_hour, airport_icao, security_checkpoint\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.478374Z", "completed_at": "2025-11-22T17:27:39.479711Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.479819Z", "completed_at": "2025-11-22T17:27:39.479821Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002117156982421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select airport_icao as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`\n    where airport_icao is not null\n),\n\nparent as (\n    select icao as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.480749Z", "completed_at": "2025-11-22T17:27:39.482142Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.482264Z", "completed_at": "2025-11-22T17:27:39.482266Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002335786819458008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.tmp_airport_terminal_food_keywords_category", "compiled": true, "compiled_code": "\n\nwith canonical_food_categories as (\n    select array_to_string(array_agg(distinct sub_category), ', ') as categories\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`\n    where dining = True\n),\ntmp_airport_terminal_food_keywords_category as (\n    select review_id, review_content, keywords,\n      AI.GENERATE(\n        ('Map the food keywords , ', keywords, ' to its best fit category: ', categories,\n          'If the keywords are too generic, return None.'),\n        connection_id => 'us-central1.vertex-ai-connection',\n        endpoint => 'gemini-2.5-flash-lite',\n        model_params => JSON '{\"generation_config\":{\"thinking_config\": {\"thinking_budget\": 0}}, \"tools\": [{\"googleSearch\": {}}]}',\n        output_schema => 'category STRING') as llm_response\n     from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_terminal_mentioned_food_keywords`\n     cross join canonical_food_categories\n     where keywords != 'None'\n  )\n\nselect review_id, review_content, keywords, llm_response.category as category\nfrom tmp_airport_terminal_food_keywords_category", "relation_name": "`cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_terminal_food_keywords_category`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.483564Z", "completed_at": "2025-11-22T17:27:39.485420Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.485535Z", "completed_at": "2025-11-22T17:27:39.485537Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027618408203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.aircraft_flight_delays", "compiled": true, "compiled_code": "with delayed_flights as (\n    select ac.name as aircraft, ac.icao as aircraft_code, \n        count(*) aircraft_delay_flights\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays` fd\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al\n        on fd.airline_id = al.id\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap\n        on fd.airport_icao = ap.icao\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment` re\n        on al.id = re.airline_id and ap.icao = re.dest_airport_icao\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft` ac\n        on re.icao_equipment = ac.icao\n    where carrier_delay_min > 0\n    and weather_delay_min = 0\n    group by ac.name, ac.icao\n    order by ac.name\n),\ntotal_flights as (\n    select ac.name as aircraft, ac.icao as aircraft_code, count(*) aircraft_total_flights\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays` fd\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al\n    on fd.airline_id = al.id\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap\n    on fd.airport_icao = ap.icao\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment` re\n    on al.id = re.airline_id and ap.icao = re.dest_airport_icao\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft` ac\n    on re.icao_equipment = ac.icao\n    group by ac.name, ac.icao\n    order by ac.name\n)\n\nselect aircraft, aircraft_code, aircraft_delay_flights, aircraft_total_flights, round(aircraft_delay_flights / aircraft_total_flights * 100) as aircraft_delay_rate\nfrom delayed_flights\njoin total_flights\nusing (aircraft, aircraft_code)\norder by aircraft_delay_rate desc", "relation_name": "`cs378-fa2025`.`dbt_air_travel_mrt`.`aircraft_flight_delays`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.486576Z", "completed_at": "2025-11-22T17:27:39.489679Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.489796Z", "completed_at": "2025-11-22T17:27:39.489798Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039517879486083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        airline_id, source_airport_icao, dest_airport_icao, icao_equipment\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`\n    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.490792Z", "completed_at": "2025-11-22T17:27:39.492219Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.492332Z", "completed_at": "2025-11-22T17:27:39.492334Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002302885055541992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select airline_id as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`\n    where airline_id is not null\n),\n\nparent as (\n    select id as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.493623Z", "completed_at": "2025-11-22T17:27:39.495145Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.495255Z", "completed_at": "2025-11-22T17:27:39.495257Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023391246795654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select dest_airport_icao as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`\n    where dest_airport_icao is not null\n),\n\nparent as (\n    select icao as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.496209Z", "completed_at": "2025-11-22T17:27:39.497836Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.497945Z", "completed_at": "2025-11-22T17:27:39.497947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002413034439086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select icao_equipment as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`\n    where icao_equipment is not null\n),\n\nparent as (\n    select icao as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.498892Z", "completed_at": "2025-11-22T17:27:39.500324Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.500428Z", "completed_at": "2025-11-22T17:27:39.500430Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024042129516601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select source_airport_icao as from_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`\n    where source_airport_icao is not null\n),\n\nparent as (\n    select icao as to_field\n    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.501801Z", "completed_at": "2025-11-22T17:27:39.503426Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.503535Z", "completed_at": "2025-11-22T17:27:39.503537Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025527477264404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.foot_traffic_starbucks_terminals_monthly", "compiled": true, "compiled_code": "with foot_traffic_starbucks_terminals_monthly as (\n  select case month_of_year\n    when 1 then 'January'\n    when 2 then 'February'\n    when 3 then 'March'\n    when 4 then 'April'\n    when 5 then 'May'\n    when 6 then 'June'\n    when 7 then 'July'\n    when 8 then 'August'\n    when 9 then 'September'\n    when 10 then 'October'\n    when 11 then 'November'\n    when 12 then 'December' end as month_long, * except (month_of_year)\n  from\n    (select extract(month from t.event_date) as month_of_year, \n      ct.mapped_terminal as terminal, t.airport_icao, a.name as airport,\n      ac.location, round(avg(total_traffic), 2) avg_foot_traffic\n    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic` t\n    join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_tsa_checkpoint_terminal` ct\n      on t.airport_icao = ct.airport_icao and t.security_checkpoint = ct.security_checkpoint\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a on t.airport_icao = a.icao\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions` ac on a.icao = ac.airport_icao\n    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions` ac2\n      on ac2.airport_icao = ct.airport_icao and ac2.terminal = ct.mapped_terminal\n    where ac.business = 'Starbucks'\n    group by extract(month from t.event_date), ct.mapped_terminal, t.airport_icao, a.name, ac.location\n    order by airport_icao, month_of_year)\n)\n\nselect *\nfrom foot_traffic_starbucks_terminals_monthly", "relation_name": "`cs378-fa2025`.`dbt_air_travel_mrt`.`foot_traffic_starbucks_terminals_monthly`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-22T17:27:39.504580Z", "completed_at": "2025-11-22T17:27:39.505805Z"}, {"name": "execute", "started_at": "2025-11-22T17:27:39.505919Z", "completed_at": "2025-11-22T17:27:39.505921Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0021381378173828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.air_travel.food_category_comparison", "compiled": true, "compiled_code": "with lax_categories as (\n  select sub_category, count(*) as lax_availability_count\n  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment` e\n  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions` c\n  on e.business = c.business\n  where e.dining = True\n  and c.airport_icao = 'KLAX'\n  group by sub_category\n  order by sub_category\n),\nreviews_categories as (\n  select category, count(*) as num_mentions\n  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_terminal_food_keywords_category`\n  where category != 'None'\n  group by category\n  order by category\n)\n\nselect r.category, r.num_mentions, l.lax_availability_count\nfrom reviews_categories r join lax_categories l\non r.category = l.sub_category\norder by r.category", "relation_name": "`cs378-fa2025`.`dbt_air_travel_mrt`.`food_category_comparison`", "batch_results": null}], "elapsed_time": 1.5168015956878662, "args": {"skip_nodes_if_on_run_start_fails": false, "static": false, "favor_state": false, "partial_parse_file_diff": true, "require_all_warnings_handled_by_warn_error": false, "strict_mode": false, "log_format": "default", "profiles_dir": "/Users/scohen/.dbt", "select": [], "show_resource_report": false, "log_format_file": "debug", "populate_cache": true, "macro_debugging": false, "send_anonymous_usage_stats": true, "upload_to_artifacts_ingest_api": false, "require_nested_cumulative_type_params": false, "which": "generate", "compile": true, "require_generic_test_arguments_property": true, "printer_width": 80, "introspect": true, "quiet": false, "use_colors": true, "show_all_deprecations": false, "exclude": [], "source_freshness_run_project_hooks": true, "require_yaml_configuration_for_mf_time_spines": false, "log_file_max_bytes": 10485760, "empty_catalog": false, "use_fast_test_edges": false, "indirect_selection": "eager", "log_path": "/Users/scohen/UTCS/378/dbt/air_travel/logs", "require_batched_execution_for_custom_microbatch_strategy": false, "state_modified_compare_more_unrendered_values": false, "write_json": true, "version_check": true, "validate_macro_args": false, "cache_selected_only": false, "require_resource_names_without_spaces": true, "static_parser": true, "defer": false, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "state_modified_compare_vars": false, "project_dir": "/Users/scohen/UTCS/378/dbt/air_travel", "use_colors_file": true, "vars": {}, "warn_error_options": {"error": [], "warn": [], "silence": []}, "invocation_command": "dbt docs generate", "log_level_file": "debug", "partial_parse": true, "log_level": "info"}}