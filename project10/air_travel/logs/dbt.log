[0m10:15:47.011965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105673750>]}


============================== 10:15:47.013577 | 82e091e8-85b5-4ed6-a118-ce0e7d5023ae ==============================
[0m10:15:47.013577 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:15:47.013828 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'empty': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m10:15:48.006554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82e091e8-85b5-4ed6-a118-ce0e7d5023ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ccc30>]}
[0m10:15:48.025740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82e091e8-85b5-4ed6-a118-ce0e7d5023ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1334be360>]}
[0m10:15:48.025957 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:15:48.101724 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:15:48.102059 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:15:48.102209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82e091e8-85b5-4ed6-a118-ce0e7d5023ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13346ab50>]}
[0m10:15:48.536535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m10:15:48.539755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82e091e8-85b5-4ed6-a118-ce0e7d5023ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261d6990>]}
[0m10:15:48.564171 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:15:48.564918 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:15:48.571681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82e091e8-85b5-4ed6-a118-ce0e7d5023ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1336f2890>]}
[0m10:15:48.571872 [info ] [MainThread]: Found 1 model, 9 sources, 513 macros
[0m10:15:48.571997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82e091e8-85b5-4ed6-a118-ce0e7d5023ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134c02ea0>]}
[0m10:15:48.572640 [info ] [MainThread]: 
[0m10:15:48.572763 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:48.572862 [info ] [MainThread]: 
[0m10:15:48.573044 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:15:48.573378 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:15:48.573523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:49.034954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now create_cs378-fa2025_dbt_air_travel_stg)
[0m10:15:49.035614 [debug] [ThreadPool]: Creating schema "database: "cs378-fa2025"
schema: "dbt_air_travel_stg"
"
[0m10:15:49.043229 [debug] [ThreadPool]: On create_cs378-fa2025_dbt_air_travel_stg: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "create_cs378-fa2025_dbt_air_travel_stg"} */
create schema if not exists `cs378-fa2025`.`dbt_air_travel_stg`
  
[0m10:15:49.043512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:49.538665 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8571a536-8113-45a8-b6f6-5db846bf0889&page=queryresults
[0m10:15:50.572567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:15:50.572776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:50.893248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82e091e8-85b5-4ed6-a118-ce0e7d5023ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a67a10>]}
[0m10:15:50.893970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:15:50.898613 [debug] [Thread-1 (]: Began running node model.air_travel.aircrafts
[0m10:15:50.899125 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.aircrafts ...................... [RUN]
[0m10:15:50.899465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.aircrafts)
[0m10:15:50.899714 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircrafts
[0m10:15:50.905103 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircrafts"
[0m10:15:50.905814 [debug] [Thread-1 (]: Began executing node model.air_travel.aircrafts
[0m10:15:50.926597 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.aircrafts"
[0m10:15:50.927324 [debug] [Thread-1 (]: On model.air_travel.aircrafts: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.aircrafts"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
      
    
    

    
    OPTIONS()
    as (
      with stg_aircrafts as (
    select aircraft_name as name,
        case iata_code when '\\N' then null else iata_code end as iata,
        case icao_code when '\\N' then null else icao_code end as icao,
        _data_source,
        _load_time
  from `cs378-fa2025`.`air_travel_raw`.`aircrafts`
)

select * from stg_aircrafts
    );
  
[0m10:15:50.927540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:51.591204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b3c42255-2d56-41f6-bd82-09220f6f1349&page=queryresults
[0m10:15:53.942250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e091e8-85b5-4ed6-a118-ce0e7d5023ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160125910>]}
[0m10:15:53.942645 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.aircrafts ................. [[32mCREATE TABLE (246.0 rows, 12.5 KiB processed)[0m in 3.04s]
[0m10:15:53.942945 [debug] [Thread-1 (]: Finished running node model.air_travel.aircrafts
[0m10:15:53.943592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:15:53.944456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:53.944593 [debug] [MainThread]: Connection 'model.air_travel.aircrafts' was properly closed.
[0m10:15:53.944741 [info ] [MainThread]: 
[0m10:15:53.944878 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m10:15:53.945174 [debug] [MainThread]: Command end result
[0m10:15:53.957692 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:15:53.958696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:15:53.961100 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:15:53.961227 [info ] [MainThread]: 
[0m10:15:53.961379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:53.961491 [info ] [MainThread]: 
[0m10:15:53.961614 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:15:53.963499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.975134, "process_in_blocks": "0", "process_kernel_time": 0.27157, "process_mem_max_rss": "390217728", "process_out_blocks": "0", "process_user_time": 1.972893}
[0m10:15:53.963680 [debug] [MainThread]: Command `dbt run` succeeded at 10:15:53.963643 after 6.98 seconds
[0m10:15:53.963822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134c40ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134c634a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13361fcd0>]}
[0m10:15:53.963956 [debug] [MainThread]: Flushing usage events
[0m10:15:54.148893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:28:59.719985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114373750>]}


============================== 10:28:59.721630 | 83d888ee-26b6-4266-a45f-266ad1b0088a ==============================
[0m10:28:59.721630 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:28:59.721895 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select airlines', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'static_parser': 'True', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'introspect': 'True', 'empty': 'False', 'use_colors': 'True', 'no_print': 'None'}
[0m10:29:00.537059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83d888ee-26b6-4266-a45f-266ad1b0088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ccc30>]}
[0m10:29:00.556397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83d888ee-26b6-4266-a45f-266ad1b0088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1611be360>]}
[0m10:29:00.556615 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:29:00.630719 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:29:00.663825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:29:00.664023 [debug] [MainThread]: Partial parsing: added file: air_travel://models/stg/airlines.sql
[0m10:29:00.739365 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m10:29:00.743597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83d888ee-26b6-4266-a45f-266ad1b0088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161716a50>]}
[0m10:29:00.768011 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:29:00.768849 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:29:00.774001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83d888ee-26b6-4266-a45f-266ad1b0088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1611ce8a0>]}
[0m10:29:00.774181 [info ] [MainThread]: Found 2 models, 9 sources, 513 macros
[0m10:29:00.774299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83d888ee-26b6-4266-a45f-266ad1b0088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162a64c90>]}
[0m10:29:00.774861 [info ] [MainThread]: 
[0m10:29:00.774990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:00.775084 [info ] [MainThread]: 
[0m10:29:00.775266 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:29:00.775592 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:29:00.775734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:01.239224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:29:01.239750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:01.558790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83d888ee-26b6-4266-a45f-266ad1b0088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162acadd0>]}
[0m10:29:01.559570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:01.563973 [debug] [Thread-1 (]: Began running node model.air_travel.airlines
[0m10:29:01.564650 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.airlines ....................... [RUN]
[0m10:29:01.565026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.airlines)
[0m10:29:01.565309 [debug] [Thread-1 (]: Began compiling node model.air_travel.airlines
[0m10:29:01.571960 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airlines"
[0m10:29:01.572638 [debug] [Thread-1 (]: Began executing node model.air_travel.airlines
[0m10:29:01.596315 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airlines"
[0m10:29:01.596878 [debug] [Thread-1 (]: On model.air_travel.airlines: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airlines"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
      
    
    

    
    OPTIONS()
    as (
      with stg_airlines as (
  select airline_id as id,
    name,
    case alias
        when '\\N' then null
        else alias
        end as alias,
    case iata
        when '' then null
        else iata
        end as iata,
    case icao
        when '' then null
        else icao
        end as icao,
    case callsign
        when '\\N' then null
        else callsign
        end as callsign,
    case country
        when '\\N' then null
        else country end as country,
    active, _data_source, _load_time
  from `cs378-fa2025`.`air_travel_raw`.`airlines`
)

select * from stg_airlines
    );
  
[0m10:29:01.597102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:02.267476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1692d831-7991-4312-915f-a4dea7b26394&page=queryresults
[0m10:29:04.857759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83d888ee-26b6-4266-a45f-266ad1b0088a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162c25fd0>]}
[0m10:29:04.858437 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.airlines .................. [[32mCREATE TABLE (6.2k rows, 489.7 KiB processed)[0m in 3.29s]
[0m10:29:04.858899 [debug] [Thread-1 (]: Finished running node model.air_travel.airlines
[0m10:29:04.859919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:04.861067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:04.861237 [debug] [MainThread]: Connection 'model.air_travel.airlines' was properly closed.
[0m10:29:04.861416 [info ] [MainThread]: 
[0m10:29:04.861603 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m10:29:04.862020 [debug] [MainThread]: Command end result
[0m10:29:04.877971 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:29:04.878985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:29:04.882076 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:29:04.882224 [info ] [MainThread]: 
[0m10:29:04.882401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:04.882529 [info ] [MainThread]: 
[0m10:29:04.882674 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:29:04.884916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1883793, "process_in_blocks": "0", "process_kernel_time": 0.240256, "process_mem_max_rss": "389873664", "process_out_blocks": "0", "process_user_time": 1.594435}
[0m10:29:04.885134 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:04.885090 after 5.19 seconds
[0m10:29:04.885298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161796d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162c0f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162c0d590>]}
[0m10:29:04.885455 [debug] [MainThread]: Flushing usage events
[0m10:29:05.094432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:31:16.065172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f6c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a73750>]}


============================== 10:31:16.066923 | 11729273-1935-4fbb-89ee-4f4cfe12212e ==============================
[0m10:31:16.066923 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:31:16.067169 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'log_cache_events': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select airport_maps', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'empty': 'False'}
[0m10:31:16.881492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11729273-1935-4fbb-89ee-4f4cfe12212e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104110c30>]}
[0m10:31:16.900374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11729273-1935-4fbb-89ee-4f4cfe12212e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2be360>]}
[0m10:31:16.900593 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:31:16.975996 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:31:17.009236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:31:17.009421 [debug] [MainThread]: Partial parsing: added file: air_travel://models/stg/airport_maps.sql
[0m10:31:17.084884 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m10:31:17.089148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11729273-1935-4fbb-89ee-4f4cfe12212e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d212a50>]}
[0m10:31:17.113656 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:31:17.114491 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:31:17.119729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11729273-1935-4fbb-89ee-4f4cfe12212e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2ce8a0>]}
[0m10:31:17.119893 [info ] [MainThread]: Found 3 models, 9 sources, 513 macros
[0m10:31:17.120014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11729273-1935-4fbb-89ee-4f4cfe12212e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d464c90>]}
[0m10:31:17.120560 [info ] [MainThread]: 
[0m10:31:17.120687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:31:17.120785 [info ] [MainThread]: 
[0m10:31:17.120976 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:31:17.121327 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:31:17.121496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:17.540356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:31:17.540974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:17.943494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11729273-1935-4fbb-89ee-4f4cfe12212e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d4ded00>]}
[0m10:31:17.944468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:17.948502 [debug] [Thread-1 (]: Began running node model.air_travel.airport_maps
[0m10:31:17.949065 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.airport_maps ................... [RUN]
[0m10:31:17.949445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.airport_maps)
[0m10:31:17.949744 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_maps
[0m10:31:17.956564 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_maps"
[0m10:31:17.957269 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_maps
[0m10:31:17.980625 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airport_maps"
[0m10:31:17.981177 [debug] [Thread-1 (]: On model.air_travel.airport_maps: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airport_maps"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
      
    
    

    
    OPTIONS()
    as (
      with stg_airport_maps as (
  select airport, terminal, business,
      case category
        when 'Airline Services' then 'Airline Service'
        when 'Airline Services' then 'Airline Service'
        when 'Cafe' then 'Coffee Shop'
        when 'Financial Services' then 'Financial Service'
        when 'Retail/Dining' then 'Retail / Dining'
        when 'Things To Do' then 'Things to Do'
        when 'Transportation' then 'Transportation Service'
        when 'Vending' then 'Vending Machine'
        when 'Service' then 'Services'
        else category end as category,
      location, dining, menu_items, _data_source, _load_time
from `cs378-fa2025`.`air_travel_raw`.`airport_maps`

select * from stg_airport_maps
    );
  
[0m10:31:17.981404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:18.276863 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:12691b85-58e2-47f4-8168-e8ae798a5071&page=queryresults
[0m10:31:18.278235 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:12691b85-58e2-47f4-8168-e8ae798a5071&page=queryresults
[0m10:31:18.291952 [debug] [Thread-1 (]: Database Error in model airport_maps (models/stg/airport_maps.sql)
  Syntax error: Expected ")" but got keyword SELECT at [30:1]
  compiled code at target/run/air_travel/models/stg/airport_maps.sql
[0m10:31:18.293548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11729273-1935-4fbb-89ee-4f4cfe12212e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d72da90>]}
[0m10:31:18.294130 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_stg.airport_maps .......... [[31mERROR[0m in 0.34s]
[0m10:31:18.294590 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_maps
[0m10:31:18.294929 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.airport_maps' to be skipped because of status 'error'.  Reason: Database Error in model airport_maps (models/stg/airport_maps.sql)
  Syntax error: Expected ")" but got keyword SELECT at [30:1]
  compiled code at target/run/air_travel/models/stg/airport_maps.sql.
[0m10:31:18.296257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:31:18.297451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:18.297651 [debug] [MainThread]: Connection 'model.air_travel.airport_maps' was properly closed.
[0m10:31:18.298056 [info ] [MainThread]: 
[0m10:31:18.298364 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m10:31:18.298844 [debug] [MainThread]: Command end result
[0m10:31:18.315324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:31:18.316327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:31:18.319350 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:31:18.319499 [info ] [MainThread]: 
[0m10:31:18.319676 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:31:18.319821 [info ] [MainThread]: 
[0m10:31:18.320002 [error] [MainThread]: [31mFailure in model airport_maps (models/stg/airport_maps.sql)[0m
[0m10:31:18.320166 [error] [MainThread]:   Database Error in model airport_maps (models/stg/airport_maps.sql)
  Syntax error: Expected ")" but got keyword SELECT at [30:1]
  compiled code at target/run/air_travel/models/stg/airport_maps.sql
[0m10:31:18.320283 [info ] [MainThread]: 
[0m10:31:18.320419 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/stg/airport_maps.sql
[0m10:31:18.320534 [info ] [MainThread]: 
[0m10:31:18.320671 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:31:18.322912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.281434, "process_in_blocks": "0", "process_kernel_time": 0.225606, "process_mem_max_rss": "391888896", "process_out_blocks": "0", "process_user_time": 1.559978}
[0m10:31:18.323121 [debug] [MainThread]: Command `dbt run` failed at 10:31:18.323079 after 2.28 seconds
[0m10:31:18.323296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d2efc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cec550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d7220d0>]}
[0m10:31:18.323456 [debug] [MainThread]: Flushing usage events
[0m10:31:18.542803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:31:39.377056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107773750>]}


============================== 10:31:39.378670 | a81b917b-51cd-4564-839e-38a765fb95f5 ==============================
[0m10:31:39.378670 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:31:39.378914 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select airport_maps', 'use_colors': 'True', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False'}
[0m10:31:40.181675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a81b917b-51cd-4564-839e-38a765fb95f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696cc30>]}
[0m10:31:40.200430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a81b917b-51cd-4564-839e-38a765fb95f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12debe360>]}
[0m10:31:40.200633 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:31:40.274156 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:31:40.306779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:31:40.306990 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/stg/airport_maps.sql
[0m10:31:40.382333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m10:31:40.386591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a81b917b-51cd-4564-839e-38a765fb95f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ec12a50>]}
[0m10:31:40.411167 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:31:40.411968 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:31:40.417189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a81b917b-51cd-4564-839e-38a765fb95f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dece8a0>]}
[0m10:31:40.417360 [info ] [MainThread]: Found 3 models, 9 sources, 513 macros
[0m10:31:40.417486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a81b917b-51cd-4564-839e-38a765fb95f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee5cbb0>]}
[0m10:31:40.418040 [info ] [MainThread]: 
[0m10:31:40.418172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:31:40.418269 [info ] [MainThread]: 
[0m10:31:40.418455 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:31:40.418813 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:31:40.418977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:40.754458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:31:40.754964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:41.189934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a81b917b-51cd-4564-839e-38a765fb95f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eeced00>]}
[0m10:31:41.190932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:41.194871 [debug] [Thread-1 (]: Began running node model.air_travel.airport_maps
[0m10:31:41.195358 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.airport_maps ................... [RUN]
[0m10:31:41.195715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.airport_maps)
[0m10:31:41.195992 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_maps
[0m10:31:41.202624 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_maps"
[0m10:31:41.203255 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_maps
[0m10:31:41.227245 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airport_maps"
[0m10:31:41.227773 [debug] [Thread-1 (]: On model.air_travel.airport_maps: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airport_maps"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
      
    
    

    
    OPTIONS()
    as (
      with stg_airport_maps as (
  select airport, terminal, business,
      case category
        when 'Airline Services' then 'Airline Service'
        when 'Airline Services' then 'Airline Service'
        when 'Cafe' then 'Coffee Shop'
        when 'Financial Services' then 'Financial Service'
        when 'Retail/Dining' then 'Retail / Dining'
        when 'Things To Do' then 'Things to Do'
        when 'Transportation' then 'Transportation Service'
        when 'Vending' then 'Vending Machine'
        when 'Service' then 'Services'
        else category end as category,
      location, dining, menu_items, _data_source, _load_time
    from `cs378-fa2025`.`air_travel_raw`.`airport_maps`
)

select * from stg_airport_maps
    );
  
[0m10:31:41.228018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:42.552505 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5f3a3c69-006b-4e69-abf3-f307897d5727&page=queryresults
[0m10:31:45.423227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81b917b-51cd-4564-839e-38a765fb95f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef31f10>]}
[0m10:31:45.423922 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.airport_maps .............. [[32mCREATE TABLE (1.5k rows, 163.3 KiB processed)[0m in 4.23s]
[0m10:31:45.424382 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_maps
[0m10:31:45.425425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:31:45.426594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:45.426765 [debug] [MainThread]: Connection 'model.air_travel.airport_maps' was properly closed.
[0m10:31:45.426944 [info ] [MainThread]: 
[0m10:31:45.427139 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m10:31:45.427559 [debug] [MainThread]: Command end result
[0m10:31:45.444443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:31:45.445451 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:31:45.448431 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:31:45.448580 [info ] [MainThread]: 
[0m10:31:45.448756 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:31:45.448883 [info ] [MainThread]: 
[0m10:31:45.449029 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:31:45.451225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.097549, "process_in_blocks": "0", "process_kernel_time": 0.221318, "process_mem_max_rss": "388825088", "process_out_blocks": "0", "process_user_time": 1.599276}
[0m10:31:45.451435 [debug] [MainThread]: Command `dbt run` succeeded at 10:31:45.451393 after 6.10 seconds
[0m10:31:45.451599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ecce780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef1f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef1d630>]}
[0m10:31:45.451756 [debug] [MainThread]: Flushing usage events
[0m10:31:45.639594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:36:23.932806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062486e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107673750>]}


============================== 10:36:23.934393 | ce2af34d-52cf-4256-9065-e29b360af8cd ==============================
[0m10:36:23.934393 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:36:23.934637 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'invocation_command': 'dbt run --select airport_reviews', 'fail_fast': 'False', 'empty': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'printer_width': '80', 'warn_error': 'None', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'static_parser': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m10:36:24.745497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce2af34d-52cf-4256-9065-e29b360af8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ccc30>]}
[0m10:36:24.764424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce2af34d-52cf-4256-9065-e29b360af8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135abe360>]}
[0m10:36:24.764632 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:36:24.838176 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:36:24.871919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:36:24.872109 [debug] [MainThread]: Partial parsing: added file: air_travel://models/stg/airport_reviews.sql
[0m10:36:24.947311 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m10:36:24.951615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce2af34d-52cf-4256-9065-e29b360af8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f16a50>]}
[0m10:36:24.976501 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:36:24.977313 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:36:24.982571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce2af34d-52cf-4256-9065-e29b360af8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135ace8a0>]}
[0m10:36:24.982757 [info ] [MainThread]: Found 4 models, 9 sources, 513 macros
[0m10:36:24.982881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce2af34d-52cf-4256-9065-e29b360af8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136160c90>]}
[0m10:36:24.983449 [info ] [MainThread]: 
[0m10:36:24.983577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:36:24.983674 [info ] [MainThread]: 
[0m10:36:24.983860 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:36:24.984206 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:36:24.984367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:25.358335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:36:25.358876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:25.683442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce2af34d-52cf-4256-9065-e29b360af8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1361ded00>]}
[0m10:36:25.684203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:36:25.687848 [debug] [Thread-1 (]: Began running node model.air_travel.airport_reviews
[0m10:36:25.688394 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.airport_reviews ................ [RUN]
[0m10:36:25.688779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.airport_reviews)
[0m10:36:25.689056 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_reviews
[0m10:36:25.695544 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_reviews"
[0m10:36:25.696222 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_reviews
[0m10:36:25.719648 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airport_reviews"
[0m10:36:25.720209 [debug] [Thread-1 (]: On model.air_travel.airport_reviews: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airport_reviews"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`
      
    
    

    
    OPTIONS()
    as (
      with stg_airport_reviews as (
	select id,
	    safe_cast(threadRef as INTEGER) as review_thread,
	    airportRef as airport_id,
	    airportIdent as airport_code,
	    safe_cast(split(date, ' ')[0] as DATE) as review_date,
	    memberNickname as review_author,
	    subject as review_subject,
	    body as review_details,
	    broad_category,
        sub_category,
        sentiment,
        language,
	    _data_source,
	    _load_time
	from `cs378-fa2025`.`air_travel_raw`.`airport_reviews`
)

select * from stg_airport_reviews
    );
  
[0m10:36:25.720436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:29.139445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7ca311d4-80b7-4a78-89c3-5a4f0da2fc34&page=queryresults
[0m10:36:47.080012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce2af34d-52cf-4256-9065-e29b360af8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136636090>]}
[0m10:36:47.080665 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.airport_reviews ........... [[32mCREATE TABLE (14.8k rows, 5.4 MiB processed)[0m in 21.39s]
[0m10:36:47.081084 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_reviews
[0m10:36:47.082096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:36:47.083276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:47.083458 [debug] [MainThread]: Connection 'model.air_travel.airport_reviews' was properly closed.
[0m10:36:47.083632 [info ] [MainThread]: 
[0m10:36:47.083826 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.10 seconds (22.10s).
[0m10:36:47.084254 [debug] [MainThread]: Command end result
[0m10:36:47.100158 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:36:47.101192 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:36:47.104169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:36:47.104321 [info ] [MainThread]: 
[0m10:36:47.104493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:36:47.104621 [info ] [MainThread]: 
[0m10:36:47.104765 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:36:47.106936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.197521, "process_in_blocks": "0", "process_kernel_time": 0.243897, "process_mem_max_rss": "389201920", "process_out_blocks": "0", "process_user_time": 1.596943}
[0m10:36:47.107142 [debug] [MainThread]: Command `dbt run` succeeded at 10:36:47.107101 after 23.20 seconds
[0m10:36:47.107309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135feec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13664c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13664f250>]}
[0m10:36:47.107466 [debug] [MainThread]: Flushing usage events
[0m10:36:47.314875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:39:31.558205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f73750>]}


============================== 10:39:31.559812 | bf13dd11-520b-4276-96ca-0fc9887fcedd ==============================
[0m10:39:31.559812 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:39:31.560053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'quiet': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'debug': 'False', 'invocation_command': 'dbt run --select airports', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager'}
[0m10:39:32.374359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf13dd11-520b-4276-96ca-0fc9887fcedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108144c30>]}
[0m10:39:32.393248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf13dd11-520b-4276-96ca-0fc9887fcedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126dbe360>]}
[0m10:39:32.393467 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:39:32.467054 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:39:32.500594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:39:32.500783 [debug] [MainThread]: Partial parsing: added file: air_travel://models/stg/airports.sql
[0m10:39:32.558971 [error] [MainThread]: Encountered an error:
Compilation Error in model airports (models/stg/airports.sql)
  unexpected '}', expected ')'
    line 33
      from {{ source('air_travel_raw', 'airports' }}
[0m10:39:32.560648 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0259049, "process_in_blocks": "0", "process_kernel_time": 0.203379, "process_mem_max_rss": "374505472", "process_out_blocks": "0", "process_user_time": 1.300628}
[0m10:39:32.560876 [debug] [MainThread]: Command `dbt run` failed at 10:39:32.560839 after 1.03 seconds
[0m10:39:32.561028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127211a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127212150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127425b80>]}
[0m10:39:32.561153 [debug] [MainThread]: Flushing usage events
[0m10:39:32.777888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:39:46.697159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a386e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e73750>]}


============================== 10:39:46.698792 | ec7eb1ad-705b-4c02-a628-48189b2ea6a6 ==============================
[0m10:39:46.698792 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:39:46.699039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'empty': 'False', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'invocation_command': 'dbt run --select airports', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'use_colors': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'introspect': 'True', 'warn_error': 'None'}
[0m10:39:47.504063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec7eb1ad-705b-4c02-a628-48189b2ea6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dccc30>]}
[0m10:39:47.522899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec7eb1ad-705b-4c02-a628-48189b2ea6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e5be360>]}
[0m10:39:47.523105 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:39:47.597235 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:39:47.629942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:39:47.630134 [debug] [MainThread]: Partial parsing: added file: air_travel://models/stg/airports.sql
[0m10:39:47.705838 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m10:39:47.710157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec7eb1ad-705b-4c02-a628-48189b2ea6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ec0d450>]}
[0m10:39:47.735089 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:39:47.735894 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:39:47.741167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec7eb1ad-705b-4c02-a628-48189b2ea6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e5ce8a0>]}
[0m10:39:47.741335 [info ] [MainThread]: Found 5 models, 9 sources, 513 macros
[0m10:39:47.741457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec7eb1ad-705b-4c02-a628-48189b2ea6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e839ef0>]}
[0m10:39:47.742030 [info ] [MainThread]: 
[0m10:39:47.742155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:39:47.742253 [info ] [MainThread]: 
[0m10:39:47.742442 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:39:47.742785 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:39:47.742941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:48.217655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:39:48.218175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:48.513744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec7eb1ad-705b-4c02-a628-48189b2ea6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eec6d00>]}
[0m10:39:48.514740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:39:48.518744 [debug] [Thread-1 (]: Began running node model.air_travel.airports
[0m10:39:48.519291 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.airports ....................... [RUN]
[0m10:39:48.519681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.airports)
[0m10:39:48.519959 [debug] [Thread-1 (]: Began compiling node model.air_travel.airports
[0m10:39:48.526656 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airports"
[0m10:39:48.527410 [debug] [Thread-1 (]: Began executing node model.air_travel.airports
[0m10:39:48.550686 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airports"
[0m10:39:48.551258 [debug] [Thread-1 (]: On model.air_travel.airports: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airports"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
      
    
    

    
    OPTIONS()
    as (
      with stg_airports as (
	select safe_cast(airport_id as INTEGER) as id,
	    airport_name as name,
	    airport_city as city,
	    airport_country as country,
	    case iata
		    when '\\N' then null
		    else iata
		    end as iata,
	    case icao
		    when '\\N' then null
		    else icao
		    end as icao,
	    latitude,
	    longitude,
	    altitude,
	    safe_cast(timezone as INTEGER) as timezone_delta,
        daylight_savings_time,
        case tz_database_timezone
		    when '\\N' then null
		    else tz_database_timezone
		    end as timezone_name,
	    case type
		    when '\\N' then null
		    else type
		    end as type,
	    case source
		    when '\\N' then null
		    else source
		    end as source,
	    _data_source,
	    _load_time
	from `cs378-fa2025`.`air_travel_raw`.`airports`    
)

select * from stg_airports
    );
  
[0m10:39:48.551487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:49.539401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7a26cbc1-25ad-4cf8-bbab-f5142523476e&page=queryresults
[0m10:39:52.938108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec7eb1ad-705b-4c02-a628-48189b2ea6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fb3a150>]}
[0m10:39:52.938782 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.airports .................. [[32mCREATE TABLE (12.7k rows, 1.7 MiB processed)[0m in 4.42s]
[0m10:39:52.939248 [debug] [Thread-1 (]: Finished running node model.air_travel.airports
[0m10:39:52.940342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:39:52.941652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:52.941845 [debug] [MainThread]: Connection 'model.air_travel.airports' was properly closed.
[0m10:39:52.942024 [info ] [MainThread]: 
[0m10:39:52.942214 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m10:39:52.942639 [debug] [MainThread]: Command end result
[0m10:39:52.959174 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:39:52.960114 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:39:52.962973 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:39:52.963107 [info ] [MainThread]: 
[0m10:39:52.963271 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:39:52.963394 [info ] [MainThread]: 
[0m10:39:52.963538 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:39:52.965724 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.291884, "process_in_blocks": "0", "process_kernel_time": 0.226306, "process_mem_max_rss": "390135808", "process_out_blocks": "0", "process_user_time": 1.595713}
[0m10:39:52.965945 [debug] [MainThread]: Command `dbt run` succeeded at 10:39:52.965903 after 6.29 seconds
[0m10:39:52.966108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ecefa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fb4efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fb4c870>]}
[0m10:39:52.966260 [debug] [MainThread]: Flushing usage events
[0m10:39:53.159568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:45:16.541924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc3750>]}


============================== 10:45:16.543527 | b549b4c7-fc2e-493d-9f26-d3f8ae4cd616 ==============================
[0m10:45:16.543527 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:45:16.543763 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/scohen/.dbt', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'version_check': 'True', 'partial_parse': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select countries', 'log_cache_events': 'False', 'warn_error': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m10:45:17.358524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b549b4c7-fc2e-493d-9f26-d3f8ae4cd616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601cc30>]}
[0m10:45:17.377653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b549b4c7-fc2e-493d-9f26-d3f8ae4cd616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cbc2360>]}
[0m10:45:17.377860 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:45:17.450878 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:45:17.484434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:45:17.484625 [debug] [MainThread]: Partial parsing: added file: air_travel://models/stg/countries.sql
[0m10:45:17.560102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m10:45:17.564413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b549b4c7-fc2e-493d-9f26-d3f8ae4cd616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d111650>]}
[0m10:45:17.589298 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:45:17.590077 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:45:17.595379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b549b4c7-fc2e-493d-9f26-d3f8ae4cd616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cbce8a0>]}
[0m10:45:17.595561 [info ] [MainThread]: Found 6 models, 9 sources, 513 macros
[0m10:45:17.595678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b549b4c7-fc2e-493d-9f26-d3f8ae4cd616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ce39ef0>]}
[0m10:45:17.596249 [info ] [MainThread]: 
[0m10:45:17.596372 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:45:17.596466 [info ] [MainThread]: 
[0m10:45:17.596648 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:45:17.596994 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:45:17.597159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:17.947154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:45:17.947682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:45:18.264724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b549b4c7-fc2e-493d-9f26-d3f8ae4cd616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d45d640>]}
[0m10:45:18.265023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:45:18.266583 [debug] [Thread-1 (]: Began running node model.air_travel.countries
[0m10:45:18.266827 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.countries ...................... [RUN]
[0m10:45:18.267016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.countries)
[0m10:45:18.267154 [debug] [Thread-1 (]: Began compiling node model.air_travel.countries
[0m10:45:18.270637 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.countries"
[0m10:45:18.271023 [debug] [Thread-1 (]: Began executing node model.air_travel.countries
[0m10:45:18.287458 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.countries"
[0m10:45:18.287904 [debug] [Thread-1 (]: On model.air_travel.countries: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.countries"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
      
    
    

    
    OPTIONS()
    as (
      with stg_countries as (
    select country_name as name,
    case iso_code
      when '\\N' then null
      else iso_code
      end as iso_code,
    dafif_code,
    _data_source,
    _load_time
    from `cs378-fa2025`.`air_travel_raw`.`countries`
)

select * from stg_countries
    );
  
[0m10:45:18.288076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:45:18.964901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a440941f-c32c-4bd4-90cf-eed16bb9b3c3&page=queryresults
[0m10:45:21.340965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b549b4c7-fc2e-493d-9f26-d3f8ae4cd616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d629fd0>]}
[0m10:45:21.341619 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.countries ................. [[32mCREATE TABLE (261.0 rows, 10.5 KiB processed)[0m in 3.07s]
[0m10:45:21.342090 [debug] [Thread-1 (]: Finished running node model.air_travel.countries
[0m10:45:21.343083 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:45:21.344253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:45:21.344422 [debug] [MainThread]: Connection 'model.air_travel.countries' was properly closed.
[0m10:45:21.344597 [info ] [MainThread]: 
[0m10:45:21.344783 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m10:45:21.345225 [debug] [MainThread]: Command end result
[0m10:45:21.361252 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:45:21.362195 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:45:21.365139 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:45:21.365272 [info ] [MainThread]: 
[0m10:45:21.365448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:45:21.365580 [info ] [MainThread]: 
[0m10:45:21.365729 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:45:21.367917 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8495727, "process_in_blocks": "0", "process_kernel_time": 0.237329, "process_mem_max_rss": "389300224", "process_out_blocks": "0", "process_user_time": 1.575377}
[0m10:45:21.368130 [debug] [MainThread]: Command `dbt run` succeeded at 10:45:21.368087 after 4.85 seconds
[0m10:45:21.368290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d18b960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d6485f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d64af30>]}
[0m10:45:21.368447 [debug] [MainThread]: Flushing usage events
[0m10:45:21.819754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:48:07.246690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e73750>]}


============================== 10:48:07.248325 | 24ebdf70-f9f8-4965-af70-ee2353be9c33 ==============================
[0m10:48:07.248325 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:48:07.248569 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'invocation_command': 'dbt run --select flight_delays', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_format': 'default', 'no_print': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False'}
[0m10:48:08.062261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24ebdf70-f9f8-4965-af70-ee2353be9c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dccc30>]}
[0m10:48:08.081566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24ebdf70-f9f8-4965-af70-ee2353be9c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bac2360>]}
[0m10:48:08.081782 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:48:08.156665 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:48:08.190713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:48:08.190906 [debug] [MainThread]: Partial parsing: added file: air_travel://models/stg/flight_delays.sql
[0m10:48:08.266891 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m10:48:08.271232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ebdf70-f9f8-4965-af70-ee2353be9c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c80e950>]}
[0m10:48:08.296672 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:48:08.297490 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:48:08.302949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ebdf70-f9f8-4965-af70-ee2353be9c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bace8a0>]}
[0m10:48:08.303142 [info ] [MainThread]: Found 7 models, 9 sources, 513 macros
[0m10:48:08.303265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ebdf70-f9f8-4965-af70-ee2353be9c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bc3f690>]}
[0m10:48:08.303852 [info ] [MainThread]: 
[0m10:48:08.303984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:48:08.304079 [info ] [MainThread]: 
[0m10:48:08.304255 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:48:08.304595 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:48:08.304751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:08.758601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:48:08.759110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:09.163303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ebdf70-f9f8-4965-af70-ee2353be9c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ca71570>]}
[0m10:48:09.163929 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:48:09.167283 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m10:48:09.167739 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.flight_delays .................. [RUN]
[0m10:48:09.168110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.flight_delays)
[0m10:48:09.168370 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m10:48:09.174890 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m10:48:09.176653 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m10:48:09.199867 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_delays"
[0m10:48:09.200441 [debug] [Thread-1 (]: On model.air_travel.flight_delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_delays as (
    select event_month, carrier, carrier_name, airport_code,
        split(city_state, ',')[0] as airport_city, 
        split(city_state, ',')[1] as airport_state,
        airport_name, 
        * except (event_month, carrier, carrier_name, airport_code, airport_name, city_state)
    from
        (select date(year, month, 01) as event_month, 
            carrier, carrier_name, airport as airport_code,
            split(airport_name, ':')[0] as city_state, 
            split(airport_name, ':')[1] as airport_name,
            safe_cast(arr_flights as INTEGER) as arr_total, 
            safe_cast(arr_cancelled as INTEGER) as arr_cancelled,
            safe_cast(arr_diverted as INTEGER) as arr_diverted, 
            safe_cast(arr_delay as INTEGER) as arr_delay_min,
            safe_cast(weather_delay as INTEGER) as weather_delay_min, 
            safe_cast(nas_delay as INTEGER) as nas_delay_min,
            safe_cast(late_aircraft_delay as INTEGER) as late_aircraft_delay_min, 
            _data_source, _load_time
          from `cs378-fa2025`.`air_travel_raw`.`flight_delays`
)

select * from stg_flight_delays
    );
  
[0m10:48:09.200678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:09.497813 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ba0feb1e-7a56-4f69-8b6b-e7a27adf2937&page=queryresults
[0m10:48:09.499279 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ba0feb1e-7a56-4f69-8b6b-e7a27adf2937&page=queryresults
[0m10:48:09.510208 [debug] [Thread-1 (]: Database Error in model flight_delays (models/stg/flight_delays.sql)
  Syntax error: Expected ")" but got keyword SELECT at [36:1]
  compiled code at target/run/air_travel/models/stg/flight_delays.sql
[0m10:48:09.512061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ebdf70-f9f8-4965-af70-ee2353be9c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ed3dc10>]}
[0m10:48:09.512637 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_stg.flight_delays ......... [[31mERROR[0m in 0.34s]
[0m10:48:09.513108 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m10:48:09.513492 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.flight_delays' to be skipped because of status 'error'.  Reason: Database Error in model flight_delays (models/stg/flight_delays.sql)
  Syntax error: Expected ")" but got keyword SELECT at [36:1]
  compiled code at target/run/air_travel/models/stg/flight_delays.sql.
[0m10:48:09.514732 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:09.515872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:09.516062 [debug] [MainThread]: Connection 'model.air_travel.flight_delays' was properly closed.
[0m10:48:09.516245 [info ] [MainThread]: 
[0m10:48:09.516453 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m10:48:09.516902 [debug] [MainThread]: Command end result
[0m10:48:09.534960 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:48:09.536056 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:48:09.539164 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:48:09.539322 [info ] [MainThread]: 
[0m10:48:09.539504 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:48:09.539647 [info ] [MainThread]: 
[0m10:48:09.539824 [error] [MainThread]: [31mFailure in model flight_delays (models/stg/flight_delays.sql)[0m
[0m10:48:09.539990 [error] [MainThread]:   Database Error in model flight_delays (models/stg/flight_delays.sql)
  Syntax error: Expected ")" but got keyword SELECT at [36:1]
  compiled code at target/run/air_travel/models/stg/flight_delays.sql
[0m10:48:09.540116 [info ] [MainThread]: 
[0m10:48:09.540263 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/stg/flight_delays.sql
[0m10:48:09.540386 [info ] [MainThread]: 
[0m10:48:09.540530 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:48:09.542735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.31961, "process_in_blocks": "0", "process_kernel_time": 0.226551, "process_mem_max_rss": "391446528", "process_out_blocks": "0", "process_user_time": 1.556164}
[0m10:48:09.542943 [debug] [MainThread]: Command `dbt run` failed at 10:48:09.542904 after 2.32 seconds
[0m10:48:09.543115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c89e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ed5c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ed5f430>]}
[0m10:48:09.543272 [debug] [MainThread]: Flushing usage events
[0m10:48:09.757372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:48:46.561620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069239d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106923750>]}


============================== 10:48:46.563252 | c9207a80-47a3-4e72-bd79-0572bcbd3248 ==============================
[0m10:48:46.563252 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:48:46.563496 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'no_print': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'write_json': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select flight_delays', 'warn_error': 'None', 'static_parser': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m10:48:47.367745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9207a80-47a3-4e72-bd79-0572bcbd3248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7cc30>]}
[0m10:48:47.386988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9207a80-47a3-4e72-bd79-0572bcbd3248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cdc2360>]}
[0m10:48:47.387210 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:48:47.460751 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:48:47.493756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:48:47.493982 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/stg/flight_delays.sql
[0m10:48:47.570153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m10:48:47.574496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9207a80-47a3-4e72-bd79-0572bcbd3248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dc0eb50>]}
[0m10:48:47.599651 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:48:47.600457 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:48:47.605523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9207a80-47a3-4e72-bd79-0572bcbd3248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cdce8a0>]}
[0m10:48:47.605693 [info ] [MainThread]: Found 7 models, 9 sources, 513 macros
[0m10:48:47.605815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9207a80-47a3-4e72-bd79-0572bcbd3248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cf3b690>]}
[0m10:48:47.606399 [info ] [MainThread]: 
[0m10:48:47.606532 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:48:47.606629 [info ] [MainThread]: 
[0m10:48:47.606824 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:48:47.607159 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:48:47.607303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:47.942169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:48:47.942713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:48.240496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9207a80-47a3-4e72-bd79-0572bcbd3248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14de714a0>]}
[0m10:48:48.241086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:48:48.244261 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m10:48:48.244795 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.flight_delays .................. [RUN]
[0m10:48:48.245184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.flight_delays)
[0m10:48:48.245466 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m10:48:48.251709 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m10:48:48.252373 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m10:48:48.275702 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_delays"
[0m10:48:48.276264 [debug] [Thread-1 (]: On model.air_travel.flight_delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_delays as (
    select event_month, carrier, carrier_name, airport_code,
        split(city_state, ',')[0] as airport_city, 
        split(city_state, ',')[1] as airport_state,
        airport_name, 
        * except (event_month, carrier, carrier_name, airport_code, airport_name, city_state)
    from
        (select date(year, month, 01) as event_month, 
            carrier, carrier_name, airport as airport_code,
            split(airport_name, ':')[0] as city_state, 
            split(airport_name, ':')[1] as airport_name,
            safe_cast(arr_flights as INTEGER) as arr_total, 
            safe_cast(arr_cancelled as INTEGER) as arr_cancelled,
            safe_cast(arr_diverted as INTEGER) as arr_diverted, 
            safe_cast(arr_delay as INTEGER) as arr_delay_min,
            safe_cast(weather_delay as INTEGER) as weather_delay_min, 
            safe_cast(nas_delay as INTEGER) as nas_delay_min,
            safe_cast(late_aircraft_delay as INTEGER) as late_aircraft_delay_min, 
            _data_source, _load_time
          from `cs378-fa2025`.`air_travel_raw`.`flight_delays`)
)

select * from stg_flight_delays
    );
  
[0m10:48:48.276508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:49.200027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:aa6c83a1-0e6b-40c2-b1da-db164a88ac97&page=queryresults
[0m10:48:53.919186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9207a80-47a3-4e72-bd79-0572bcbd3248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14df3e2d0>]}
[0m10:48:53.919653 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.flight_delays ............. [[32mCREATE TABLE (381.2k rows, 64.1 MiB processed)[0m in 5.67s]
[0m10:48:53.920014 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m10:48:53.920783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:53.921802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:53.921976 [debug] [MainThread]: Connection 'model.air_travel.flight_delays' was properly closed.
[0m10:48:53.922137 [info ] [MainThread]: 
[0m10:48:53.922307 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.32 seconds (6.32s).
[0m10:48:53.922682 [debug] [MainThread]: Command end result
[0m10:48:53.937276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:48:53.938240 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:48:53.941041 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:48:53.941178 [info ] [MainThread]: 
[0m10:48:53.941360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:53.941495 [info ] [MainThread]: 
[0m10:48:53.941636 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:48:53.943710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4028635, "process_in_blocks": "0", "process_kernel_time": 0.226119, "process_mem_max_rss": "388399104", "process_out_blocks": "0", "process_user_time": 1.59026}
[0m10:48:53.943917 [debug] [MainThread]: Command `dbt run` succeeded at 10:48:53.943877 after 7.40 seconds
[0m10:48:53.944071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dcd3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14df5efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14df5c870>]}
[0m10:48:53.944219 [debug] [MainThread]: Flushing usage events
[0m10:48:54.134391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:14.691408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073139d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107313750>]}


============================== 11:01:14.693027 | e8f3f784-b2b1-4e7e-896c-e38fef240dac ==============================
[0m11:01:14.693027 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:01:14.693271 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select flight_routes', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True'}
[0m11:01:15.508037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8f3f784-b2b1-4e7e-896c-e38fef240dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666cc30>]}
[0m11:01:15.527160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8f3f784-b2b1-4e7e-896c-e38fef240dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d2be360>]}
[0m11:01:15.527376 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:01:15.602098 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:01:15.635645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:01:15.635830 [debug] [MainThread]: Partial parsing: added file: air_travel://models/stg/flight_routes.sql
[0m11:01:15.711928 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m11:01:15.716251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8f3f784-b2b1-4e7e-896c-e38fef240dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e10eb50>]}
[0m11:01:15.741275 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:01:15.742094 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:01:15.747314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8f3f784-b2b1-4e7e-896c-e38fef240dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d2ce8a0>]}
[0m11:01:15.747505 [info ] [MainThread]: Found 8 models, 9 sources, 513 macros
[0m11:01:15.747628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8f3f784-b2b1-4e7e-896c-e38fef240dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d43fa10>]}
[0m11:01:15.748239 [info ] [MainThread]: 
[0m11:01:15.748367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:15.748464 [info ] [MainThread]: 
[0m11:01:15.748649 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:01:15.749009 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:01:15.749150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:16.212215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:01:16.212743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:16.506537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8f3f784-b2b1-4e7e-896c-e38fef240dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e3594a0>]}
[0m11:01:16.507111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:16.510248 [debug] [Thread-1 (]: Began running node model.air_travel.flight_routes
[0m11:01:16.510700 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.flight_routes .................. [RUN]
[0m11:01:16.511040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.flight_routes)
[0m11:01:16.511302 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_routes
[0m11:01:16.517391 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_routes"
[0m11:01:16.517967 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_routes
[0m11:01:16.540719 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_routes"
[0m11:01:16.541287 [debug] [Thread-1 (]: On model.air_travel.flight_routes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_routes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_routes as (
  select airline_code,
    safe_cast(airline_id as INTEGER) as airline_id,
    source_airport,
    case source_airport_id
      when '\\N' then null
      else safe_cast(source_airport_id as INTEGER)
      end as source_airport_id,
    dest_airport,
    case dest_airport_id
      when '\\N' then null
      else safe_cast(dest_airport_id as INTEGER)
      end as dest_airport_id,
    codeshare,
    stops,
    equipment,
    _data_source,
    _load_time
  from `cs378-fa2025`.`air_travel_raw`.`flight_routes`
)

select * from stg_flight_routes
    );
  
[0m11:01:16.541506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:17.329175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2d8fb708-b09a-4a88-8406-402766c6ecca&page=queryresults
[0m11:01:23.468053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8f3f784-b2b1-4e7e-896c-e38fef240dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e83e150>]}
[0m11:01:23.468429 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.flight_routes ............. [[32mCREATE TABLE (67.7k rows, 4.4 MiB processed)[0m in 6.96s]
[0m11:01:23.468735 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_routes
[0m11:01:23.469368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:01:23.470213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:23.470347 [debug] [MainThread]: Connection 'model.air_travel.flight_routes' was properly closed.
[0m11:01:23.470474 [info ] [MainThread]: 
[0m11:01:23.470612 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m11:01:23.470908 [debug] [MainThread]: Command end result
[0m11:01:23.483424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:01:23.484267 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:01:23.486679 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:01:23.486792 [info ] [MainThread]: 
[0m11:01:23.486937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:01:23.487039 [info ] [MainThread]: 
[0m11:01:23.487159 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:01:23.489027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.822366, "process_in_blocks": "0", "process_kernel_time": 0.246959, "process_mem_max_rss": "389365760", "process_out_blocks": "0", "process_user_time": 1.591386}
[0m11:01:23.489213 [debug] [MainThread]: Command `dbt run` succeeded at 11:01:23.489176 after 8.82 seconds
[0m11:01:23.489356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e1d38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e85f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e85c910>]}
[0m11:01:23.489487 [debug] [MainThread]: Flushing usage events
[0m11:01:23.699265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:56.289517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10852c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093779d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109377750>]}


============================== 11:02:56.291147 | c1e4e221-a39b-48e5-bab4-deceb7207e4f ==============================
[0m11:02:56.291147 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:02:56.291386 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'no_print': 'None', 'write_json': 'True', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'static_parser': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select tsa_traffic', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'version_check': 'True', 'empty': 'False', 'use_colors': 'True', 'partial_parse': 'True'}
[0m11:02:57.108362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1e4e221-a39b-48e5-bab4-deceb7207e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d0c30>]}
[0m11:02:57.127607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1e4e221-a39b-48e5-bab4-deceb7207e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125dbe360>]}
[0m11:02:57.127830 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:02:57.201499 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:02:57.235171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:02:57.235372 [debug] [MainThread]: Partial parsing: added file: air_travel://models/stg/tsa_traffic.sql
[0m11:02:57.310844 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m11:02:57.315132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1e4e221-a39b-48e5-bab4-deceb7207e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126b0a950>]}
[0m11:02:57.340379 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:02:57.341188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:02:57.346418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1e4e221-a39b-48e5-bab4-deceb7207e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125dce8a0>]}
[0m11:02:57.346588 [info ] [MainThread]: Found 9 models, 9 sources, 513 macros
[0m11:02:57.346711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e4e221-a39b-48e5-bab4-deceb7207e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12683c750>]}
[0m11:02:57.347301 [info ] [MainThread]: 
[0m11:02:57.347433 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:57.347532 [info ] [MainThread]: 
[0m11:02:57.347711 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:02:57.348030 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:02:57.348169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:57.680162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:02:57.680770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:58.304335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e4e221-a39b-48e5-bab4-deceb7207e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d394a0>]}
[0m11:02:58.304862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:58.307672 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_traffic
[0m11:02:58.308109 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.tsa_traffic .................... [RUN]
[0m11:02:58.308409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tsa_traffic)
[0m11:02:58.308638 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_traffic
[0m11:02:58.313765 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_traffic"
[0m11:02:58.314224 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_traffic
[0m11:02:58.335060 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tsa_traffic"
[0m11:02:58.335607 [debug] [Thread-1 (]: On model.air_travel.tsa_traffic: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tsa_traffic"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`
      
    
    

    
    OPTIONS()
    as (
      with stg_tsa_traffic as (
  select safe_cast(event_date as DATE format 'MM/DD/YYYY') as event_date,
    safe_cast(event_hour as INTEGER) as event_hour,
    airport_code,
    airport_name,
    airport_city,
    airport_state,
    security_checkpoint,
    safe_cast(total_traffic as INTEGER) as total_traffic,
    _data_source,
    _load_time
  from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic`
)

select * from tsa_traffic
    );
  
[0m11:02:58.335818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:58.911159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:af777637-d420-46b0-80ae-41af2c814cc6&page=queryresults
[0m11:02:58.912706 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:af777637-d420-46b0-80ae-41af2c814cc6&page=queryresults
[0m11:02:58.923600 [debug] [Thread-1 (]: Database Error in model tsa_traffic (models/stg/tsa_traffic.sql)
  Table "tsa_traffic" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/tsa_traffic.sql
[0m11:02:58.925479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1e4e221-a39b-48e5-bab4-deceb7207e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12733dd90>]}
[0m11:02:58.926224 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_stg.tsa_traffic ........... [[31mERROR[0m in 0.62s]
[0m11:02:58.926655 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_traffic
[0m11:02:58.927045 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tsa_traffic' to be skipped because of status 'error'.  Reason: Database Error in model tsa_traffic (models/stg/tsa_traffic.sql)
  Table "tsa_traffic" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/tsa_traffic.sql.
[0m11:02:58.928431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:58.929718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:58.929939 [debug] [MainThread]: Connection 'model.air_travel.tsa_traffic' was properly closed.
[0m11:02:58.930141 [info ] [MainThread]: 
[0m11:02:58.930359 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m11:02:58.930801 [debug] [MainThread]: Command end result
[0m11:02:58.947748 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:02:58.948697 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:02:58.951712 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:02:58.951876 [info ] [MainThread]: 
[0m11:02:58.952066 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:02:58.952218 [info ] [MainThread]: 
[0m11:02:58.952410 [error] [MainThread]: [31mFailure in model tsa_traffic (models/stg/tsa_traffic.sql)[0m
[0m11:02:58.952585 [error] [MainThread]:   Database Error in model tsa_traffic (models/stg/tsa_traffic.sql)
  Table "tsa_traffic" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/tsa_traffic.sql
[0m11:02:58.952712 [info ] [MainThread]: 
[0m11:02:58.952847 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/stg/tsa_traffic.sql
[0m11:02:58.952962 [info ] [MainThread]: 
[0m11:02:58.953101 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:02:58.955309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6891658, "process_in_blocks": "0", "process_kernel_time": 0.223516, "process_mem_max_rss": "385482752", "process_out_blocks": "0", "process_user_time": 1.558876}
[0m11:02:58.955519 [debug] [MainThread]: Command `dbt run` failed at 11:02:58.955479 after 2.69 seconds
[0m11:02:58.955694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126bb6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273647d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273674d0>]}
[0m11:02:58.955848 [debug] [MainThread]: Flushing usage events
[0m11:02:59.175028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:03:34.498752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1b750>]}


============================== 11:03:34.500348 | 7a16ea1b-8791-4fe4-a7b4-c153bb9ef00e ==============================
[0m11:03:34.500348 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:03:34.500586 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'invocation_command': 'dbt run --select tsa_traffic', 'write_json': 'True', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error': 'None', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False'}
[0m11:03:35.330976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a16ea1b-8791-4fe4-a7b4-c153bb9ef00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d74c30>]}
[0m11:03:35.350527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a16ea1b-8791-4fe4-a7b4-c153bb9ef00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124ebe360>]}
[0m11:03:35.350769 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:03:35.424352 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:03:35.457423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:03:35.457641 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/stg/tsa_traffic.sql
[0m11:03:35.534720 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m11:03:35.539051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a16ea1b-8791-4fe4-a7b4-c153bb9ef00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12550d950>]}
[0m11:03:35.564422 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:03:35.565225 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:03:35.570490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a16ea1b-8791-4fe4-a7b4-c153bb9ef00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124ece8a0>]}
[0m11:03:35.570660 [info ] [MainThread]: Found 9 models, 9 sources, 513 macros
[0m11:03:35.570782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a16ea1b-8791-4fe4-a7b4-c153bb9ef00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12513fbd0>]}
[0m11:03:35.571343 [info ] [MainThread]: 
[0m11:03:35.571473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:35.571569 [info ] [MainThread]: 
[0m11:03:35.571752 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:03:35.572092 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:03:35.572243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:35.990574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:03:35.991122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:36.263208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a16ea1b-8791-4fe4-a7b4-c153bb9ef00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1257514a0>]}
[0m11:03:36.263812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:03:36.267199 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_traffic
[0m11:03:36.267737 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.tsa_traffic .................... [RUN]
[0m11:03:36.268114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tsa_traffic)
[0m11:03:36.268385 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_traffic
[0m11:03:36.274941 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_traffic"
[0m11:03:36.275638 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_traffic
[0m11:03:36.299216 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tsa_traffic"
[0m11:03:36.299664 [debug] [Thread-1 (]: On model.air_travel.tsa_traffic: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tsa_traffic"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`
      
    
    

    
    OPTIONS()
    as (
      with stg_tsa_traffic as (
  select safe_cast(event_date as DATE format 'MM/DD/YYYY') as event_date,
    safe_cast(event_hour as INTEGER) as event_hour,
    airport_code,
    airport_name,
    airport_city,
    airport_state,
    security_checkpoint,
    safe_cast(total_traffic as INTEGER) as total_traffic,
    _data_source,
    _load_time
  from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic`
)

select * from stg_tsa_traffic
    );
  
[0m11:03:36.299875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:37.107002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:95af1f77-9f85-4c58-ac0e-08608005a097&page=queryresults
[0m11:03:39.988741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a16ea1b-8791-4fe4-a7b4-c153bb9ef00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a3e150>]}
[0m11:03:39.989309 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.tsa_traffic ............... [[32mCREATE TABLE (23.4k rows, 2.2 MiB processed)[0m in 3.72s]
[0m11:03:39.989718 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_traffic
[0m11:03:39.990631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:39.991763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:39.991960 [debug] [MainThread]: Connection 'model.air_travel.tsa_traffic' was properly closed.
[0m11:03:39.992136 [info ] [MainThread]: 
[0m11:03:39.992316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m11:03:39.992885 [debug] [MainThread]: Command end result
[0m11:03:40.008554 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:03:40.009605 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:03:40.012525 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:03:40.012674 [info ] [MainThread]: 
[0m11:03:40.012854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:40.012978 [info ] [MainThread]: 
[0m11:03:40.013119 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:03:40.015214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.540592, "process_in_blocks": "0", "process_kernel_time": 0.23004, "process_mem_max_rss": "390742016", "process_out_blocks": "0", "process_user_time": 1.605863}
[0m11:03:40.015455 [debug] [MainThread]: Command `dbt run` succeeded at 11:03:40.015416 after 5.54 seconds
[0m11:03:40.015615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12559f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a5c870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a5c190>]}
[0m11:03:40.015765 [debug] [MainThread]: Flushing usage events
[0m11:03:40.202859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:39.930486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b73750>]}


============================== 12:15:39.932053 | 2940ccf4-79fa-4b83-bb81-34d7397fffd7 ==============================
[0m12:15:39.932053 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:15:39.932295 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'debug': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_cache_events': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'no_print': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:15:40.802186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2940ccf4-79fa-4b83-bb81-34d7397fffd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ccc30>]}
[0m12:15:40.820991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2940ccf4-79fa-4b83-bb81-34d7397fffd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136abe360>]}
[0m12:15:40.821224 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:15:40.895458 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:15:40.925244 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading air_travel: stg/schema.yml - Runtime Error
    Syntax error near line 22
    ------------------------------
    19 |   - name: aircrafts
    20 |     tests:
    21 |       - check_row_count_equals:
    22 |           expected_count: {{ source('air_travel_raw', 'aircrafts') }}
    
    Raw Error:
    ------------------------------
    while parsing a flow mapping
      in "<unicode string>", line 22, column 28
    did not find expected ',' or '}'
      in "<unicode string>", line 22, column 66
[0m12:15:40.926904 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.021182, "process_in_blocks": "0", "process_kernel_time": 0.212643, "process_mem_max_rss": "375095296", "process_out_blocks": "0", "process_user_time": 1.24669}
[0m12:15:40.927182 [debug] [MainThread]: Command `dbt test` failed at 12:15:40.927146 after 1.02 seconds
[0m12:15:40.927322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a6b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a6bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137065d60>]}
[0m12:15:40.927449 [debug] [MainThread]: Flushing usage events
[0m12:15:41.142424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:11.506760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107273750>]}


============================== 12:17:11.508407 | bf8eb369-0b5e-4abd-b83d-8910ccaaa525 ==============================
[0m12:17:11.508407 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:17:11.508646 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'debug': 'False', 'target_path': 'None', 'empty': 'None', 'write_json': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'profiles_dir': '/Users/scohen/.dbt'}
[0m12:17:12.327058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf8eb369-0b5e-4abd-b83d-8910ccaaa525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ccc30>]}
[0m12:17:12.345670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf8eb369-0b5e-4abd-b83d-8910ccaaa525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1369ba360>]}
[0m12:17:12.345878 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:17:12.419100 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:17:12.447810 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading air_travel: stg/schema.yml - Runtime Error
    Syntax error near line 22
    ------------------------------
    19 |   - name: aircrafts
    20 |     tests:
    21 |       - check_row_count_equals:
    22 |           raw_table: {{ source('air_travel_raw', 'aircrafts') }}
    
    Raw Error:
    ------------------------------
    while parsing a flow mapping
      in "<unicode string>", line 22, column 23
    did not find expected ',' or '}'
      in "<unicode string>", line 22, column 61
[0m12:17:12.449426 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.9661032, "process_in_blocks": "0", "process_kernel_time": 0.205449, "process_mem_max_rss": "371392512", "process_out_blocks": "0", "process_user_time": 1.244827}
[0m12:17:12.449718 [debug] [MainThread]: Command `dbt test` failed at 12:17:12.449682 after 0.97 seconds
[0m12:17:12.449858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13696b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13696bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f61d60>]}
[0m12:17:12.449981 [debug] [MainThread]: Flushing usage events
[0m12:17:12.673284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:43.582571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a73750>]}


============================== 12:20:43.584194 | fcc5f5ce-86ed-4510-a8f6-b184b3e45ce2 ==============================
[0m12:20:43.584194 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:20:43.584434 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True', 'use_colors': 'True', 'introspect': 'True', 'empty': 'None', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'log_cache_events': 'False'}
[0m12:20:44.400374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcc5f5ce-86ed-4510-a8f6-b184b3e45ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ccc30>]}
[0m12:20:44.419178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcc5f5ce-86ed-4510-a8f6-b184b3e45ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1507ba360>]}
[0m12:20:44.419411 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:20:44.494047 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:20:44.532140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:20:44.532353 [debug] [MainThread]: Partial parsing: added file: air_travel://macros/check_row_count_equals.sql
[0m12:20:44.532511 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/stg/schema.yml
[0m12:20:44.554371 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `check_row_count_equals` defined on
'aircrafts' in package 'air_travel' (models/stg/schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m12:20:44.554562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fcc5f5ce-86ed-4510-a8f6-b184b3e45ce2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15076af50>]}
[0m12:20:44.613535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m12:20:44.617925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcc5f5ce-86ed-4510-a8f6-b184b3e45ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150e627b0>]}
[0m12:20:44.647934 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:20:44.648746 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:20:44.659205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcc5f5ce-86ed-4510-a8f6-b184b3e45ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151862890>]}
[0m12:20:44.659377 [info ] [MainThread]: Found 9 models, 1 test, 9 sources, 514 macros
[0m12:20:44.659498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc5f5ce-86ed-4510-a8f6-b184b3e45ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151dbcfc0>]}
[0m12:20:44.660258 [info ] [MainThread]: 
[0m12:20:44.660387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:20:44.660480 [info ] [MainThread]: 
[0m12:20:44.660668 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:20:44.662175 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:20:44.662334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:45.000401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc5f5ce-86ed-4510-a8f6-b184b3e45ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151a62450>]}
[0m12:20:45.001061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:20:45.004623 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:20:45.004973 [info ] [Thread-1 (]: 1 of 1 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m12:20:45.005320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m12:20:45.005599 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:20:45.013764 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:20:45.014549 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:20:45.028159 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:20:45.028758 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from base_table )

  
  
      
    ) dbt_internal_test
[0m12:20:45.028993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:45.368210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:35c63ffe-eeef-49c3-a18e-b1bae3726b20&page=queryresults
[0m12:20:45.369627 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:35c63ffe-eeef-49c3-a18e-b1bae3726b20&page=queryresults
[0m12:20:45.382759 [debug] [Thread-1 (]: Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Table "base_table" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:20:45.383498 [error] [Thread-1 (]: 1 of 1 ERROR check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ . [[31mERROR[0m in 0.38s]
[0m12:20:45.384013 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:20:45.384392 [debug] [Thread-4 (]: Marking all children of 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' to be skipped because of status 'error'.  Reason: Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Table "base_table" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql.
[0m12:20:45.385782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:20:45.387071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:45.387294 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' was properly closed.
[0m12:20:45.387492 [info ] [MainThread]: 
[0m12:20:45.387708 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m12:20:45.388147 [debug] [MainThread]: Command end result
[0m12:20:45.403778 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:20:45.404788 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:20:45.408367 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:20:45.408523 [info ] [MainThread]: 
[0m12:20:45.408707 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:20:45.408848 [info ] [MainThread]: 
[0m12:20:45.409030 [error] [MainThread]: [31mFailure in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)[0m
[0m12:20:45.409207 [error] [MainThread]:   Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Table "base_table" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:20:45.409333 [info ] [MainThread]: 
[0m12:20:45.409481 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:20:45.409606 [info ] [MainThread]: 
[0m12:20:45.409747 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:20:45.409997 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:20:45.412264 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.8530298, "process_in_blocks": "0", "process_kernel_time": 0.224749, "process_mem_max_rss": "387842048", "process_out_blocks": "0", "process_user_time": 1.51744}
[0m12:20:45.412487 [debug] [MainThread]: Command `dbt test` failed at 12:20:45.412434 after 1.85 seconds
[0m12:20:45.412654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151d3f540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151dd7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151dd7d90>]}
[0m12:20:45.412822 [debug] [MainThread]: Flushing usage events
[0m12:20:45.622470 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:15.162379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d406e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111973750>]}


============================== 12:21:15.164055 | e86e3012-6861-4a8f-aa74-c9268b03727d ==============================
[0m12:21:15.164055 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:21:15.164290 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'no_print': 'None', 'version_check': 'True', 'debug': 'False', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'quiet': 'False', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_cache_events': 'False', 'write_json': 'True', 'empty': 'None'}
[0m12:21:15.992729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e86e3012-6861-4a8f-aa74-c9268b03727d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ccc30>]}
[0m12:21:16.012348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e86e3012-6861-4a8f-aa74-c9268b03727d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ffba360>]}
[0m12:21:16.012616 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:21:16.088808 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:21:16.127997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:21:16.128267 [debug] [MainThread]: Partial parsing: updated file: air_travel://macros/check_row_count_equals.sql
[0m12:21:16.205062 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `check_row_count_equals` defined on
'aircrafts' in package 'air_travel' (models/stg/schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m12:21:16.205301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e86e3012-6861-4a8f-aa74-c9268b03727d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158507550>]}
[0m12:21:16.252495 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m12:21:16.256909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e86e3012-6861-4a8f-aa74-c9268b03727d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158756d50>]}
[0m12:21:16.288537 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:21:16.289380 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:21:16.298083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e86e3012-6861-4a8f-aa74-c9268b03727d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15874b850>]}
[0m12:21:16.298256 [info ] [MainThread]: Found 9 models, 1 test, 9 sources, 514 macros
[0m12:21:16.298374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e86e3012-6861-4a8f-aa74-c9268b03727d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158e66ea0>]}
[0m12:21:16.299044 [info ] [MainThread]: 
[0m12:21:16.299172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:16.299265 [info ] [MainThread]: 
[0m12:21:16.299446 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:21:16.300964 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:21:16.301126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:16.596520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e86e3012-6861-4a8f-aa74-c9268b03727d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158872510>]}
[0m12:21:16.597125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:16.600460 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:21:16.600909 [info ] [Thread-1 (]: 1 of 1 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m12:21:16.601305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m12:21:16.601571 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:21:16.608804 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:21:16.609480 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:21:16.623095 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:21:16.623627 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from raw_table )

  
  
      
    ) dbt_internal_test
[0m12:21:16.623859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:16.893638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d4496f29-2b04-4d47-995e-d1312121a82e&page=queryresults
[0m12:21:16.895010 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d4496f29-2b04-4d47-995e-d1312121a82e&page=queryresults
[0m12:21:16.906709 [debug] [Thread-1 (]: Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Table "raw_table" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:21:16.907579 [error] [Thread-1 (]: 1 of 1 ERROR check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ . [[31mERROR[0m in 0.31s]
[0m12:21:16.908145 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:21:16.908573 [debug] [Thread-4 (]: Marking all children of 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' to be skipped because of status 'error'.  Reason: Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Table "raw_table" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql.
[0m12:21:16.910271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:16.911736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:16.911955 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' was properly closed.
[0m12:21:16.912155 [info ] [MainThread]: 
[0m12:21:16.912376 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m12:21:16.912841 [debug] [MainThread]: Command end result
[0m12:21:16.928609 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:21:16.929710 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:21:16.933174 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:21:16.933337 [info ] [MainThread]: 
[0m12:21:16.933517 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:21:16.933664 [info ] [MainThread]: 
[0m12:21:16.933845 [error] [MainThread]: [31mFailure in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)[0m
[0m12:21:16.934028 [error] [MainThread]:   Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Table "raw_table" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:21:16.934168 [info ] [MainThread]: 
[0m12:21:16.934320 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:21:16.934452 [info ] [MainThread]: 
[0m12:21:16.934601 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:21:16.934853 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:21:16.937287 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.7983501, "process_in_blocks": "0", "process_kernel_time": 0.214012, "process_mem_max_rss": "387825664", "process_out_blocks": "0", "process_user_time": 1.583167}
[0m12:21:16.937498 [debug] [MainThread]: Command `dbt test` failed at 12:21:16.937457 after 1.80 seconds
[0m12:21:16.937675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15884b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158e862b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158e86990>]}
[0m12:21:16.937835 [debug] [MainThread]: Flushing usage events
[0m12:21:17.132152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:22:15.530179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082fc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091479d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109147750>]}


============================== 12:22:15.531798 | 8dcae525-0df3-4e73-af67-f75cba0fba2b ==============================
[0m12:22:15.531798 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:22:15.532041 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'empty': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt test', 'partial_parse': 'True', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error': 'None'}
[0m12:22:16.354468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dcae525-0df3-4e73-af67-f75cba0fba2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a0c30>]}
[0m12:22:16.373590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dcae525-0df3-4e73-af67-f75cba0fba2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ffba360>]}
[0m12:22:16.373824 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:22:16.447712 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:22:16.486389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:22:16.486668 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/stg/schema.yml
[0m12:22:16.562558 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `check_row_count_equals` defined on
'aircrafts' in package 'air_travel' (models/stg/schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m12:22:16.562777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8dcae525-0df3-4e73-af67-f75cba0fba2b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138507250>]}
[0m12:22:16.610661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m12:22:16.614951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dcae525-0df3-4e73-af67-f75cba0fba2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13875b890>]}
[0m12:22:16.646618 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:22:16.647426 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:22:16.656080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dcae525-0df3-4e73-af67-f75cba0fba2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138238750>]}
[0m12:22:16.656258 [info ] [MainThread]: Found 9 models, 1 test, 9 sources, 514 macros
[0m12:22:16.656377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dcae525-0df3-4e73-af67-f75cba0fba2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138886ea0>]}
[0m12:22:16.657039 [info ] [MainThread]: 
[0m12:22:16.657164 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:16.657260 [info ] [MainThread]: 
[0m12:22:16.657435 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:22:16.658963 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:22:16.659115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:16.949911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dcae525-0df3-4e73-af67-f75cba0fba2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138ddc050>]}
[0m12:22:16.950497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:16.953839 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_air_travel_raw_aircrafts.9dec59d2f2
[0m12:22:16.954209 [info ] [Thread-1 (]: 1 of 1 START test check_row_count_equals_aircrafts_air_travel_raw_aircrafts .... [RUN]
[0m12:22:16.954584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_air_travel_raw_aircrafts.9dec59d2f2)
[0m12:22:16.954865 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_air_travel_raw_aircrafts.9dec59d2f2
[0m12:22:16.961829 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_air_travel_raw_aircrafts.9dec59d2f2"
[0m12:22:16.962435 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_air_travel_raw_aircrafts.9dec59d2f2
[0m12:22:16.976769 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_air_travel_raw_aircrafts.9dec59d2f2"
[0m12:22:16.977345 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_air_travel_raw_aircrafts.9dec59d2f2: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_air_travel_raw_aircrafts.9dec59d2f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from raw_table )

  
  
      
    ) dbt_internal_test
[0m12:22:16.977574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:17.230515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f2fd9575-7d77-4c9c-8564-f39a5253542f&page=queryresults
[0m12:22:17.231895 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f2fd9575-7d77-4c9c-8564-f39a5253542f&page=queryresults
[0m12:22:17.243933 [debug] [Thread-1 (]: Database Error in test check_row_count_equals_aircrafts_air_travel_raw_aircrafts (models/stg/schema.yml)
  Table "raw_table" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircrafts_air_travel_raw_aircrafts.sql
[0m12:22:17.244782 [error] [Thread-1 (]: 1 of 1 ERROR check_row_count_equals_aircrafts_air_travel_raw_aircrafts ......... [[31mERROR[0m in 0.29s]
[0m12:22:17.245331 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_air_travel_raw_aircrafts.9dec59d2f2
[0m12:22:17.245865 [debug] [Thread-4 (]: Marking all children of 'test.air_travel.check_row_count_equals_aircrafts_air_travel_raw_aircrafts.9dec59d2f2' to be skipped because of status 'error'.  Reason: Database Error in test check_row_count_equals_aircrafts_air_travel_raw_aircrafts (models/stg/schema.yml)
  Table "raw_table" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircrafts_air_travel_raw_aircrafts.sql.
[0m12:22:17.247696 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:17.249138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:17.249350 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_aircrafts_air_travel_raw_aircrafts.9dec59d2f2' was properly closed.
[0m12:22:17.249560 [info ] [MainThread]: 
[0m12:22:17.249785 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m12:22:17.250255 [debug] [MainThread]: Command end result
[0m12:22:17.267178 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:22:17.268435 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:22:17.271927 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:22:17.272093 [info ] [MainThread]: 
[0m12:22:17.272280 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:22:17.272426 [info ] [MainThread]: 
[0m12:22:17.272607 [error] [MainThread]: [31mFailure in test check_row_count_equals_aircrafts_air_travel_raw_aircrafts (models/stg/schema.yml)[0m
[0m12:22:17.272780 [error] [MainThread]:   Database Error in test check_row_count_equals_aircrafts_air_travel_raw_aircrafts (models/stg/schema.yml)
  Table "raw_table" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircrafts_air_travel_raw_aircrafts.sql
[0m12:22:17.272910 [info ] [MainThread]: 
[0m12:22:17.273065 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/stg/schema.yml/check_row_count_equals_aircrafts_air_travel_raw_aircrafts.sql
[0m12:22:17.273192 [info ] [MainThread]: 
[0m12:22:17.273340 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:22:17.273592 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:22:17.275950 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.7693514, "process_in_blocks": "0", "process_kernel_time": 0.21371, "process_mem_max_rss": "389120000", "process_out_blocks": "0", "process_user_time": 1.57832}
[0m12:22:17.276170 [debug] [MainThread]: Command `dbt test` failed at 12:22:17.276128 after 1.77 seconds
[0m12:22:17.276348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1388776a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138e85810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138e853b0>]}
[0m12:22:17.276512 [debug] [MainThread]: Flushing usage events
[0m12:22:17.498038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:23:23.145425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2b750>]}


============================== 12:23:23.147010 | 0494dcc4-5eeb-4187-90db-79eb1e8feaf7 ==============================
[0m12:23:23.147010 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:23:23.147257 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'invocation_command': 'dbt test', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'use_colors': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_format': 'default'}
[0m12:23:23.961167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0494dcc4-5eeb-4187-90db-79eb1e8feaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108284c30>]}
[0m12:23:23.979884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0494dcc4-5eeb-4187-90db-79eb1e8feaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1277be360>]}
[0m12:23:23.980090 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:23:24.053416 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:23:24.092833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:23:24.093103 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/stg/schema.yml
[0m12:23:24.093235 [debug] [MainThread]: Partial parsing: updated file: air_travel://macros/check_row_count_equals.sql
[0m12:23:24.169922 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `check_row_count_equals` defined on
'aircrafts' in package 'air_travel' (models/stg/schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m12:23:24.170178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0494dcc4-5eeb-4187-90db-79eb1e8feaf7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13050b250>]}
[0m12:23:24.218067 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m12:23:24.222399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0494dcc4-5eeb-4187-90db-79eb1e8feaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130856e40>]}
[0m12:23:24.254172 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:23:24.254994 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:23:24.263659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0494dcc4-5eeb-4187-90db-79eb1e8feaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13084f850>]}
[0m12:23:24.263835 [info ] [MainThread]: Found 9 models, 1 test, 9 sources, 514 macros
[0m12:23:24.263953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0494dcc4-5eeb-4187-90db-79eb1e8feaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d66ea0>]}
[0m12:23:24.264643 [info ] [MainThread]: 
[0m12:23:24.264770 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:23:24.264865 [info ] [MainThread]: 
[0m12:23:24.265048 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:23:24.266547 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:23:24.266677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:24.568679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0494dcc4-5eeb-4187-90db-79eb1e8feaf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130a76450>]}
[0m12:23:24.569379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:23:24.572930 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:23:24.573343 [info ] [Thread-1 (]: 1 of 1 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m12:23:24.573733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m12:23:24.574034 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:23:24.581598 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:23:24.582161 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:23:24.596578 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:23:24.597141 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from air_travel_raw.`cs378-fa2025`.`air_travel_raw`.`aircrafts` )

  
  
      
    ) dbt_internal_test
[0m12:23:24.597389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:24.968735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d0f3da15-2caf-469e-a2aa-d849c5fde5af&page=queryresults
[0m12:23:24.970115 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d0f3da15-2caf-469e-a2aa-d849c5fde5af&page=queryresults
[0m12:23:24.982361 [debug] [Thread-1 (]: Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Invalid project ID 'air_travel_raw'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:23:24.983167 [error] [Thread-1 (]: 1 of 1 ERROR check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ . [[31mERROR[0m in 0.41s]
[0m12:23:24.983704 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:23:24.984124 [debug] [Thread-4 (]: Marking all children of 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' to be skipped because of status 'error'.  Reason: Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Invalid project ID 'air_travel_raw'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql.
[0m12:23:24.985694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:23:24.987059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:24.987287 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' was properly closed.
[0m12:23:24.987486 [info ] [MainThread]: 
[0m12:23:24.987695 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m12:23:24.988152 [debug] [MainThread]: Command end result
[0m12:23:25.004311 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:23:25.005340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:23:25.008701 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:23:25.008853 [info ] [MainThread]: 
[0m12:23:25.009034 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:23:25.009178 [info ] [MainThread]: 
[0m12:23:25.009449 [error] [MainThread]: [31mFailure in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)[0m
[0m12:23:25.009750 [error] [MainThread]:   Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Invalid project ID 'air_travel_raw'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:23:25.009969 [info ] [MainThread]: 
[0m12:23:25.010155 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:23:25.010299 [info ] [MainThread]: 
[0m12:23:25.010455 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:23:25.010726 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:23:25.012993 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.8911655, "process_in_blocks": "0", "process_kernel_time": 0.222646, "process_mem_max_rss": "398704640", "process_out_blocks": "0", "process_user_time": 1.563965}
[0m12:23:25.013206 [debug] [MainThread]: Command `dbt test` failed at 12:23:25.013163 after 1.89 seconds
[0m12:23:25.013381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130a636a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d82210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d828f0>]}
[0m12:23:25.013547 [debug] [MainThread]: Flushing usage events
[0m12:23:25.205913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:01.496238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062646e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070af9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070af750>]}


============================== 12:24:01.497839 | 7e769a31-6c71-4998-a781-1ba5159a08d9 ==============================
[0m12:24:01.497839 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:24:01.498073 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'no_print': 'None', 'invocation_command': 'dbt test', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'quiet': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_format': 'default', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m12:24:02.306831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e769a31-6c71-4998-a781-1ba5159a08d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106408c30>]}
[0m12:24:02.325646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e769a31-6c71-4998-a781-1ba5159a08d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116016360>]}
[0m12:24:02.325851 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:24:02.398959 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:24:02.437484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:02.437737 [debug] [MainThread]: Partial parsing: updated file: air_travel://macros/check_row_count_equals.sql
[0m12:24:02.514868 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `check_row_count_equals` defined on
'aircrafts' in package 'air_travel' (models/stg/schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m12:24:02.515111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7e769a31-6c71-4998-a781-1ba5159a08d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11645f250>]}
[0m12:24:02.562627 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m12:24:02.567077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e769a31-6c71-4998-a781-1ba5159a08d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1166aee40>]}
[0m12:24:02.598903 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:24:02.599714 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:24:02.608326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e769a31-6c71-4998-a781-1ba5159a08d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1166a7850>]}
[0m12:24:02.608508 [info ] [MainThread]: Found 9 models, 1 test, 9 sources, 514 macros
[0m12:24:02.608629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e769a31-6c71-4998-a781-1ba5159a08d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169b6ea0>]}
[0m12:24:02.609296 [info ] [MainThread]: 
[0m12:24:02.609423 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:02.609520 [info ] [MainThread]: 
[0m12:24:02.609712 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:24:02.611208 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:24:02.611344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:02.900386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e769a31-6c71-4998-a781-1ba5159a08d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167f2450>]}
[0m12:24:02.901056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:02.904447 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:24:02.904881 [info ] [Thread-1 (]: 1 of 1 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m12:24:02.905262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m12:24:02.905563 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:24:02.912972 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:24:02.913561 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:24:02.927789 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:24:02.928267 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.air_travel_raw.`cs378-fa2025`.`air_travel_raw`.`aircrafts` )

  
  
      
    ) dbt_internal_test
[0m12:24:02.928501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:03.369628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:917c0267-15ef-49a6-8b92-53b28143f828&page=queryresults
[0m12:24:03.371073 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:917c0267-15ef-49a6-8b92-53b28143f828&page=queryresults
[0m12:24:03.384364 [debug] [Thread-1 (]: Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Not found: Dataset cs378-fa2025:air_travel_raw.cs378-fa2025.air_travel_raw was not found in location us-central1
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:24:03.385002 [error] [Thread-1 (]: 1 of 1 ERROR check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ . [[31mERROR[0m in 0.48s]
[0m12:24:03.385498 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:24:03.386039 [debug] [Thread-4 (]: Marking all children of 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' to be skipped because of status 'error'.  Reason: Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Not found: Dataset cs378-fa2025:air_travel_raw.cs378-fa2025.air_travel_raw was not found in location us-central1
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql.
[0m12:24:03.387553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:24:03.389018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:03.389270 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' was properly closed.
[0m12:24:03.389485 [info ] [MainThread]: 
[0m12:24:03.389759 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m12:24:03.390311 [debug] [MainThread]: Command end result
[0m12:24:03.406105 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:24:03.407248 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:24:03.410644 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:24:03.410809 [info ] [MainThread]: 
[0m12:24:03.410989 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:24:03.411134 [info ] [MainThread]: 
[0m12:24:03.411318 [error] [MainThread]: [31mFailure in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)[0m
[0m12:24:03.411492 [error] [MainThread]:   Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Not found: Dataset cs378-fa2025:air_travel_raw.cs378-fa2025.air_travel_raw was not found in location us-central1
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:24:03.411622 [info ] [MainThread]: 
[0m12:24:03.411773 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:24:03.411895 [info ] [MainThread]: 
[0m12:24:03.412044 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:24:03.412292 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:24:03.414750 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.9421183, "process_in_blocks": "0", "process_kernel_time": 0.206147, "process_mem_max_rss": "388448256", "process_out_blocks": "0", "process_user_time": 1.571301}
[0m12:24:03.414964 [debug] [MainThread]: Command `dbt test` failed at 12:24:03.414920 after 1.94 seconds
[0m12:24:03.415147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167c76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169de7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169de8f0>]}
[0m12:24:03.415305 [debug] [MainThread]: Flushing usage events
[0m12:24:03.626258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:18.744035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e57750>]}


============================== 12:25:18.745639 | 826800dd-a312-40b2-a275-18bf0a122a24 ==============================
[0m12:25:18.745639 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:25:18.745879 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True'}
[0m12:25:19.561139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '826800dd-a312-40b2-a275-18bf0a122a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b0c30>]}
[0m12:25:19.580145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '826800dd-a312-40b2-a275-18bf0a122a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a0ba360>]}
[0m12:25:19.580348 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:25:19.654652 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:25:19.693699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:19.693836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:19.695796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m12:25:19.709535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '826800dd-a312-40b2-a275-18bf0a122a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a06b050>]}
[0m12:25:19.740802 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:25:19.741570 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:25:19.750245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '826800dd-a312-40b2-a275-18bf0a122a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1bfd40>]}
[0m12:25:19.750414 [info ] [MainThread]: Found 9 models, 1 test, 9 sources, 514 macros
[0m12:25:19.750539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '826800dd-a312-40b2-a275-18bf0a122a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b2020b0>]}
[0m12:25:19.751201 [info ] [MainThread]: 
[0m12:25:19.751330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:19.751424 [info ] [MainThread]: 
[0m12:25:19.751610 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:25:19.753076 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:25:19.753225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:20.016134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '826800dd-a312-40b2-a275-18bf0a122a24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1f5e60>]}
[0m12:25:20.016967 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:20.021332 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:25:20.021751 [info ] [Thread-1 (]: 1 of 1 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m12:25:20.022138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m12:25:20.022424 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:25:20.034978 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:25:20.035619 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:25:20.048936 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:25:20.049379 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.air_travel_raw.`cs378-fa2025`.`air_travel_raw`.`aircrafts` )

  
  
      
    ) dbt_internal_test
[0m12:25:20.049611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:20.786266 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2515ba89-e642-4a0f-a6f1-dd165936573d&page=queryresults
[0m12:25:20.787442 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2515ba89-e642-4a0f-a6f1-dd165936573d&page=queryresults
[0m12:25:20.798297 [debug] [Thread-1 (]: Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Not found: Dataset cs378-fa2025:air_travel_raw.cs378-fa2025.air_travel_raw was not found in location us-central1
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:25:20.798975 [error] [Thread-1 (]: 1 of 1 ERROR check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ . [[31mERROR[0m in 0.78s]
[0m12:25:20.799462 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:25:20.799880 [debug] [Thread-4 (]: Marking all children of 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' to be skipped because of status 'error'.  Reason: Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Not found: Dataset cs378-fa2025:air_travel_raw.cs378-fa2025.air_travel_raw was not found in location us-central1
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql.
[0m12:25:20.801306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:20.802603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:20.802825 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' was properly closed.
[0m12:25:20.803025 [info ] [MainThread]: 
[0m12:25:20.803250 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m12:25:20.803702 [debug] [MainThread]: Command end result
[0m12:25:20.819705 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:25:20.820681 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:25:20.824151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:25:20.824311 [info ] [MainThread]: 
[0m12:25:20.824491 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:25:20.824638 [info ] [MainThread]: 
[0m12:25:20.824822 [error] [MainThread]: [31mFailure in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)[0m
[0m12:25:20.824995 [error] [MainThread]:   Database Error in test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ (models/stg/schema.yml)
  Not found: Dataset cs378-fa2025:air_travel_raw.cs378-fa2025.air_travel_raw was not found in location us-central1
  compiled code at target/run/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:25:20.825128 [info ] [MainThread]: 
[0m12:25:20.825282 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/stg/schema.yml/check_row_count_equals_aircraf_f61e206623a18910c5f896f8da3cff2c.sql
[0m12:25:20.825418 [info ] [MainThread]: 
[0m12:25:20.825560 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:25:20.827918 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.107775, "process_in_blocks": "0", "process_kernel_time": 0.223788, "process_mem_max_rss": "382730240", "process_out_blocks": "0", "process_user_time": 1.453468}
[0m12:25:20.828130 [debug] [MainThread]: Command `dbt test` failed at 12:25:20.828088 after 2.11 seconds
[0m12:25:20.828306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b2124c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b2120a0>]}
[0m12:25:20.828466 [debug] [MainThread]: Flushing usage events
[0m12:25:21.042092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:58.844531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108386e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c73750>]}


============================== 12:25:58.846152 | 55dc8ab3-2ff8-44e5-b81b-e04141c24b85 ==============================
[0m12:25:58.846152 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:25:58.846397 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt test', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/scohen/.dbt', 'fail_fast': 'False', 'empty': 'None', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m12:25:59.661439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55dc8ab3-2ff8-44e5-b81b-e04141c24b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bccc30>]}
[0m12:25:59.680083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55dc8ab3-2ff8-44e5-b81b-e04141c24b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f6ba360>]}
[0m12:25:59.680300 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:25:59.752688 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:25:59.791994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:25:59.792246 [debug] [MainThread]: Partial parsing: updated file: air_travel://macros/check_row_count_equals.sql
[0m12:25:59.868437 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `check_row_count_equals` defined on
'aircrafts' in package 'air_travel' (models/stg/schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m12:25:59.868669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55dc8ab3-2ff8-44e5-b81b-e04141c24b85', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fe07250>]}
[0m12:25:59.916708 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m12:25:59.921118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55dc8ab3-2ff8-44e5-b81b-e04141c24b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159056e40>]}
[0m12:25:59.952701 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:25:59.953515 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:25:59.962198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55dc8ab3-2ff8-44e5-b81b-e04141c24b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15904f850>]}
[0m12:25:59.962376 [info ] [MainThread]: Found 9 models, 1 test, 9 sources, 514 macros
[0m12:25:59.962498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55dc8ab3-2ff8-44e5-b81b-e04141c24b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a966ea0>]}
[0m12:25:59.963171 [info ] [MainThread]: 
[0m12:25:59.963294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:59.963388 [info ] [MainThread]: 
[0m12:25:59.963571 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:25:59.965155 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:25:59.965289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:00.244007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55dc8ab3-2ff8-44e5-b81b-e04141c24b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159276450>]}
[0m12:26:00.244656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:00.248152 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:26:00.248483 [info ] [Thread-1 (]: 1 of 1 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m12:26:00.248831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m12:26:00.249104 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:26:00.257122 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:26:00.257879 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:26:00.271704 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:26:00.272208 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`aircrafts` )

  
  
      
    ) dbt_internal_test
[0m12:26:00.272444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:01.142210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b4fa049d-68ee-46c7-8a70-a8328e721fb4&page=queryresults
[0m12:26:01.623853 [info ] [Thread-1 (]: 1 of 1 PASS check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ .. [[32mPASS[0m in 1.37s]
[0m12:26:01.624747 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:26:01.626128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:26:01.627795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:01.628050 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' was properly closed.
[0m12:26:01.628291 [info ] [MainThread]: 
[0m12:26:01.628542 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m12:26:01.629078 [debug] [MainThread]: Command end result
[0m12:26:01.646665 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:26:01.647950 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:26:01.651551 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:26:01.651712 [info ] [MainThread]: 
[0m12:26:01.651892 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:01.652026 [info ] [MainThread]: 
[0m12:26:01.652185 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:26:01.652442 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:26:01.654793 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.8328824, "process_in_blocks": "0", "process_kernel_time": 0.242615, "process_mem_max_rss": "399081472", "process_out_blocks": "0", "process_user_time": 1.591355}
[0m12:26:01.655018 [debug] [MainThread]: Command `dbt test` succeeded at 12:26:01.654973 after 2.83 seconds
[0m12:26:01.655197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159267cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a986990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a986210>]}
[0m12:26:01.655371 [debug] [MainThread]: Flushing usage events
[0m12:26:01.852165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:46.688902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107173750>]}


============================== 12:28:46.690573 | 3b1a9f4a-494c-4e14-93d5-76230df2f9e3 ==============================
[0m12:28:46.690573 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:28:46.690821 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'empty': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m12:28:47.504922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b1a9f4a-494c-4e14-93d5-76230df2f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ccc30>]}
[0m12:28:47.523687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b1a9f4a-494c-4e14-93d5-76230df2f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e6ba360>]}
[0m12:28:47.523897 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:28:47.598160 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:28:47.637163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:47.637303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:47.639273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m12:28:47.652816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b1a9f4a-494c-4e14-93d5-76230df2f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e66b050>]}
[0m12:28:47.684165 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:28:47.684967 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:28:47.693574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b1a9f4a-494c-4e14-93d5-76230df2f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12efbfd40>]}
[0m12:28:47.693750 [info ] [MainThread]: Found 9 models, 1 test, 9 sources, 514 macros
[0m12:28:47.693878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1a9f4a-494c-4e14-93d5-76230df2f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9020b0>]}
[0m12:28:47.694555 [info ] [MainThread]: 
[0m12:28:47.694678 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:47.694774 [info ] [MainThread]: 
[0m12:28:47.694962 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:28:47.696466 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:28:47.696626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:48.033628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1a9f4a-494c-4e14-93d5-76230df2f9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eff9e60>]}
[0m12:28:48.034148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:48.037225 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:28:48.037631 [info ] [Thread-1 (]: 1 of 1 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m12:28:48.038003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m12:28:48.038277 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:28:48.049730 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:28:48.050328 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:28:48.063727 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:28:48.064234 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`aircrafts` )

  
  
      
    ) dbt_internal_test
[0m12:28:48.064475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:48.676278 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:09bc202d-8dc7-4836-85ca-7354b9c25eb4&page=queryresults
[0m12:28:49.261466 [info ] [Thread-1 (]: 1 of 1 PASS check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ .. [[32mPASS[0m in 1.22s]
[0m12:28:49.262220 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:28:49.263470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:49.265095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:49.265348 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc' was properly closed.
[0m12:28:49.265582 [info ] [MainThread]: 
[0m12:28:49.265827 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m12:28:49.266370 [debug] [MainThread]: Command end result
[0m12:28:49.283306 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:28:49.284427 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:28:49.288158 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:28:49.288312 [info ] [MainThread]: 
[0m12:28:49.288493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:49.288628 [info ] [MainThread]: 
[0m12:28:49.288780 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:28:49.291081 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.6258407, "process_in_blocks": "0", "process_kernel_time": 0.235584, "process_mem_max_rss": "386433024", "process_out_blocks": "0", "process_user_time": 1.475684}
[0m12:28:49.291318 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:49.291274 after 2.63 seconds
[0m12:28:49.291505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107078a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f912830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f912a40>]}
[0m12:28:49.291676 [debug] [MainThread]: Flushing usage events
[0m12:28:49.503036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:35.702048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044346e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527f750>]}


============================== 12:50:35.703652 | 1042e4a4-fd5b-4358-8be0-2890120b4cf8 ==============================
[0m12:50:35.703652 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:50:35.703900 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select airlines', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_format': 'default', 'partial_parse': 'True', 'debug': 'False', 'introspect': 'True', 'use_colors': 'True', 'version_check': 'True'}
[0m12:50:36.516669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1042e4a4-fd5b-4358-8be0-2890120b4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d8c30>]}
[0m12:50:36.535473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1042e4a4-fd5b-4358-8be0-2890120b4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12adbe360>]}
[0m12:50:36.535687 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:50:36.609404 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:50:36.648277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:50:36.648507 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/stg/schema.yml
[0m12:50:36.669542 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `check_row_count_equals` defined on 'airlines'
in package 'air_travel' (models/stg/schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m12:50:36.669738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1042e4a4-fd5b-4358-8be0-2890120b4cf8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ad6af50>]}
[0m12:50:36.723331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m12:50:36.727700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1042e4a4-fd5b-4358-8be0-2890120b4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c5626c0>]}
[0m12:50:36.758675 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:50:36.759508 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:50:36.764850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1042e4a4-fd5b-4358-8be0-2890120b4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c853a10>]}
[0m12:50:36.765038 [info ] [MainThread]: Found 9 models, 2 data tests, 9 sources, 514 macros
[0m12:50:36.765164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1042e4a4-fd5b-4358-8be0-2890120b4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c75e9c0>]}
[0m12:50:36.765752 [info ] [MainThread]: 
[0m12:50:36.765878 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:36.765972 [info ] [MainThread]: 
[0m12:50:36.766162 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:50:36.766500 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:50:36.766644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:37.178538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:50:37.179054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:37.453347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1042e4a4-fd5b-4358-8be0-2890120b4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8bcad0>]}
[0m12:50:37.453939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:37.457165 [debug] [Thread-1 (]: Began running node model.air_travel.airlines
[0m12:50:37.457691 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.airlines ....................... [RUN]
[0m12:50:37.458077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.airlines)
[0m12:50:37.458361 [debug] [Thread-1 (]: Began compiling node model.air_travel.airlines
[0m12:50:37.466830 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airlines"
[0m12:50:37.467456 [debug] [Thread-1 (]: Began executing node model.air_travel.airlines
[0m12:50:37.476506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:37.771329 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airlines"
[0m12:50:37.771852 [debug] [Thread-1 (]: On model.air_travel.airlines: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airlines"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
      
    
    

    
    OPTIONS()
    as (
      with stg_airlines as (
  select airline_id as id,
    name,
    case alias
        when '\\N' then null
        else alias
        end as alias,
    case iata
        when '' then null
        else iata
        end as iata,
    case icao
        when '' then null
        else icao
        end as icao,
    case callsign
        when '\\N' then null
        else callsign
        end as callsign,
    case country
        when '\\N' then null
        else country end as country,
    active, _data_source, _load_time
  from `cs378-fa2025`.`air_travel_raw`.`airlines`
)

select * from stg_airlines
    );
  
[0m12:50:38.235698 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:356ee0e7-a503-4613-b80e-e5903ade8f98&page=queryresults
[0m12:50:40.235771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1042e4a4-fd5b-4358-8be0-2890120b4cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c935c80>]}
[0m12:50:40.236111 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.airlines .................. [[32mCREATE TABLE (6.2k rows, 489.7 KiB processed)[0m in 2.78s]
[0m12:50:40.236369 [debug] [Thread-1 (]: Finished running node model.air_travel.airlines
[0m12:50:40.236917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:40.237618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:40.237727 [debug] [MainThread]: Connection 'model.air_travel.airlines' was properly closed.
[0m12:50:40.237832 [info ] [MainThread]: 
[0m12:50:40.237959 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m12:50:40.238220 [debug] [MainThread]: Command end result
[0m12:50:40.248235 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:50:40.249131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:50:40.251295 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:50:40.251408 [info ] [MainThread]: 
[0m12:50:40.251553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:40.251654 [info ] [MainThread]: 
[0m12:50:40.251768 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:50:40.251959 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:50:40.253751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5752487, "process_in_blocks": "0", "process_kernel_time": 0.24134, "process_mem_max_rss": "389578752", "process_out_blocks": "0", "process_user_time": 1.609162}
[0m12:50:40.253987 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:40.253912 after 4.58 seconds
[0m12:50:40.254188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c93a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea02450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c76ab50>]}
[0m12:50:40.254329 [debug] [MainThread]: Flushing usage events
[0m12:50:40.474260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:33.497869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105573750>]}


============================== 12:51:33.499524 | 09cdead4-e848-4ff6-891a-8011c8e251f2 ==============================
[0m12:51:33.499524 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:51:33.499765 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'no_print': 'None', 'invocation_command': 'dbt parse --no-partial-parse --show-all-deprecations', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default', 'debug': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'indirect_selection': 'eager', 'profiles_dir': '/Users/scohen/.dbt', 'empty': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True'}
[0m12:51:34.316064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09cdead4-e848-4ff6-891a-8011c8e251f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ccc30>]}
[0m12:51:34.334911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09cdead4-e848-4ff6-891a-8011c8e251f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b3c2360>]}
[0m12:51:34.335119 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:51:34.409054 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:51:34.409381 [debug] [MainThread]: Partial parsing not enabled
[0m12:51:34.722468 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `check_row_count_equals` defined on
'aircrafts' in package 'air_travel' (models/stg/schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m12:51:34.722752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '09cdead4-e848-4ff6-891a-8011c8e251f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e279950>]}
[0m12:51:34.760884 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `check_row_count_equals` defined on 'airlines'
in package 'air_travel' (models/stg/schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m12:51:34.761134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '09cdead4-e848-4ff6-891a-8011c8e251f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f496d0>]}
[0m12:51:34.904888 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m12:51:34.908077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09cdead4-e848-4ff6-891a-8011c8e251f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b5ece50>]}
[0m12:51:34.909388 [info ] [MainThread]: Performance info: /Users/scohen/UTCS/378/dbt/air_travel/target/perf_info.json
[0m12:51:34.938860 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:51:34.939611 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:51:34.939793 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
[0m12:51:34.941467 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.4672883, "process_in_blocks": "0", "process_kernel_time": 0.217684, "process_mem_max_rss": "386449408", "process_out_blocks": "0", "process_user_time": 1.727529}
[0m12:51:34.941618 [debug] [MainThread]: Command `dbt parse` succeeded at 12:51:34.941589 after 1.47 seconds
[0m12:51:34.941740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e647c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105478a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e5b6150>]}
[0m12:51:34.941858 [debug] [MainThread]: Flushing usage events
[0m12:51:35.132298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:58.895177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088039d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108803750>]}


============================== 12:53:58.896808 | 705808fa-5463-42dc-ae6c-631f2b754b01 ==============================
[0m12:53:58.896808 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:53:58.897051 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default'}
[0m12:53:59.712954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '705808fa-5463-42dc-ae6c-631f2b754b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5cc30>]}
[0m12:53:59.731885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '705808fa-5463-42dc-ae6c-631f2b754b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1ba360>]}
[0m12:53:59.732090 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:53:59.805460 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:53:59.845287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:59.845594 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/stg/schema.yml
[0m12:53:59.970258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m12:53:59.974643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '705808fa-5463-42dc-ae6c-631f2b754b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f70ba50>]}
[0m12:54:00.006514 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:54:00.007407 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:54:00.016273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '705808fa-5463-42dc-ae6c-631f2b754b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1388148c0>]}
[0m12:54:00.016470 [info ] [MainThread]: Found 9 models, 2 data tests, 9 sources, 514 macros
[0m12:54:00.016595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '705808fa-5463-42dc-ae6c-631f2b754b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f33af90>]}
[0m12:54:00.017298 [info ] [MainThread]: 
[0m12:54:00.017430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:00.017524 [info ] [MainThread]: 
[0m12:54:00.017705 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:54:00.019248 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:54:00.019378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:00.320083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '705808fa-5463-42dc-ae6c-631f2b754b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138372f70>]}
[0m12:54:00.320666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:00.324018 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:54:00.324321 [info ] [Thread-1 (]: 1 of 2 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m12:54:00.324622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m12:54:00.324881 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:54:00.332018 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:54:00.332536 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:54:00.346241 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:54:00.346780 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`aircrafts` )

  
  
      
    ) dbt_internal_test
[0m12:54:00.347034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:00.948326 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:fdfd153f-4741-4fd3-8848-ec84da2beea0&page=queryresults
[0m12:54:01.440145 [info ] [Thread-1 (]: 1 of 2 PASS check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ .. [[32mPASS[0m in 1.12s]
[0m12:54:01.440910 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:54:01.441237 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:54:01.441613 [info ] [Thread-1 (]: 2 of 2 START test check_row_count_equals_airlines_source_air_travel_raw_airlines_  [RUN]
[0m12:54:01.442045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc, now test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d)
[0m12:54:01.442339 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:54:01.446207 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m12:54:01.446944 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:54:01.448251 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m12:54:01.448760 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airlines` )

  
  
      
    ) dbt_internal_test
[0m12:54:01.449050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:02.174823 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a527462e-63d4-4173-8d1f-2ff0552a9407&page=queryresults
[0m12:54:02.612874 [info ] [Thread-1 (]: 2 of 2 PASS check_row_count_equals_airlines_source_air_travel_raw_airlines_ .... [[32mPASS[0m in 1.17s]
[0m12:54:02.613871 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:54:02.615483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:02.617302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:02.617569 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d' was properly closed.
[0m12:54:02.617846 [info ] [MainThread]: 
[0m12:54:02.618104 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m12:54:02.618758 [debug] [MainThread]: Command end result
[0m12:54:02.639503 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:54:02.640648 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:54:02.644232 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:54:02.644390 [info ] [MainThread]: 
[0m12:54:02.644581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:02.644719 [info ] [MainThread]: 
[0m12:54:02.644880 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:54:02.647214 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.77549, "process_in_blocks": "0", "process_kernel_time": 0.24546, "process_mem_max_rss": "396214272", "process_out_blocks": "0", "process_user_time": 1.662711}
[0m12:54:02.647448 [debug] [MainThread]: Command `dbt test` succeeded at 12:54:02.647399 after 3.78 seconds
[0m12:54:02.647629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108708a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13833bb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13833b3e0>]}
[0m12:54:02.647800 [debug] [MainThread]: Flushing usage events
[0m12:54:02.958756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:40.312448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106573750>]}


============================== 12:56:40.314012 | 9a2a05f7-0b9b-4cba-8292-af50982b59b3 ==============================
[0m12:56:40.314012 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:56:40.314256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'None', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_experimental_parser': 'False'}
[0m12:56:41.155559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a2a05f7-0b9b-4cba-8292-af50982b59b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ccc30>]}
[0m12:56:41.174324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a2a05f7-0b9b-4cba-8292-af50982b59b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1372ba360>]}
[0m12:56:41.174533 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:56:41.248968 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:56:41.288320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:56:41.288609 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/stg/schema.yml
[0m12:56:41.370680 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m12:56:41.375010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a2a05f7-0b9b-4cba-8292-af50982b59b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f009e50>]}
[0m12:56:41.407109 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:56:41.407931 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:56:41.417134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a2a05f7-0b9b-4cba-8292-af50982b59b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f42eb70>]}
[0m12:56:41.417316 [info ] [MainThread]: Found 9 models, 9 data tests, 9 sources, 514 macros
[0m12:56:41.417443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a2a05f7-0b9b-4cba-8292-af50982b59b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f491b70>]}
[0m12:56:41.418230 [info ] [MainThread]: 
[0m12:56:41.418359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:56:41.418458 [info ] [MainThread]: 
[0m12:56:41.418643 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:56:41.420218 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:56:41.420355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:41.702594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a2a05f7-0b9b-4cba-8292-af50982b59b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f4ac940>]}
[0m12:56:41.703193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:41.706761 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:56:41.707186 [info ] [Thread-1 (]: 1 of 9 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m12:56:41.707576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m12:56:41.707830 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:56:41.714967 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:56:41.715487 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:56:41.729137 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:56:41.729718 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`aircrafts` )

  
  
      
    ) dbt_internal_test
[0m12:56:41.729957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:42.536547 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:70ca8b6e-f606-4431-b873-476e11a62e19&page=queryresults
[0m12:56:43.057730 [info ] [Thread-1 (]: 1 of 9 PASS check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ .. [[32mPASS[0m in 1.35s]
[0m12:56:43.058444 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:56:43.058763 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:56:43.059146 [info ] [Thread-1 (]: 2 of 9 START test check_row_count_equals_airlines_source_air_travel_raw_airlines_  [RUN]
[0m12:56:43.059572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc, now test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d)
[0m12:56:43.059861 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:56:43.063407 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m12:56:43.064108 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:56:43.065431 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m12:56:43.065851 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airlines` )

  
  
      
    ) dbt_internal_test
[0m12:56:43.066105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:43.560430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6e684f31-9e6b-43b1-8f3e-4981c35063d1&page=queryresults
[0m12:56:44.076973 [info ] [Thread-1 (]: 2 of 9 PASS check_row_count_equals_airlines_source_air_travel_raw_airlines_ .... [[32mPASS[0m in 1.02s]
[0m12:56:44.077979 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:56:44.078505 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:56:44.079029 [info ] [Thread-1 (]: 3 of 9 START test check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_  [RUN]
[0m12:56:44.079625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d, now test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510)
[0m12:56:44.080419 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:56:44.085516 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m12:56:44.086386 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:56:44.088432 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m12:56:44.089398 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_maps` )

  
  
      
    ) dbt_internal_test
[0m12:56:44.089841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:44.892211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7328e193-c27a-48c6-af93-9e1980b23b79&page=queryresults
[0m12:56:45.289990 [info ] [Thread-1 (]: 3 of 9 PASS check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_  [[32mPASS[0m in 1.21s]
[0m12:56:45.291578 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:56:45.292241 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:56:45.292740 [info ] [Thread-1 (]: 4 of 9 START test check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_  [RUN]
[0m12:56:45.293328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510, now test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587)
[0m12:56:45.293708 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:56:45.298269 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m12:56:45.299099 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:56:45.300719 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m12:56:45.301281 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_reviews` )

  
  
      
    ) dbt_internal_test
[0m12:56:45.301594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:46.123575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b3b09d26-b544-4ba3-91d2-9b548b60928e&page=queryresults
[0m12:56:46.528446 [info ] [Thread-1 (]: 4 of 9 PASS check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_  [[32mPASS[0m in 1.23s]
[0m12:56:46.529753 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:56:46.530197 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:56:46.530653 [info ] [Thread-1 (]: 5 of 9 START test check_row_count_equals_airports_source_air_travel_raw_airports_  [RUN]
[0m12:56:46.531243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587, now test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0)
[0m12:56:46.531624 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:56:46.535922 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m12:56:46.536967 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:56:46.538753 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m12:56:46.539335 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airports` )

  
  
      
    ) dbt_internal_test
[0m12:56:46.539628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:47.452347 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5164b047-bf4c-474d-b41e-4e88d212b887&page=queryresults
[0m12:56:47.879897 [info ] [Thread-1 (]: 5 of 9 PASS check_row_count_equals_airports_source_air_travel_raw_airports_ .... [[32mPASS[0m in 1.35s]
[0m12:56:47.881241 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:56:47.881844 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:56:47.882327 [info ] [Thread-1 (]: 6 of 9 START test check_row_count_equals_countries_source_air_travel_raw_countries_  [RUN]
[0m12:56:47.882878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0, now test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414)
[0m12:56:47.883317 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:56:47.888515 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m12:56:47.889480 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:56:47.891170 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m12:56:47.891702 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`countries` )

  
  
      
    ) dbt_internal_test
[0m12:56:47.892030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:48.680049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5295b666-5b00-4707-8b75-c31a38a25288&page=queryresults
[0m12:56:49.498803 [info ] [Thread-1 (]: 6 of 9 PASS check_row_count_equals_countries_source_air_travel_raw_countries_ .. [[32mPASS[0m in 1.62s]
[0m12:56:49.499260 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:56:49.499489 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:56:49.499739 [info ] [Thread-1 (]: 7 of 9 START test check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_  [RUN]
[0m12:56:49.500041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414, now test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823)
[0m12:56:49.500252 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:56:49.503117 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m12:56:49.503623 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:56:49.504664 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m12:56:49.505009 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_delays` )

  
  
      
    ) dbt_internal_test
[0m12:56:49.505221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:50.299962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c13bb32c-1bcc-45dd-b172-837107590855&page=queryresults
[0m12:56:50.676708 [info ] [Thread-1 (]: 7 of 9 PASS check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_  [[32mPASS[0m in 1.18s]
[0m12:56:50.677239 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:56:50.677506 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:56:50.677777 [info ] [Thread-1 (]: 8 of 9 START test check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_  [RUN]
[0m12:56:50.678109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823, now test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81)
[0m12:56:50.678335 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:56:50.681295 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m12:56:50.681803 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:56:50.682918 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m12:56:50.683319 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_routes` )

  
  
      
    ) dbt_internal_test
[0m12:56:50.683550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:51.650127 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:134c79d9-450d-49e3-949c-10d7b2ec7bde&page=queryresults
[0m12:56:52.110748 [info ] [Thread-1 (]: 8 of 9 PASS check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_  [[32mPASS[0m in 1.43s]
[0m12:56:52.111180 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:56:52.111394 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:56:52.111630 [info ] [Thread-1 (]: 9 of 9 START test check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_  [RUN]
[0m12:56:52.111925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81, now test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee)
[0m12:56:52.112137 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:56:52.114855 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m12:56:52.115313 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:56:52.116340 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m12:56:52.116709 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic` )

  
  
      
    ) dbt_internal_test
[0m12:56:52.116905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:52.780066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:023977a6-c681-4f72-b004-ce8c5c67821c&page=queryresults
[0m12:56:53.182562 [info ] [Thread-1 (]: 9 of 9 PASS check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_  [[32mPASS[0m in 1.07s]
[0m12:56:53.183314 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:56:53.184493 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:53.186304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:53.186627 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee' was properly closed.
[0m12:56:53.186917 [info ] [MainThread]: 
[0m12:56:53.187183 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 11.77 seconds (11.77s).
[0m12:56:53.188546 [debug] [MainThread]: Command end result
[0m12:56:53.209216 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:56:53.210470 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:56:53.214417 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:56:53.214596 [info ] [MainThread]: 
[0m12:56:53.214792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:53.214946 [info ] [MainThread]: 
[0m12:56:53.215115 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m12:56:53.217528 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.929091, "process_in_blocks": "0", "process_kernel_time": 0.297147, "process_mem_max_rss": "403095552", "process_out_blocks": "0", "process_user_time": 2.215661}
[0m12:56:53.217752 [debug] [MainThread]: Command `dbt test` succeeded at 12:56:53.217708 after 12.93 seconds
[0m12:56:53.217924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106378ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1693e55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1693e5e90>]}
[0m12:56:53.218094 [debug] [MainThread]: Flushing usage events
[0m12:56:53.432967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:19.685320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c73c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c739d0>]}


============================== 12:57:19.687281 | ef61122a-9a2c-42c2-9e18-765eacc1fa9c ==============================
[0m12:57:19.687281 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:57:19.687549 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'target_path': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'quiet': 'False', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'empty': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/scohen/.dbt'}
[0m12:57:20.533973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef61122a-9a2c-42c2-9e18-765eacc1fa9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad0c30>]}
[0m12:57:20.556045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef61122a-9a2c-42c2-9e18-765eacc1fa9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f5ba360>]}
[0m12:57:20.556384 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:57:20.635185 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:57:20.678034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:20.678248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:20.680360 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m12:57:20.695103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef61122a-9a2c-42c2-9e18-765eacc1fa9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f56b050>]}
[0m12:57:20.705423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef61122a-9a2c-42c2-9e18-765eacc1fa9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fd73e30>]}
[0m12:57:20.705656 [info ] [MainThread]: Found 9 models, 9 data tests, 9 sources, 514 macros
[0m12:57:20.705794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef61122a-9a2c-42c2-9e18-765eacc1fa9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f782970>]}
[0m12:57:20.706702 [info ] [MainThread]: 
[0m12:57:20.706838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:20.706994 [info ] [MainThread]: 
[0m12:57:20.707411 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:57:20.708967 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:57:20.709111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:20.993323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef61122a-9a2c-42c2-9e18-765eacc1fa9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff7c940>]}
[0m12:57:20.993983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:20.997875 [debug] [Thread-1 (]: Began running node model.air_travel.aircrafts
[0m12:57:20.998364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.aircrafts)
[0m12:57:20.998693 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircrafts
[0m12:57:21.006866 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircrafts"
[0m12:57:21.007596 [debug] [Thread-1 (]: Began executing node model.air_travel.aircrafts
[0m12:57:21.007842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.009104 [debug] [Thread-1 (]: Finished running node model.air_travel.aircrafts
[0m12:57:21.009338 [debug] [Thread-1 (]: Began running node model.air_travel.airlines
[0m12:57:21.009631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircrafts, now model.air_travel.airlines)
[0m12:57:21.009953 [debug] [Thread-1 (]: Began compiling node model.air_travel.airlines
[0m12:57:21.011786 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airlines"
[0m12:57:21.012245 [debug] [Thread-1 (]: Began executing node model.air_travel.airlines
[0m12:57:21.012461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.013585 [debug] [Thread-1 (]: Finished running node model.air_travel.airlines
[0m12:57:21.013784 [debug] [Thread-1 (]: Began running node model.air_travel.airport_maps
[0m12:57:21.013992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airlines, now model.air_travel.airport_maps)
[0m12:57:21.014197 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_maps
[0m12:57:21.015542 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_maps"
[0m12:57:21.016052 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_maps
[0m12:57:21.016227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.017536 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_maps
[0m12:57:21.017731 [debug] [Thread-1 (]: Began running node model.air_travel.airport_reviews
[0m12:57:21.017924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_maps, now model.air_travel.airport_reviews)
[0m12:57:21.018123 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_reviews
[0m12:57:21.019391 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_reviews"
[0m12:57:21.019943 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_reviews
[0m12:57:21.020119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.021053 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_reviews
[0m12:57:21.021245 [debug] [Thread-1 (]: Began running node model.air_travel.airports
[0m12:57:21.021432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_reviews, now model.air_travel.airports)
[0m12:57:21.021607 [debug] [Thread-1 (]: Began compiling node model.air_travel.airports
[0m12:57:21.022879 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airports"
[0m12:57:21.023298 [debug] [Thread-1 (]: Began executing node model.air_travel.airports
[0m12:57:21.023457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.024311 [debug] [Thread-1 (]: Finished running node model.air_travel.airports
[0m12:57:21.024489 [debug] [Thread-1 (]: Began running node model.air_travel.countries
[0m12:57:21.024671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airports, now model.air_travel.countries)
[0m12:57:21.024871 [debug] [Thread-1 (]: Began compiling node model.air_travel.countries
[0m12:57:21.026340 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.countries"
[0m12:57:21.026605 [debug] [Thread-1 (]: Began executing node model.air_travel.countries
[0m12:57:21.026761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.027570 [debug] [Thread-1 (]: Finished running node model.air_travel.countries
[0m12:57:21.027733 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m12:57:21.027927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.countries, now model.air_travel.flight_delays)
[0m12:57:21.028097 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m12:57:21.029302 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m12:57:21.029694 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m12:57:21.029836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.030590 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m12:57:21.030742 [debug] [Thread-1 (]: Began running node model.air_travel.flight_routes
[0m12:57:21.030898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_delays, now model.air_travel.flight_routes)
[0m12:57:21.031090 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_routes
[0m12:57:21.032539 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_routes"
[0m12:57:21.032957 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_routes
[0m12:57:21.033109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.033906 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_routes
[0m12:57:21.034070 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_traffic
[0m12:57:21.034238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_routes, now model.air_travel.tsa_traffic)
[0m12:57:21.034410 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_traffic
[0m12:57:21.035436 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_traffic"
[0m12:57:21.035795 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_traffic
[0m12:57:21.035927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.036617 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_traffic
[0m12:57:21.036769 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:57:21.036946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tsa_traffic, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m12:57:21.037083 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:57:21.041140 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:57:21.041391 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:57:21.041535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.042281 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:57:21.042431 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:57:21.042583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc, now test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d)
[0m12:57:21.042723 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:57:21.044423 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m12:57:21.044662 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:57:21.044794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.045488 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:57:21.045631 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:57:21.045773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d, now test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510)
[0m12:57:21.045904 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:57:21.047839 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m12:57:21.048054 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:57:21.048184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.048841 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:57:21.048976 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:57:21.049110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510, now test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587)
[0m12:57:21.049234 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:57:21.050852 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m12:57:21.051062 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:57:21.051191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.051836 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:57:21.051967 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:57:21.052109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587, now test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0)
[0m12:57:21.052243 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:57:21.053888 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m12:57:21.054105 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:57:21.054232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.055168 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:57:21.055302 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:57:21.055441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0, now test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414)
[0m12:57:21.055563 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:57:21.057201 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m12:57:21.057403 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:57:21.057522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.058149 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:57:21.058277 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:57:21.058405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414, now test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823)
[0m12:57:21.058523 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:57:21.060085 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m12:57:21.060278 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:57:21.060397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.061015 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:57:21.061143 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:57:21.061273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823, now test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81)
[0m12:57:21.061670 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:57:21.063224 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m12:57:21.063419 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:57:21.063536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.064131 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:57:21.064255 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:57:21.064374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81, now test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee)
[0m12:57:21.064497 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:57:21.065998 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m12:57:21.066199 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:57:21.066314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.066912 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:57:21.067317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:21.067420 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee' was properly closed.
[0m12:57:21.068300 [debug] [MainThread]: Command end result
[0m12:57:21.101024 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:57:21.101718 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:57:21.104014 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:57:21.104577 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:57:21.104677 [info ] [MainThread]: Building catalog
[0m12:57:21.106764 [debug] [ThreadPool]: Acquiring new bigquery connection 'cs378-fa2025.information_schema'
[0m12:57:21.113951 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_stg`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('flight_routes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airport_reviews')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('aircrafts')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airlines')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airports')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('tsa_traffic')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('flight_delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airport_maps')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('countries')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:57:21.114327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:21.551681 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6c498a60-7bb5-41f3-b2c8-32918d0ca798&page=queryresults
[0m12:57:23.021211 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`air_travel_raw`.__TABLES__ tables
    left join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airlines')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('tsa_traffic')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airport_reviews')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airport_maps')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('flight_routes')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airports')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('flight_delays')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('aircrafts')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('countries')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:57:23.021964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:23.497651 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f1c4c9c9-5c4a-4b11-b817-5ac13a99d3df&page=queryresults
[0m12:57:24.886192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:24.893019 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/scohen/UTCS/378/dbt/air_travel/target/catalog.json
[0m12:57:24.902612 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:57:24.903245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:57:24.903357 [info ] [MainThread]: Catalog written to /Users/scohen/UTCS/378/dbt/air_travel/target/catalog.json
[0m12:57:24.905162 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.244653, "process_in_blocks": "0", "process_kernel_time": 0.260378, "process_mem_max_rss": "395476992", "process_out_blocks": "0", "process_user_time": 1.666655}
[0m12:57:24.905361 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:57:24.905325 after 5.24 seconds
[0m12:57:24.905478 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:57:24.905569 [debug] [MainThread]: Connection 'cs378-fa2025.information_schema' was properly closed.
[0m12:57:24.905679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a78ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff9a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff9a2b0>]}
[0m12:57:24.905803 [debug] [MainThread]: Flushing usage events
[0m12:57:25.094439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:47.331217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108873c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088739d0>]}


============================== 12:57:47.332836 | d66967a9-1d30-4331-b41c-d7d7eda820f1 ==============================
[0m12:57:47.332836 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:57:47.333078 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --port 8181', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'empty': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'False', 'warn_error': 'None'}
[0m12:57:48.148003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd66967a9-1d30-4331-b41c-d7d7eda820f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ccc30>]}
[0m12:57:48.168027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd66967a9-1d30-4331-b41c-d7d7eda820f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12deba360>]}
[0m13:01:06.967158 [error] [MainThread]: Encountered an error:

[0m13:01:06.975571 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m13:01:06.980605 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 199.67331, "process_in_blocks": "0", "process_kernel_time": 0.195354, "process_mem_max_rss": "371113984", "process_out_blocks": "0", "process_user_time": 1.209162}
[0m13:01:06.981595 [debug] [MainThread]: Command `dbt docs serve` failed at 13:01:06.981480 after 199.67 seconds
[0m13:01:06.981995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea8a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea8a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea66a80>]}
[0m13:01:06.982299 [debug] [MainThread]: Flushing usage events
[0m13:01:07.208067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:15.803968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105573750>]}


============================== 13:01:15.805597 | cc411617-36b4-49e0-ac3e-c1e82937ea56 ==============================
[0m13:01:15.805597 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:01:15.805841 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'empty': 'False', 'target_path': 'None', 'fail_fast': 'False'}
[0m13:01:16.622930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f0c30>]}
[0m13:01:16.641783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b3c2360>]}
[0m13:01:16.641986 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:01:16.717234 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:01:16.757004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:16.757142 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:16.759145 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m13:01:16.773226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c126450>]}
[0m13:01:16.805161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:01:16.805963 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:01:16.811470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b3ce8a0>]}
[0m13:01:16.811635 [info ] [MainThread]: Found 9 models, 9 data tests, 9 sources, 514 macros
[0m13:01:16.811752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b582350>]}
[0m13:01:16.812525 [info ] [MainThread]: 
[0m13:01:16.812657 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:16.812754 [info ] [MainThread]: 
[0m13:01:16.812942 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:01:16.814405 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:01:16.814569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:17.186070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:01:17.186601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:17.476088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c367860>]}
[0m13:01:17.476673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:17.479979 [debug] [Thread-1 (]: Began running node model.air_travel.aircrafts
[0m13:01:17.480483 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_air_travel_stg.aircrafts ...................... [RUN]
[0m13:01:17.480865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.aircrafts)
[0m13:01:17.481124 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircrafts
[0m13:01:17.488567 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircrafts"
[0m13:01:17.489220 [debug] [Thread-1 (]: Began executing node model.air_travel.aircrafts
[0m13:01:17.498016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:17.764284 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.aircrafts"
[0m13:01:17.764820 [debug] [Thread-1 (]: On model.air_travel.aircrafts: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.aircrafts"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
      
    
    

    
    OPTIONS()
    as (
      with stg_aircrafts as (
    select aircraft_name as name,
        case iata_code when '\\N' then null else iata_code end as iata,
        case icao_code when '\\N' then null else icao_code end as icao,
        _data_source,
        _load_time
  from `cs378-fa2025`.`air_travel_raw`.`aircrafts`
)

select * from stg_aircrafts
    );
  
[0m13:01:18.304441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4c81db04-d2de-4e63-99bb-1427a2adc9ea&page=queryresults
[0m13:01:20.254746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3e9a90>]}
[0m13:01:20.255428 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_air_travel_stg.aircrafts ................. [[32mCREATE TABLE (246.0 rows, 12.5 KiB processed)[0m in 2.77s]
[0m13:01:20.255901 [debug] [Thread-1 (]: Finished running node model.air_travel.aircrafts
[0m13:01:20.256164 [debug] [Thread-1 (]: Began running node model.air_travel.airlines
[0m13:01:20.256551 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_air_travel_stg.airlines ....................... [RUN]
[0m13:01:20.256920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircrafts, now model.air_travel.airlines)
[0m13:01:20.257159 [debug] [Thread-1 (]: Began compiling node model.air_travel.airlines
[0m13:01:20.259065 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airlines"
[0m13:01:20.259628 [debug] [Thread-1 (]: Began executing node model.air_travel.airlines
[0m13:01:20.261194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:20.490110 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airlines"
[0m13:01:20.491154 [debug] [Thread-1 (]: On model.air_travel.airlines: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airlines"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
      
    
    

    
    OPTIONS()
    as (
      with stg_airlines as (
  select airline_id as id,
    name,
    case alias
        when '\\N' then null
        else alias
        end as alias,
    case iata
        when '' then null
        else iata
        end as iata,
    case icao
        when '' then null
        else icao
        end as icao,
    case callsign
        when '\\N' then null
        else callsign
        end as callsign,
    case country
        when '\\N' then null
        else country end as country,
    active, _data_source, _load_time
  from `cs378-fa2025`.`air_travel_raw`.`airlines`
)

select * from stg_airlines
    );
  
[0m13:01:20.864062 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e316a7a7-a462-4a15-8f82-2073d50a6832&page=queryresults
[0m13:01:22.940230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c415180>]}
[0m13:01:22.941120 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_air_travel_stg.airlines .................. [[32mCREATE TABLE (6.2k rows, 489.7 KiB processed)[0m in 2.68s]
[0m13:01:22.941715 [debug] [Thread-1 (]: Finished running node model.air_travel.airlines
[0m13:01:22.942089 [debug] [Thread-1 (]: Began running node model.air_travel.airport_maps
[0m13:01:22.942645 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_air_travel_stg.airport_maps ................... [RUN]
[0m13:01:22.943175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airlines, now model.air_travel.airport_maps)
[0m13:01:22.943548 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_maps
[0m13:01:22.946451 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_maps"
[0m13:01:22.947197 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_maps
[0m13:01:22.948905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:23.234002 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airport_maps"
[0m13:01:23.234909 [debug] [Thread-1 (]: On model.air_travel.airport_maps: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airport_maps"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
      
    
    

    
    OPTIONS()
    as (
      with stg_airport_maps as (
  select airport, terminal, business,
      case category
        when 'Airline Services' then 'Airline Service'
        when 'Airline Services' then 'Airline Service'
        when 'Cafe' then 'Coffee Shop'
        when 'Financial Services' then 'Financial Service'
        when 'Retail/Dining' then 'Retail / Dining'
        when 'Things To Do' then 'Things to Do'
        when 'Transportation' then 'Transportation Service'
        when 'Vending' then 'Vending Machine'
        when 'Service' then 'Services'
        else category end as category,
      location, dining, menu_items, _data_source, _load_time
    from `cs378-fa2025`.`air_travel_raw`.`airport_maps`
)

select * from stg_airport_maps
    );
  
[0m13:01:23.628688 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9cce0bde-6b19-4272-9e11-e7b961b60fbf&page=queryresults
[0m13:01:25.766394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dda8ff0>]}
[0m13:01:25.767327 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_air_travel_stg.airport_maps .............. [[32mCREATE TABLE (1.5k rows, 163.3 KiB processed)[0m in 2.82s]
[0m13:01:25.767932 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_maps
[0m13:01:25.768307 [debug] [Thread-1 (]: Began running node model.air_travel.airport_reviews
[0m13:01:25.768849 [info ] [Thread-1 (]: 4 of 9 START sql table model dbt_air_travel_stg.airport_reviews ................ [RUN]
[0m13:01:25.769386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_maps, now model.air_travel.airport_reviews)
[0m13:01:25.769749 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_reviews
[0m13:01:25.772357 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_reviews"
[0m13:01:25.773066 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_reviews
[0m13:01:25.774642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:26.026327 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airport_reviews"
[0m13:01:26.027956 [debug] [Thread-1 (]: On model.air_travel.airport_reviews: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airport_reviews"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`
      
    
    

    
    OPTIONS()
    as (
      with stg_airport_reviews as (
	select id,
	    safe_cast(threadRef as INTEGER) as review_thread,
	    airportRef as airport_id,
	    airportIdent as airport_code,
	    safe_cast(split(date, ' ')[0] as DATE) as review_date,
	    memberNickname as review_author,
	    subject as review_subject,
	    body as review_details,
	    broad_category,
        sub_category,
        sentiment,
        language,
	    _data_source,
	    _load_time
	from `cs378-fa2025`.`air_travel_raw`.`airport_reviews`
)

select * from stg_airport_reviews
    );
  
[0m13:01:26.393573 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0cef8d99-f668-44d2-ace3-0b1b1247af94&page=queryresults
[0m13:01:28.758790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039a0b50>]}
[0m13:01:28.759788 [info ] [Thread-1 (]: 4 of 9 OK created sql table model dbt_air_travel_stg.airport_reviews ........... [[32mCREATE TABLE (14.8k rows, 5.4 MiB processed)[0m in 2.99s]
[0m13:01:28.760493 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_reviews
[0m13:01:28.760959 [debug] [Thread-1 (]: Began running node model.air_travel.airports
[0m13:01:28.761524 [info ] [Thread-1 (]: 5 of 9 START sql table model dbt_air_travel_stg.airports ....................... [RUN]
[0m13:01:28.762101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_reviews, now model.air_travel.airports)
[0m13:01:28.762461 [debug] [Thread-1 (]: Began compiling node model.air_travel.airports
[0m13:01:28.765242 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airports"
[0m13:01:28.766135 [debug] [Thread-1 (]: Began executing node model.air_travel.airports
[0m13:01:28.767913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:29.066771 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airports"
[0m13:01:29.067721 [debug] [Thread-1 (]: On model.air_travel.airports: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airports"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
      
    
    

    
    OPTIONS()
    as (
      with stg_airports as (
	select safe_cast(airport_id as INTEGER) as id,
	    airport_name as name,
	    airport_city as city,
	    airport_country as country,
	    case iata
		    when '\\N' then null
		    else iata
		    end as iata,
	    case icao
		    when '\\N' then null
		    else icao
		    end as icao,
	    latitude,
	    longitude,
	    altitude,
	    safe_cast(timezone as INTEGER) as timezone_delta,
        daylight_savings_time,
        case tz_database_timezone
		    when '\\N' then null
		    else tz_database_timezone
		    end as timezone_name,
	    case type
		    when '\\N' then null
		    else type
		    end as type,
	    case source
		    when '\\N' then null
		    else source
		    end as source,
	    _data_source,
	    _load_time
	from `cs378-fa2025`.`air_travel_raw`.`airports`    
)

select * from stg_airports
    );
  
[0m13:01:29.467500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1f47728a-4c34-4866-83da-0819ad9c2b5d&page=queryresults
[0m13:01:31.217511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ded7690>]}
[0m13:01:31.218311 [info ] [Thread-1 (]: 5 of 9 OK created sql table model dbt_air_travel_stg.airports .................. [[32mCREATE TABLE (12.7k rows, 1.7 MiB processed)[0m in 2.46s]
[0m13:01:31.218813 [debug] [Thread-1 (]: Finished running node model.air_travel.airports
[0m13:01:31.219128 [debug] [Thread-1 (]: Began running node model.air_travel.countries
[0m13:01:31.219590 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_air_travel_stg.countries ...................... [RUN]
[0m13:01:31.220033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airports, now model.air_travel.countries)
[0m13:01:31.220335 [debug] [Thread-1 (]: Began compiling node model.air_travel.countries
[0m13:01:31.222697 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.countries"
[0m13:01:31.223390 [debug] [Thread-1 (]: Began executing node model.air_travel.countries
[0m13:01:31.224749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:31.482973 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.countries"
[0m13:01:31.485029 [debug] [Thread-1 (]: On model.air_travel.countries: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.countries"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
      
    
    

    
    OPTIONS()
    as (
      with stg_countries as (
    select country_name as name,
    case iso_code
      when '\\N' then null
      else iso_code
      end as iso_code,
    dafif_code,
    _data_source,
    _load_time
    from `cs378-fa2025`.`air_travel_raw`.`countries`
)

select * from stg_countries
    );
  
[0m13:01:32.110135 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9815022b-0306-48a3-8d7d-0e65d93fdb08&page=queryresults
[0m13:01:34.187871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dda1f70>]}
[0m13:01:34.188702 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_air_travel_stg.countries ................. [[32mCREATE TABLE (261.0 rows, 10.5 KiB processed)[0m in 2.97s]
[0m13:01:34.189221 [debug] [Thread-1 (]: Finished running node model.air_travel.countries
[0m13:01:34.189544 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m13:01:34.190009 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_air_travel_stg.flight_delays .................. [RUN]
[0m13:01:34.190448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.countries, now model.air_travel.flight_delays)
[0m13:01:34.190738 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m13:01:34.193009 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m13:01:34.193683 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m13:01:34.194994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:34.424043 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_delays"
[0m13:01:34.426408 [debug] [Thread-1 (]: On model.air_travel.flight_delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_delays as (
    select event_month, carrier, carrier_name, airport_code,
        split(city_state, ',')[0] as airport_city, 
        split(city_state, ',')[1] as airport_state,
        airport_name, 
        * except (event_month, carrier, carrier_name, airport_code, airport_name, city_state)
    from
        (select date(year, month, 01) as event_month, 
            carrier, carrier_name, airport as airport_code,
            split(airport_name, ':')[0] as city_state, 
            split(airport_name, ':')[1] as airport_name,
            safe_cast(arr_flights as INTEGER) as arr_total, 
            safe_cast(arr_cancelled as INTEGER) as arr_cancelled,
            safe_cast(arr_diverted as INTEGER) as arr_diverted, 
            safe_cast(arr_delay as INTEGER) as arr_delay_min,
            safe_cast(weather_delay as INTEGER) as weather_delay_min, 
            safe_cast(nas_delay as INTEGER) as nas_delay_min,
            safe_cast(late_aircraft_delay as INTEGER) as late_aircraft_delay_min, 
            _data_source, _load_time
          from `cs378-fa2025`.`air_travel_raw`.`flight_delays`)
)

select * from stg_flight_delays
    );
  
[0m13:01:34.734524 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c2881090-737d-4cce-b14b-f382eff2cad5&page=queryresults
[0m13:01:39.229643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dda3d10>]}
[0m13:01:39.230501 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_air_travel_stg.flight_delays ............. [[32mCREATE TABLE (381.2k rows, 64.1 MiB processed)[0m in 5.04s]
[0m13:01:39.230998 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m13:01:39.231322 [debug] [Thread-1 (]: Began running node model.air_travel.flight_routes
[0m13:01:39.231788 [info ] [Thread-1 (]: 8 of 9 START sql table model dbt_air_travel_stg.flight_routes .................. [RUN]
[0m13:01:39.232247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_delays, now model.air_travel.flight_routes)
[0m13:01:39.232548 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_routes
[0m13:01:39.234854 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_routes"
[0m13:01:39.235545 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_routes
[0m13:01:39.236849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:39.484880 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_routes"
[0m13:01:39.486874 [debug] [Thread-1 (]: On model.air_travel.flight_routes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_routes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_routes as (
  select airline_code,
    safe_cast(airline_id as INTEGER) as airline_id,
    source_airport,
    case source_airport_id
      when '\\N' then null
      else safe_cast(source_airport_id as INTEGER)
      end as source_airport_id,
    dest_airport,
    case dest_airport_id
      when '\\N' then null
      else safe_cast(dest_airport_id as INTEGER)
      end as dest_airport_id,
    codeshare,
    stops,
    equipment,
    _data_source,
    _load_time
  from `cs378-fa2025`.`air_travel_raw`.`flight_routes`
)

select * from stg_flight_routes
    );
  
[0m13:01:39.810517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c5c842e8-3101-4877-8a86-89c4cd1d57ab&page=queryresults
[0m13:01:42.471278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3b4950>]}
[0m13:01:42.472303 [info ] [Thread-1 (]: 8 of 9 OK created sql table model dbt_air_travel_stg.flight_routes ............. [[32mCREATE TABLE (67.7k rows, 4.4 MiB processed)[0m in 3.24s]
[0m13:01:42.472936 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_routes
[0m13:01:42.473277 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_traffic
[0m13:01:42.473758 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_air_travel_stg.tsa_traffic .................... [RUN]
[0m13:01:42.474237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_routes, now model.air_travel.tsa_traffic)
[0m13:01:42.474547 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_traffic
[0m13:01:42.477401 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_traffic"
[0m13:01:42.478247 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_traffic
[0m13:01:42.479894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:42.727092 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tsa_traffic"
[0m13:01:42.729046 [debug] [Thread-1 (]: On model.air_travel.tsa_traffic: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tsa_traffic"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`
      
    
    

    
    OPTIONS()
    as (
      with stg_tsa_traffic as (
  select safe_cast(event_date as DATE format 'MM/DD/YYYY') as event_date,
    safe_cast(event_hour as INTEGER) as event_hour,
    airport_code,
    airport_name,
    airport_city,
    airport_state,
    security_checkpoint,
    safe_cast(total_traffic as INTEGER) as total_traffic,
    _data_source,
    _load_time
  from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic`
)

select * from stg_tsa_traffic
    );
  
[0m13:01:43.173994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3b507755-247b-4698-bfce-b3f01465add1&page=queryresults
[0m13:01:45.223643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc411617-36b4-49e0-ac3e-c1e82937ea56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3b60f0>]}
[0m13:01:45.224537 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_air_travel_stg.tsa_traffic ............... [[32mCREATE TABLE (23.4k rows, 2.2 MiB processed)[0m in 2.75s]
[0m13:01:45.225106 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_traffic
[0m13:01:45.226449 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:45.228096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:45.228351 [debug] [MainThread]: Connection 'model.air_travel.tsa_traffic' was properly closed.
[0m13:01:45.228668 [info ] [MainThread]: 
[0m13:01:45.228918 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 28.42 seconds (28.42s).
[0m13:01:45.230294 [debug] [MainThread]: Command end result
[0m13:01:45.248193 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:01:45.249373 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:01:45.252867 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:01:45.253030 [info ] [MainThread]: 
[0m13:01:45.253209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:45.253349 [info ] [MainThread]: 
[0m13:01:45.253507 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m13:01:45.255868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.475676, "process_in_blocks": "0", "process_kernel_time": 0.307785, "process_mem_max_rss": "390660096", "process_out_blocks": "0", "process_user_time": 2.213414}
[0m13:01:45.256095 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:45.256052 after 29.48 seconds
[0m13:01:45.256268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c1323f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3b7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3b7ad0>]}
[0m13:01:45.256443 [debug] [MainThread]: Flushing usage events
[0m13:01:45.492366 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:11.866120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039dc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104827750>]}


============================== 14:30:11.868233 | 64f1c643-e87d-419e-9540-b1f9e7475893 ==============================
[0m14:30:11.868233 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m14:30:11.868505 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': '/Users/scohen/.dbt', 'target_path': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'static_parser': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'printer_width': '80', 'fail_fast': 'False', 'version_check': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --select aircraft', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m14:30:12.875361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f1c643-e87d-419e-9540-b1f9e7475893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b80c30>]}
[0m14:30:12.896209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64f1c643-e87d-419e-9540-b1f9e7475893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7be360>]}
[0m14:30:12.896578 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:30:12.975909 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m14:30:13.024017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:13.024206 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:13.026333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m14:30:13.040721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f1c643-e87d-419e-9540-b1f9e7475893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac2a450>]}
[0m14:30:13.074535 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:30:13.075626 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:30:13.084180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f1c643-e87d-419e-9540-b1f9e7475893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7ce8a0>]}
[0m14:30:13.084432 [info ] [MainThread]: Found 9 models, 9 data tests, 9 sources, 514 macros
[0m14:30:13.084563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f1c643-e87d-419e-9540-b1f9e7475893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a886350>]}
[0m14:30:13.084853 [warn ] [MainThread]: The selection criterion 'aircraft' does not match any enabled nodes
[0m14:30:13.085343 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:30:13.086144 [debug] [MainThread]: Command end result
[0m14:30:13.095683 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:30:13.096388 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:30:13.097721 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m14:30:13.099603 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2626296, "process_in_blocks": "0", "process_kernel_time": 0.256074, "process_mem_max_rss": "377110528", "process_out_blocks": "0", "process_user_time": 1.424771}
[0m14:30:13.099888 [debug] [MainThread]: Command `dbt run` succeeded at 14:30:13.099850 after 1.26 seconds
[0m14:30:13.100038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae77e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aeb8110>]}
[0m14:30:13.100168 [debug] [MainThread]: Flushing usage events
[0m14:30:13.342351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:26.026549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113773750>]}


============================== 14:30:26.028303 | aa66d72f-2408-41fa-9497-2c920808d4cd ==============================
[0m14:30:26.028303 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m14:30:26.028547 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'target_path': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --select aircrafts', 'empty': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True'}
[0m14:30:26.908165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa66d72f-2408-41fa-9497-2c920808d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126ccc30>]}
[0m14:30:26.928417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa66d72f-2408-41fa-9497-2c920808d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1596be360>]}
[0m14:30:26.928650 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:30:27.007290 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m14:30:27.050049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:27.050246 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:27.052617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m14:30:27.067274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa66d72f-2408-41fa-9497-2c920808d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159c02450>]}
[0m14:30:27.102015 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:30:27.102899 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:30:27.108865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa66d72f-2408-41fa-9497-2c920808d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1596ce8a0>]}
[0m14:30:27.109058 [info ] [MainThread]: Found 9 models, 9 data tests, 9 sources, 514 macros
[0m14:30:27.109195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa66d72f-2408-41fa-9497-2c920808d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159886350>]}
[0m14:30:27.109782 [info ] [MainThread]: 
[0m14:30:27.109914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:30:27.110062 [info ] [MainThread]: 
[0m14:30:27.110294 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:30:27.110623 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m14:30:27.110755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:27.493370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m14:30:27.493866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:27.790371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa66d72f-2408-41fa-9497-2c920808d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159e67860>]}
[0m14:30:27.790981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:27.795231 [debug] [Thread-1 (]: Began running node model.air_travel.aircrafts
[0m14:30:27.795734 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.aircrafts ...................... [RUN]
[0m14:30:27.796102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.aircrafts)
[0m14:30:27.796380 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircrafts
[0m14:30:27.804076 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircrafts"
[0m14:30:27.804664 [debug] [Thread-1 (]: Began executing node model.air_travel.aircrafts
[0m14:30:27.814210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:28.110755 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.aircrafts"
[0m14:30:28.111575 [debug] [Thread-1 (]: On model.air_travel.aircrafts: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.aircrafts"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
      
    
    

    
    OPTIONS()
    as (
      with stg_aircrafts as (
    select aircraft_name as name,
        case iata_code when '\\N' then null else iata_code end as iata,
        case icao_code when '\\N' then null else icao_code end as icao,
        _data_source,
        _load_time
  from `cs378-fa2025`.`air_travel_raw`.`aircrafts`
)

select * from stg_aircrafts
    );
  
[0m14:30:28.577641 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:18df1341-c8f9-4a19-81f8-0f7dd74610bf&page=queryresults
[0m14:30:30.436588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa66d72f-2408-41fa-9497-2c920808d4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159edd910>]}
[0m14:30:30.437177 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.aircrafts ................. [[32mCREATE TABLE (246.0 rows, 12.5 KiB processed)[0m in 2.64s]
[0m14:30:30.437612 [debug] [Thread-1 (]: Finished running node model.air_travel.aircrafts
[0m14:30:30.438521 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:30.439812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:30.440052 [debug] [MainThread]: Connection 'model.air_travel.aircrafts' was properly closed.
[0m14:30:30.440250 [info ] [MainThread]: 
[0m14:30:30.440452 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m14:30:30.440870 [debug] [MainThread]: Command end result
[0m14:30:30.457250 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:30:30.458276 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:30:30.461222 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m14:30:30.461372 [info ] [MainThread]: 
[0m14:30:30.461547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:30.461679 [info ] [MainThread]: 
[0m14:30:30.461825 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:30:30.464037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.464036, "process_in_blocks": "0", "process_kernel_time": 0.26488, "process_mem_max_rss": "388251648", "process_out_blocks": "0", "process_user_time": 1.643768}
[0m14:30:30.464257 [debug] [MainThread]: Command `dbt run` succeeded at 14:30:30.464214 after 4.46 seconds
[0m14:30:30.464421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159f0c9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ec25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ec3e30>]}
[0m14:30:30.464578 [debug] [MainThread]: Flushing usage events
[0m14:30:30.665813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:51.147751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c039d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c03750>]}


============================== 14:31:51.149460 | bb401598-b6df-4bd2-9b53-237f35c4c45b ==============================
[0m14:31:51.149460 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m14:31:51.149699 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'invocation_command': 'dbt run', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'target_path': 'None', 'empty': 'False', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'log_format': 'default', 'introspect': 'True'}
[0m14:31:52.070446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5cc30>]}
[0m14:31:52.091994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b1c2360>]}
[0m14:31:52.092408 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:31:52.179290 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m14:31:52.225866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:31:52.226134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:31:52.228688 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.int
- models.air_travel.mrt
[0m14:31:52.244028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cb2e450>]}
[0m14:31:52.282225 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:31:52.283188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:31:52.290113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b1ce8a0>]}
[0m14:31:52.290337 [info ] [MainThread]: Found 9 models, 9 data tests, 9 sources, 514 macros
[0m14:31:52.290564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b386350>]}
[0m14:31:52.291606 [info ] [MainThread]: 
[0m14:31:52.291757 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:31:52.291862 [info ] [MainThread]: 
[0m14:31:52.292069 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:31:52.293946 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m14:31:52.294112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:52.646745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m14:31:52.647246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:52.972818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cd47860>]}
[0m14:31:52.973414 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:52.976699 [debug] [Thread-1 (]: Began running node model.air_travel.aircrafts
[0m14:31:52.977223 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_air_travel_stg.aircrafts ...................... [RUN]
[0m14:31:52.977612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.aircrafts)
[0m14:31:52.977906 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircrafts
[0m14:31:52.985788 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircrafts"
[0m14:31:52.986679 [debug] [Thread-1 (]: Began executing node model.air_travel.aircrafts
[0m14:31:52.996335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:53.314622 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.aircrafts"
[0m14:31:53.315487 [debug] [Thread-1 (]: On model.air_travel.aircrafts: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.aircrafts"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
      
    
    

    
    OPTIONS()
    as (
      with stg_aircrafts as (
    select aircraft_name as name,
        case iata_code when '\\N' then null else iata_code end as iata,
        case icao_code when '\\N' then null else icao_code end as icao,
        _data_source,
        _load_time
  from `cs378-fa2025`.`air_travel_raw`.`aircrafts`
)

select * from stg_aircrafts
    );
  
[0m14:31:53.765523 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:aa5a7d43-e078-4f23-9621-2b9a00665f33&page=queryresults
[0m14:31:55.653364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cde9a90>]}
[0m14:31:55.653979 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_air_travel_stg.aircrafts ................. [[32mCREATE TABLE (246.0 rows, 12.5 KiB processed)[0m in 2.67s]
[0m14:31:55.654440 [debug] [Thread-1 (]: Finished running node model.air_travel.aircrafts
[0m14:31:55.654709 [debug] [Thread-1 (]: Began running node model.air_travel.airlines
[0m14:31:55.655116 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_air_travel_stg.airlines ....................... [RUN]
[0m14:31:55.655476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircrafts, now model.air_travel.airlines)
[0m14:31:55.655734 [debug] [Thread-1 (]: Began compiling node model.air_travel.airlines
[0m14:31:55.657655 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airlines"
[0m14:31:55.658621 [debug] [Thread-1 (]: Began executing node model.air_travel.airlines
[0m14:31:55.660302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:55.967775 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airlines"
[0m14:31:55.969592 [debug] [Thread-1 (]: On model.air_travel.airlines: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airlines"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
      
    
    

    
    OPTIONS()
    as (
      with stg_airlines as (
  select airline_id as id,
    name,
    case alias
        when '\\N' then null
        else alias
        end as alias,
    case iata
        when '' then null
        else iata
        end as iata,
    case icao
        when '' then null
        else icao
        end as icao,
    case callsign
        when '\\N' then null
        else callsign
        end as callsign,
    case country
        when '\\N' then null
        else country end as country,
    active, _data_source, _load_time
  from `cs378-fa2025`.`air_travel_raw`.`airlines`
)

select * from stg_airlines
    );
  
[0m14:31:56.347480 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d98b3d7a-96d2-4b52-a07c-245688ac7c5c&page=queryresults
[0m14:31:58.443759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ce14cb0>]}
[0m14:31:58.444966 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_air_travel_stg.airlines .................. [[32mCREATE TABLE (6.2k rows, 489.7 KiB processed)[0m in 2.79s]
[0m14:31:58.445607 [debug] [Thread-1 (]: Finished running node model.air_travel.airlines
[0m14:31:58.446003 [debug] [Thread-1 (]: Began running node model.air_travel.airport_maps
[0m14:31:58.446558 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_air_travel_stg.airport_maps ................... [RUN]
[0m14:31:58.447106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airlines, now model.air_travel.airport_maps)
[0m14:31:58.447476 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_maps
[0m14:31:58.449998 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_maps"
[0m14:31:58.450766 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_maps
[0m14:31:58.452424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:58.738785 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airport_maps"
[0m14:31:58.739758 [debug] [Thread-1 (]: On model.air_travel.airport_maps: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airport_maps"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
      
    
    

    
    OPTIONS()
    as (
      with stg_airport_maps as (
  select airport, terminal, business,
      case category
        when 'Airline Services' then 'Airline Service'
        when 'Airline Services' then 'Airline Service'
        when 'Cafe' then 'Coffee Shop'
        when 'Financial Services' then 'Financial Service'
        when 'Retail/Dining' then 'Retail / Dining'
        when 'Things To Do' then 'Things to Do'
        when 'Transportation' then 'Transportation Service'
        when 'Vending' then 'Vending Machine'
        when 'Service' then 'Services'
        else category end as category,
      location, dining, menu_items, _data_source, _load_time
    from `cs378-fa2025`.`air_travel_raw`.`airport_maps`
)

select * from stg_airport_maps
    );
  
[0m14:31:59.069847 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d690a13b-c097-4688-a0ea-9ab6cce49f4e&page=queryresults
[0m14:32:01.152245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dea8f50>]}
[0m14:32:01.153274 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_air_travel_stg.airport_maps .............. [[32mCREATE TABLE (1.5k rows, 163.3 KiB processed)[0m in 2.70s]
[0m14:32:01.153891 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_maps
[0m14:32:01.154249 [debug] [Thread-1 (]: Began running node model.air_travel.airport_reviews
[0m14:32:01.154740 [info ] [Thread-1 (]: 4 of 9 START sql table model dbt_air_travel_stg.airport_reviews ................ [RUN]
[0m14:32:01.155281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_maps, now model.air_travel.airport_reviews)
[0m14:32:01.155600 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_reviews
[0m14:32:01.158528 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_reviews"
[0m14:32:01.160274 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_reviews
[0m14:32:01.162239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:01.430819 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airport_reviews"
[0m14:32:01.432726 [debug] [Thread-1 (]: On model.air_travel.airport_reviews: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airport_reviews"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`
      
    
    

    
    OPTIONS()
    as (
      with stg_airport_reviews as (
	select id,
	    safe_cast(threadRef as INTEGER) as review_thread,
	    airportRef as airport_id,
	    airportIdent as airport_code,
	    safe_cast(split(date, ' ')[0] as DATE) as review_date,
	    memberNickname as review_author,
	    subject as review_subject,
	    body as review_details,
	    broad_category,
        sub_category,
        sentiment,
        language,
	    _data_source,
	    _load_time
	from `cs378-fa2025`.`air_travel_raw`.`airport_reviews`
)

select * from stg_airport_reviews
    );
  
[0m14:32:01.874443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2447c591-51a9-4a94-ba26-b06778d14ebf&page=queryresults
[0m14:32:04.340640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b45e6d0>]}
[0m14:32:04.341879 [info ] [Thread-1 (]: 4 of 9 OK created sql table model dbt_air_travel_stg.airport_reviews ........... [[32mCREATE TABLE (14.8k rows, 5.4 MiB processed)[0m in 3.19s]
[0m14:32:04.342683 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_reviews
[0m14:32:04.343087 [debug] [Thread-1 (]: Began running node model.air_travel.airports
[0m14:32:04.343646 [info ] [Thread-1 (]: 5 of 9 START sql table model dbt_air_travel_stg.airports ....................... [RUN]
[0m14:32:04.344189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_reviews, now model.air_travel.airports)
[0m14:32:04.344559 [debug] [Thread-1 (]: Began compiling node model.air_travel.airports
[0m14:32:04.346994 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airports"
[0m14:32:04.347916 [debug] [Thread-1 (]: Began executing node model.air_travel.airports
[0m14:32:04.349632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:04.630448 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airports"
[0m14:32:04.631528 [debug] [Thread-1 (]: On model.air_travel.airports: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airports"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
      
    
    

    
    OPTIONS()
    as (
      with stg_airports as (
	select safe_cast(airport_id as INTEGER) as id,
	    airport_name as name,
	    airport_city as city,
	    airport_country as country,
	    case iata
		    when '\\N' then null
		    else iata
		    end as iata,
	    case icao
		    when '\\N' then null
		    else icao
		    end as icao,
	    latitude,
	    longitude,
	    altitude,
	    safe_cast(timezone as INTEGER) as timezone_delta,
        daylight_savings_time,
        case tz_database_timezone
		    when '\\N' then null
		    else tz_database_timezone
		    end as timezone_name,
	    case type
		    when '\\N' then null
		    else type
		    end as type,
	    case source
		    when '\\N' then null
		    else source
		    end as source,
	    _data_source,
	    _load_time
	from `cs378-fa2025`.`air_travel_raw`.`airports`    
)

select * from stg_airports
    );
  
[0m14:32:04.991255 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e86d41a1-7d34-427e-a3ae-c52aad3a8ccc&page=queryresults
[0m14:32:07.079505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dfd7690>]}
[0m14:32:07.079884 [info ] [Thread-1 (]: 5 of 9 OK created sql table model dbt_air_travel_stg.airports .................. [[32mCREATE TABLE (12.7k rows, 1.7 MiB processed)[0m in 2.74s]
[0m14:32:07.080120 [debug] [Thread-1 (]: Finished running node model.air_travel.airports
[0m14:32:07.080274 [debug] [Thread-1 (]: Began running node model.air_travel.countries
[0m14:32:07.080520 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_air_travel_stg.countries ...................... [RUN]
[0m14:32:07.080796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airports, now model.air_travel.countries)
[0m14:32:07.080946 [debug] [Thread-1 (]: Began compiling node model.air_travel.countries
[0m14:32:07.082057 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.countries"
[0m14:32:07.082411 [debug] [Thread-1 (]: Began executing node model.air_travel.countries
[0m14:32:07.083061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:07.322151 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.countries"
[0m14:32:07.323959 [debug] [Thread-1 (]: On model.air_travel.countries: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.countries"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
      
    
    

    
    OPTIONS()
    as (
      with stg_countries as (
    select country_name as name,
    case iso_code
      when '\\N' then null
      else iso_code
      end as iso_code,
    dafif_code,
    _data_source,
    _load_time
    from `cs378-fa2025`.`air_travel_raw`.`countries`
)

select * from stg_countries
    );
  
[0m14:32:07.675862 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1b66056a-f43c-465c-8eec-a2e1163c6cfe&page=queryresults
[0m14:32:09.730685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14de9ea50>]}
[0m14:32:09.731791 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_air_travel_stg.countries ................. [[32mCREATE TABLE (261.0 rows, 10.5 KiB processed)[0m in 2.65s]
[0m14:32:09.732432 [debug] [Thread-1 (]: Finished running node model.air_travel.countries
[0m14:32:09.732824 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m14:32:09.733377 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_air_travel_stg.flight_delays .................. [RUN]
[0m14:32:09.733941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.countries, now model.air_travel.flight_delays)
[0m14:32:09.734305 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m14:32:09.736776 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m14:32:09.737482 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m14:32:09.739066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:09.991473 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_delays"
[0m14:32:09.993137 [debug] [Thread-1 (]: On model.air_travel.flight_delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_delays as (
    select event_month, carrier, carrier_name, airport_code,
        split(city_state, ',')[0] as airport_city, 
        split(city_state, ',')[1] as airport_state,
        airport_name, 
        * except (event_month, carrier, carrier_name, airport_code, airport_name, city_state)
    from
        (select date(year, month, 01) as event_month, 
            carrier, carrier_name, airport as airport_code,
            split(airport_name, ':')[0] as city_state, 
            split(airport_name, ':')[1] as airport_name,
            safe_cast(arr_flights as INTEGER) as arr_total, 
            safe_cast(arr_cancelled as INTEGER) as arr_cancelled,
            safe_cast(arr_diverted as INTEGER) as arr_diverted, 
            safe_cast(arr_delay as INTEGER) as arr_delay_min,
            safe_cast(weather_delay as INTEGER) as weather_delay_min, 
            safe_cast(nas_delay as INTEGER) as nas_delay_min,
            safe_cast(late_aircraft_delay as INTEGER) as late_aircraft_delay_min, 
            _data_source, _load_time
          from `cs378-fa2025`.`air_travel_raw`.`flight_delays`)
)

select * from stg_flight_delays
    );
  
[0m14:32:10.377874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:39a90b28-d9e0-4dbd-9220-e48b8429bbfe&page=queryresults
[0m14:32:14.862631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14de9fcb0>]}
[0m14:32:14.863622 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_air_travel_stg.flight_delays ............. [[32mCREATE TABLE (381.2k rows, 64.1 MiB processed)[0m in 5.13s]
[0m14:32:14.864234 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m14:32:14.864617 [debug] [Thread-1 (]: Began running node model.air_travel.flight_routes
[0m14:32:14.865159 [info ] [Thread-1 (]: 8 of 9 START sql table model dbt_air_travel_stg.flight_routes .................. [RUN]
[0m14:32:14.865696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_delays, now model.air_travel.flight_routes)
[0m14:32:14.866056 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_routes
[0m14:32:14.868571 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_routes"
[0m14:32:14.869322 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_routes
[0m14:32:14.870980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:15.151537 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_routes"
[0m14:32:15.152819 [debug] [Thread-1 (]: On model.air_travel.flight_routes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_routes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_routes as (
  select airline_code,
    safe_cast(airline_id as INTEGER) as airline_id,
    source_airport,
    case source_airport_id
      when '\\N' then null
      else safe_cast(source_airport_id as INTEGER)
      end as source_airport_id,
    dest_airport,
    case dest_airport_id
      when '\\N' then null
      else safe_cast(dest_airport_id as INTEGER)
      end as dest_airport_id,
    codeshare,
    stops,
    equipment,
    _data_source,
    _load_time
  from `cs378-fa2025`.`air_travel_raw`.`flight_routes`
)

select * from stg_flight_routes
    );
  
[0m14:32:15.491660 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9a325ab1-7c59-49e7-9708-98d8e975280b&page=queryresults
[0m14:32:17.565613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14de809b0>]}
[0m14:32:17.566817 [info ] [Thread-1 (]: 8 of 9 OK created sql table model dbt_air_travel_stg.flight_routes ............. [[32mCREATE TABLE (67.7k rows, 4.4 MiB processed)[0m in 2.70s]
[0m14:32:17.567936 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_routes
[0m14:32:17.568435 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_traffic
[0m14:32:17.569029 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_air_travel_stg.tsa_traffic .................... [RUN]
[0m14:32:17.569572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_routes, now model.air_travel.tsa_traffic)
[0m14:32:17.569938 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_traffic
[0m14:32:17.572556 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_traffic"
[0m14:32:17.573272 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_traffic
[0m14:32:17.574859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:17.819283 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tsa_traffic"
[0m14:32:17.821258 [debug] [Thread-1 (]: On model.air_travel.tsa_traffic: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tsa_traffic"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`
      
    
    

    
    OPTIONS()
    as (
      with stg_tsa_traffic as (
  select safe_cast(event_date as DATE format 'MM/DD/YYYY') as event_date,
    safe_cast(event_hour as INTEGER) as event_hour,
    airport_code,
    airport_name,
    airport_city,
    airport_state,
    security_checkpoint,
    safe_cast(total_traffic as INTEGER) as total_traffic,
    _data_source,
    _load_time
  from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic`
)

select * from stg_tsa_traffic
    );
  
[0m14:32:18.181120 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:fd6afbc0-d7e2-43d7-b7e0-7d27351742fd&page=queryresults
[0m14:32:20.220378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb401598-b6df-4bd2-9b53-237f35c4c45b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14de82150>]}
[0m14:32:20.221288 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_air_travel_stg.tsa_traffic ............... [[32mCREATE TABLE (23.4k rows, 2.2 MiB processed)[0m in 2.65s]
[0m14:32:20.221890 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_traffic
[0m14:32:20.223160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:32:20.224761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:20.225019 [debug] [MainThread]: Connection 'model.air_travel.tsa_traffic' was properly closed.
[0m14:32:20.225320 [info ] [MainThread]: 
[0m14:32:20.225567 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 27.93 seconds (27.93s).
[0m14:32:20.226912 [debug] [MainThread]: Command end result
[0m14:32:20.244352 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:32:20.245453 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:32:20.249356 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m14:32:20.249530 [info ] [MainThread]: 
[0m14:32:20.249716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:32:20.249855 [info ] [MainThread]: 
[0m14:32:20.250014 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m14:32:20.252490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.129976, "process_in_blocks": "0", "process_kernel_time": 0.34097, "process_mem_max_rss": "394264576", "process_out_blocks": "0", "process_user_time": 2.325038}
[0m14:32:20.252724 [debug] [MainThread]: Command `dbt run` succeeded at 14:32:20.252680 after 29.13 seconds
[0m14:32:20.252906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c9aa630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14de83e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14de83ad0>]}
[0m14:32:20.253084 [debug] [MainThread]: Flushing usage events
[0m14:32:20.522425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:26.940100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d73750>]}


============================== 14:32:26.941841 | e0be2b40-f3eb-49b7-b901-38b467bd519d ==============================
[0m14:32:26.941841 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m14:32:26.942114 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'debug': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'empty': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'log_cache_events': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '/Users/scohen/.dbt'}
[0m14:32:27.813063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0be2b40-f3eb-49b7-b901-38b467bd519d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cccc30>]}
[0m14:32:27.833222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0be2b40-f3eb-49b7-b901-38b467bd519d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135cba360>]}
[0m14:32:27.833504 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:32:27.914143 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m14:32:27.956157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:32:27.956337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:32:27.958390 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m14:32:27.974139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0be2b40-f3eb-49b7-b901-38b467bd519d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135c6b050>]}
[0m14:32:28.008153 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:32:28.009047 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:32:28.018579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0be2b40-f3eb-49b7-b901-38b467bd519d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136e30140>]}
[0m14:32:28.018814 [info ] [MainThread]: Found 9 models, 9 data tests, 9 sources, 514 macros
[0m14:32:28.018954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0be2b40-f3eb-49b7-b901-38b467bd519d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c69ef0>]}
[0m14:32:28.019828 [info ] [MainThread]: 
[0m14:32:28.019958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:28.020053 [info ] [MainThread]: 
[0m14:32:28.020248 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:32:28.021928 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m14:32:28.022114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:28.355057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0be2b40-f3eb-49b7-b901-38b467bd519d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136e0a000>]}
[0m14:32:28.355628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:32:28.358859 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m14:32:28.359251 [info ] [Thread-1 (]: 1 of 9 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m14:32:28.359618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m14:32:28.359899 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m14:32:28.372141 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m14:32:28.372836 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m14:32:28.386039 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m14:32:28.386911 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`aircrafts` )

  
  
      
    ) dbt_internal_test
[0m14:32:28.387158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:29.037559 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:523d8ed3-66b1-47d7-9f92-ca7c8da53b8c&page=queryresults
[0m14:32:29.471289 [info ] [Thread-1 (]: 1 of 9 PASS check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ .. [[32mPASS[0m in 1.11s]
[0m14:32:29.471787 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m14:32:29.472006 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m14:32:29.472242 [info ] [Thread-1 (]: 2 of 9 START test check_row_count_equals_airlines_source_air_travel_raw_airlines_  [RUN]
[0m14:32:29.472483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc, now test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d)
[0m14:32:29.472633 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m14:32:29.474949 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m14:32:29.475727 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m14:32:29.476633 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m14:32:29.477150 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airlines` )

  
  
      
    ) dbt_internal_test
[0m14:32:29.477451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:30.185181 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:078f2ae2-5b28-4525-98b0-75bea9d99867&page=queryresults
[0m14:32:30.549061 [info ] [Thread-1 (]: 2 of 9 PASS check_row_count_equals_airlines_source_air_travel_raw_airlines_ .... [[32mPASS[0m in 1.08s]
[0m14:32:30.549494 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m14:32:30.549712 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m14:32:30.549999 [info ] [Thread-1 (]: 3 of 9 START test check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_  [RUN]
[0m14:32:30.550390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d, now test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510)
[0m14:32:30.550655 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m14:32:30.553824 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m14:32:30.554421 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m14:32:30.555566 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m14:32:30.556287 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_maps` )

  
  
      
    ) dbt_internal_test
[0m14:32:30.556502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:31.179858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ed42dbbf-b0ec-4bc2-b416-30bc47e4e2d8&page=queryresults
[0m14:32:31.553811 [info ] [Thread-1 (]: 3 of 9 PASS check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_  [[32mPASS[0m in 1.00s]
[0m14:32:31.554391 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m14:32:31.554696 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m14:32:31.555026 [info ] [Thread-1 (]: 4 of 9 START test check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_  [RUN]
[0m14:32:31.555440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510, now test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587)
[0m14:32:31.555686 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m14:32:31.558940 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m14:32:31.559580 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m14:32:31.561039 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m14:32:31.561932 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_reviews` )

  
  
      
    ) dbt_internal_test
[0m14:32:31.562193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:32.183733 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ad882b46-947b-433e-a386-021559b91620&page=queryresults
[0m14:32:32.607301 [info ] [Thread-1 (]: 4 of 9 PASS check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_  [[32mPASS[0m in 1.05s]
[0m14:32:32.607868 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m14:32:32.608146 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m14:32:32.608451 [info ] [Thread-1 (]: 5 of 9 START test check_row_count_equals_airports_source_air_travel_raw_airports_  [RUN]
[0m14:32:32.608810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587, now test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0)
[0m14:32:32.609047 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m14:32:32.612530 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m14:32:32.613218 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m14:32:32.614772 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m14:32:32.615576 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airports` )

  
  
      
    ) dbt_internal_test
[0m14:32:32.615877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:33.337981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8ee2725f-f370-4881-8aff-f88c8b17e601&page=queryresults
[0m14:32:33.736776 [info ] [Thread-1 (]: 5 of 9 PASS check_row_count_equals_airports_source_air_travel_raw_airports_ .... [[32mPASS[0m in 1.13s]
[0m14:32:33.737265 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m14:32:33.737518 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m14:32:33.737821 [info ] [Thread-1 (]: 6 of 9 START test check_row_count_equals_countries_source_air_travel_raw_countries_  [RUN]
[0m14:32:33.738179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0, now test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414)
[0m14:32:33.738433 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m14:32:33.741627 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m14:32:33.742117 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m14:32:33.743241 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m14:32:33.743667 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`countries` )

  
  
      
    ) dbt_internal_test
[0m14:32:33.743901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:34.350067 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0d2c3d25-bf77-4c68-a769-d09f500ad759&page=queryresults
[0m14:32:34.704918 [info ] [Thread-1 (]: 6 of 9 PASS check_row_count_equals_countries_source_air_travel_raw_countries_ .. [[32mPASS[0m in 0.97s]
[0m14:32:34.705494 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m14:32:34.705777 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m14:32:34.706024 [info ] [Thread-1 (]: 7 of 9 START test check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_  [RUN]
[0m14:32:34.706741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414, now test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823)
[0m14:32:34.707094 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m14:32:34.711337 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m14:32:34.712094 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m14:32:34.713646 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m14:32:34.714175 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_delays` )

  
  
      
    ) dbt_internal_test
[0m14:32:34.714455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:35.335843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:72f95b85-22e4-4aac-af02-12afb6780122&page=queryresults
[0m14:32:35.701546 [info ] [Thread-1 (]: 7 of 9 PASS check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_  [[32mPASS[0m in 0.99s]
[0m14:32:35.702304 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m14:32:35.702663 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m14:32:35.703070 [info ] [Thread-1 (]: 8 of 9 START test check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_  [RUN]
[0m14:32:35.703847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823, now test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81)
[0m14:32:35.704495 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m14:32:35.709613 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m14:32:35.710612 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m14:32:35.712190 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m14:32:35.712825 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_routes` )

  
  
      
    ) dbt_internal_test
[0m14:32:35.713134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:36.393679 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:565f8e79-4669-481d-8c0d-9923b8e33198&page=queryresults
[0m14:32:36.742480 [info ] [Thread-1 (]: 8 of 9 PASS check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_  [[32mPASS[0m in 1.04s]
[0m14:32:36.743381 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m14:32:36.744031 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m14:32:36.744515 [info ] [Thread-1 (]: 9 of 9 START test check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_  [RUN]
[0m14:32:36.745109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81, now test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee)
[0m14:32:36.745508 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m14:32:36.750349 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m14:32:36.751257 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m14:32:36.753118 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m14:32:36.753762 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic` )

  
  
      
    ) dbt_internal_test
[0m14:32:36.754053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:37.509581 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1256811b-22db-43dc-adc9-8168d8375605&page=queryresults
[0m14:32:37.864527 [info ] [Thread-1 (]: 9 of 9 PASS check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_  [[32mPASS[0m in 1.12s]
[0m14:32:37.866188 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m14:32:37.867701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:32:37.869326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:37.869576 [debug] [MainThread]: Connection 'test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee' was properly closed.
[0m14:32:37.869830 [info ] [MainThread]: 
[0m14:32:37.870082 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 9.85 seconds (9.85s).
[0m14:32:37.871441 [debug] [MainThread]: Command end result
[0m14:32:37.890911 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:32:37.892464 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:32:37.896898 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m14:32:37.897118 [info ] [MainThread]: 
[0m14:32:37.897311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:32:37.897463 [info ] [MainThread]: 
[0m14:32:37.897642 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m14:32:37.900353 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.985569, "process_in_blocks": "0", "process_kernel_time": 0.305024, "process_mem_max_rss": "395149312", "process_out_blocks": "0", "process_user_time": 2.090263}
[0m14:32:37.900602 [debug] [MainThread]: Command `dbt test` succeeded at 14:32:37.900557 after 10.99 seconds
[0m14:32:37.900807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c78ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142161230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142160e10>]}
[0m14:32:37.900982 [debug] [MainThread]: Flushing usage events
[0m14:32:38.104222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:03.959027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e086e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c53750>]}


============================== 18:43:03.961642 | 0bfe591c-523b-4e2b-a65f-f071dbfc751f ==============================
[0m18:43:03.961642 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m18:43:03.961878 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'empty': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error': 'None', 'write_json': 'True', 'version_check': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select tmp_countries_iso_codes'}
[0m18:43:06.614448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bfe591c-523b-4e2b-a65f-f071dbfc751f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105facc30>]}
[0m18:43:06.633364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bfe591c-523b-4e2b-a65f-f071dbfc751f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138bbe360>]}
[0m18:43:06.633568 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m18:43:06.724342 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m18:43:06.757186 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:43:06.757369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0bfe591c-523b-4e2b-a65f-f071dbfc751f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138b6bd50>]}
[0m18:43:07.248449 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m18:43:07.251649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bfe591c-523b-4e2b-a65f-f071dbfc751f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13929fe30>]}
[0m18:43:07.281236 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m18:43:07.282244 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m18:43:07.289738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bfe591c-523b-4e2b-a65f-f071dbfc751f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138df66d0>]}
[0m18:43:07.289935 [info ] [MainThread]: Found 10 models, 9 data tests, 9 sources, 514 macros
[0m18:43:07.290063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bfe591c-523b-4e2b-a65f-f071dbfc751f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139170bb0>]}
[0m18:43:07.290659 [info ] [MainThread]: 
[0m18:43:07.290795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:07.290890 [info ] [MainThread]: 
[0m18:43:07.291074 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:43:07.291398 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m18:43:07.291561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:07.746548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now create_cs378-fa2025_dbt_air_travel_tmp)
[0m18:43:07.746861 [debug] [ThreadPool]: Creating schema "database: "cs378-fa2025"
schema: "dbt_air_travel_tmp"
"
[0m18:43:07.753020 [debug] [ThreadPool]: On create_cs378-fa2025_dbt_air_travel_tmp: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "create_cs378-fa2025_dbt_air_travel_tmp"} */
create schema if not exists `cs378-fa2025`.`dbt_air_travel_tmp`
  
[0m18:43:07.753345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:08.268716 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a00950fa-f725-46b2-a14b-3c2c2746591e&page=queryresults
[0m18:43:09.054619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m18:43:09.054883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:09.441555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m18:43:09.443515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:09.846060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bfe591c-523b-4e2b-a65f-f071dbfc751f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1394d59d0>]}
[0m18:43:09.847002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:09.852474 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_countries_iso_codes
[0m18:43:09.853032 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_countries_iso_codes ........ [RUN]
[0m18:43:09.853418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_countries_iso_codes)
[0m18:43:09.853704 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_countries_iso_codes
[0m18:43:09.859427 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_countries_iso_codes"
[0m18:43:09.860098 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_countries_iso_codes
[0m18:43:09.882723 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_countries_iso_codes"
[0m18:43:09.883311 [debug] [Thread-1 (]: On model.air_travel.tmp_countries_iso_codes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_countries_iso_codes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_countries_iso_codes`
      
    
    

    
    OPTIONS()
    as (
      with tmp_countries_iso_codes as (
    select
      name,
      AI.GENERATE(
        ('What is the iso code for country ', name, '? If it does not have one, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from ref('countries')
    where iso_code is null
  )
select name, llm_response.iso_code as mapped_iso_code
from tmp_countries_iso_codes
    );
  
[0m18:43:09.883542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:10.521848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c737a8eb-c046-4d1c-994d-feed6e6d285a&page=queryresults
[0m18:43:10.663611 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c737a8eb-c046-4d1c-994d-feed6e6d285a&page=queryresults
[0m18:43:10.679051 [debug] [Thread-1 (]: Database Error in model tmp_countries_iso_codes (models/tmp/tmp_countries_iso_codes.sql)
  Table-valued function not found: ref at [23:10]
  compiled code at target/run/air_travel/models/tmp/tmp_countries_iso_codes.sql
[0m18:43:10.680903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bfe591c-523b-4e2b-a65f-f071dbfc751f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1396da830>]}
[0m18:43:10.681408 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_countries_iso_codes  [[31mERROR[0m in 0.83s]
[0m18:43:10.681828 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_countries_iso_codes
[0m18:43:10.682248 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_countries_iso_codes' to be skipped because of status 'error'.  Reason: Database Error in model tmp_countries_iso_codes (models/tmp/tmp_countries_iso_codes.sql)
  Table-valued function not found: ref at [23:10]
  compiled code at target/run/air_travel/models/tmp/tmp_countries_iso_codes.sql.
[0m18:43:10.683832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:10.685118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:10.685340 [debug] [MainThread]: Connection 'model.air_travel.tmp_countries_iso_codes' was properly closed.
[0m18:43:10.685538 [info ] [MainThread]: 
[0m18:43:10.685746 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m18:43:10.686180 [debug] [MainThread]: Command end result
[0m18:43:10.703862 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m18:43:10.704819 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m18:43:10.707883 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m18:43:10.708062 [info ] [MainThread]: 
[0m18:43:10.708257 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:43:10.708407 [info ] [MainThread]: 
[0m18:43:10.708572 [error] [MainThread]: [31mFailure in model tmp_countries_iso_codes (models/tmp/tmp_countries_iso_codes.sql)[0m
[0m18:43:10.708728 [error] [MainThread]:   Database Error in model tmp_countries_iso_codes (models/tmp/tmp_countries_iso_codes.sql)
  Table-valued function not found: ref at [23:10]
  compiled code at target/run/air_travel/models/tmp/tmp_countries_iso_codes.sql
[0m18:43:10.708845 [info ] [MainThread]: 
[0m18:43:10.708993 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_countries_iso_codes.sql
[0m18:43:10.709107 [info ] [MainThread]: 
[0m18:43:10.709244 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:43:10.721763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.7904754, "process_in_blocks": "0", "process_kernel_time": 0.383427, "process_mem_max_rss": "402866176", "process_out_blocks": "0", "process_user_time": 2.331442}
[0m18:43:10.722019 [debug] [MainThread]: Command `dbt run` failed at 18:43:10.721977 after 6.79 seconds
[0m18:43:10.722196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1396d1ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139627380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566a250>]}
[0m18:43:10.722367 [debug] [MainThread]: Flushing usage events
[0m18:43:11.115641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:28.600449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107573750>]}


============================== 18:43:28.602061 | 54149d31-a0db-4102-8c51-23737da39008 ==============================
[0m18:43:28.602061 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m18:43:28.602305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select tmp_countries_iso_codes', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'False', 'partial_parse': 'True', 'target_path': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None'}
[0m18:43:29.413895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54149d31-a0db-4102-8c51-23737da39008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ccc30>]}
[0m18:43:29.432641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54149d31-a0db-4102-8c51-23737da39008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dbbe360>]}
[0m18:43:29.432841 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m18:43:29.506366 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m18:43:29.545438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:43:29.545704 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_countries_iso_codes.sql
[0m18:43:29.625729 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.air_travel.mrt
- models.air_travel.int
[0m18:43:29.630061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54149d31-a0db-4102-8c51-23737da39008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e82df50>]}
[0m18:43:29.660550 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m18:43:29.661406 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m18:43:29.666907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54149d31-a0db-4102-8c51-23737da39008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e877200>]}
[0m18:43:29.667090 [info ] [MainThread]: Found 10 models, 9 data tests, 9 sources, 514 macros
[0m18:43:29.667215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54149d31-a0db-4102-8c51-23737da39008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eadec10>]}
[0m18:43:29.667819 [info ] [MainThread]: 
[0m18:43:29.667945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:29.668041 [info ] [MainThread]: 
[0m18:43:29.668221 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:43:29.668533 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m18:43:29.668672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:30.192220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m18:43:30.192707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:30.564690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m18:43:30.565418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:30.927198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54149d31-a0db-4102-8c51-23737da39008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea99b20>]}
[0m18:43:30.927803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:30.931038 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_countries_iso_codes
[0m18:43:30.931581 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_countries_iso_codes ........ [RUN]
[0m18:43:30.931968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_countries_iso_codes)
[0m18:43:30.932255 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_countries_iso_codes
[0m18:43:30.938557 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_countries_iso_codes"
[0m18:43:30.939190 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_countries_iso_codes
[0m18:43:30.962469 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_countries_iso_codes"
[0m18:43:30.962977 [debug] [Thread-1 (]: On model.air_travel.tmp_countries_iso_codes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_countries_iso_codes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_countries_iso_codes`
      
    
    

    
    OPTIONS()
    as (
      with tmp_countries_iso_codes as (
    select
      name,
      AI.GENERATE(
        ('What is the iso code for country ', name, '? If it does not have one, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
    where iso_code is null
  )
select name, llm_response.iso_code as mapped_iso_code
from tmp_countries_iso_codes
    );
  
[0m18:43:30.963199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:31.616679 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b180dc8c-38b5-48dd-8663-deb0cdb66c3a&page=queryresults
[0m18:43:38.806954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54149d31-a0db-4102-8c51-23737da39008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138107110>]}
[0m18:43:38.807335 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_countries_iso_codes ... [[32mCREATE TABLE (20.0 rows, 4.0 KiB processed)[0m in 7.87s]
[0m18:43:38.807642 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_countries_iso_codes
[0m18:43:38.808271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:38.809087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:38.809235 [debug] [MainThread]: Connection 'model.air_travel.tmp_countries_iso_codes' was properly closed.
[0m18:43:38.809358 [info ] [MainThread]: 
[0m18:43:38.809490 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.14 seconds (9.14s).
[0m18:43:38.809772 [debug] [MainThread]: Command end result
[0m18:43:38.824709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m18:43:38.825736 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m18:43:38.828265 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m18:43:38.828401 [info ] [MainThread]: 
[0m18:43:38.828550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:38.828656 [info ] [MainThread]: 
[0m18:43:38.828775 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:43:38.830620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.253817, "process_in_blocks": "0", "process_kernel_time": 0.242583, "process_mem_max_rss": "393068544", "process_out_blocks": "0", "process_user_time": 1.667511}
[0m18:43:38.830810 [debug] [MainThread]: Command `dbt run` succeeded at 18:43:38.830775 after 10.25 seconds
[0m18:43:38.830959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1381a1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106469810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646bf70>]}
[0m18:43:38.831093 [debug] [MainThread]: Flushing usage events
[0m18:43:39.069400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:32.030571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f506e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d9b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d9b750>]}


============================== 19:36:32.032219 | dd1644f0-b2e1-420d-88b8-b62ea6e0869f ==============================
[0m19:36:32.032219 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:36:32.032462 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --select Country', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt'}
[0m19:36:32.888456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd1644f0-b2e1-420d-88b8-b62ea6e0869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f4c30>]}
[0m19:36:32.907304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd1644f0-b2e1-420d-88b8-b62ea6e0869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1312c2360>]}
[0m19:36:32.907510 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:36:32.983044 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:36:33.022156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:36:33.022373 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Country.sql
[0m19:36:33.081762 [error] [MainThread]: Encountered an error:
Compilation Error in model Country (models/int/Country.sql)
  The name argument to ref() must be a string, got <class 'dbt_common.clients.jinja.create_undefined.<locals>.Undefined'>
[0m19:36:33.083411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0763671, "process_in_blocks": "0", "process_kernel_time": 0.213129, "process_mem_max_rss": "378912768", "process_out_blocks": "0", "process_user_time": 1.325582}
[0m19:36:33.083634 [debug] [MainThread]: Command `dbt run` failed at 19:36:33.083594 after 1.08 seconds
[0m19:36:33.083783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13202f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13202e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132251a90>]}
[0m19:36:33.083909 [debug] [MainThread]: Flushing usage events
[0m19:36:33.414510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:55.362127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111273750>]}


============================== 19:36:55.363725 | e3b91989-96dc-49f2-b1ba-36cdc6651e0c ==============================
[0m19:36:55.363725 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:36:55.363986 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'empty': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'printer_width': '80', 'invocation_command': 'dbt run --select Country', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None'}
[0m19:36:56.170147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3b91989-96dc-49f2-b1ba-36cdc6651e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ccc30>]}
[0m19:36:56.188910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3b91989-96dc-49f2-b1ba-36cdc6651e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fdc2360>]}
[0m19:36:56.189119 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:36:56.261154 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:36:56.299255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:36:56.299451 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Country.sql
[0m19:36:56.379098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m19:36:56.383479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3b91989-96dc-49f2-b1ba-36cdc6651e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15862a150>]}
[0m19:36:56.414098 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:36:56.414939 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:36:56.420527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3b91989-96dc-49f2-b1ba-36cdc6651e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158677110>]}
[0m19:36:56.420713 [info ] [MainThread]: Found 11 models, 9 data tests, 9 sources, 514 macros
[0m19:36:56.420838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b91989-96dc-49f2-b1ba-36cdc6651e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1598c2dd0>]}
[0m19:36:56.421439 [info ] [MainThread]: 
[0m19:36:56.421565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:56.421659 [info ] [MainThread]: 
[0m19:36:56.421850 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:36:56.422196 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m19:36:56.422358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:56.920349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now create_cs378-fa2025_dbt_air_travel_int)
[0m19:36:56.921173 [debug] [ThreadPool]: Creating schema "database: "cs378-fa2025"
schema: "dbt_air_travel_int"
"
[0m19:36:56.929508 [debug] [ThreadPool]: On create_cs378-fa2025_dbt_air_travel_int: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "create_cs378-fa2025_dbt_air_travel_int"} */
create schema if not exists `cs378-fa2025`.`dbt_air_travel_int`
  
[0m19:36:56.929818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:57.528270 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6331cdba-7bba-4308-9e35-94eeb199eaec&page=queryresults
[0m19:36:58.175018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_int)
[0m19:36:58.175295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:58.556702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m19:36:58.557284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:58.933990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m19:36:58.934916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:59.310063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b91989-96dc-49f2-b1ba-36cdc6651e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159e03ad0>]}
[0m19:36:59.310931 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:59.315554 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m19:36:59.316285 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Country ........................ [RUN]
[0m19:36:59.316799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Country)
[0m19:36:59.317137 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m19:36:59.323711 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m19:36:59.324494 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m19:36:59.346556 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Country"
[0m19:36:59.347187 [debug] [Thread-1 (]: On model.air_travel.Country: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Country"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Country`
      
    
    

    
    OPTIONS()
    as (
      with Country as (
    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` 
    group by iso_code, name, _data_source, _load_time
)

select *
from Country 
where iso_code is not null 
union distinct 
select c.* 
from Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_countries_iso_codes` t 
on c.name = t.name
where t.mapped_iso_code is not null
and c.iso_code is null
    );
  
[0m19:36:59.347416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:00.191276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:cbf029cc-ca88-4f69-a616-62613e40f458&page=queryresults
[0m19:37:00.312379 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:cbf029cc-ca88-4f69-a616-62613e40f458&page=queryresults
[0m19:37:00.325509 [debug] [Thread-1 (]: Database Error in model Country (models/int/Country.sql)
  Type ARRAY is not supported in UNION DISTINCT operation
  compiled code at target/run/air_travel/models/int/Country.sql
[0m19:37:00.327397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b91989-96dc-49f2-b1ba-36cdc6651e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159e37350>]}
[0m19:37:00.328003 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Country ............... [[31mERROR[0m in 1.01s]
[0m19:37:00.328437 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m19:37:00.328767 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Country' to be skipped because of status 'error'.  Reason: Database Error in model Country (models/int/Country.sql)
  Type ARRAY is not supported in UNION DISTINCT operation
  compiled code at target/run/air_travel/models/int/Country.sql.
[0m19:37:00.330037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:00.331262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:00.331474 [debug] [MainThread]: Connection 'model.air_travel.Country' was properly closed.
[0m19:37:00.331673 [info ] [MainThread]: 
[0m19:37:00.331890 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m19:37:00.332336 [debug] [MainThread]: Command end result
[0m19:37:00.349126 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:37:00.350130 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:37:00.353245 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m19:37:00.353420 [info ] [MainThread]: 
[0m19:37:00.353616 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:37:00.353775 [info ] [MainThread]: 
[0m19:37:00.353976 [error] [MainThread]: [31mFailure in model Country (models/int/Country.sql)[0m
[0m19:37:00.354175 [error] [MainThread]:   Database Error in model Country (models/int/Country.sql)
  Type ARRAY is not supported in UNION DISTINCT operation
  compiled code at target/run/air_travel/models/int/Country.sql
[0m19:37:00.354304 [info ] [MainThread]: 
[0m19:37:00.354460 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Country.sql
[0m19:37:00.354618 [info ] [MainThread]: 
[0m19:37:00.354778 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:37:00.357044 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0181894, "process_in_blocks": "0", "process_kernel_time": 0.236858, "process_mem_max_rss": "399572992", "process_out_blocks": "0", "process_user_time": 1.778933}
[0m19:37:00.357253 [debug] [MainThread]: Command `dbt run` failed at 19:37:00.357211 after 5.02 seconds
[0m19:37:00.357432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159e7e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ffdc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ffdff70>]}
[0m19:37:00.357594 [debug] [MainThread]: Flushing usage events
[0m19:37:00.597292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:38.468566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108673750>]}


============================== 19:37:38.470158 | 459e2dee-ddcf-40ee-af5c-00793084991c ==============================
[0m19:37:38.470158 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:37:38.470409 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'write_json': 'True', 'invocation_command': 'dbt run --select Country', 'version_check': 'True', 'debug': 'False', 'log_cache_events': 'False', 'target_path': 'None'}
[0m19:37:39.282130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '459e2dee-ddcf-40ee-af5c-00793084991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dccc30>]}
[0m19:37:39.301031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '459e2dee-ddcf-40ee-af5c-00793084991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1be360>]}
[0m19:37:39.301246 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:37:39.376206 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:37:39.415126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:39.415345 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Country.sql
[0m19:37:39.494689 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m19:37:39.499047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '459e2dee-ddcf-40ee-af5c-00793084991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f82e150>]}
[0m19:37:39.529435 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:37:39.530289 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:37:39.535927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '459e2dee-ddcf-40ee-af5c-00793084991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f877110>]}
[0m19:37:39.536130 [info ] [MainThread]: Found 11 models, 9 data tests, 9 sources, 514 macros
[0m19:37:39.536259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '459e2dee-ddcf-40ee-af5c-00793084991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fac2dd0>]}
[0m19:37:39.536863 [info ] [MainThread]: 
[0m19:37:39.536986 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:39.537077 [info ] [MainThread]: 
[0m19:37:39.537264 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:37:39.537613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m19:37:39.537783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:40.038206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m19:37:40.038764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:40.424388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m19:37:40.426314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:40.817318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m19:37:40.818115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:41.198588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '459e2dee-ddcf-40ee-af5c-00793084991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150053ad0>]}
[0m19:37:41.199271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:41.203263 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m19:37:41.203719 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Country ........................ [RUN]
[0m19:37:41.204066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Country)
[0m19:37:41.204337 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m19:37:41.210880 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m19:37:41.211493 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m19:37:41.236007 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Country"
[0m19:37:41.236582 [debug] [Thread-1 (]: On model.air_travel.Country: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Country"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Country`
      
    
    

    
    OPTIONS()
    as (
      with Country as (
    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` 
    group by iso_code, name, _data_source, _load_time
)

select *
from Country 
where iso_code is not null 
union all
select c.* 
from Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_countries_iso_codes` t 
on c.name = t.name
where t.mapped_iso_code is not null
and c.iso_code is null
    );
  
[0m19:37:41.236808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:41.868162 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:619d1edd-8c7e-4c61-b404-6835118607cc&page=queryresults
[0m19:37:44.075541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459e2dee-ddcf-40ee-af5c-00793084991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150032ed0>]}
[0m19:37:44.076186 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Country ................... [[32mCREATE TABLE (243.0 rows, 10.7 KiB processed)[0m in 2.87s]
[0m19:37:44.076647 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m19:37:44.077793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:44.079129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:44.079328 [debug] [MainThread]: Connection 'model.air_travel.Country' was properly closed.
[0m19:37:44.079522 [info ] [MainThread]: 
[0m19:37:44.079715 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m19:37:44.080148 [debug] [MainThread]: Command end result
[0m19:37:44.096100 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:37:44.097166 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:37:44.100101 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m19:37:44.100243 [info ] [MainThread]: 
[0m19:37:44.100418 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:37:44.100550 [info ] [MainThread]: 
[0m19:37:44.100699 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:37:44.102950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6578345, "process_in_blocks": "0", "process_kernel_time": 0.250933, "process_mem_max_rss": "389890048", "process_out_blocks": "0", "process_user_time": 1.746952}
[0m19:37:44.103179 [debug] [MainThread]: Command `dbt run` succeeded at 19:37:44.103137 after 5.66 seconds
[0m19:37:44.103351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1500a5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d62530>]}
[0m19:37:44.103511 [debug] [MainThread]: Flushing usage events
[0m19:37:44.395717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:41:26.714968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048306e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567b750>]}


============================== 19:41:26.716569 | ac539168-9816-4c29-8dd0-6645281be314 ==============================
[0m19:41:26.716569 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:41:26.716805 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'invocation_command': 'dbt run --select Country', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True'}
[0m19:41:27.538789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac539168-9816-4c29-8dd0-6645281be314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d4c30>]}
[0m19:41:27.557502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac539168-9816-4c29-8dd0-6645281be314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b4c2360>]}
[0m19:41:27.557701 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:41:27.631258 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:41:27.670174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:41:27.670406 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Country.sql
[0m19:41:27.749773 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m19:41:27.754055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac539168-9816-4c29-8dd0-6645281be314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ba32150>]}
[0m19:41:27.788840 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:41:27.789750 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:41:27.795696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac539168-9816-4c29-8dd0-6645281be314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ba7b110>]}
[0m19:41:27.795883 [info ] [MainThread]: Found 11 models, 9 data tests, 9 sources, 514 macros
[0m19:41:27.796011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac539168-9816-4c29-8dd0-6645281be314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bcdadd0>]}
[0m19:41:27.796642 [info ] [MainThread]: 
[0m19:41:27.796773 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:41:27.796866 [info ] [MainThread]: 
[0m19:41:27.797065 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:41:27.797444 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m19:41:27.797613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:28.261689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m19:41:28.262222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:28.617356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m19:41:28.619599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:28.981496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m19:41:28.982612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:29.316127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac539168-9816-4c29-8dd0-6645281be314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c653ee0>]}
[0m19:41:29.316768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:29.320912 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m19:41:29.321489 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Country ........................ [RUN]
[0m19:41:29.321907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Country)
[0m19:41:29.322205 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m19:41:29.328637 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m19:41:29.329339 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m19:41:29.339239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:29.676848 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Country"
[0m19:41:29.677439 [debug] [Thread-1 (]: On model.air_travel.Country: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Country"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Country`
      
    
    

    
    OPTIONS()
    as (
      with Country as (
    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` 
    group by iso_code, name, _data_source, _load_time
)

select *
from Country 
where iso_code is not null 
union all
select t.mapped_iso_code, c.* except(c.iso_code) 
from Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_countries_iso_codes` t 
on c.name = t.name
where t.mapped_iso_code is not null
and c.iso_code is null
    );
  
[0m19:41:29.916394 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a3963e92-1e6b-427d-bad3-767d2691cd38&page=queryresults
[0m19:41:29.917783 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a3963e92-1e6b-427d-bad3-767d2691cd38&page=queryresults
[0m19:41:29.929349 [debug] [Thread-1 (]: Database Error in model Country (models/int/Country.sql)
  Syntax error: Expected ")" or "," but got "." at [24:39]
  compiled code at target/run/air_travel/models/int/Country.sql
[0m19:41:29.931619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac539168-9816-4c29-8dd0-6645281be314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c619550>]}
[0m19:41:29.932363 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Country ............... [[31mERROR[0m in 0.61s]
[0m19:41:29.932866 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m19:41:29.933353 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Country' to be skipped because of status 'error'.  Reason: Database Error in model Country (models/int/Country.sql)
  Syntax error: Expected ")" or "," but got "." at [24:39]
  compiled code at target/run/air_travel/models/int/Country.sql.
[0m19:41:29.934800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:29.936046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:29.936252 [debug] [MainThread]: Connection 'model.air_travel.Country' was properly closed.
[0m19:41:29.936454 [info ] [MainThread]: 
[0m19:41:29.936673 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m19:41:29.937100 [debug] [MainThread]: Command end result
[0m19:41:29.955713 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:41:29.956830 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:41:29.959945 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m19:41:29.960094 [info ] [MainThread]: 
[0m19:41:29.960270 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:41:29.960403 [info ] [MainThread]: 
[0m19:41:29.960577 [error] [MainThread]: [31mFailure in model Country (models/int/Country.sql)[0m
[0m19:41:29.960729 [error] [MainThread]:   Database Error in model Country (models/int/Country.sql)
  Syntax error: Expected ")" or "," but got "." at [24:39]
  compiled code at target/run/air_travel/models/int/Country.sql
[0m19:41:29.960852 [info ] [MainThread]: 
[0m19:41:29.961001 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Country.sql
[0m19:41:29.961123 [info ] [MainThread]: 
[0m19:41:29.961262 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:41:29.963505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2718487, "process_in_blocks": "0", "process_kernel_time": 0.231453, "process_mem_max_rss": "392314880", "process_out_blocks": "0", "process_user_time": 1.717303}
[0m19:41:29.963723 [debug] [MainThread]: Command `dbt run` failed at 19:41:29.963680 after 3.27 seconds
[0m19:41:29.963894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bceb960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c686a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c6868f0>]}
[0m19:41:29.964057 [debug] [MainThread]: Flushing usage events
[0m19:41:30.249111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:42:11.368001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f806e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107273750>]}


============================== 19:42:11.369562 | d4cb1044-88e6-4321-a904-b4bd9216d274 ==============================
[0m19:42:11.369562 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:42:11.369804 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'quiet': 'False', 'debug': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select Country', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'no_print': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_colors': 'True'}
[0m19:42:12.187286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4cb1044-88e6-4321-a904-b4bd9216d274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106124c30>]}
[0m19:42:12.206233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4cb1044-88e6-4321-a904-b4bd9216d274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dbe360>]}
[0m19:42:12.206461 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:42:12.281170 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:42:12.319685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:42:12.319923 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Country.sql
[0m19:42:12.399680 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m19:42:12.404064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4cb1044-88e6-4321-a904-b4bd9216d274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136332150>]}
[0m19:42:12.434427 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:42:12.435285 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:42:12.440833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4cb1044-88e6-4321-a904-b4bd9216d274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13637b110>]}
[0m19:42:12.441034 [info ] [MainThread]: Found 11 models, 9 data tests, 9 sources, 514 macros
[0m19:42:12.441160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4cb1044-88e6-4321-a904-b4bd9216d274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1366e2dd0>]}
[0m19:42:12.441770 [info ] [MainThread]: 
[0m19:42:12.441904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:42:12.441998 [info ] [MainThread]: 
[0m19:42:12.442182 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:42:12.442522 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m19:42:12.442677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:12.902081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m19:42:12.902609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:13.234370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m19:42:13.236451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:13.584023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m19:42:13.584997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:13.930033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4cb1044-88e6-4321-a904-b4bd9216d274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136b4fee0>]}
[0m19:42:13.930614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:42:13.934364 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m19:42:13.934897 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Country ........................ [RUN]
[0m19:42:13.935311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.Country)
[0m19:42:13.935597 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m19:42:13.941741 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m19:42:13.942398 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m19:42:13.951867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:14.291438 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Country"
[0m19:42:14.292063 [debug] [Thread-1 (]: On model.air_travel.Country: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Country"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Country`
      
    
    

    
    OPTIONS()
    as (
      with Country as (
    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` 
    group by iso_code, name, _data_source, _load_time
)

select *
from Country 
where iso_code is not null 
union all
select t.mapped_iso_code, name, dafif_codes, _data_source, _load_time 
from Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_countries_iso_codes` t 
on c.name = t.name
where t.mapped_iso_code is not null
and c.iso_code is null
    );
  
[0m19:42:14.664720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:bb4b2edb-b987-4234-8673-5bb4802bc4b1&page=queryresults
[0m19:42:14.786088 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:bb4b2edb-b987-4234-8673-5bb4802bc4b1&page=queryresults
[0m19:42:14.798755 [debug] [Thread-1 (]: Database Error in model Country (models/int/Country.sql)
  Column name name is ambiguous at [24:27]
  compiled code at target/run/air_travel/models/int/Country.sql
[0m19:42:14.800288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4cb1044-88e6-4321-a904-b4bd9216d274', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136b0a090>]}
[0m19:42:14.800848 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Country ............... [[31mERROR[0m in 0.86s]
[0m19:42:14.801310 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m19:42:14.801674 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Country' to be skipped because of status 'error'.  Reason: Database Error in model Country (models/int/Country.sql)
  Column name name is ambiguous at [24:27]
  compiled code at target/run/air_travel/models/int/Country.sql.
[0m19:42:14.802974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:42:14.804238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:14.804458 [debug] [MainThread]: Connection 'model.air_travel.Country' was properly closed.
[0m19:42:14.804661 [info ] [MainThread]: 
[0m19:42:14.804872 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m19:42:14.805369 [debug] [MainThread]: Command end result
[0m19:42:14.823400 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:42:14.824392 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:42:14.827462 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m19:42:14.827590 [info ] [MainThread]: 
[0m19:42:14.827756 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:42:14.827883 [info ] [MainThread]: 
[0m19:42:14.828050 [error] [MainThread]: [31mFailure in model Country (models/int/Country.sql)[0m
[0m19:42:14.828206 [error] [MainThread]:   Database Error in model Country (models/int/Country.sql)
  Column name name is ambiguous at [24:27]
  compiled code at target/run/air_travel/models/int/Country.sql
[0m19:42:14.828317 [info ] [MainThread]: 
[0m19:42:14.828453 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Country.sql
[0m19:42:14.828564 [info ] [MainThread]: 
[0m19:42:14.828699 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:42:14.830848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4862127, "process_in_blocks": "0", "process_kernel_time": 0.223358, "process_mem_max_rss": "386875392", "process_out_blocks": "0", "process_user_time": 1.737041}
[0m19:42:14.831064 [debug] [MainThread]: Command `dbt run` failed at 19:42:14.831024 after 3.49 seconds
[0m19:42:14.831231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1366eb800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136b6aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136b6a8f0>]}
[0m19:42:14.831390 [debug] [MainThread]: Flushing usage events
[0m19:42:15.069904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:42:40.873064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068086e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107653750>]}


============================== 19:42:40.874678 | 538a7ee3-cc7e-460c-b0bc-9ce387028413 ==============================
[0m19:42:40.874678 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:42:40.874923 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'indirect_selection': 'eager', 'no_print': 'None', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'log_format': 'default', 'version_check': 'True', 'empty': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt run --select Country', 'fail_fast': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m19:42:41.693966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '538a7ee3-cc7e-460c-b0bc-9ce387028413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069acc30>]}
[0m19:42:41.713364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '538a7ee3-cc7e-460c-b0bc-9ce387028413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bdc2360>]}
[0m19:42:41.713590 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:42:41.786787 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:42:41.825756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:42:41.826005 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Country.sql
[0m19:42:41.906155 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m19:42:41.910586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '538a7ee3-cc7e-460c-b0bc-9ce387028413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cc2e150>]}
[0m19:42:41.941339 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:42:41.942181 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:42:41.947849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '538a7ee3-cc7e-460c-b0bc-9ce387028413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cc77110>]}
[0m19:42:41.948025 [info ] [MainThread]: Found 11 models, 9 data tests, 9 sources, 514 macros
[0m19:42:41.948146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '538a7ee3-cc7e-460c-b0bc-9ce387028413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cedadd0>]}
[0m19:42:41.948769 [info ] [MainThread]: 
[0m19:42:41.948897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:42:41.948993 [info ] [MainThread]: 
[0m19:42:41.949179 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:42:41.949534 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m19:42:41.949703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:42.364280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m19:42:42.364731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:42.706494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m19:42:42.707513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:43.335070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m19:42:43.336285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:43.673947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '538a7ee3-cc7e-460c-b0bc-9ce387028413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dc4fad0>]}
[0m19:42:43.674759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:42:43.679373 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m19:42:43.679941 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Country ........................ [RUN]
[0m19:42:43.680334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.Country)
[0m19:42:43.680617 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m19:42:43.687017 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m19:42:43.687644 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m19:42:43.697550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:44.052790 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Country"
[0m19:42:44.053755 [debug] [Thread-1 (]: On model.air_travel.Country: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Country"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Country`
      
    
    

    
    OPTIONS()
    as (
      with Country as (
    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` 
    group by iso_code, name, _data_source, _load_time
)

select *
from Country 
where iso_code is not null 
union all
select t.mapped_iso_code, c.name, c.dafif_codes, c._data_source, c._load_time 
from Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_countries_iso_codes` t 
on c.name = t.name
where t.mapped_iso_code is not null
and c.iso_code is null
    );
  
[0m19:42:44.462769 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:93ee8918-00ac-4972-8687-ee5e35aea9d4&page=queryresults
[0m19:42:46.323671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '538a7ee3-cc7e-460c-b0bc-9ce387028413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dc2ef90>]}
[0m19:42:46.324203 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Country ................... [[32mCREATE TABLE (243.0 rows, 10.7 KiB processed)[0m in 2.64s]
[0m19:42:46.324567 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m19:42:46.325316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:42:46.326252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:46.326405 [debug] [MainThread]: Connection 'model.air_travel.Country' was properly closed.
[0m19:42:46.326553 [info ] [MainThread]: 
[0m19:42:46.326726 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m19:42:46.327075 [debug] [MainThread]: Command end result
[0m19:42:46.341341 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:42:46.342413 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:42:46.345448 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m19:42:46.345611 [info ] [MainThread]: 
[0m19:42:46.345791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:42:46.345924 [info ] [MainThread]: 
[0m19:42:46.346064 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:42:46.348140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.49871, "process_in_blocks": "0", "process_kernel_time": 0.255535, "process_mem_max_rss": "393641984", "process_out_blocks": "0", "process_user_time": 1.773801}
[0m19:42:46.348342 [debug] [MainThread]: Command `dbt run` succeeded at 19:42:46.348304 after 5.50 seconds
[0m19:42:46.348495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dca5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106947f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dcb2df0>]}
[0m19:42:46.348645 [debug] [MainThread]: Flushing usage events
[0m19:42:46.590287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:36.108453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107273750>]}


============================== 20:00:36.110052 | e8bbcc4c-86d6-4571-826b-1e3a7d9ecfef ==============================
[0m20:00:36.110052 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m20:00:36.110295 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'cache_selected_only': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'no_print': 'None', 'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tmp_airports_llm', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'False'}
[0m20:00:36.923993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8bbcc4c-86d6-4571-826b-1e3a7d9ecfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ccc30>]}
[0m20:00:36.943994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8bbcc4c-86d6-4571-826b-1e3a7d9ecfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dabe360>]}
[0m20:00:36.944306 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m20:00:37.020112 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m20:00:37.060339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:00:37.060610 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airports_llm.sql
[0m20:00:37.145020 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m20:00:37.149658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8bbcc4c-86d6-4571-826b-1e3a7d9ecfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e82e150>]}
[0m20:00:37.180736 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m20:00:37.181712 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m20:00:37.187575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8bbcc4c-86d6-4571-826b-1e3a7d9ecfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dace8a0>]}
[0m20:00:37.187754 [info ] [MainThread]: Found 12 models, 9 data tests, 9 sources, 514 macros
[0m20:00:37.187877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8bbcc4c-86d6-4571-826b-1e3a7d9ecfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eab6eb0>]}
[0m20:00:37.188496 [info ] [MainThread]: 
[0m20:00:37.188628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:00:37.188721 [info ] [MainThread]: 
[0m20:00:37.188906 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:00:37.189269 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m20:00:37.189455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:37.680348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m20:00:37.680853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:38.100715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m20:00:38.102527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:38.511257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m20:00:38.512227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:38.924349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8bbcc4c-86d6-4571-826b-1e3a7d9ecfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea99a50>]}
[0m20:00:38.925853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:38.930214 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airports_llm
[0m20:00:38.930778 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airports_llm ............... [RUN]
[0m20:00:38.931165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airports_llm)
[0m20:00:38.931439 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airports_llm
[0m20:00:38.937598 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airports_llm"
[0m20:00:38.938281 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airports_llm
[0m20:00:38.961910 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airports_llm"
[0m20:00:38.962515 [debug] [Thread-1 (]: On model.air_travel.tmp_airports_llm: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airports_llm"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airports_llm`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airports_llm as (
    select
      name,
      country,
      iata,
      AI.GENERATE(
        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'icao STRING, state_prov STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
    where iata is not null
  )
select name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov
from tmp_airports_llm
    );
  
[0m20:00:38.962742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:40.280137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8a3545fa-338f-4b00-bb1e-bc7da3b40a4e&page=queryresults
[0m20:05:55.933681 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airports_llm"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airports_llm`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airports_llm as (
    select
      name,
      country,
      iata,
      AI.GENERATE(
        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'icao STRING, state_prov STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
    where iata is not null
  )
select name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov
from tmp_airports_llm
    );
  
[0m20:05:55.935389 [debug] [Thread-1 (]: BigQuery adapter: 499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/8a3545fa-338f-4b00-bb1e-bc7da3b40a4e?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec

Location: us-central1
Job ID: 8a3545fa-338f-4b00-bb1e-bc7da3b40a4e

[0m20:05:55.948692 [debug] [Thread-1 (]: Database Error in model tmp_airports_llm (models/tmp/tmp_airports_llm.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/8a3545fa-338f-4b00-bb1e-bc7da3b40a4e?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: us-central1
  Job ID: 8a3545fa-338f-4b00-bb1e-bc7da3b40a4e
  
  compiled code at target/run/air_travel/models/tmp/tmp_airports_llm.sql
[0m20:05:55.950384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8bbcc4c-86d6-4571-826b-1e3a7d9ecfef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef16c90>]}
[0m20:05:55.950973 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airports_llm ...... [[31mERROR[0m in 317.02s]
[0m20:05:55.951373 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airports_llm
[0m20:05:55.951802 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airports_llm' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airports_llm (models/tmp/tmp_airports_llm.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/8a3545fa-338f-4b00-bb1e-bc7da3b40a4e?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: us-central1
  Job ID: 8a3545fa-338f-4b00-bb1e-bc7da3b40a4e
  
  compiled code at target/run/air_travel/models/tmp/tmp_airports_llm.sql.
[0m20:05:55.953454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:05:55.954838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:55.955021 [debug] [MainThread]: Connection 'model.air_travel.tmp_airports_llm' was properly closed.
[0m20:05:55.955205 [info ] [MainThread]: 
[0m20:05:55.955390 [info ] [MainThread]: Finished running 1 table model in 0 hours 5 minutes and 18.77 seconds (318.77s).
[0m20:05:55.955823 [debug] [MainThread]: Command end result
[0m20:05:55.973767 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m20:05:55.974834 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m20:05:55.977399 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m20:05:55.977541 [info ] [MainThread]: 
[0m20:05:55.977710 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:05:55.977838 [info ] [MainThread]: 
[0m20:05:55.978001 [error] [MainThread]: [31mFailure in model tmp_airports_llm (models/tmp/tmp_airports_llm.sql)[0m
[0m20:05:55.978156 [error] [MainThread]:   Database Error in model tmp_airports_llm (models/tmp/tmp_airports_llm.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/8a3545fa-338f-4b00-bb1e-bc7da3b40a4e?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: Job timed out after 5 min 0 sec
  
  Location: us-central1
  Job ID: 8a3545fa-338f-4b00-bb1e-bc7da3b40a4e
  
  compiled code at target/run/air_travel/models/tmp/tmp_airports_llm.sql
[0m20:05:55.978275 [info ] [MainThread]: 
[0m20:05:55.978408 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airports_llm.sql
[0m20:05:55.978526 [info ] [MainThread]: 
[0m20:05:55.978655 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:05:55.980816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 319.89786, "process_in_blocks": "0", "process_kernel_time": 0.298733, "process_mem_max_rss": "390840320", "process_out_blocks": "0", "process_user_time": 1.947236}
[0m20:05:55.981026 [debug] [MainThread]: Command `dbt run` failed at 20:05:55.980987 after 319.90 seconds
[0m20:05:55.981194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e9f3d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104285810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ddf6e90>]}
[0m20:05:55.981346 [debug] [MainThread]: Flushing usage events
[0m20:05:56.286200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:17:59.737789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111973750>]}


============================== 20:17:59.739529 | 0bc1f99c-11a8-4753-bf36-bca4bff4bdb2 ==============================
[0m20:17:59.739529 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m20:17:59.739769 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'write_json': 'True', 'invocation_command': 'dbt run --select tmp_airports_llm', 'use_colors': 'True', 'warn_error': 'None', 'empty': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'target_path': 'None', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager'}
[0m20:18:00.603019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bc1f99c-11a8-4753-bf36-bca4bff4bdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fccc30>]}
[0m20:18:00.622296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bc1f99c-11a8-4753-bf36-bca4bff4bdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ddbe360>]}
[0m20:18:00.622531 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m20:18:00.698177 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m20:18:00.730787 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:18:00.730988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0bc1f99c-11a8-4753-bf36-bca4bff4bdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dd6bd50>]}
[0m20:18:01.227851 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m20:18:01.231114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bc1f99c-11a8-4753-bf36-bca4bff4bdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ec798b0>]}
[0m20:18:01.260932 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m20:18:01.261699 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m20:18:01.267584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bc1f99c-11a8-4753-bf36-bca4bff4bdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e8f27b0>]}
[0m20:18:01.267789 [info ] [MainThread]: Found 12 models, 9 data tests, 9 sources, 514 macros
[0m20:18:01.267919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bc1f99c-11a8-4753-bf36-bca4bff4bdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ece5090>]}
[0m20:18:01.268527 [info ] [MainThread]: 
[0m20:18:01.268651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:18:01.268746 [info ] [MainThread]: 
[0m20:18:01.268928 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:18:01.269253 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m20:18:01.269399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:01.751804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m20:18:01.752332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:02.111851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m20:18:02.112711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:02.490568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m20:18:02.492121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:02.854977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bc1f99c-11a8-4753-bf36-bca4bff4bdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fcd1610>]}
[0m20:18:02.855998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:02.859800 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airports_llm
[0m20:18:02.860281 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airports_llm ............... [RUN]
[0m20:18:02.860635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airports_llm)
[0m20:18:02.860914 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airports_llm
[0m20:18:02.867649 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airports_llm"
[0m20:18:02.868319 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airports_llm
[0m20:18:02.891794 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airports_llm"
[0m20:18:02.892374 [debug] [Thread-1 (]: On model.air_travel.tmp_airports_llm: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airports_llm"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airports_llm`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airports_llm as (
    select
      name,
      country,
      iata,
      AI.GENERATE(
        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'icao STRING, state_prov STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
    where iata is not null
  )
select name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov
from tmp_airports_llm
    );
  
[0m20:18:02.892606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:03.690642 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:580906c9-5840-468f-aafb-7f1c1c258926&page=queryresults
[0m20:48:22.789490 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airports_llm"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airports_llm`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airports_llm as (
    select
      name,
      country,
      iata,
      AI.GENERATE(
        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'icao STRING, state_prov STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
    where iata is not null
  )
select name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov
from tmp_airports_llm
    );
  
[0m20:48:22.791463 [debug] [Thread-1 (]: BigQuery adapter: 499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/580906c9-5840-468f-aafb-7f1c1c258926?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: Job timed out after 30 min 0 sec

Location: us-central1
Job ID: 580906c9-5840-468f-aafb-7f1c1c258926

[0m20:48:22.804567 [debug] [Thread-1 (]: Database Error in model tmp_airports_llm (models/tmp/tmp_airports_llm.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/580906c9-5840-468f-aafb-7f1c1c258926?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: Job timed out after 30 min 0 sec
  
  Location: us-central1
  Job ID: 580906c9-5840-468f-aafb-7f1c1c258926
  
  compiled code at target/run/air_travel/models/tmp/tmp_airports_llm.sql
[0m20:48:22.806239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bc1f99c-11a8-4753-bf36-bca4bff4bdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fee5a70>]}
[0m20:48:22.806797 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airports_llm ...... [[31mERROR[0m in 1819.94s]
[0m20:48:22.807239 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airports_llm
[0m20:48:22.807703 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airports_llm' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airports_llm (models/tmp/tmp_airports_llm.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/580906c9-5840-468f-aafb-7f1c1c258926?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: Job timed out after 30 min 0 sec
  
  Location: us-central1
  Job ID: 580906c9-5840-468f-aafb-7f1c1c258926
  
  compiled code at target/run/air_travel/models/tmp/tmp_airports_llm.sql.
[0m20:48:22.809234 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:48:22.810501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:22.810691 [debug] [MainThread]: Connection 'model.air_travel.tmp_airports_llm' was properly closed.
[0m20:48:22.810886 [info ] [MainThread]: 
[0m20:48:22.811098 [info ] [MainThread]: Finished running 1 table model in 0 hours 30 minutes and 21.54 seconds (1821.54s).
[0m20:48:22.811553 [debug] [MainThread]: Command end result
[0m20:48:22.830259 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m20:48:22.831108 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m20:48:22.833180 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m20:48:22.833307 [info ] [MainThread]: 
[0m20:48:22.833445 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:48:22.833573 [info ] [MainThread]: 
[0m20:48:22.833704 [error] [MainThread]: [31mFailure in model tmp_airports_llm (models/tmp/tmp_airports_llm.sql)[0m
[0m20:48:22.833837 [error] [MainThread]:   Database Error in model tmp_airports_llm (models/tmp/tmp_airports_llm.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/580906c9-5840-468f-aafb-7f1c1c258926?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: Job timed out after 30 min 0 sec
  
  Location: us-central1
  Job ID: 580906c9-5840-468f-aafb-7f1c1c258926
  
  compiled code at target/run/air_travel/models/tmp/tmp_airports_llm.sql
[0m20:48:22.833944 [info ] [MainThread]: 
[0m20:48:22.834056 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airports_llm.sql
[0m20:48:22.834144 [info ] [MainThread]: 
[0m20:48:22.834255 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:48:22.835880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1823.0905, "process_in_blocks": "0", "process_kernel_time": 0.612308, "process_mem_max_rss": "395313152", "process_out_blocks": "0", "process_user_time": 3.798451}
[0m20:48:22.836024 [debug] [MainThread]: Command `dbt run` failed at 20:48:22.835995 after 1823.09 seconds
[0m20:48:22.836149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fe9d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fce31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f74950>]}
[0m20:48:22.836261 [debug] [MainThread]: Flushing usage events
[0m20:48:23.149102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:03:25.860737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e246e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6f750>]}


============================== 21:03:25.862393 | 989a41db-d70f-405e-905e-438e8bde3907 ==============================
[0m21:03:25.862393 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m21:03:25.862648 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'log_format': 'default', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'introspect': 'True', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select tmp_airports_llm', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'no_print': 'None'}
[0m21:03:26.697642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '989a41db-d70f-405e-905e-438e8bde3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc8c30>]}
[0m21:03:26.716635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '989a41db-d70f-405e-905e-438e8bde3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eebe360>]}
[0m21:03:26.716870 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:03:26.794065 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m21:03:26.831397 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:03:26.831669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '989a41db-d70f-405e-905e-438e8bde3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ee6bd50>]}
[0m21:03:27.358408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m21:03:27.361931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '989a41db-d70f-405e-905e-438e8bde3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fd758b0>]}
[0m21:03:27.393030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m21:03:27.393793 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m21:03:27.399358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '989a41db-d70f-405e-905e-438e8bde3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f9f27b0>]}
[0m21:03:27.399555 [info ] [MainThread]: Found 12 models, 9 data tests, 9 sources, 514 macros
[0m21:03:27.399687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '989a41db-d70f-405e-905e-438e8bde3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fde5090>]}
[0m21:03:27.400295 [info ] [MainThread]: 
[0m21:03:27.400422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:03:27.400521 [info ] [MainThread]: 
[0m21:03:27.400700 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:03:27.401038 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m21:03:27.401201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:27.939108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m21:03:27.939654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:28.342002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m21:03:28.342415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:28.704507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m21:03:28.705486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:29.039429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '989a41db-d70f-405e-905e-438e8bde3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1485b9c10>]}
[0m21:03:29.040263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:29.043738 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airports_llm
[0m21:03:29.044423 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airports_llm ............... [RUN]
[0m21:03:29.044899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airports_llm)
[0m21:03:29.045263 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airports_llm
[0m21:03:29.052353 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airports_llm"
[0m21:03:29.053203 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airports_llm
[0m21:03:29.077741 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airports_llm"
[0m21:03:29.078366 [debug] [Thread-1 (]: On model.air_travel.tmp_airports_llm: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airports_llm"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airports_llm`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airports_llm as (
    select
      name,
      country,
      iata,
      AI.GENERATE(
        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'icao STRING, state_prov STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
    where iata is not null
  )
select name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov
from tmp_airports_llm
    );
  
[0m21:03:29.078621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:29.874793 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:16646051-7555-46ac-b3ad-51d908eac885&page=queryresults
[0m21:36:22.674889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '989a41db-d70f-405e-905e-438e8bde3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1486d9860>]}
[0m21:36:22.675395 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airports_llm .......... [[32mCREATE TABLE (6.9k rows, 453.8 KiB processed)[0m in 1973.63s]
[0m21:36:22.675803 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airports_llm
[0m21:36:22.676601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:22.677622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:22.677799 [debug] [MainThread]: Connection 'model.air_travel.tmp_airports_llm' was properly closed.
[0m21:36:22.677959 [info ] [MainThread]: 
[0m21:36:22.678129 [info ] [MainThread]: Finished running 1 table model in 0 hours 32 minutes and 55.28 seconds (1975.28s).
[0m21:36:22.678491 [debug] [MainThread]: Command end result
[0m21:36:22.693309 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m21:36:22.694310 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m21:36:22.696942 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m21:36:22.697080 [info ] [MainThread]: 
[0m21:36:22.697252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:22.697379 [info ] [MainThread]: 
[0m21:36:22.697521 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:36:22.699319 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1976.9752, "process_in_blocks": "0", "process_kernel_time": 0.665985, "process_mem_max_rss": "407912448", "process_out_blocks": "0", "process_user_time": 4.039611}
[0m21:36:22.699475 [debug] [MainThread]: Command `dbt run` succeeded at 21:36:22.699437 after 1976.98 seconds
[0m21:36:22.699621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f860910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14961ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14806c650>]}
[0m21:36:22.699756 [debug] [MainThread]: Flushing usage events
[0m21:36:23.004365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:59.353577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e73750>]}


============================== 21:43:59.355174 | 6b4b77a0-5820-4620-aedf-71da5b79fd40 ==============================
[0m21:43:59.355174 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m21:43:59.355413 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'invocation_command': 'dbt run --select Airport', 'version_check': 'True', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m21:44:00.171758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b4b77a0-5820-4620-aedf-71da5b79fd40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408cc30>]}
[0m21:44:00.190460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b4b77a0-5820-4620-aedf-71da5b79fd40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13adc2360>]}
[0m21:44:00.190674 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:44:00.264407 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m21:44:00.303624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:44:00.303830 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airport.sql
[0m21:44:00.382759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m21:44:00.387275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b4b77a0-5820-4620-aedf-71da5b79fd40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b52e150>]}
[0m21:44:00.417690 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m21:44:00.418559 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m21:44:00.424197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b4b77a0-5820-4620-aedf-71da5b79fd40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13adce8a0>]}
[0m21:44:00.424397 [info ] [MainThread]: Found 13 models, 9 data tests, 9 sources, 514 macros
[0m21:44:00.424525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b4b77a0-5820-4620-aedf-71da5b79fd40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b7d6f90>]}
[0m21:44:00.425142 [info ] [MainThread]: 
[0m21:44:00.425269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:44:00.425368 [info ] [MainThread]: 
[0m21:44:00.425563 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:44:00.425911 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m21:44:00.426097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:00.912871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m21:44:00.913396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:01.280232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m21:44:01.281207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:01.651245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m21:44:01.653012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:02.031779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b4b77a0-5820-4620-aedf-71da5b79fd40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b799b20>]}
[0m21:44:02.032629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:02.037491 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m21:44:02.038078 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m21:44:02.038469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.Airport)
[0m21:44:02.038806 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m21:44:02.045267 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m21:44:02.045968 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m21:44:02.070114 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m21:44:02.070694 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
    select distinct al.llm_icao as icao, a.iata, a.name, a.city, al.llm_state_prov as state_prov, 
        a.country, a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, 
        a.timezone_name, a.type, a.source, 'openflights,llm' as _data_source, a._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airports_llm` al
    on a.name = al.name and a.country = al.country
    where a.iata is not null
    and al.llm_icao is not null
)

select * from Airport
    );
  
[0m21:44:02.070920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:02.767278 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:38071c75-8eba-4768-a12a-bd041daf7524&page=queryresults
[0m21:44:04.544027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b4b77a0-5820-4620-aedf-71da5b79fd40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d60b110>]}
[0m21:44:04.544688 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Airport ................... [[32mCREATE TABLE (4.2k rows, 1.6 MiB processed)[0m in 2.50s]
[0m21:44:04.545175 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m21:44:04.546261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:44:04.547677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:04.547897 [debug] [MainThread]: Connection 'model.air_travel.Airport' was properly closed.
[0m21:44:04.548104 [info ] [MainThread]: 
[0m21:44:04.548319 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m21:44:04.548792 [debug] [MainThread]: Command end result
[0m21:44:04.565213 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m21:44:04.566340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m21:44:04.569432 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m21:44:04.569592 [info ] [MainThread]: 
[0m21:44:04.569782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:44:04.569924 [info ] [MainThread]: 
[0m21:44:04.570080 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:44:04.572469 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.242462, "process_in_blocks": "0", "process_kernel_time": 0.245773, "process_mem_max_rss": "399589376", "process_out_blocks": "0", "process_user_time": 1.744767}
[0m21:44:04.572694 [debug] [MainThread]: Command `dbt run` succeeded at 21:44:04.572650 after 5.24 seconds
[0m21:44:04.572859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d6b1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d6bd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d6bda90>]}
[0m21:44:04.573020 [debug] [MainThread]: Flushing usage events
[0m21:44:04.924207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:38:43.197648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122673750>]}


============================== 08:38:43.199410 | 8ff3d209-7cfd-43e7-8111-7c369736732b ==============================
[0m08:38:43.199410 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m08:38:43.199669 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'target_path': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'quiet': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'printer_width': '80', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select tmp_airport_duplicates'}
[0m08:38:44.078345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ff3d209-7cfd-43e7-8111-7c369736732b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213ccc30>]}
[0m08:38:44.097333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ff3d209-7cfd-43e7-8111-7c369736732b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168fc2360>]}
[0m08:38:44.097536 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m08:38:44.174349 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m08:38:44.216311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:38:44.216526 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_duplicates.sql
[0m08:38:44.296198 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m08:38:44.300541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ff3d209-7cfd-43e7-8111-7c369736732b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169d2e150>]}
[0m08:38:44.331106 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m08:38:44.331916 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m08:38:44.338945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ff3d209-7cfd-43e7-8111-7c369736732b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168fce8a0>]}
[0m08:38:44.339151 [info ] [MainThread]: Found 14 models, 9 data tests, 9 sources, 514 macros
[0m08:38:44.339284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff3d209-7cfd-43e7-8111-7c369736732b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169fc7070>]}
[0m08:38:44.339915 [info ] [MainThread]: 
[0m08:38:44.340042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:38:44.340135 [info ] [MainThread]: 
[0m08:38:44.340317 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:38:44.340688 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m08:38:44.340850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:44.774059 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_int'
[0m08:38:44.774593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:45.095136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m08:38:45.096125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:45.375088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m08:38:45.376310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:45.659431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff3d209-7cfd-43e7-8111-7c369736732b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dc07a00>]}
[0m08:38:45.660118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:38:45.665400 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates
[0m08:38:45.665976 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_duplicates ......... [RUN]
[0m08:38:45.666339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_duplicates)
[0m08:38:45.666605 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates
[0m08:38:45.672444 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates"
[0m08:38:45.672993 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates
[0m08:38:45.695488 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_duplicates"
[0m08:38:45.696226 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_duplicates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_duplicates"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_duplicates as (
    select * 
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
    where icao in
        (select icao
        from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
        group by icao
        having count(*) > 1)
)

select * from tmp_airport_duplicates
    );
  
[0m08:38:45.696447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:46.508381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d3c6d2b1-bb3e-4021-a653-ac4b0f2f0540&page=queryresults
[0m08:38:48.781158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff3d209-7cfd-43e7-8111-7c369736732b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169fe90d0>]}
[0m08:38:48.781824 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_duplicates .... [[32mCREATE TABLE (1.0k rows, 639.8 KiB processed)[0m in 3.11s]
[0m08:38:48.782296 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates
[0m08:38:48.783331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:38:48.784590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:48.784757 [debug] [MainThread]: Connection 'list_cs378-fa2025' was properly closed.
[0m08:38:48.784903 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_duplicates' was properly closed.
[0m08:38:48.785071 [info ] [MainThread]: 
[0m08:38:48.785252 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m08:38:48.785666 [debug] [MainThread]: Command end result
[0m08:38:48.802113 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m08:38:48.803151 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m08:38:48.806121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m08:38:48.806267 [info ] [MainThread]: 
[0m08:38:48.806444 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:38:48.806571 [info ] [MainThread]: 
[0m08:38:48.806713 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:38:48.808932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.63755, "process_in_blocks": "0", "process_kernel_time": 0.27163, "process_mem_max_rss": "397934592", "process_out_blocks": "0", "process_user_time": 1.737084}
[0m08:38:48.809145 [debug] [MainThread]: Command `dbt run` succeeded at 08:38:48.809099 after 5.64 seconds
[0m08:38:48.809303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dcb1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121367f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dc8c9b0>]}
[0m08:38:48.809460 [debug] [MainThread]: Flushing usage events
[0m08:38:49.032073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:42:13.689516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b906e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049db9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049db750>]}


============================== 08:42:13.691164 | ab361e5c-ff87-4431-b1d6-ae85982d4604 ==============================
[0m08:42:13.691164 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m08:42:13.691406 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'empty': 'False', 'use_colors': 'True', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'write_json': 'True', 'invocation_command': 'dbt run --select tmp_airport_duplicates_embeddings', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'fail_fast': 'False', 'target_path': 'None', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager'}
[0m08:42:14.508105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab361e5c-ff87-4431-b1d6-ae85982d4604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d34c30>]}
[0m08:42:14.526996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab361e5c-ff87-4431-b1d6-ae85982d4604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228be360>]}
[0m08:42:14.527214 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m08:42:14.602402 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m08:42:14.641703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:42:14.641909 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_duplicates_embeddings.sql
[0m08:42:14.721572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m08:42:14.725973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab361e5c-ff87-4431-b1d6-ae85982d4604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f2e150>]}
[0m08:42:14.757161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m08:42:14.757987 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m08:42:14.763548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab361e5c-ff87-4431-b1d6-ae85982d4604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228ce8a0>]}
[0m08:42:14.763745 [info ] [MainThread]: Found 15 models, 9 data tests, 9 sources, 514 macros
[0m08:42:14.763875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab361e5c-ff87-4431-b1d6-ae85982d4604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231bb150>]}
[0m08:42:14.764542 [info ] [MainThread]: 
[0m08:42:14.764669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:42:14.764762 [info ] [MainThread]: 
[0m08:42:14.764944 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:42:14.765318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m08:42:14.765518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:15.209795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m08:42:15.210336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:15.521779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m08:42:15.523315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:15.804040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m08:42:15.805283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:16.085799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab361e5c-ff87-4431-b1d6-ae85982d4604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12319db20>]}
[0m08:42:16.086317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:42:16.089002 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:42:16.089430 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_duplicates_embeddings  [RUN]
[0m08:42:16.089738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_duplicates_embeddings)
[0m08:42:16.089967 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:42:16.094562 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m08:42:16.095082 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:42:16.115399 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m08:42:16.115914 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_duplicates_embeddings: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_duplicates_embeddings"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_duplicates_embeddings as (
  select icao, iata, name, ml_generate_embedding_result as embedding
  from
    ML.GENERATE_EMBEDDING(
      model air_travel_model.embedding_model,
      (select icao, iata, name, concat(icao, ',', iata, ',', name) as content
       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`,
      struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type))
    )
)

select * from tmp_airport_duplicates_embeddings
    );
  
[0m08:42:16.116123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:42:16.406007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ea4e97e5-a8d2-4c9b-9d46-f4b119da6670&page=queryresults
[0m08:42:16.407385 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ea4e97e5-a8d2-4c9b-9d46-f4b119da6670&page=queryresults
[0m08:42:16.421308 [debug] [Thread-1 (]: Database Error in model tmp_airport_duplicates_embeddings (models/tmp/tmp_airport_duplicates_embeddings.sql)
  Syntax error: Unexpected keyword STRUCT at [21:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_duplicates_embeddings.sql
[0m08:42:16.423016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab361e5c-ff87-4431-b1d6-ae85982d4604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12340eed0>]}
[0m08:42:16.423616 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_duplicates_embeddings  [[31mERROR[0m in 0.33s]
[0m08:42:16.424030 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:42:16.424363 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_duplicates_embeddings' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_duplicates_embeddings (models/tmp/tmp_airport_duplicates_embeddings.sql)
  Syntax error: Unexpected keyword STRUCT at [21:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_duplicates_embeddings.sql.
[0m08:42:16.425653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:42:16.426924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:42:16.427151 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_duplicates_embeddings' was properly closed.
[0m08:42:16.427351 [info ] [MainThread]: 
[0m08:42:16.427572 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m08:42:16.428038 [debug] [MainThread]: Command end result
[0m08:42:16.446874 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m08:42:16.447924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m08:42:16.450853 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m08:42:16.450995 [info ] [MainThread]: 
[0m08:42:16.451163 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:42:16.451301 [info ] [MainThread]: 
[0m08:42:16.451469 [error] [MainThread]: [31mFailure in model tmp_airport_duplicates_embeddings (models/tmp/tmp_airport_duplicates_embeddings.sql)[0m
[0m08:42:16.451625 [error] [MainThread]:   Database Error in model tmp_airport_duplicates_embeddings (models/tmp/tmp_airport_duplicates_embeddings.sql)
  Syntax error: Unexpected keyword STRUCT at [21:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_duplicates_embeddings.sql
[0m08:42:16.451742 [info ] [MainThread]: 
[0m08:42:16.451882 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_duplicates_embeddings.sql
[0m08:42:16.451995 [info ] [MainThread]: 
[0m08:42:16.452130 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:42:16.454323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7904015, "process_in_blocks": "0", "process_kernel_time": 0.234809, "process_mem_max_rss": "395739136", "process_out_blocks": "0", "process_user_time": 1.682396}
[0m08:42:16.454544 [debug] [MainThread]: Command `dbt run` failed at 08:42:16.454505 after 2.79 seconds
[0m08:42:16.454721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230ffcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234a14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234a0f50>]}
[0m08:42:16.454885 [debug] [MainThread]: Flushing usage events
[0m08:42:16.668447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:46:13.761375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a73750>]}


============================== 08:46:13.763002 | 15e8b3bb-22a3-4e37-9c59-530cc74d3a65 ==============================
[0m08:46:13.763002 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m08:46:13.763240 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/scohen/.dbt', 'log_cache_events': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --select tmp_airport_duplicates_embeddings', 'empty': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'printer_width': '80', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'static_parser': 'True'}
[0m08:46:14.576551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15e8b3bb-22a3-4e37-9c59-530cc74d3a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ccc30>]}
[0m08:46:14.595470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15e8b3bb-22a3-4e37-9c59-530cc74d3a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fabe360>]}
[0m08:46:14.595675 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m08:46:14.669789 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m08:46:14.709436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:46:14.709723 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_duplicates_embeddings.sql
[0m08:46:14.794515 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m08:46:14.799245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15e8b3bb-22a3-4e37-9c59-530cc74d3a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f02e150>]}
[0m08:46:14.831863 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m08:46:14.832811 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m08:46:14.838929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15e8b3bb-22a3-4e37-9c59-530cc74d3a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12face8a0>]}
[0m08:46:14.839144 [info ] [MainThread]: Found 15 models, 9 data tests, 9 sources, 514 macros
[0m08:46:14.839275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15e8b3bb-22a3-4e37-9c59-530cc74d3a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f2ef150>]}
[0m08:46:14.839953 [info ] [MainThread]: 
[0m08:46:14.840086 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:46:14.840180 [info ] [MainThread]: 
[0m08:46:14.840372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:46:14.840729 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m08:46:14.840890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:15.185425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m08:46:15.185969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:46:15.460632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m08:46:15.462585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:46:15.771099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m08:46:15.771830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:46:16.046858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15e8b3bb-22a3-4e37-9c59-530cc74d3a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f295b20>]}
[0m08:46:16.047840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:46:16.051684 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:46:16.052162 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_duplicates_embeddings  [RUN]
[0m08:46:16.052527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_duplicates_embeddings)
[0m08:46:16.052807 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:46:16.058960 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m08:46:16.059566 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:46:16.083208 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m08:46:16.083755 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_duplicates_embeddings: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_duplicates_embeddings"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_duplicates_embeddings as (
      select icao, iata, name, ml_generate_embedding_result as embedding
      from
      ML.GENERATE_EMBEDDING(
        model air_travel_model.embedding_model,
        (select icao, iata, name, concat(icao, ',', iata, ',', name) as content
        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`,
        struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type)
      )
  )

  select * from tmp_airport_duplicates_embeddings
    );
  
[0m08:46:16.083981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:16.361683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:70bb49b9-6e91-4840-a752-4e4d507ec751&page=queryresults
[0m08:46:16.363150 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:70bb49b9-6e91-4840-a752-4e4d507ec751&page=queryresults
[0m08:46:16.375432 [debug] [Thread-1 (]: Database Error in model tmp_airport_duplicates_embeddings (models/tmp/tmp_airport_duplicates_embeddings.sql)
  Syntax error: Unexpected keyword STRUCT at [21:9]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_duplicates_embeddings.sql
[0m08:46:16.377073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15e8b3bb-22a3-4e37-9c59-530cc74d3a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f2eaed0>]}
[0m08:46:16.377640 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_duplicates_embeddings  [[31mERROR[0m in 0.32s]
[0m08:46:16.378049 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:46:16.378467 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_duplicates_embeddings' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_duplicates_embeddings (models/tmp/tmp_airport_duplicates_embeddings.sql)
  Syntax error: Unexpected keyword STRUCT at [21:9]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_duplicates_embeddings.sql.
[0m08:46:16.379870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:46:16.381221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:46:16.381444 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_duplicates_embeddings' was properly closed.
[0m08:46:16.381653 [info ] [MainThread]: 
[0m08:46:16.381871 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m08:46:16.382312 [debug] [MainThread]: Command end result
[0m08:46:16.401198 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m08:46:16.402238 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m08:46:16.405343 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m08:46:16.405494 [info ] [MainThread]: 
[0m08:46:16.405665 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:46:16.405799 [info ] [MainThread]: 
[0m08:46:16.405971 [error] [MainThread]: [31mFailure in model tmp_airport_duplicates_embeddings (models/tmp/tmp_airport_duplicates_embeddings.sql)[0m
[0m08:46:16.406134 [error] [MainThread]:   Database Error in model tmp_airport_duplicates_embeddings (models/tmp/tmp_airport_duplicates_embeddings.sql)
  Syntax error: Unexpected keyword STRUCT at [21:9]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_duplicates_embeddings.sql
[0m08:46:16.406258 [info ] [MainThread]: 
[0m08:46:16.406401 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_duplicates_embeddings.sql
[0m08:46:16.406517 [info ] [MainThread]: 
[0m08:46:16.406656 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m08:46:16.408877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.670966, "process_in_blocks": "0", "process_kernel_time": 0.230409, "process_mem_max_rss": "386957312", "process_out_blocks": "0", "process_user_time": 1.693328}
[0m08:46:16.409093 [debug] [MainThread]: Command `dbt run` failed at 08:46:16.409050 after 2.67 seconds
[0m08:46:16.409271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1138b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f6954f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f694f50>]}
[0m08:46:16.409435 [debug] [MainThread]: Flushing usage events
[0m08:46:16.618874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:47:08.739010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd7750>]}


============================== 08:47:08.740683 | 86dce5b0-6c43-40d6-a243-218f7915c33c ==============================
[0m08:47:08.740683 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m08:47:08.740932 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run --select tmp_airport_duplicates_embeddings', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/scohen/.dbt', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m08:47:09.558774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86dce5b0-6c43-40d6-a243-218f7915c33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f30c30>]}
[0m08:47:09.578106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86dce5b0-6c43-40d6-a243-218f7915c33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d4be360>]}
[0m08:47:09.578328 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m08:47:09.653434 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m08:47:09.692515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:47:09.692743 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_duplicates_embeddings.sql
[0m08:47:09.772394 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m08:47:09.776824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86dce5b0-6c43-40d6-a243-218f7915c33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e32e150>]}
[0m08:47:09.807291 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m08:47:09.808137 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m08:47:09.814026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86dce5b0-6c43-40d6-a243-218f7915c33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d4ce8a0>]}
[0m08:47:09.814205 [info ] [MainThread]: Found 15 models, 9 data tests, 9 sources, 514 macros
[0m08:47:09.814331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86dce5b0-6c43-40d6-a243-218f7915c33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e5ef150>]}
[0m08:47:09.814965 [info ] [MainThread]: 
[0m08:47:09.815095 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:47:09.815188 [info ] [MainThread]: 
[0m08:47:09.815376 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:47:09.815727 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m08:47:09.815891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:10.207494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m08:47:10.208058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:10.522435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m08:47:10.524146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:11.043152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m08:47:11.044147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:11.322764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86dce5b0-6c43-40d6-a243-218f7915c33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa0fba0>]}
[0m08:47:11.323597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:47:11.328259 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:47:11.328851 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_duplicates_embeddings  [RUN]
[0m08:47:11.329228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_duplicates_embeddings)
[0m08:47:11.329526 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:47:11.335900 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m08:47:11.336590 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:47:11.360039 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m08:47:11.360578 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_duplicates_embeddings: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_duplicates_embeddings"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_duplicates_embeddings as (
      select icao, iata, name, ml_generate_embedding_result as embedding
      from
      ML.GENERATE_EMBEDDING(
        model air_travel_model.embedding_model,
        (select icao, iata, name, concat(icao, ',', iata, ',', name) as content
        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`),
        struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type)
      )
  )

  select * from tmp_airport_duplicates_embeddings
    );
  
[0m08:47:11.360803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:11.939459 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:27b927ba-354c-4cd1-8a25-6a518bde1b0a&page=queryresults
[0m08:47:15.308873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dce5b0-6c43-40d6-a243-218f7915c33c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e5e8e90>]}
[0m08:47:15.309199 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_duplicates_embeddings  [[32mCREATE TABLE (1.0k rows, 34.0 KiB processed)[0m in 3.98s]
[0m08:47:15.309460 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates_embeddings
[0m08:47:15.309989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:47:15.310644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:15.310742 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_duplicates_embeddings' was properly closed.
[0m08:47:15.310846 [info ] [MainThread]: 
[0m08:47:15.310964 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m08:47:15.311209 [debug] [MainThread]: Command end result
[0m08:47:15.321630 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m08:47:15.322381 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m08:47:15.324532 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m08:47:15.324634 [info ] [MainThread]: 
[0m08:47:15.324765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:47:15.324863 [info ] [MainThread]: 
[0m08:47:15.324975 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:47:15.326831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.611772, "process_in_blocks": "0", "process_kernel_time": 0.250986, "process_mem_max_rss": "391888896", "process_out_blocks": "0", "process_user_time": 1.720243}
[0m08:47:15.327014 [debug] [MainThread]: Command `dbt run` succeeded at 08:47:15.326980 after 6.61 seconds
[0m08:47:15.327148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fab9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fac18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fac1450>]}
[0m08:47:15.327273 [debug] [MainThread]: Flushing usage events
[0m08:47:15.522001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:26.593713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072039d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107203750>]}


============================== 08:51:26.595360 | 34a66a4a-c003-43ee-b7ad-201a7cbcba96 ==============================
[0m08:51:26.595360 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m08:51:26.595613 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'no_print': 'None', 'introspect': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select tmp_airport_inference_results', 'empty': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True'}
[0m08:51:27.442857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34a66a4a-c003-43ee-b7ad-201a7cbcba96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655cc30>]}
[0m08:51:27.461677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34a66a4a-c003-43ee-b7ad-201a7cbcba96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d6be360>]}
[0m08:51:27.461884 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m08:51:27.536743 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m08:51:27.576140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:51:27.576344 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_inference_results.sql
[0m08:51:27.655952 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m08:51:27.660346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34a66a4a-c003-43ee-b7ad-201a7cbcba96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e42e150>]}
[0m08:51:27.691198 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m08:51:27.692035 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m08:51:27.697755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34a66a4a-c003-43ee-b7ad-201a7cbcba96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d6ce8a0>]}
[0m08:51:27.697958 [info ] [MainThread]: Found 16 models, 9 data tests, 9 sources, 514 macros
[0m08:51:27.698083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a66a4a-c003-43ee-b7ad-201a7cbcba96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e5fecf0>]}
[0m08:51:27.698669 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:51:27.698873 [debug] [MainThread]: Command end result
[0m08:51:27.709363 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m08:51:27.710057 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m08:51:27.711233 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m08:51:27.712819 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1427487, "process_in_blocks": "0", "process_kernel_time": 0.224227, "process_mem_max_rss": "383254528", "process_out_blocks": "0", "process_user_time": 1.409586}
[0m08:51:27.713006 [debug] [MainThread]: Command `dbt run` succeeded at 08:51:27.712976 after 1.14 seconds
[0m08:51:27.713141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e70bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107108ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e6dcad0>]}
[0m08:51:27.713260 [debug] [MainThread]: Flushing usage events
[0m08:51:27.919761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:53:49.429585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118386e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d73750>]}


============================== 08:53:49.431223 | ae708e24-be9f-485b-8dd1-9a55ccbef660 ==============================
[0m08:53:49.431223 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m08:53:49.431488 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'introspect': 'True', 'static_parser': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select tmp_airport_inference_results', 'fail_fast': 'False', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'no_print': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'log_format': 'default', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80'}
[0m08:53:50.289898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae708e24-be9f-485b-8dd1-9a55ccbef660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bccc30>]}
[0m08:53:50.309248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae708e24-be9f-485b-8dd1-9a55ccbef660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b9be360>]}
[0m08:53:50.309484 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m08:53:50.389461 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m08:53:50.429354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:53:50.429637 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_inference_results.sql
[0m08:53:50.510138 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m08:53:50.514535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae708e24-be9f-485b-8dd1-9a55ccbef660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e332150>]}
[0m08:53:50.545277 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m08:53:50.546133 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m08:53:50.551903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae708e24-be9f-485b-8dd1-9a55ccbef660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b9ce8a0>]}
[0m08:53:50.552076 [info ] [MainThread]: Found 16 models, 9 data tests, 9 sources, 514 macros
[0m08:53:50.552200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae708e24-be9f-485b-8dd1-9a55ccbef660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e3eb150>]}
[0m08:53:50.552831 [info ] [MainThread]: 
[0m08:53:50.552963 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:53:50.553056 [info ] [MainThread]: 
[0m08:53:50.553243 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:53:50.553600 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m08:53:50.553762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:50.921728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m08:53:50.922257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:51.193662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m08:53:51.194924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:51.482487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m08:53:51.484335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:51.782691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae708e24-be9f-485b-8dd1-9a55ccbef660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1703502c0>]}
[0m08:53:51.783264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:51.786914 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results
[0m08:53:51.787377 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_inference_results .. [RUN]
[0m08:53:51.787727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_inference_results)
[0m08:53:51.787987 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results
[0m08:53:51.793689 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results"
[0m08:53:51.794340 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results
[0m08:53:51.817704 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_inference_results"
[0m08:53:51.818265 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_inference_results: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_inference_results"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_inference_results as (
    select icao,
      AI.GENERATE(
        ('What are the iata code and name of the airport that has the icao code of ', icao, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iata STRING, name STRING') as llm_response
    from (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)
)
select icao, llm_response.iata as iata, llm_response.name as name
from tmp_airport_inference_results
    );
  
[0m08:53:51.818491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:52.410235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:03863c65-1ecf-4754-880c-dcc96c41b897&page=queryresults
[0m09:03:50.681952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae708e24-be9f-485b-8dd1-9a55ccbef660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e5e7650>]}
[0m09:03:50.682673 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_inference_results  [[32mCREATE TABLE (417.0 rows, 5.8 KiB processed)[0m in 598.89s]
[0m09:03:50.683127 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results
[0m09:03:50.684214 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:03:50.685502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:03:50.685699 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_inference_results' was properly closed.
[0m09:03:50.685889 [info ] [MainThread]: 
[0m09:03:50.686099 [info ] [MainThread]: Finished running 1 table model in 0 hours 10 minutes and 0.13 seconds (600.13s).
[0m09:03:50.686541 [debug] [MainThread]: Command end result
[0m09:03:50.702605 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:03:50.703688 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:03:50.706810 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:03:50.706994 [info ] [MainThread]: 
[0m09:03:50.707187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:03:50.707325 [info ] [MainThread]: 
[0m09:03:50.707472 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:03:50.709648 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 601.30615, "process_in_blocks": "0", "process_kernel_time": 0.363154, "process_mem_max_rss": "396197888", "process_out_blocks": "0", "process_user_time": 2.195836}
[0m09:03:50.709865 [debug] [MainThread]: Command `dbt run` succeeded at 09:03:50.709827 after 601.31 seconds
[0m09:03:50.710033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x170355c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x170365810>]}
[0m09:03:50.710185 [debug] [MainThread]: Flushing usage events
[0m09:03:50.942476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:06:50.497172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110973750>]}


============================== 09:06:50.498806 | e20ef69a-b2d6-4e9f-81a2-f183ad87bce5 ==============================
[0m09:06:50.498806 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:06:50.499050 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select tmp_airport_inference_results_embeddings', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m09:06:51.315115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e20ef69a-b2d6-4e9f-81a2-f183ad87bce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ccc30>]}
[0m09:06:51.334180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e20ef69a-b2d6-4e9f-81a2-f183ad87bce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e0c2360>]}
[0m09:06:51.334400 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:06:51.408827 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:06:51.448349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:06:51.448567 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_inference_results_embeddings.sql
[0m09:06:51.507716 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.tmp_airport_inference_results_embeddings' (models/tmp/tmp_airport_inference_results_embeddings.sql) depends on a node named 'airport_inference_results' which was not found
[0m09:06:51.509476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0359976, "process_in_blocks": "0", "process_kernel_time": 0.213763, "process_mem_max_rss": "375930880", "process_out_blocks": "0", "process_user_time": 1.298013}
[0m09:06:51.509699 [debug] [MainThread]: Command `dbt run` failed at 09:06:51.509660 after 1.04 seconds
[0m09:06:51.509853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e06b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e06b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ea41e50>]}
[0m09:06:51.509985 [debug] [MainThread]: Flushing usage events
[0m09:06:51.726474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:09.266978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d373750>]}


============================== 09:07:09.268654 | d36083ba-15bb-4536-ade0-f4c4ef67c8cb ==============================
[0m09:07:09.268654 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:07:09.268902 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'printer_width': '80', 'empty': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select tmp_airport_inference_results_embeddings', 'partial_parse': 'True', 'write_json': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_format': 'default', 'indirect_selection': 'eager', 'profiles_dir': '/Users/scohen/.dbt'}
[0m09:07:10.079751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd36083ba-15bb-4536-ade0-f4c4ef67c8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fcc30>]}
[0m09:07:10.098718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd36083ba-15bb-4536-ade0-f4c4ef67c8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169fc2360>]}
[0m09:07:10.098940 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:07:10.172602 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:07:10.211028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:07:10.211232 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_inference_results_embeddings.sql
[0m09:07:10.269026 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.tmp_airport_inference_results_embeddings' (models/tmp/tmp_airport_inference_results_embeddings.sql) depends on a node named 'airport_inference_results' which was not found
[0m09:07:10.270730 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0277594, "process_in_blocks": "0", "process_kernel_time": 0.199097, "process_mem_max_rss": "380780544", "process_out_blocks": "0", "process_user_time": 1.314629}
[0m09:07:10.270956 [debug] [MainThread]: Command `dbt run` failed at 09:07:10.270917 after 1.03 seconds
[0m09:07:10.271107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169f6b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169f6b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b83de50>]}
[0m09:07:10.271239 [debug] [MainThread]: Flushing usage events
[0m09:07:10.465163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:25.491498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad7750>]}


============================== 09:07:25.493272 | 7edc1380-2548-4911-ac2e-90b91f340df1 ==============================
[0m09:07:25.493272 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:07:25.493521 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'empty': 'False', 'warn_error': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select tmp_airport_inference_results_embeddings', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'no_print': 'None', 'introspect': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m09:07:26.299310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7edc1380-2548-4911-ac2e-90b91f340df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e30c30>]}
[0m09:07:26.318496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7edc1380-2548-4911-ac2e-90b91f340df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cabe360>]}
[0m09:07:26.318725 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:07:26.393241 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:07:26.431789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:07:26.431996 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_inference_results_embeddings.sql
[0m09:07:26.511032 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:07:26.515463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7edc1380-2548-4911-ac2e-90b91f340df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d232150>]}
[0m09:07:26.546726 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:07:26.547620 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:07:26.553489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7edc1380-2548-4911-ac2e-90b91f340df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cace8a0>]}
[0m09:07:26.553672 [info ] [MainThread]: Found 17 models, 9 data tests, 9 sources, 514 macros
[0m09:07:26.553802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7edc1380-2548-4911-ac2e-90b91f340df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d3ff150>]}
[0m09:07:26.554483 [info ] [MainThread]: 
[0m09:07:26.554620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:07:26.554713 [info ] [MainThread]: 
[0m09:07:26.554900 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:07:26.555247 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:07:26.555411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:26.942809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:07:26.943356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:27.238052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:07:27.239856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:27.559702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:07:27.560637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:27.863480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7edc1380-2548-4911-ac2e-90b91f340df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d49dbf0>]}
[0m09:07:27.864334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:07:27.868606 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results_embeddings
[0m09:07:27.869220 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_inference_results_embeddings  [RUN]
[0m09:07:27.869604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_inference_results_embeddings)
[0m09:07:27.869900 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results_embeddings
[0m09:07:27.876395 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results_embeddings"
[0m09:07:27.877067 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results_embeddings
[0m09:07:27.901111 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_inference_results_embeddings"
[0m09:07:27.901736 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_inference_results_embeddings: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_inference_results_embeddings"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results_embeddings`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_inference_results_embeddings as (
  select icao, iata, name, ml_generate_embedding_result as embedding
  from
    ML.GENERATE_EMBEDDING(
      model air_travel_model.embedding_model,
      (select icao, iata, name, concat(icao, ',', iata, ',', name) as content
       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results`
       where iata is not null
       and name != 'Unknown'),
       struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type)
    )
)

select * from tmp_airport_inference_results_embeddings
    );
  
[0m09:07:27.901979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:28.446269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ce1aa2e6-9adc-4608-b394-7142089875c9&page=queryresults
[0m09:07:33.119450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edc1380-2548-4911-ac2e-90b91f340df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d4cb890>]}
[0m09:07:33.119994 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_inference_results_embeddings  [[32mCREATE TABLE (97.0 rows, 5.0 KiB processed)[0m in 5.25s]
[0m09:07:33.120395 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results_embeddings
[0m09:07:33.121247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:07:33.122297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:33.122469 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_inference_results_embeddings' was properly closed.
[0m09:07:33.122632 [info ] [MainThread]: 
[0m09:07:33.122814 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m09:07:33.123178 [debug] [MainThread]: Command end result
[0m09:07:33.138658 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:07:33.139707 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:07:33.142630 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:07:33.142778 [info ] [MainThread]: 
[0m09:07:33.142955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:07:33.143094 [info ] [MainThread]: 
[0m09:07:33.143247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:07:33.145421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6782107, "process_in_blocks": "0", "process_kernel_time": 0.231361, "process_mem_max_rss": "392724480", "process_out_blocks": "0", "process_user_time": 1.721461}
[0m09:07:33.145634 [debug] [MainThread]: Command `dbt run` succeeded at 09:07:33.145594 after 7.68 seconds
[0m09:07:33.145800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e0adc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104415810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e0889b0>]}
[0m09:07:33.145949 [debug] [MainThread]: Flushing usage events
[0m09:07:33.331745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:17:17.688162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111573750>]}


============================== 09:17:17.689723 | aea6e409-b3e5-429e-9427-bc5103f95316 ==============================
[0m09:17:17.689723 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:17:17.689966 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --full-refresh --select tmp_airport_llm', 'version_check': 'True', 'partial_parse': 'True', 'empty': 'False'}
[0m09:17:18.504263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aea6e409-b3e5-429e-9427-bc5103f95316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cccc30>]}
[0m09:17:18.522963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aea6e409-b3e5-429e-9427-bc5103f95316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156ec2360>]}
[0m09:17:18.523164 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:17:18.597601 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:17:18.637022 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m09:17:18.637226 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_llm.sql
[0m09:17:18.637406 [debug] [MainThread]: Partial parsing: deleted file: air_travel://models/tmp/tmp_airports_llm.sql
[0m09:17:18.637507 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport.sql
[0m09:17:18.720721 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:17:18.725151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aea6e409-b3e5-429e-9427-bc5103f95316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157532150>]}
[0m09:17:18.755910 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:17:18.756786 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:17:18.762610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aea6e409-b3e5-429e-9427-bc5103f95316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156ece8a0>]}
[0m09:17:18.762800 [info ] [MainThread]: Found 17 models, 9 data tests, 9 sources, 514 macros
[0m09:17:18.762921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea6e409-b3e5-429e-9427-bc5103f95316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1577a2510>]}
[0m09:17:18.763563 [info ] [MainThread]: 
[0m09:17:18.763692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:17:18.763786 [info ] [MainThread]: 
[0m09:17:18.763973 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:17:18.764330 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:17:18.764518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:19.123314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:17:19.123838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:17:19.393923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:17:19.395916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:17:19.678492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:17:19.680267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:17:19.953743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea6e409-b3e5-429e-9427-bc5103f95316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159413930>]}
[0m09:17:19.954581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:17:19.959320 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_llm
[0m09:17:19.960072 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_llm ................ [RUN]
[0m09:17:19.960558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_llm)
[0m09:17:19.960906 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_llm
[0m09:17:19.967478 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_llm"
[0m09:17:19.968171 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_llm
[0m09:17:19.980550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:17:20.321183 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_llm"
[0m09:17:20.321849 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_llm: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_llm"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airports_llm as (
    select
      name,
      country,
      iata,
      AI.GENERATE(
        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'icao STRING, state_prov STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
    where iata is not null
  )
select name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov
from tmp_airports_llm
    );
  
[0m09:17:20.863612 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:400cf2a7-62de-4c5e-bd6a-eb84b88cf3c4&page=queryresults
[0m09:26:08.820378 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:26:09.457973 [error] [MainThread]: CANCEL query model.air_travel.tmp_airport_llm .................................. [[31mCANCEL[0m]
[0m09:26:09.458747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:26:12.765254 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_llm"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airports_llm as (
    select
      name,
      country,
      iata,
      AI.GENERATE(
        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'icao STRING, state_prov STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
    where iata is not null
  )
select name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov
from tmp_airports_llm
    );
  
[0m09:26:12.766442 [debug] [Thread-1 (]: BigQuery adapter: 499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/400cf2a7-62de-4c5e-bd6a-eb84b88cf3c4?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: User requested cancellation

Location: us-central1
Job ID: 400cf2a7-62de-4c5e-bd6a-eb84b88cf3c4

[0m09:26:12.776411 [debug] [Thread-1 (]: Database Error in model tmp_airport_llm (models/tmp/tmp_airport_llm.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/400cf2a7-62de-4c5e-bd6a-eb84b88cf3c4?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: User requested cancellation
  
  Location: us-central1
  Job ID: 400cf2a7-62de-4c5e-bd6a-eb84b88cf3c4
  
  compiled code at target/run/air_travel/models/tmp/tmp_airport_llm.sql
[0m09:26:12.778195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea6e409-b3e5-429e-9427-bc5103f95316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1594571d0>]}
[0m09:26:12.778857 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_llm ....... [[31mERROR[0m in 532.82s]
[0m09:26:12.779347 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_llm
[0m09:26:12.779715 [info ] [MainThread]: 
[0m09:26:12.780105 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m09:26:12.780340 [info ] [MainThread]: 
[0m09:26:12.780583 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m09:26:12.780803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:26:12.780980 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_llm' was properly closed.
[0m09:26:12.781159 [info ] [MainThread]: 
[0m09:26:12.781364 [info ] [MainThread]: Finished running  in 0 hours 8 minutes and 54.02 seconds (534.02s).
[0m09:26:12.781676 [error] [MainThread]: Encountered an error:

[0m09:26:12.783583 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 587, in run
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 604, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 541, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 421, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 348, in run_queue
    self.job_queue.join()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 105, in join
    self.all_tasks_done.wait()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

[0m09:26:12.787356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 535.12616, "process_in_blocks": "0", "process_kernel_time": 0.318856, "process_mem_max_rss": "389562368", "process_out_blocks": "0", "process_user_time": 2.073662}
[0m09:26:12.787745 [debug] [MainThread]: Command `dbt run` failed at 09:26:12.787665 after 535.13 seconds
[0m09:26:12.787985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1594b9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1594a0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1594a02d0>]}
[0m09:26:12.788210 [debug] [MainThread]: Flushing usage events
[0m09:26:13.027736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:23.540465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106473750>]}


============================== 09:49:23.542065 | 7fc21e81-f40d-4425-a291-ba84250bc4d8 ==============================
[0m09:49:23.542065 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:49:23.542311 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'cache_selected_only': 'False', 'log_format': 'default', 'fail_fast': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m09:49:24.402975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc21e81-f40d-4425-a291-ba84250bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104accc30>]}
[0m09:49:24.422286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fc21e81-f40d-4425-a291-ba84250bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135ec2360>]}
[0m09:49:24.422566 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:49:24.500918 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:49:24.541536 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 5 files added, 3 files changed.
[0m09:49:24.541799 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_all.sql
[0m09:49:24.541909 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_refined.sql
[0m09:49:24.542003 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_country_iso_codes.sql
[0m09:49:24.542094 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_vector_search_results.sql
[0m09:49:24.542184 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_country_iso_codes.sql
[0m09:49:24.542286 [debug] [MainThread]: Partial parsing: deleted file: air_travel://models/tmp/tmp_countries_iso_codes.sql
[0m09:49:24.542407 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_llm.sql
[0m09:49:24.542539 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport.sql
[0m09:49:24.542650 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Country.sql
[0m09:49:24.630550 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:49:24.635555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fc21e81-f40d-4425-a291-ba84250bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136432150>]}
[0m09:49:24.667952 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:49:24.668894 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:49:24.674092 [error] [MainThread]: Encountered an error:
Found a cycle: model.air_travel.tmp_airport_refined --> model.air_travel.tmp_airport_country_iso_codes --> model.air_travel.Airport --> model.air_travel.tmp_airport_duplicates --> model.air_travel.tmp_airport_duplicates_embeddings --> model.air_travel.tmp_airport_vector_search_results
[0m09:49:24.676018 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 587, in run
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 588, in run
    self._runtime_initialize()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/compilation.py", line 666, in compile
    linker.link_graph(manifest)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/compilation.py", line 210, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.air_travel.tmp_airport_refined --> model.air_travel.tmp_airport_country_iso_codes --> model.air_travel.Airport --> model.air_travel.tmp_airport_duplicates --> model.air_travel.tmp_airport_duplicates_embeddings --> model.air_travel.tmp_airport_vector_search_results

[0m09:49:24.677776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1608843, "process_in_blocks": "0", "process_kernel_time": 0.231897, "process_mem_max_rss": "380731392", "process_out_blocks": "0", "process_user_time": 1.415623}
[0m09:49:24.678049 [debug] [MainThread]: Command `dbt run` failed at 09:49:24.678011 after 1.16 seconds
[0m09:49:24.678207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1373dc320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1373dc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647be70>]}
[0m09:49:24.678341 [debug] [MainThread]: Flushing usage events
[0m09:49:24.880790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:55.412385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076179d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107617750>]}


============================== 11:01:55.414081 | 0eaf3517-1ba5-4bd6-bb8b-92459e446fae ==============================
[0m11:01:55.414081 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:01:55.414317 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_format': 'default', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --full-refresh', 'empty': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'no_print': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'partial_parse': 'True'}
[0m11:01:56.232105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0eaf3517-1ba5-4bd6-bb8b-92459e446fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106970c30>]}
[0m11:01:56.250894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0eaf3517-1ba5-4bd6-bb8b-92459e446fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d5be360>]}
[0m11:01:56.251103 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:01:56.325786 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:01:56.365416 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m11:01:56.365726 [debug] [MainThread]: Partial parsing: deleted file: air_travel://models/int/Airport.sql
[0m11:01:56.430015 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.tmp_airport_duplicates' (models/tmp/tmp_airport_duplicates.sql) depends on a node named 'Airport' which was not found
[0m11:01:56.431820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0465516, "process_in_blocks": "0", "process_kernel_time": 0.216939, "process_mem_max_rss": "375996416", "process_out_blocks": "0", "process_user_time": 1.312794}
[0m11:01:56.432054 [debug] [MainThread]: Command `dbt run` failed at 11:01:56.432008 after 1.05 seconds
[0m11:01:56.432239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d56b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12db32350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dd6dd60>]}
[0m11:01:56.432386 [debug] [MainThread]: Flushing usage events
[0m11:01:56.661732 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:30.415226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112073750>]}


============================== 11:02:30.416841 | 583cc9e8-ba2c-49c0-9a27-e2e8e32d8865 ==============================
[0m11:02:30.416841 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:02:30.417117 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --full-refresh', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'empty': 'False', 'quiet': 'False', 'introspect': 'True', 'warn_error': 'None', 'partial_parse': 'True'}
[0m11:02:31.223812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ccc30>]}
[0m11:02:31.243326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f9be360>]}
[0m11:02:31.243607 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:02:31.316989 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:02:31.355508 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m11:02:31.355821 [debug] [MainThread]: Partial parsing: deleted file: air_travel://models/int/Airport.sql
[0m11:02:31.355935 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_duplicates.sql
[0m11:02:31.440057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:02:31.444521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151236150>]}
[0m11:02:31.476013 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:02:31.476839 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:02:31.482751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151283110>]}
[0m11:02:31.482934 [info ] [MainThread]: Found 20 models, 9 data tests, 9 sources, 514 macros
[0m11:02:31.483061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1514aa970>]}
[0m11:02:31.483997 [info ] [MainThread]: 
[0m11:02:31.484127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:31.484226 [info ] [MainThread]: 
[0m11:02:31.484402 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:02:31.486122 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:02:31.486290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:31.940974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:32.290623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:32.618716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:02:32.619156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:33.043519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:02:33.045440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:33.378255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:02:33.379390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:33.687275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15321fba0>]}
[0m11:02:33.688103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:33.692500 [debug] [Thread-1 (]: Began running node model.air_travel.aircrafts
[0m11:02:33.693127 [info ] [Thread-1 (]: 1 of 20 START sql table model dbt_air_travel_stg.aircrafts ..................... [RUN]
[0m11:02:33.693539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.aircrafts)
[0m11:02:33.693830 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircrafts
[0m11:02:33.700077 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircrafts"
[0m11:02:33.701699 [debug] [Thread-1 (]: Began executing node model.air_travel.aircrafts
[0m11:02:33.714333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:34.004599 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.aircrafts"
[0m11:02:34.005257 [debug] [Thread-1 (]: On model.air_travel.aircrafts: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.aircrafts"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
      
    
    

    
    OPTIONS()
    as (
      with stg_aircrafts as (
    select aircraft_name as name,
        case iata_code when '\\N' then null else iata_code end as iata,
        case icao_code when '\\N' then null else icao_code end as icao,
        _data_source,
        _load_time
  from `cs378-fa2025`.`air_travel_raw`.`aircrafts`
)

select * from stg_aircrafts
    );
  
[0m11:02:34.496686 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1a7e910a-a1f6-4468-a3f8-ba3120fc2ef3&page=queryresults
[0m11:02:38.291400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15322f7d0>]}
[0m11:02:38.291833 [info ] [Thread-1 (]: 1 of 20 OK created sql table model dbt_air_travel_stg.aircrafts ................ [[32mCREATE TABLE (246.0 rows, 12.5 KiB processed)[0m in 4.60s]
[0m11:02:38.292181 [debug] [Thread-1 (]: Finished running node model.air_travel.aircrafts
[0m11:02:38.292385 [debug] [Thread-1 (]: Began running node model.air_travel.airlines
[0m11:02:38.292678 [info ] [Thread-1 (]: 2 of 20 START sql table model dbt_air_travel_stg.airlines ...................... [RUN]
[0m11:02:38.292964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircrafts, now model.air_travel.airlines)
[0m11:02:38.293154 [debug] [Thread-1 (]: Began compiling node model.air_travel.airlines
[0m11:02:38.294494 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airlines"
[0m11:02:38.295109 [debug] [Thread-1 (]: Began executing node model.air_travel.airlines
[0m11:02:38.296297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:38.579766 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airlines"
[0m11:02:38.583000 [debug] [Thread-1 (]: On model.air_travel.airlines: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airlines"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
      
    
    

    
    OPTIONS()
    as (
      with stg_airlines as (
  select airline_id as id,
    name,
    case alias
        when '\\N' then null
        else alias
        end as alias,
    case iata
        when '' then null
        else iata
        end as iata,
    case icao
        when '' then null
        else icao
        end as icao,
    case callsign
        when '\\N' then null
        else callsign
        end as callsign,
    case country
        when '\\N' then null
        else country end as country,
    active, _data_source, _load_time
  from `cs378-fa2025`.`air_travel_raw`.`airlines`
)

select * from stg_airlines
    );
  
[0m11:02:39.001635 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:704449af-4f80-416e-8649-6ddc9ffd8477&page=queryresults
[0m11:02:41.259866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1532b5c80>]}
[0m11:02:41.260908 [info ] [Thread-1 (]: 2 of 20 OK created sql table model dbt_air_travel_stg.airlines ................. [[32mCREATE TABLE (6.2k rows, 489.7 KiB processed)[0m in 2.97s]
[0m11:02:41.261549 [debug] [Thread-1 (]: Finished running node model.air_travel.airlines
[0m11:02:41.261952 [debug] [Thread-1 (]: Began running node model.air_travel.airport_maps
[0m11:02:41.262507 [info ] [Thread-1 (]: 3 of 20 START sql table model dbt_air_travel_stg.airport_maps .................. [RUN]
[0m11:02:41.263071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airlines, now model.air_travel.airport_maps)
[0m11:02:41.263462 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_maps
[0m11:02:41.265995 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_maps"
[0m11:02:41.266778 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_maps
[0m11:02:41.268485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:41.564572 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airport_maps"
[0m11:02:41.566995 [debug] [Thread-1 (]: On model.air_travel.airport_maps: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airport_maps"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
      
    
    

    
    OPTIONS()
    as (
      with stg_airport_maps as (
  select airport, terminal, business,
      case category
        when 'Airline Services' then 'Airline Service'
        when 'Airline Services' then 'Airline Service'
        when 'Cafe' then 'Coffee Shop'
        when 'Financial Services' then 'Financial Service'
        when 'Retail/Dining' then 'Retail / Dining'
        when 'Things To Do' then 'Things to Do'
        when 'Transportation' then 'Transportation Service'
        when 'Vending' then 'Vending Machine'
        when 'Service' then 'Services'
        else category end as category,
      location, dining, menu_items, _data_source, _load_time
    from `cs378-fa2025`.`air_travel_raw`.`airport_maps`
)

select * from stg_airport_maps
    );
  
[0m11:02:41.972537 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:bf5a1ee2-438c-41ff-879a-8e51cda4eec7&page=queryresults
[0m11:02:44.046742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155c177f0>]}
[0m11:02:44.047579 [info ] [Thread-1 (]: 3 of 20 OK created sql table model dbt_air_travel_stg.airport_maps ............. [[32mCREATE TABLE (1.5k rows, 163.3 KiB processed)[0m in 2.78s]
[0m11:02:44.048092 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_maps
[0m11:02:44.048406 [debug] [Thread-1 (]: Began running node model.air_travel.airport_reviews
[0m11:02:44.048860 [info ] [Thread-1 (]: 4 of 20 START sql table model dbt_air_travel_stg.airport_reviews ............... [RUN]
[0m11:02:44.049303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_maps, now model.air_travel.airport_reviews)
[0m11:02:44.049612 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_reviews
[0m11:02:44.051974 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_reviews"
[0m11:02:44.052661 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_reviews
[0m11:02:44.054046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:44.356330 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airport_reviews"
[0m11:02:44.358555 [debug] [Thread-1 (]: On model.air_travel.airport_reviews: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airport_reviews"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`
      
    
    

    
    OPTIONS()
    as (
      with stg_airport_reviews as (
	select id,
	    safe_cast(threadRef as INTEGER) as review_thread,
	    airportRef as airport_id,
	    airportIdent as airport_code,
	    safe_cast(split(date, ' ')[0] as DATE) as review_date,
	    memberNickname as review_author,
	    subject as review_subject,
	    body as review_details,
	    broad_category,
        sub_category,
        sentiment,
        language,
	    _data_source,
	    _load_time
	from `cs378-fa2025`.`air_travel_raw`.`airport_reviews`
)

select * from stg_airport_reviews
    );
  
[0m11:02:44.736773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c3cf1fcd-466b-4258-a43c-f30da780a8c8&page=queryresults
[0m11:02:51.060790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1511d00d0>]}
[0m11:02:51.061771 [info ] [Thread-1 (]: 4 of 20 OK created sql table model dbt_air_travel_stg.airport_reviews .......... [[32mCREATE TABLE (14.8k rows, 5.4 MiB processed)[0m in 7.01s]
[0m11:02:51.062375 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_reviews
[0m11:02:51.062756 [debug] [Thread-1 (]: Began running node model.air_travel.airports
[0m11:02:51.063301 [info ] [Thread-1 (]: 5 of 20 START sql table model dbt_air_travel_stg.airports ...................... [RUN]
[0m11:02:51.063837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_reviews, now model.air_travel.airports)
[0m11:02:51.064154 [debug] [Thread-1 (]: Began compiling node model.air_travel.airports
[0m11:02:51.067082 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airports"
[0m11:02:51.068009 [debug] [Thread-1 (]: Began executing node model.air_travel.airports
[0m11:02:51.069773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:51.358977 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airports"
[0m11:02:51.360983 [debug] [Thread-1 (]: On model.air_travel.airports: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airports"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
      
    
    

    
    OPTIONS()
    as (
      with stg_airports as (
	select safe_cast(airport_id as INTEGER) as id,
	    airport_name as name,
	    airport_city as city,
	    airport_country as country,
	    case iata
		    when '\\N' then null
		    else iata
		    end as iata,
	    case icao
		    when '\\N' then null
		    else icao
		    end as icao,
	    latitude,
	    longitude,
	    altitude,
	    safe_cast(timezone as INTEGER) as timezone_delta,
        daylight_savings_time,
        case tz_database_timezone
		    when '\\N' then null
		    else tz_database_timezone
		    end as timezone_name,
	    case type
		    when '\\N' then null
		    else type
		    end as type,
	    case source
		    when '\\N' then null
		    else source
		    end as source,
	    _data_source,
	    _load_time
	from `cs378-fa2025`.`air_travel_raw`.`airports`    
)

select * from stg_airports
    );
  
[0m11:02:51.705645 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d7288b3f-295c-466b-92d5-f244164727b3&page=queryresults
[0m11:02:54.079371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15328d630>]}
[0m11:02:54.080326 [info ] [Thread-1 (]: 5 of 20 OK created sql table model dbt_air_travel_stg.airports ................. [[32mCREATE TABLE (12.7k rows, 1.7 MiB processed)[0m in 3.02s]
[0m11:02:54.080940 [debug] [Thread-1 (]: Finished running node model.air_travel.airports
[0m11:02:54.081337 [debug] [Thread-1 (]: Began running node model.air_travel.countries
[0m11:02:54.081829 [info ] [Thread-1 (]: 6 of 20 START sql table model dbt_air_travel_stg.countries ..................... [RUN]
[0m11:02:54.082371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airports, now model.air_travel.countries)
[0m11:02:54.082848 [debug] [Thread-1 (]: Began compiling node model.air_travel.countries
[0m11:02:54.085371 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.countries"
[0m11:02:54.086171 [debug] [Thread-1 (]: Began executing node model.air_travel.countries
[0m11:02:54.087750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:54.379470 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.countries"
[0m11:02:54.380936 [debug] [Thread-1 (]: On model.air_travel.countries: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.countries"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
      
    
    

    
    OPTIONS()
    as (
      with stg_countries as (
    select country_name as name,
    case iso_code
      when '\\N' then null
      else iso_code
      end as iso_code,
    dafif_code,
    _data_source,
    _load_time
    from `cs378-fa2025`.`air_travel_raw`.`countries`
)

select * from stg_countries
    );
  
[0m11:02:54.771548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3b0208a6-befa-48b1-980f-beef302a87ff&page=queryresults
[0m11:02:56.897520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155b9bd70>]}
[0m11:02:56.898766 [info ] [Thread-1 (]: 6 of 20 OK created sql table model dbt_air_travel_stg.countries ................ [[32mCREATE TABLE (261.0 rows, 10.5 KiB processed)[0m in 2.82s]
[0m11:02:56.899618 [debug] [Thread-1 (]: Finished running node model.air_travel.countries
[0m11:02:56.900025 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m11:02:56.900642 [info ] [Thread-1 (]: 7 of 20 START sql table model dbt_air_travel_stg.flight_delays ................. [RUN]
[0m11:02:56.901269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.countries, now model.air_travel.flight_delays)
[0m11:02:56.901643 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m11:02:56.904276 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m11:02:56.906544 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m11:02:56.908356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:57.169167 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_delays"
[0m11:02:57.169899 [debug] [Thread-1 (]: On model.air_travel.flight_delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_delays as (
    select event_month, carrier, carrier_name, airport_code,
        split(city_state, ',')[0] as airport_city, 
        split(city_state, ',')[1] as airport_state,
        airport_name, 
        * except (event_month, carrier, carrier_name, airport_code, airport_name, city_state)
    from
        (select date(year, month, 01) as event_month, 
            carrier, carrier_name, airport as airport_code,
            split(airport_name, ':')[0] as city_state, 
            split(airport_name, ':')[1] as airport_name,
            safe_cast(arr_flights as INTEGER) as arr_total, 
            safe_cast(arr_cancelled as INTEGER) as arr_cancelled,
            safe_cast(arr_diverted as INTEGER) as arr_diverted, 
            safe_cast(arr_delay as INTEGER) as arr_delay_min,
            safe_cast(weather_delay as INTEGER) as weather_delay_min, 
            safe_cast(nas_delay as INTEGER) as nas_delay_min,
            safe_cast(late_aircraft_delay as INTEGER) as late_aircraft_delay_min, 
            _data_source, _load_time
          from `cs378-fa2025`.`air_travel_raw`.`flight_delays`)
)

select * from stg_flight_delays
    );
  
[0m11:02:57.639515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ae88a96d-c0ce-4a3a-b41b-b096160050a7&page=queryresults
[0m11:03:25.825736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ce8bf0>]}
[0m11:03:25.826791 [info ] [Thread-1 (]: 7 of 20 OK created sql table model dbt_air_travel_stg.flight_delays ............ [[32mCREATE TABLE (381.2k rows, 64.1 MiB processed)[0m in 28.92s]
[0m11:03:25.827641 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m11:03:25.828054 [debug] [Thread-1 (]: Began running node model.air_travel.flight_routes
[0m11:03:25.828610 [info ] [Thread-1 (]: 8 of 20 START sql table model dbt_air_travel_stg.flight_routes ................. [RUN]
[0m11:03:25.829151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_delays, now model.air_travel.flight_routes)
[0m11:03:25.829517 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_routes
[0m11:03:25.831650 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_routes"
[0m11:03:25.832251 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_routes
[0m11:03:25.833762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:26.095439 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_routes"
[0m11:03:26.096309 [debug] [Thread-1 (]: On model.air_travel.flight_routes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_routes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_routes as (
  select airline_code,
    safe_cast(airline_id as INTEGER) as airline_id,
    source_airport,
    case source_airport_id
      when '\\N' then null
      else safe_cast(source_airport_id as INTEGER)
      end as source_airport_id,
    dest_airport,
    case dest_airport_id
      when '\\N' then null
      else safe_cast(dest_airport_id as INTEGER)
      end as dest_airport_id,
    codeshare,
    stops,
    equipment,
    _data_source,
    _load_time
  from `cs378-fa2025`.`air_travel_raw`.`flight_routes`
)

select * from stg_flight_routes
    );
  
[0m11:03:26.539831 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:766c7d55-bcf0-436b-bd9c-6b816cb5eb3b&page=queryresults
[0m11:03:28.835865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ce9610>]}
[0m11:03:28.836771 [info ] [Thread-1 (]: 8 of 20 OK created sql table model dbt_air_travel_stg.flight_routes ............ [[32mCREATE TABLE (67.7k rows, 4.4 MiB processed)[0m in 3.01s]
[0m11:03:28.837348 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_routes
[0m11:03:28.837712 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_traffic
[0m11:03:28.838237 [info ] [Thread-1 (]: 9 of 20 START sql table model dbt_air_travel_stg.tsa_traffic ................... [RUN]
[0m11:03:28.838759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_routes, now model.air_travel.tsa_traffic)
[0m11:03:28.839115 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_traffic
[0m11:03:28.841571 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_traffic"
[0m11:03:28.842380 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_traffic
[0m11:03:28.843920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:29.244082 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tsa_traffic"
[0m11:03:29.245881 [debug] [Thread-1 (]: On model.air_travel.tsa_traffic: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tsa_traffic"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`
      
    
    

    
    OPTIONS()
    as (
      with stg_tsa_traffic as (
  select safe_cast(event_date as DATE format 'MM/DD/YYYY') as event_date,
    safe_cast(event_hour as INTEGER) as event_hour,
    airport_code,
    airport_name,
    airport_city,
    airport_state,
    security_checkpoint,
    safe_cast(total_traffic as INTEGER) as total_traffic,
    _data_source,
    _load_time
  from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic`
)

select * from stg_tsa_traffic
    );
  
[0m11:03:29.627283 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:173900ca-d528-47fa-9e8f-0049f8829721&page=queryresults
[0m11:03:31.877528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155cea150>]}
[0m11:03:31.877930 [info ] [Thread-1 (]: 9 of 20 OK created sql table model dbt_air_travel_stg.tsa_traffic .............. [[32mCREATE TABLE (23.4k rows, 2.2 MiB processed)[0m in 3.04s]
[0m11:03:31.878231 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_traffic
[0m11:03:31.878418 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_llm
[0m11:03:31.878701 [info ] [Thread-1 (]: 10 of 20 START sql table model dbt_air_travel_tmp.tmp_airport_llm .............. [RUN]
[0m11:03:31.878977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tsa_traffic, now model.air_travel.tmp_airport_llm)
[0m11:03:31.879165 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_llm
[0m11:03:31.880585 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_llm"
[0m11:03:31.881010 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_llm
[0m11:03:31.881917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:32.205558 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_llm"
[0m11:03:32.206353 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_llm: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_llm"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_llm as (
    select
      name,
      country,
      iata,
      AI.GENERATE(
        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'icao STRING, state_prov STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
    where iata is not null
  )
select name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov
from tmp_airport_llm
    );
  
[0m11:03:32.562436 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a2f09a4e-03bb-4e26-9438-e8dee2f30909&page=queryresults
[0m11:44:01.619814 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a2f09a4e-03bb-4e26-9438-e8dee2f30909&page=queryresults
[0m11:44:01.638577 [debug] [Thread-1 (]: Database Error in model tmp_airport_llm (models/tmp/tmp_airport_llm.sql)
  syntax error while parsing value - invalid string: missing closing quote; last read: '"Marshall Islands}AB2755A5-B0C2-4312-AA5B-767C339CE9DC</event>PKWA is the ICAO code for Bucholz Army Air Field, which is located in the Marshall Islands.The airport, which also has the IATA code KWA, is situated in the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.KWA is an airport code.PKWA is the ICAO code for Bucholz Army Air Field.KWA is an airport code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.'
  compiled code at target/run/air_travel/models/tmp/tmp_airport_llm.sql
[0m11:44:01.640596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155cebd70>]}
[0m11:44:01.641061 [error] [Thread-1 (]: 10 of 20 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_llm ..... [[31mERROR[0m in 2429.76s]
[0m11:44:01.642912 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_llm
[0m11:44:01.643158 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_country_iso_codes
[0m11:44:01.644963 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_llm' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_llm (models/tmp/tmp_airport_llm.sql)
  syntax error while parsing value - invalid string: missing closing quote; last read: '"Marshall Islands}AB2755A5-B0C2-4312-AA5B-767C339CE9DC</event>PKWA is the ICAO code for Bucholz Army Air Field, which is located in the Marshall Islands.The airport, which also has the IATA code KWA, is situated in the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.KWA is an airport code.PKWA is the ICAO code for Bucholz Army Air Field.KWA is an airport code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.'
  compiled code at target/run/air_travel/models/tmp/tmp_airport_llm.sql.
[0m11:44:01.646343 [info ] [Thread-1 (]: 11 of 20 START sql table model dbt_air_travel_tmp.tmp_country_iso_codes ........ [RUN]
[0m11:44:01.647036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_llm, now model.air_travel.tmp_country_iso_codes)
[0m11:44:01.647216 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_country_iso_codes
[0m11:44:01.648327 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_country_iso_codes"
[0m11:44:01.648734 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_country_iso_codes
[0m11:44:01.650017 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_country_iso_codes"
[0m11:44:01.650418 [debug] [Thread-1 (]: On model.air_travel.tmp_country_iso_codes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_country_iso_codes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes`
      
    
    

    
    OPTIONS()
    as (
      with tmp_country_iso_codes as (
    select
      name,
      AI.GENERATE(
        ('What is the iso code for country ', name, '? If it does not have one, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
    where iso_code is null
  )
select name, llm_response.iso_code as mapped_iso_code
from tmp_country_iso_codes
    );
  
[0m11:44:01.650645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:02.441823 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ef889873-f70c-4be0-85fd-a2436143abf3&page=queryresults
[0m11:46:03.810244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ceae10>]}
[0m11:46:03.811223 [info ] [Thread-1 (]: 11 of 20 OK created sql table model dbt_air_travel_tmp.tmp_country_iso_codes ... [[32mCREATE TABLE (20.0 rows, 4.0 KiB processed)[0m in 122.16s]
[0m11:46:03.811836 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_country_iso_codes
[0m11:46:03.812222 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m11:46:03.812654 [info ] [Thread-1 (]: 12 of 20 SKIP relation dbt_air_travel_tmp.tmp_airport_all ...................... [[33mSKIP[0m]
[0m11:46:03.813192 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m11:46:03.813591 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m11:46:03.814044 [info ] [Thread-1 (]: 13 of 20 START sql table model dbt_air_travel_int.Country ...................... [RUN]
[0m11:46:03.814460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_country_iso_codes, now model.air_travel.Country)
[0m11:46:03.814745 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m11:46:03.817348 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m11:46:03.819087 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m11:46:03.820745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:04.154732 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Country"
[0m11:46:04.157379 [debug] [Thread-1 (]: On model.air_travel.Country: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Country"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Country`
      
    
    

    
    OPTIONS()
    as (
      with Country as (
    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` 
    group by iso_code, name, _data_source, _load_time
    where iso_code is not null
)

select *
from Country 
union all
select t.mapped_iso_code, c.name, c.dafif_codes, c._data_source, c._load_time 
from Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes` t 
on c.name = t.name
where t.mapped_iso_code is not null
and c.iso_code is null
    );
  
[0m11:46:04.285012 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:08bee91c-4c49-4ca8-a96c-692caf96421a&page=queryresults
[0m11:46:04.285674 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:08bee91c-4c49-4ca8-a96c-692caf96421a&page=queryresults
[0m11:46:04.292580 [debug] [Thread-1 (]: Database Error in model Country (models/int/Country.sql)
  Syntax error: Expected ")" but got keyword WHERE at [18:5]
  compiled code at target/run/air_travel/models/int/Country.sql
[0m11:46:04.293033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583cc9e8-ba2c-49c0-9a27-e2e8e32d8865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15145d190>]}
[0m11:46:04.293578 [error] [Thread-1 (]: 13 of 20 ERROR creating sql table model dbt_air_travel_int.Country ............. [[31mERROR[0m in 0.48s]
[0m11:46:04.293985 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m11:46:04.294249 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates
[0m11:46:04.294614 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Country' to be skipped because of status 'error'.  Reason: Database Error in model Country (models/int/Country.sql)
  Syntax error: Expected ")" but got keyword WHERE at [18:5]
  compiled code at target/run/air_travel/models/int/Country.sql.
[0m11:46:04.294935 [info ] [Thread-1 (]: 14 of 20 SKIP relation dbt_air_travel_tmp.tmp_airport_duplicates ............... [[33mSKIP[0m]
[0m11:46:04.295341 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates
[0m11:46:04.295844 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates_embeddings
[0m11:46:04.296107 [info ] [Thread-1 (]: 15 of 20 SKIP relation dbt_air_travel_tmp.tmp_airport_duplicates_embeddings .... [[33mSKIP[0m]
[0m11:46:04.296357 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates_embeddings
[0m11:46:04.296559 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results
[0m11:46:04.296798 [info ] [Thread-1 (]: 16 of 20 SKIP relation dbt_air_travel_tmp.tmp_airport_inference_results ........ [[33mSKIP[0m]
[0m11:46:04.297060 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results
[0m11:46:04.297425 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results_embeddings
[0m11:46:04.297842 [info ] [Thread-1 (]: 17 of 20 SKIP relation dbt_air_travel_tmp.tmp_airport_inference_results_embeddings  [[33mSKIP[0m]
[0m11:46:04.298179 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results_embeddings
[0m11:46:04.298487 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_vector_search_results
[0m11:46:04.298771 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbt_air_travel_tmp.tmp_airport_vector_search_results .... [[33mSKIP[0m]
[0m11:46:04.299142 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_vector_search_results
[0m11:46:04.299631 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m11:46:04.299955 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbt_air_travel_tmp.tmp_airport_refined .................. [[33mSKIP[0m]
[0m11:46:04.300287 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m11:46:04.300646 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_iso_codes
[0m11:46:04.300911 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbt_air_travel_tmp.tmp_airport_country_iso_codes ........ [[33mSKIP[0m]
[0m11:46:04.301190 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_iso_codes
[0m11:46:04.301930 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:04.302984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:04.303157 [debug] [MainThread]: Connection 'model.air_travel.Country' was properly closed.
[0m11:46:04.303373 [info ] [MainThread]: 
[0m11:46:04.303564 [info ] [MainThread]: Finished running 20 table models in 0 hours 43 minutes and 32.82 seconds (2612.82s).
[0m11:46:04.306068 [debug] [MainThread]: Command end result
[0m11:46:04.322144 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:46:04.323307 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:46:04.326485 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:46:04.326627 [info ] [MainThread]: 
[0m11:46:04.326779 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:46:04.326905 [info ] [MainThread]: 
[0m11:46:04.327060 [error] [MainThread]: [31mFailure in model tmp_airport_llm (models/tmp/tmp_airport_llm.sql)[0m
[0m11:46:04.328196 [error] [MainThread]:   Database Error in model tmp_airport_llm (models/tmp/tmp_airport_llm.sql)
  syntax error while parsing value - invalid string: missing closing quote; last read: '"Marshall Islands}AB2755A5-B0C2-4312-AA5B-767C339CE9DC</event>PKWA is the ICAO code for Bucholz Army Air Field, which is located in the Marshall Islands.The airport, which also has the IATA code KWA, is situated in the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.KWA is an airport code.PKWA is the ICAO code for Bucholz Army Air Field.KWA is an airport code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.The Marshall Islands is a country.PKWA is the ICAO code for Bucholz Army Air Field.The state/province for Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.Bucholz Army Air Field is an airfield.PKWA is the ICAO code for Bucholz Army Air Field.The country of Bucholz Army Air Field is the Marshall Islands.KWA is the IATA code for Bucholz Army Air Field.PKWA is the ICAO code for Bucholz Army Air Field.Bucholz Army Air Field is located in the Marshall Islands.'
  compiled code at target/run/air_travel/models/tmp/tmp_airport_llm.sql
[0m11:46:04.330154 [info ] [MainThread]: 
[0m11:46:04.330307 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_llm.sql
[0m11:46:04.330425 [info ] [MainThread]: 
[0m11:46:04.330560 [error] [MainThread]: [31mFailure in model Country (models/int/Country.sql)[0m
[0m11:46:04.330695 [error] [MainThread]:   Database Error in model Country (models/int/Country.sql)
  Syntax error: Expected ")" but got keyword WHERE at [18:5]
  compiled code at target/run/air_travel/models/int/Country.sql
[0m11:46:04.330799 [info ] [MainThread]: 
[0m11:46:04.330921 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Country.sql
[0m11:46:04.331031 [info ] [MainThread]: 
[0m11:46:04.331165 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=8 NO-OP=0 TOTAL=20
[0m11:46:04.333224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2613.9446, "process_in_blocks": "0", "process_kernel_time": 0.706626, "process_mem_max_rss": "409075712", "process_out_blocks": "0", "process_user_time": 4.911541}
[0m11:46:04.333416 [debug] [MainThread]: Command `dbt run` failed at 11:46:04.333380 after 2613.94 seconds
[0m11:46:04.333574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1512a8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151284e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15145d190>]}
[0m11:46:04.333725 [debug] [MainThread]: Flushing usage events
[0m11:46:04.601301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:17.436645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111473750>]}


============================== 11:47:17.438282 | 436bbf75-475b-4a60-9cb3-a2ac4027ba1f ==============================
[0m11:47:17.438282 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:47:17.438529 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'invocation_command': 'dbt run --select Country', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False'}
[0m11:47:18.266006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '436bbf75-475b-4a60-9cb3-a2ac4027ba1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ccc30>]}
[0m11:47:18.284847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '436bbf75-475b-4a60-9cb3-a2ac4027ba1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162abe360>]}
[0m11:47:18.285054 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:47:18.359772 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:47:18.399781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 1 files changed.
[0m11:47:18.400001 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_establishment_broad_categories_mapped.sql
[0m11:47:18.400135 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_establishment_canonical_categories.sql
[0m11:47:18.400234 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/TSA_Traffic.sql
[0m11:47:18.400325 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_establishment_unique.sql
[0m11:47:18.400414 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airport_Concessions.sql
[0m11:47:18.400499 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airport_Reviews.sql
[0m11:47:18.400583 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airport.sql
[0m11:47:18.400668 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_establishment_raw_categories.sql
[0m11:47:18.400774 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Country.sql
[0m11:47:18.488408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:47:18.492957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '436bbf75-475b-4a60-9cb3-a2ac4027ba1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163036050>]}
[0m11:47:18.524355 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:47:18.525202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:47:18.531367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '436bbf75-475b-4a60-9cb3-a2ac4027ba1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162ace8a0>]}
[0m11:47:18.531546 [info ] [MainThread]: Found 28 models, 9 data tests, 9 sources, 514 macros
[0m11:47:18.531672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '436bbf75-475b-4a60-9cb3-a2ac4027ba1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1630f2eb0>]}
[0m11:47:18.532349 [info ] [MainThread]: 
[0m11:47:18.532473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:18.532575 [info ] [MainThread]: 
[0m11:47:18.532760 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:47:18.533085 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:47:18.533244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:18.884175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:47:18.884718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:19.173838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:47:19.175830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:19.482756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:47:19.484614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:19.781885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '436bbf75-475b-4a60-9cb3-a2ac4027ba1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163413c70>]}
[0m11:47:19.782234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:19.784021 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m11:47:19.784342 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Country ........................ [RUN]
[0m11:47:19.784586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.Country)
[0m11:47:19.784767 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m11:47:19.788852 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m11:47:19.789245 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m11:47:19.796754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:20.080991 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Country"
[0m11:47:20.081856 [debug] [Thread-1 (]: On model.air_travel.Country: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Country"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Country`
      
    
    

    
    OPTIONS()
    as (
      with Country as (
    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` 
    group by iso_code, name, _data_source, _load_time
)

select *
from Country
where iso_code is not null 
union all
select t.mapped_iso_code, c.name, c.dafif_codes, c._data_source, c._load_time 
from Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes` t 
on c.name = t.name
where t.mapped_iso_code is not null
and c.iso_code is null
    );
  
[0m11:47:20.595576 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:80353b4c-d2f5-4245-ba54-cdd10437ad75&page=queryresults
[0m11:47:22.840066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '436bbf75-475b-4a60-9cb3-a2ac4027ba1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163417d10>]}
[0m11:47:22.840498 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Country ................... [[32mCREATE TABLE (245.0 rows, 10.7 KiB processed)[0m in 3.05s]
[0m11:47:22.840817 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m11:47:22.841519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:47:22.842451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:22.842609 [debug] [MainThread]: Connection 'model.air_travel.Country' was properly closed.
[0m11:47:22.842756 [info ] [MainThread]: 
[0m11:47:22.842914 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m11:47:22.843251 [debug] [MainThread]: Command end result
[0m11:47:22.858363 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:47:22.859447 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:47:22.862173 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:47:22.862310 [info ] [MainThread]: 
[0m11:47:22.862470 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:22.862591 [info ] [MainThread]: 
[0m11:47:22.862730 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:47:22.864739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4526753, "process_in_blocks": "0", "process_kernel_time": 0.25144, "process_mem_max_rss": "393625600", "process_out_blocks": "0", "process_user_time": 1.749436}
[0m11:47:22.864932 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:22.864896 after 5.45 seconds
[0m11:47:22.865095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1634de410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1634d0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1642b3cf0>]}
[0m11:47:22.865250 [debug] [MainThread]: Flushing usage events
[0m11:47:23.085269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:46.217660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046386e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054839d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105483750>]}


============================== 11:47:46.219337 | 1a03410a-65cc-444a-936e-0eb1795ba0e0 ==============================
[0m11:47:46.219337 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:47:46.219601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'invocation_command': 'dbt run --select tmp_airport_llm', 'partial_parse': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'version_check': 'True', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m11:47:47.075345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a03410a-65cc-444a-936e-0eb1795ba0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dcc30>]}
[0m11:47:47.094797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a03410a-65cc-444a-936e-0eb1795ba0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e8be360>]}
[0m11:47:47.095061 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:47:47.170852 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:47:47.210647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:47:47.210805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:47:47.213104 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:47:47.226813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a03410a-65cc-444a-936e-0eb1795ba0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef42650>]}
[0m11:47:47.261414 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:47:47.262304 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:47:47.268453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a03410a-65cc-444a-936e-0eb1795ba0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e8ce8a0>]}
[0m11:47:47.268652 [info ] [MainThread]: Found 28 models, 9 data tests, 9 sources, 514 macros
[0m11:47:47.268777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a03410a-65cc-444a-936e-0eb1795ba0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eb3de10>]}
[0m11:47:47.269477 [info ] [MainThread]: 
[0m11:47:47.269603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:47.269697 [info ] [MainThread]: 
[0m11:47:47.269891 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:47:47.270254 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:47:47.270418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:47.607450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:47:47.607980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:47.890487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:47:47.892908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:48.170779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:47:48.173059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:48.486377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a03410a-65cc-444a-936e-0eb1795ba0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0dfd40>]}
[0m11:47:48.487045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:48.490500 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_llm
[0m11:47:48.491023 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_llm ................ [RUN]
[0m11:47:48.491412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_llm)
[0m11:47:48.491693 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_llm
[0m11:47:48.499986 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_llm"
[0m11:47:48.500797 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_llm
[0m11:47:48.509958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:48.797196 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_llm"
[0m11:47:48.798210 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_llm: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_llm"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_llm as (
    select
      name,
      country,
      iata,
      AI.GENERATE(
        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'icao STRING, state_prov STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
    where iata is not null
  )
select name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov
from tmp_airport_llm
    );
  
[0m11:47:49.167646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:346d6a13-4812-43f1-a91a-7f522899ca53&page=queryresults
[0m12:23:31.189726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a03410a-65cc-444a-936e-0eb1795ba0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1c6090>]}
[0m12:23:31.190183 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_llm ........... [[32mCREATE TABLE (6.9k rows, 453.8 KiB processed)[0m in 2142.70s]
[0m12:23:31.190513 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_llm
[0m12:23:31.191192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:23:31.192138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:31.192298 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_llm' was properly closed.
[0m12:23:31.192444 [info ] [MainThread]: 
[0m12:23:31.192599 [info ] [MainThread]: Finished running 1 table model in 0 hours 35 minutes and 43.92 seconds (2143.92s).
[0m12:23:31.192937 [debug] [MainThread]: Command end result
[0m12:23:31.208003 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:23:31.209250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:23:31.211967 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:23:31.212112 [info ] [MainThread]: 
[0m12:23:31.212269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:23:31.212385 [info ] [MainThread]: 
[0m12:23:31.212518 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:23:31.214515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2145.0146, "process_in_blocks": "0", "process_kernel_time": 0.550626, "process_mem_max_rss": "394690560", "process_out_blocks": "0", "process_user_time": 3.564026}
[0m12:23:31.214708 [debug] [MainThread]: Command `dbt run` succeeded at 12:23:31.214665 after 2145.01 seconds
[0m12:23:31.214857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f137540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea9c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea9c0f0>]}
[0m12:23:31.215006 [debug] [MainThread]: Flushing usage events
[0m12:23:31.444922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:23:48.273841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a173750>]}


============================== 12:23:48.275434 | da3d8a20-c2a5-458c-8a97-c722286c9551 ==============================
[0m12:23:48.275434 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:23:48.275661 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'target_path': 'None', 'empty': 'False', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select Airport', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'version_check': 'True'}
[0m12:23:49.119289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da3d8a20-c2a5-458c-8a97-c722286c9551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ccc30>]}
[0m12:23:49.138914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da3d8a20-c2a5-458c-8a97-c722286c9551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c2c2360>]}
[0m12:23:49.139169 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:23:49.213313 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:23:49.253456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 2 files changed.
[0m12:23:49.253681 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airline_country_mapped.sql
[0m12:23:49.253792 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_establishment_sub_categories_mapped.sql
[0m12:23:49.253887 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airline.sql
[0m12:23:49.253977 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airport_Establishment.sql
[0m12:23:49.254066 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Food_Beverage.sql
[0m12:23:49.254176 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_broad_categories_mapped.sql
[0m12:23:49.254281 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport_Concessions.sql
[0m12:23:49.318249 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.tmp_airport_establishment_sub_categories_mapped' (models/tmp/tmp_airport_establishment_sub_categories_mapped.sql) depends on a node named 'airport_establishment_canonical_categories' which was not found
[0m12:23:49.320078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0712872, "process_in_blocks": "0", "process_kernel_time": 0.215713, "process_mem_max_rss": "377094144", "process_out_blocks": "0", "process_user_time": 1.334416}
[0m12:23:49.320300 [debug] [MainThread]: Command `dbt run` failed at 12:23:49.320262 after 1.07 seconds
[0m12:23:49.320446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c26b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d042350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d26a120>]}
[0m12:23:49.320580 [debug] [MainThread]: Flushing usage events
[0m12:23:49.517855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:31.676477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b73750>]}


============================== 12:24:31.678268 | 5479e4f7-bb11-4d92-bd10-f125ecdb8dd8 ==============================
[0m12:24:31.678268 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:24:31.678511 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_colors': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select Airport', 'profiles_dir': '/Users/scohen/.dbt', 'version_check': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False'}
[0m12:24:32.499709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5479e4f7-bb11-4d92-bd10-f125ecdb8dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ccc30>]}
[0m12:24:32.518829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5479e4f7-bb11-4d92-bd10-f125ecdb8dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dac2360>]}
[0m12:24:32.519103 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:24:32.594798 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:24:32.633990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 2 files changed.
[0m12:24:32.634207 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Food_Beverage.sql
[0m12:24:32.634317 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airport_Establishment.sql
[0m12:24:32.634415 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airline.sql
[0m12:24:32.634503 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airline_country_mapped.sql
[0m12:24:32.634593 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_establishment_sub_categories_mapped.sql
[0m12:24:32.634704 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_broad_categories_mapped.sql
[0m12:24:32.634813 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport_Concessions.sql
[0m12:24:32.721908 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:24:32.726642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5479e4f7-bb11-4d92-bd10-f125ecdb8dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14df42150>]}
[0m12:24:32.759508 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:24:32.760394 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:24:32.767746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5479e4f7-bb11-4d92-bd10-f125ecdb8dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dace8a0>]}
[0m12:24:32.767925 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:24:32.768048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5479e4f7-bb11-4d92-bd10-f125ecdb8dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dcf6190>]}
[0m12:24:32.768746 [info ] [MainThread]: 
[0m12:24:32.768877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:32.768971 [info ] [MainThread]: 
[0m12:24:32.769157 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:24:32.769514 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:24:32.769685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:33.191987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:24:33.192499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:33.509466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:24:33.510268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:33.788396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:24:33.789791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:34.062395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5479e4f7-bb11-4d92-bd10-f125ecdb8dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e9bd8b0>]}
[0m12:24:34.063011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:34.066364 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m12:24:34.066808 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m12:24:34.067146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Airport)
[0m12:24:34.067411 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m12:24:34.074477 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m12:24:34.075144 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m12:24:34.084760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:34.371465 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m12:24:34.372209 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.name
  where a.country_code is null
)
    );
  
[0m12:24:34.502854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:966a8b50-c461-4be7-acef-099fce43d2b2&page=queryresults
[0m12:24:34.504146 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:966a8b50-c461-4be7-acef-099fce43d2b2&page=queryresults
[0m12:24:34.516482 [debug] [Thread-1 (]: Database Error in model Airport (models/int/Airport.sql)
  Syntax error: Unexpected ")" at [28:5]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:24:34.518225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5479e4f7-bb11-4d92-bd10-f125ecdb8dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ef153d0>]}
[0m12:24:34.518803 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Airport ............... [[31mERROR[0m in 0.45s]
[0m12:24:34.519255 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m12:24:34.519722 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport' to be skipped because of status 'error'.  Reason: Database Error in model Airport (models/int/Airport.sql)
  Syntax error: Unexpected ")" at [28:5]
  compiled code at target/run/air_travel/models/int/Airport.sql.
[0m12:24:34.521238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:24:34.522383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:34.522571 [debug] [MainThread]: Connection 'model.air_travel.Airport' was properly closed.
[0m12:24:34.522758 [info ] [MainThread]: 
[0m12:24:34.522963 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m12:24:34.523392 [debug] [MainThread]: Command end result
[0m12:24:34.543015 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:24:34.544131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:24:34.547151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:24:34.547300 [info ] [MainThread]: 
[0m12:24:34.547469 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:24:34.547603 [info ] [MainThread]: 
[0m12:24:34.547768 [error] [MainThread]: [31mFailure in model Airport (models/int/Airport.sql)[0m
[0m12:24:34.547918 [error] [MainThread]:   Database Error in model Airport (models/int/Airport.sql)
  Syntax error: Unexpected ")" at [28:5]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:24:34.548030 [info ] [MainThread]: 
[0m12:24:34.548164 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport.sql
[0m12:24:34.548278 [info ] [MainThread]: 
[0m12:24:34.548416 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:24:34.550608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8977203, "process_in_blocks": "0", "process_kernel_time": 0.221254, "process_mem_max_rss": "388202496", "process_out_blocks": "0", "process_user_time": 1.720665}
[0m12:24:34.550837 [debug] [MainThread]: Command `dbt run` failed at 12:24:34.550790 after 2.90 seconds
[0m12:24:34.551006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14efec890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14efc76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14efc74d0>]}
[0m12:24:34.551174 [debug] [MainThread]: Flushing usage events
[0m12:24:34.749143 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:31.925321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fb750>]}


============================== 12:25:31.926967 | f375d545-6251-4e33-832d-7d47b50704ff ==============================
[0m12:25:31.926967 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:25:31.927218 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select Airport', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'quiet': 'False', 'target_path': 'None', 'warn_error': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'version_check': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m12:25:32.736821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f375d545-6251-4e33-832d-7d47b50704ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c54c30>]}
[0m12:25:32.755561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f375d545-6251-4e33-832d-7d47b50704ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d4c2360>]}
[0m12:25:32.755763 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:25:32.831102 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:25:32.870669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:25:32.870927 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport.sql
[0m12:25:32.952015 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:25:32.956601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f375d545-6251-4e33-832d-7d47b50704ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e24a150>]}
[0m12:25:32.988862 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:25:32.989716 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:25:32.996704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f375d545-6251-4e33-832d-7d47b50704ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d4ce8a0>]}
[0m12:25:32.996881 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:25:32.997000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f375d545-6251-4e33-832d-7d47b50704ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d6f1b70>]}
[0m12:25:32.997704 [info ] [MainThread]: 
[0m12:25:32.997836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:32.997930 [info ] [MainThread]: 
[0m12:25:32.998117 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:25:32.998436 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:25:32.998575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:33.338595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:25:33.339125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:33.653884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:25:33.655671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:33.947322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:25:33.948541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:34.718965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f375d545-6251-4e33-832d-7d47b50704ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f2d06d0>]}
[0m12:25:34.719612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:34.722899 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m12:25:34.723355 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m12:25:34.723707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.Airport)
[0m12:25:34.723976 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m12:25:34.730977 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m12:25:34.731612 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m12:25:34.741317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:35.020727 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m12:25:35.021452 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.name
  where a.country_code is null
)

select * 
from Airport
    );
  
[0m12:25:35.415021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:33322979-8685-4696-9773-8becaebd4732&page=queryresults
[0m12:25:35.416520 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:33322979-8685-4696-9773-8becaebd4732&page=queryresults
[0m12:25:35.428531 [debug] [Thread-1 (]: Database Error in model Airport (models/int/Airport.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_country_iso_codes was not found in location us-central1
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:25:35.430092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f375d545-6251-4e33-832d-7d47b50704ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f249850>]}
[0m12:25:35.430650 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Airport ............... [[31mERROR[0m in 0.71s]
[0m12:25:35.431103 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m12:25:35.431475 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport' to be skipped because of status 'error'.  Reason: Database Error in model Airport (models/int/Airport.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_country_iso_codes was not found in location us-central1
  compiled code at target/run/air_travel/models/int/Airport.sql.
[0m12:25:35.432850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:35.434061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:35.434271 [debug] [MainThread]: Connection 'model.air_travel.Airport' was properly closed.
[0m12:25:35.434465 [info ] [MainThread]: 
[0m12:25:35.434681 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m12:25:35.435120 [debug] [MainThread]: Command end result
[0m12:25:35.454664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:25:35.455960 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:25:35.459149 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:25:35.459320 [info ] [MainThread]: 
[0m12:25:35.459493 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:25:35.459629 [info ] [MainThread]: 
[0m12:25:35.459798 [error] [MainThread]: [31mFailure in model Airport (models/int/Airport.sql)[0m
[0m12:25:35.459954 [error] [MainThread]:   Database Error in model Airport (models/int/Airport.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_country_iso_codes was not found in location us-central1
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:25:35.460068 [info ] [MainThread]: 
[0m12:25:35.460204 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport.sql
[0m12:25:35.460318 [info ] [MainThread]: 
[0m12:25:35.460454 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:25:35.462641 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5610209, "process_in_blocks": "0", "process_kernel_time": 0.231224, "process_mem_max_rss": "397705216", "process_out_blocks": "0", "process_user_time": 1.721375}
[0m12:25:35.462865 [debug] [MainThread]: Command `dbt run` failed at 12:25:35.462817 after 3.56 seconds
[0m12:25:35.463042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f2d8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f41ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f41b250>]}
[0m12:25:35.463200 [debug] [MainThread]: Flushing usage events
[0m12:25:35.690728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:04.136376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107173750>]}


============================== 12:26:04.138028 | 95c0d8b4-ed20-454d-8af3-22d4fa639a9c ==============================
[0m12:26:04.138028 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:26:04.138271 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'log_format': 'default', 'partial_parse': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'invocation_command': 'dbt run --select tmp_airport_country_iso_codes', 'debug': 'False', 'fail_fast': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m12:26:04.953047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95c0d8b4-ed20-454d-8af3-22d4fa639a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ccc30>]}
[0m12:26:04.972094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95c0d8b4-ed20-454d-8af3-22d4fa639a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14acc2360>]}
[0m12:26:04.972313 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:26:05.046528 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:26:05.086492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:26:05.086631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:26:05.088952 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:26:05.102871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95c0d8b4-ed20-454d-8af3-22d4fa639a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ba4a650>]}
[0m12:26:05.136462 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:26:05.137326 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:26:05.143303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95c0d8b4-ed20-454d-8af3-22d4fa639a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14acce8a0>]}
[0m12:26:05.143475 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:26:05.143601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95c0d8b4-ed20-454d-8af3-22d4fa639a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ae41550>]}
[0m12:26:05.144306 [info ] [MainThread]: 
[0m12:26:05.144434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:05.144529 [info ] [MainThread]: 
[0m12:26:05.144711 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:26:05.145094 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:26:05.145266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:05.648327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:26:05.648839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:05.948366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:26:05.949449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:06.218491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:26:06.220362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:06.494103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95c0d8b4-ed20-454d-8af3-22d4fa639a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bcef860>]}
[0m12:26:06.494409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:06.496372 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_iso_codes
[0m12:26:06.496671 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_country_iso_codes .. [RUN]
[0m12:26:06.496923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_country_iso_codes)
[0m12:26:06.497108 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_iso_codes
[0m12:26:06.502465 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_iso_codes"
[0m12:26:06.502909 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_iso_codes
[0m12:26:06.522618 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_country_iso_codes"
[0m12:26:06.523139 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_country_iso_codes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_country_iso_codes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`
      
    
    

    
    OPTIONS()
    as (
      with tmp_orphan_country as (
    select distinct country as airport_country_name
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`
    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)
),
tmp_airport_country_iso_codes as (
    select airport_country_name,
      AI.GENERATE(
        ('What is the iso code for the country ', airport_country_name, '? If it does not have an iso code, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from tmp_orphan_country
)
select airport_country_name, llm_response.iso_code as mapped_iso_code
from tmp_airport_country_iso_codes
    );
  
[0m12:26:06.523339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:06.969004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3db8b4e4-8334-499c-ab1f-08028c8fa8df&page=queryresults
[0m12:26:06.970305 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3db8b4e4-8334-499c-ab1f-08028c8fa8df&page=queryresults
[0m12:26:06.980834 [debug] [Thread-1 (]: Database Error in model tmp_airport_country_iso_codes (models/tmp/tmp_airport_country_iso_codes.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_refined was not found in location us-central1
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_iso_codes.sql
[0m12:26:06.982988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95c0d8b4-ed20-454d-8af3-22d4fa639a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bdd2510>]}
[0m12:26:06.983696 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_country_iso_codes  [[31mERROR[0m in 0.48s]
[0m12:26:06.984139 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_iso_codes
[0m12:26:06.984481 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_country_iso_codes' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_country_iso_codes (models/tmp/tmp_airport_country_iso_codes.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_refined was not found in location us-central1
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_iso_codes.sql.
[0m12:26:06.985760 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:26:06.986990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:06.987186 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_country_iso_codes' was properly closed.
[0m12:26:06.987372 [info ] [MainThread]: 
[0m12:26:06.987549 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m12:26:06.987935 [debug] [MainThread]: Command end result
[0m12:26:07.006788 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:26:07.007802 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:26:07.010955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:26:07.011108 [info ] [MainThread]: 
[0m12:26:07.011272 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:26:07.011409 [info ] [MainThread]: 
[0m12:26:07.011581 [error] [MainThread]: [31mFailure in model tmp_airport_country_iso_codes (models/tmp/tmp_airport_country_iso_codes.sql)[0m
[0m12:26:07.011750 [error] [MainThread]:   Database Error in model tmp_airport_country_iso_codes (models/tmp/tmp_airport_country_iso_codes.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_refined was not found in location us-central1
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_iso_codes.sql
[0m12:26:07.011868 [info ] [MainThread]: 
[0m12:26:07.012011 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_country_iso_codes.sql
[0m12:26:07.012129 [info ] [MainThread]: 
[0m12:26:07.012268 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:26:07.014465 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9014847, "process_in_blocks": "0", "process_kernel_time": 0.230153, "process_mem_max_rss": "383844352", "process_out_blocks": "0", "process_user_time": 1.614378}
[0m12:26:07.014678 [debug] [MainThread]: Command `dbt run` failed at 12:26:07.014639 after 2.90 seconds
[0m12:26:07.014849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bd3f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bdaf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bdaf1b0>]}
[0m12:26:07.015010 [debug] [MainThread]: Flushing usage events
[0m12:26:07.222870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:25.162809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870f750>]}


============================== 12:26:25.164475 | f5ec4330-1bbd-405b-8c9b-26147defb0e8 ==============================
[0m12:26:25.164475 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:26:25.164732 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'empty': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select tmp_airport_refined', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_colors': 'True', 'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'use_experimental_parser': 'False'}
[0m12:26:25.969970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5ec4330-1bbd-405b-8c9b-26147defb0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a68c30>]}
[0m12:26:25.988703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5ec4330-1bbd-405b-8c9b-26147defb0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dcc2360>]}
[0m12:26:25.988905 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:26:26.063920 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:26:26.103336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:26:26.103478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:26:26.105810 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:26:26.119840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5ec4330-1bbd-405b-8c9b-26147defb0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eb4a650>]}
[0m12:26:26.153518 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:26:26.154338 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:26:26.160434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5ec4330-1bbd-405b-8c9b-26147defb0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dcce8a0>]}
[0m12:26:26.160602 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:26:26.160728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5ec4330-1bbd-405b-8c9b-26147defb0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12df3d550>]}
[0m12:26:26.161418 [info ] [MainThread]: 
[0m12:26:26.161544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:26.161636 [info ] [MainThread]: 
[0m12:26:26.161833 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:26:26.162176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:26:26.162341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:26.642889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:26:26.643425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:26.917745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:26:26.919817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:27.181156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:26:27.182057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:27.439060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5ec4330-1bbd-405b-8c9b-26147defb0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eceb860>]}
[0m12:26:27.439633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:27.442820 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m12:26:27.443370 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_refined ............ [RUN]
[0m12:26:27.443749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_refined)
[0m12:26:27.444000 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_refined
[0m12:26:27.452048 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_refined"
[0m12:26:27.452727 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_refined
[0m12:26:27.474909 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_refined"
[0m12:26:27.475434 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_refined: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_refined"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_refined as (
    select *
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao not in (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
    union all
    select * from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
    where concat(icao, ',', iata, ',', name) in
      (select concat(base_icao, ',', base_iata, ',', base_name)
       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`
       where distance < 0.08)
)

select * from tmp_airport_refined
    );
  
[0m12:26:27.475653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:27.728534 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1882cf3f-8a29-4a05-9ae5-af3537982b59&page=queryresults
[0m12:26:27.729516 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1882cf3f-8a29-4a05-9ae5-af3537982b59&page=queryresults
[0m12:26:27.740940 [debug] [Thread-1 (]: Database Error in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)
  Syntax error: Expected ")" but got keyword SELECT at [26:1]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_refined.sql
[0m12:26:27.742604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5ec4330-1bbd-405b-8c9b-26147defb0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12edca510>]}
[0m12:26:27.743192 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_refined ... [[31mERROR[0m in 0.30s]
[0m12:26:27.743673 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m12:26:27.744052 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_refined' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)
  Syntax error: Expected ")" but got keyword SELECT at [26:1]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_refined.sql.
[0m12:26:27.745445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:26:27.746821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:27.747051 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_refined' was properly closed.
[0m12:26:27.747260 [info ] [MainThread]: 
[0m12:26:27.747481 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m12:26:27.747935 [debug] [MainThread]: Command end result
[0m12:26:27.767342 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:26:27.768469 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:26:27.771622 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:26:27.771779 [info ] [MainThread]: 
[0m12:26:27.771953 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:26:27.772088 [info ] [MainThread]: 
[0m12:26:27.772257 [error] [MainThread]: [31mFailure in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)[0m
[0m12:26:27.772422 [error] [MainThread]:   Database Error in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)
  Syntax error: Expected ")" but got keyword SELECT at [26:1]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_refined.sql
[0m12:26:27.772539 [info ] [MainThread]: 
[0m12:26:27.772678 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_refined.sql
[0m12:26:27.772799 [info ] [MainThread]: 
[0m12:26:27.772946 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:26:27.775185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.636146, "process_in_blocks": "0", "process_kernel_time": 0.211503, "process_mem_max_rss": "383139840", "process_out_blocks": "0", "process_user_time": 1.637607}
[0m12:26:27.775440 [debug] [MainThread]: Command `dbt run` failed at 12:26:27.775393 after 2.64 seconds
[0m12:26:27.775637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ed3ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eda71b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eda4a50>]}
[0m12:26:27.775805 [debug] [MainThread]: Flushing usage events
[0m12:26:27.981911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:56.641602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107073750>]}


============================== 12:26:56.643222 | 3be2ee92-481e-45ae-a160-a95bd64b2342 ==============================
[0m12:26:56.643222 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:26:56.643452 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select tmp_airport_refined', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'version_check': 'True', 'quiet': 'False', 'write_json': 'True', 'fail_fast': 'False'}
[0m12:26:57.451390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3be2ee92-481e-45ae-a160-a95bd64b2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ccc30>]}
[0m12:26:57.470215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3be2ee92-481e-45ae-a160-a95bd64b2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d3be360>]}
[0m12:26:57.470426 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:26:57.545970 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:26:57.585618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:57.585863 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_refined.sql
[0m12:26:57.685797 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:26:57.692190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3be2ee92-481e-45ae-a160-a95bd64b2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d94a150>]}
[0m12:26:57.727235 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:26:57.728152 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:26:57.735353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3be2ee92-481e-45ae-a160-a95bd64b2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d3ce8a0>]}
[0m12:26:57.735541 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:26:57.735677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3be2ee92-481e-45ae-a160-a95bd64b2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d6f1b70>]}
[0m12:26:57.736373 [info ] [MainThread]: 
[0m12:26:57.736502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:57.736595 [info ] [MainThread]: 
[0m12:26:57.736780 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:26:57.737138 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:26:57.737308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:58.072039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:26:58.072575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:58.352779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:26:58.354843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:58.620122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:26:58.622289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:58.910859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3be2ee92-481e-45ae-a160-a95bd64b2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16890fc70>]}
[0m12:26:58.912048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:58.915759 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m12:26:58.916292 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_refined ............ [RUN]
[0m12:26:58.916674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_refined)
[0m12:26:58.916951 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_refined
[0m12:26:58.924047 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_refined"
[0m12:26:58.924859 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_refined
[0m12:26:58.948357 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_refined"
[0m12:26:58.948912 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_refined: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_refined"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_refined as (
    select *
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao not in (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)
    union all
    select * from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
    where concat(icao, ',', iata, ',', name) in
      (select concat(base_icao, ',', base_iata, ',', base_name)
       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`
       where distance < 0.08)
)

select * from tmp_airport_refined
    );
  
[0m12:26:58.949138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:59.501354 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4675e98a-9da9-4553-87b1-f77ff8b5cbdf&page=queryresults
[0m12:26:59.502881 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4675e98a-9da9-4553-87b1-f77ff8b5cbdf&page=queryresults
[0m12:26:59.515336 [debug] [Thread-1 (]: Database Error in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_all was not found in location us-central1
  compiled code at target/run/air_travel/models/tmp/tmp_airport_refined.sql
[0m12:26:59.517335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be2ee92-481e-45ae-a160-a95bd64b2342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16894aed0>]}
[0m12:26:59.518014 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_refined ... [[31mERROR[0m in 0.60s]
[0m12:26:59.518489 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m12:26:59.518880 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_refined' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_all was not found in location us-central1
  compiled code at target/run/air_travel/models/tmp/tmp_airport_refined.sql.
[0m12:26:59.520384 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:26:59.521682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:59.521902 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_refined' was properly closed.
[0m12:26:59.522125 [info ] [MainThread]: 
[0m12:26:59.522340 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m12:26:59.522790 [debug] [MainThread]: Command end result
[0m12:26:59.542030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:26:59.543051 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:26:59.546149 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:26:59.546288 [info ] [MainThread]: 
[0m12:26:59.546462 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:26:59.546594 [info ] [MainThread]: 
[0m12:26:59.546764 [error] [MainThread]: [31mFailure in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)[0m
[0m12:26:59.546924 [error] [MainThread]:   Database Error in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_all was not found in location us-central1
  compiled code at target/run/air_travel/models/tmp/tmp_airport_refined.sql
[0m12:26:59.547039 [info ] [MainThread]: 
[0m12:26:59.547177 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_refined.sql
[0m12:26:59.547291 [info ] [MainThread]: 
[0m12:26:59.547428 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:26:59.549630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9318197, "process_in_blocks": "0", "process_kernel_time": 0.227785, "process_mem_max_rss": "391610368", "process_out_blocks": "0", "process_user_time": 1.71577}
[0m12:26:59.549840 [debug] [MainThread]: Command `dbt run` failed at 12:26:59.549800 after 2.93 seconds
[0m12:26:59.550011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1689e4aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168a22df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168a231b0>]}
[0m12:26:59.550167 [debug] [MainThread]: Flushing usage events
[0m12:26:59.776000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:11.556722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040446e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8f750>]}


============================== 12:27:11.558392 | 2407b3b6-6631-46af-a722-a1dedd7861f3 ==============================
[0m12:27:11.558392 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:27:11.558631 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'fail_fast': 'False', 'empty': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'printer_width': '80', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select tmp_airport_all'}
[0m12:27:12.365436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2407b3b6-6631-46af-a722-a1dedd7861f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e8c30>]}
[0m12:27:12.384266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2407b3b6-6631-46af-a722-a1dedd7861f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221c2360>]}
[0m12:27:12.384469 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:27:12.464430 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:27:12.504127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:12.504267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:12.506605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:27:12.520857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2407b3b6-6631-46af-a722-a1dedd7861f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b4a650>]}
[0m12:27:12.554723 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:27:12.555589 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:27:12.561685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2407b3b6-6631-46af-a722-a1dedd7861f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221ce8a0>]}
[0m12:27:12.561859 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:27:12.561983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2407b3b6-6631-46af-a722-a1dedd7861f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122441550>]}
[0m12:27:12.562700 [info ] [MainThread]: 
[0m12:27:12.562835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:12.562935 [info ] [MainThread]: 
[0m12:27:12.563129 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:27:12.563491 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:27:12.563659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:12.897376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:27:12.897969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:13.155055 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:27:13.155805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:13.420208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:27:13.421294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:13.704456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2407b3b6-6631-46af-a722-a1dedd7861f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cef860>]}
[0m12:27:13.705181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:13.708985 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m12:27:13.709633 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_all ................ [RUN]
[0m12:27:13.710085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_all)
[0m12:27:13.710377 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_all
[0m12:27:13.719131 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_all"
[0m12:27:13.719975 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_all
[0m12:27:13.744396 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_all"
[0m12:27:13.744994 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_all: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_all"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_all as (
    select distinct al.llm_icao as icao, a.iata, a.name, a.city, al.llm_state_prov as state_prov, 
        a.country, a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, 
        a.timezone_name, a.type, a.source, 'openflights,llm' as _data_source, a._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm` al
    on a.name = al.name and a.country = al.country
    where a.iata is not null
    and al.llm_icao is not null
)

select * from tmp_airport_all
    );
  
[0m12:27:13.745221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:14.247933 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6e269d80-cc26-43fc-b3ad-37e2b375da15&page=queryresults
[0m12:27:16.120221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2407b3b6-6631-46af-a722-a1dedd7861f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123dcee10>]}
[0m12:27:16.120880 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_all ........... [[32mCREATE TABLE (4.7k rows, 1.6 MiB processed)[0m in 2.41s]
[0m12:27:16.121300 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m12:27:16.122305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:16.123473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:16.123647 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_all' was properly closed.
[0m12:27:16.123826 [info ] [MainThread]: 
[0m12:27:16.124027 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m12:27:16.124446 [debug] [MainThread]: Command end result
[0m12:27:16.144322 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:27:16.145314 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:27:16.148089 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:27:16.148226 [info ] [MainThread]: 
[0m12:27:16.148400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:27:16.148527 [info ] [MainThread]: 
[0m12:27:16.148673 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:27:16.150837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6176405, "process_in_blocks": "0", "process_kernel_time": 0.237133, "process_mem_max_rss": "387039232", "process_out_blocks": "0", "process_user_time": 1.652511}
[0m12:27:16.151052 [debug] [MainThread]: Command `dbt run` succeeded at 12:27:16.151012 after 4.62 seconds
[0m12:27:16.151210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d3b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123dc9b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123dca490>]}
[0m12:27:16.151353 [debug] [MainThread]: Flushing usage events
[0m12:27:16.351887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:19.211973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108957750>]}


============================== 12:27:19.213564 | 1bd0f391-0932-41a0-8819-fa30dbff4ef5 ==============================
[0m12:27:19.213564 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:27:19.213807 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'version_check': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'target_path': 'None', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tmp_airport_refined', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False'}
[0m12:27:20.021134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bd0f391-0932-41a0-8819-fa30dbff4ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb0c30>]}
[0m12:27:20.040327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bd0f391-0932-41a0-8819-fa30dbff4ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9c2360>]}
[0m12:27:20.040540 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:27:20.114268 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:27:20.153680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:20.153822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:20.156170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:27:20.170015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bd0f391-0932-41a0-8819-fa30dbff4ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13884e650>]}
[0m12:27:20.203500 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:27:20.204330 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:27:20.210308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bd0f391-0932-41a0-8819-fa30dbff4ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9ce8a0>]}
[0m12:27:20.210480 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:27:20.210604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bd0f391-0932-41a0-8819-fa30dbff4ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb41550>]}
[0m12:27:20.211328 [info ] [MainThread]: 
[0m12:27:20.211458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:20.211554 [info ] [MainThread]: 
[0m12:27:20.211751 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:27:20.212114 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:27:20.212287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:20.585997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:27:20.586533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:20.863781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:27:20.864961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:21.159938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:27:21.162169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:21.420066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bd0f391-0932-41a0-8819-fa30dbff4ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1389ef860>]}
[0m12:27:21.420941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:21.425664 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m12:27:21.426365 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_refined ............ [RUN]
[0m12:27:21.426763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_refined)
[0m12:27:21.427049 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_refined
[0m12:27:21.435839 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_refined"
[0m12:27:21.436580 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_refined
[0m12:27:21.460389 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_refined"
[0m12:27:21.460957 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_refined: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_refined"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_refined as (
    select *
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao not in (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)
    union all
    select * from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
    where concat(icao, ',', iata, ',', name) in
      (select concat(base_icao, ',', base_iata, ',', base_name)
       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`
       where distance < 0.08)
)

select * from tmp_airport_refined
    );
  
[0m12:27:21.461186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:22.029792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:43a6d49e-9606-444f-aac3-7833ae154bd9&page=queryresults
[0m12:27:22.031309 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:43a6d49e-9606-444f-aac3-7833ae154bd9&page=queryresults
[0m12:27:22.044388 [debug] [Thread-1 (]: Database Error in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_vector_search_results was not found in location us-central1
  compiled code at target/run/air_travel/models/tmp/tmp_airport_refined.sql
[0m12:27:22.046355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bd0f391-0932-41a0-8819-fa30dbff4ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138ac65d0>]}
[0m12:27:22.046996 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_refined ... [[31mERROR[0m in 0.62s]
[0m12:27:22.047475 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m12:27:22.047859 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_refined' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_vector_search_results was not found in location us-central1
  compiled code at target/run/air_travel/models/tmp/tmp_airport_refined.sql.
[0m12:27:22.049210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:22.050447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:22.050670 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_refined' was properly closed.
[0m12:27:22.050875 [info ] [MainThread]: 
[0m12:27:22.051112 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m12:27:22.051586 [debug] [MainThread]: Command end result
[0m12:27:22.071112 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:27:22.072272 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:27:22.075385 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:27:22.075552 [info ] [MainThread]: 
[0m12:27:22.075736 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:27:22.075883 [info ] [MainThread]: 
[0m12:27:22.076062 [error] [MainThread]: [31mFailure in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)[0m
[0m12:27:22.076221 [error] [MainThread]:   Database Error in model tmp_airport_refined (models/tmp/tmp_airport_refined.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_vector_search_results was not found in location us-central1
  compiled code at target/run/air_travel/models/tmp/tmp_airport_refined.sql
[0m12:27:22.076338 [info ] [MainThread]: 
[0m12:27:22.076479 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_refined.sql
[0m12:27:22.076593 [info ] [MainThread]: 
[0m12:27:22.076728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:27:22.078945 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.890339, "process_in_blocks": "0", "process_kernel_time": 0.216447, "process_mem_max_rss": "386580480", "process_out_blocks": "0", "process_user_time": 1.643814}
[0m12:27:22.079158 [debug] [MainThread]: Command `dbt run` failed at 12:27:22.079120 after 2.89 seconds
[0m12:27:22.079329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138a37120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138a9f1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138a9ca50>]}
[0m12:27:22.079491 [debug] [MainThread]: Flushing usage events
[0m12:27:22.284367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:38.464119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111973750>]}


============================== 12:27:38.465687 | 0a1e3fce-c673-4643-a336-6991575145a6 ==============================
[0m12:27:38.465687 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:27:38.465928 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'invocation_command': 'dbt run --select tmp_airport_vector_search_results', 'static_parser': 'True', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'warn_error': 'None', 'no_print': 'None', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m12:27:39.272651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a1e3fce-c673-4643-a336-6991575145a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ccc30>]}
[0m12:27:39.291942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a1e3fce-c673-4643-a336-6991575145a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1373c2360>]}
[0m12:27:39.292158 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:27:39.366863 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:27:39.406354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:39.406498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:39.408829 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:27:39.422826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a1e3fce-c673-4643-a336-6991575145a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137a4a650>]}
[0m12:27:39.457025 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:27:39.457843 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:27:39.463879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a1e3fce-c673-4643-a336-6991575145a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1373ce8a0>]}
[0m12:27:39.464054 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:27:39.464177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a1e3fce-c673-4643-a336-6991575145a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137641550>]}
[0m12:27:39.464896 [info ] [MainThread]: 
[0m12:27:39.465030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:39.465126 [info ] [MainThread]: 
[0m12:27:39.465311 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:27:39.465685 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:27:39.465857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:39.783420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:27:39.783937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:40.054525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:27:40.056360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:40.345054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:27:40.346844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:40.602185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a1e3fce-c673-4643-a336-6991575145a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137beb860>]}
[0m12:27:40.602735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:40.605787 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_vector_search_results
[0m12:27:40.606308 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_vector_search_results  [RUN]
[0m12:27:40.606646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_vector_search_results)
[0m12:27:40.606916 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_vector_search_results
[0m12:27:40.614863 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_vector_search_results"
[0m12:27:40.615532 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_vector_search_results
[0m12:27:40.638648 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_vector_search_results"
[0m12:27:40.639229 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_vector_search_results: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_vector_search_results"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_vector_search_results as (
  select base.icao as base_icao, base.iata as base_iata, base.name as base_name,
    query.icao as query_icao, query.iata as query_iata, query.name as query_name,
    distance
  from
    vector_search(
      table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`, -- this is the base (i.e what's in the Airport table)
      'embedding',
      table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results_embeddings` -- this is the query (i.e. results from LLM inference)
      'embedding',
      top_k => 1,
      distance_type => 'COSINE')
  where query.icao = base.icao
  order by distance
)

select * from tmp_airport_vector_search_results
    );
  
[0m12:27:40.639458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:40.890042 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:97693c69-b2ee-48f2-a27d-362a7febe24f&page=queryresults
[0m12:27:40.891452 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:97693c69-b2ee-48f2-a27d-362a7febe24f&page=queryresults
[0m12:27:40.904300 [debug] [Thread-1 (]: Database Error in model tmp_airport_vector_search_results (models/tmp/tmp_airport_vector_search_results.sql)
  Syntax error: Expected ")" but got string literal 'embedding' at [23:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_vector_search_results.sql
[0m12:27:40.905948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a1e3fce-c673-4643-a336-6991575145a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137cce5d0>]}
[0m12:27:40.906538 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_vector_search_results  [[31mERROR[0m in 0.30s]
[0m12:27:40.906963 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_vector_search_results
[0m12:27:40.907312 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_vector_search_results' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_vector_search_results (models/tmp/tmp_airport_vector_search_results.sql)
  Syntax error: Expected ")" but got string literal 'embedding' at [23:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_vector_search_results.sql.
[0m12:27:40.908574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:40.909819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:40.910035 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_vector_search_results' was properly closed.
[0m12:27:40.910235 [info ] [MainThread]: 
[0m12:27:40.910450 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m12:27:40.910881 [debug] [MainThread]: Command end result
[0m12:27:40.930231 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:27:40.931340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:27:40.934365 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:27:40.934505 [info ] [MainThread]: 
[0m12:27:40.934677 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:27:40.934808 [info ] [MainThread]: 
[0m12:27:40.934978 [error] [MainThread]: [31mFailure in model tmp_airport_vector_search_results (models/tmp/tmp_airport_vector_search_results.sql)[0m
[0m12:27:40.935137 [error] [MainThread]:   Database Error in model tmp_airport_vector_search_results (models/tmp/tmp_airport_vector_search_results.sql)
  Syntax error: Expected ")" but got string literal 'embedding' at [23:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_vector_search_results.sql
[0m12:27:40.935255 [info ] [MainThread]: 
[0m12:27:40.935396 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_vector_search_results.sql
[0m12:27:40.935511 [info ] [MainThread]: 
[0m12:27:40.935648 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:27:40.937828 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4971538, "process_in_blocks": "0", "process_kernel_time": 0.214898, "process_mem_max_rss": "383188992", "process_out_blocks": "0", "process_user_time": 1.632799}
[0m12:27:40.938042 [debug] [MainThread]: Command `dbt run` failed at 12:27:40.938002 after 2.50 seconds
[0m12:27:40.938219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c3ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137caf430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137caf1b0>]}
[0m12:27:40.938383 [debug] [MainThread]: Flushing usage events
[0m12:27:41.142091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:55.767443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043506e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105773750>]}


============================== 12:32:55.769108 | a424431e-e5f0-4e70-aa24-f41422c9a49d ==============================
[0m12:32:55.769108 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:32:55.769349 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select tmp_airport_vector_search_results', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'False', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/Users/scohen/.dbt'}
[0m12:32:56.585848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a424431e-e5f0-4e70-aa24-f41422c9a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f4c30>]}
[0m12:32:56.605012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a424431e-e5f0-4e70-aa24-f41422c9a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b9be360>]}
[0m12:32:56.605232 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:32:56.679792 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:32:56.720095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:56.720335 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_vector_search_results.sql
[0m12:32:56.800867 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:32:56.805402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a424431e-e5f0-4e70-aa24-f41422c9a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c04a150>]}
[0m12:32:56.837880 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:32:56.838751 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:32:56.845786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a424431e-e5f0-4e70-aa24-f41422c9a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b9ce8a0>]}
[0m12:32:56.845965 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:32:56.846086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a424431e-e5f0-4e70-aa24-f41422c9a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bbf5b70>]}
[0m12:32:56.846779 [info ] [MainThread]: 
[0m12:32:56.846911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:56.847003 [info ] [MainThread]: 
[0m12:32:56.847191 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:56.847538 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:32:56.847701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:57.303749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:32:57.304285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:57.628853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:32:57.630853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:57.984622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:32:57.986064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:58.280666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a424431e-e5f0-4e70-aa24-f41422c9a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c5d8530>]}
[0m12:32:58.281288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:32:58.284616 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_vector_search_results
[0m12:32:58.285170 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_vector_search_results  [RUN]
[0m12:32:58.285569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_vector_search_results)
[0m12:32:58.285850 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_vector_search_results
[0m12:32:58.292181 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_vector_search_results"
[0m12:32:58.292799 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_vector_search_results
[0m12:32:58.315561 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_vector_search_results"
[0m12:32:58.316147 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_vector_search_results: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_vector_search_results"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_vector_search_results as (
  select base.icao as base_icao, base.iata as base_iata, base.name as base_name,
    query.icao as query_icao, query.iata as query_iata, query.name as query_name,
    distance
  from
    vector_search(
      table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`, -- this is the base (i.e what's in the Airport table)
      'embedding',
      table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results_embeddings`, -- this is the query (i.e. results from LLM inference)
      'embedding',
      top_k => 1,
      distance_type => 'COSINE')
  where query.icao = base.icao
  order by distance
)

select * 
from tmp_airport_vector_search_results
    );
  
[0m12:32:58.316377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:59.034781 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:73223fa3-89b0-443a-99df-42aaf4f91e89&page=queryresults
[0m12:33:02.291853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a424431e-e5f0-4e70-aa24-f41422c9a49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c517650>]}
[0m12:33:02.292545 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_vector_search_results  [[32mCREATE TABLE (51.0 rows, 6.5 MiB processed)[0m in 4.01s]
[0m12:33:02.293027 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_vector_search_results
[0m12:33:02.294114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:02.295367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:02.295559 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_vector_search_results' was properly closed.
[0m12:33:02.295751 [info ] [MainThread]: 
[0m12:33:02.295962 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m12:33:02.296391 [debug] [MainThread]: Command end result
[0m12:33:02.315387 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:33:02.316504 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:33:02.319423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:33:02.319577 [info ] [MainThread]: 
[0m12:33:02.319755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:02.319886 [info ] [MainThread]: 
[0m12:33:02.320038 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:33:02.322309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5784106, "process_in_blocks": "0", "process_kernel_time": 0.256911, "process_mem_max_rss": "394166272", "process_out_blocks": "0", "process_user_time": 1.735542}
[0m12:33:02.322528 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:02.322485 after 6.58 seconds
[0m12:33:02.322692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c5e9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a61810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12da23430>]}
[0m12:33:02.322850 [debug] [MainThread]: Flushing usage events
[0m12:33:02.542463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:08.884308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d73750>]}


============================== 12:33:08.885881 | d070f257-d4cb-4dbe-8af2-533a5bd315cb ==============================
[0m12:33:08.885881 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:33:08.886128 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'introspect': 'True', 'partial_parse': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select tmp_airport_refined', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'write_json': 'True', 'debug': 'False', 'use_colors': 'True'}
[0m12:33:09.689434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd070f257-d4cb-4dbe-8af2-533a5bd315cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cccc30>]}
[0m12:33:09.708255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd070f257-d4cb-4dbe-8af2-533a5bd315cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ffbe360>]}
[0m12:33:09.708462 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:33:09.784094 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:33:09.823688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:33:09.823833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:33:09.826178 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:33:09.840556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd070f257-d4cb-4dbe-8af2-533a5bd315cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fd4a650>]}
[0m12:33:09.874455 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:33:09.875253 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:33:09.881207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd070f257-d4cb-4dbe-8af2-533a5bd315cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ffce8a0>]}
[0m12:33:09.881372 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:33:09.881498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd070f257-d4cb-4dbe-8af2-533a5bd315cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa3d550>]}
[0m12:33:09.882164 [info ] [MainThread]: 
[0m12:33:09.882291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:09.882385 [info ] [MainThread]: 
[0m12:33:09.882566 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:33:09.882893 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:33:09.883043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:10.173066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:33:10.173429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:10.451313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:33:10.453118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:10.757811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:33:10.759220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:11.033275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd070f257-d4cb-4dbe-8af2-533a5bd315cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13feef860>]}
[0m12:33:11.034249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:11.038152 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m12:33:11.038655 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_refined ............ [RUN]
[0m12:33:11.039022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_refined)
[0m12:33:11.039295 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_refined
[0m12:33:11.048127 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_refined"
[0m12:33:11.048802 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_refined
[0m12:33:11.072006 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_refined"
[0m12:33:11.072586 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_refined: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_refined"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_refined as (
    select *
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao not in (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)
    union all
    select * from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
    where concat(icao, ',', iata, ',', name) in
      (select concat(base_icao, ',', base_iata, ',', base_name)
       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`
       where distance < 0.08)
)

select * from tmp_airport_refined
    );
  
[0m12:33:11.072844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:11.628185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:259d3d4e-06b1-456f-bdb6-1b435b87dcb9&page=queryresults
[0m12:33:15.220483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd070f257-d4cb-4dbe-8af2-533a5bd315cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ffd2390>]}
[0m12:33:15.220841 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_refined ....... [[32mCREATE TABLE (4.1k rows, 866.7 KiB processed)[0m in 4.18s]
[0m12:33:15.221119 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m12:33:15.221725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:15.222500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:15.222636 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_refined' was properly closed.
[0m12:33:15.222759 [info ] [MainThread]: 
[0m12:33:15.222894 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m12:33:15.223185 [debug] [MainThread]: Command end result
[0m12:33:15.238073 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:33:15.238963 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:33:15.241324 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:33:15.241439 [info ] [MainThread]: 
[0m12:33:15.241579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:15.241682 [info ] [MainThread]: 
[0m12:33:15.241798 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:33:15.243565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.383042, "process_in_blocks": "0", "process_kernel_time": 0.227689, "process_mem_max_rss": "391675904", "process_out_blocks": "0", "process_user_time": 1.637892}
[0m12:33:15.243740 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:15.243706 after 6.38 seconds
[0m12:33:15.243872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ff3aa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ffaee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ffaefd0>]}
[0m12:33:15.243999 [debug] [MainThread]: Flushing usage events
[0m12:33:15.448493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:25.400895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa73750>]}


============================== 12:33:25.402524 | 53dc101f-4cd7-478e-b25e-a1d6f27cd066 ==============================
[0m12:33:25.402524 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:33:25.402768 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'use_colors': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select Airport', 'quiet': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'False'}
[0m12:33:26.209529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53dc101f-4cd7-478e-b25e-a1d6f27cd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109accc30>]}
[0m12:33:26.228553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53dc101f-4cd7-478e-b25e-a1d6f27cd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1502be360>]}
[0m12:33:26.228765 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:33:26.303244 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:33:26.342557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:33:26.342698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:33:26.345076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:33:26.359318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53dc101f-4cd7-478e-b25e-a1d6f27cd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15074a650>]}
[0m12:33:26.393089 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:33:26.393913 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:33:26.399853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53dc101f-4cd7-478e-b25e-a1d6f27cd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1502ce8a0>]}
[0m12:33:26.400024 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:33:26.400137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53dc101f-4cd7-478e-b25e-a1d6f27cd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150441550>]}
[0m12:33:26.400823 [info ] [MainThread]: 
[0m12:33:26.400948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:26.401049 [info ] [MainThread]: 
[0m12:33:26.401238 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:33:26.401603 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:33:26.401771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:26.663940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:33:26.664419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:26.972091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:33:26.973253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:27.253566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:33:27.255910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:27.515600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53dc101f-4cd7-478e-b25e-a1d6f27cd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1510ef860>]}
[0m12:33:27.516177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:27.519424 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m12:33:27.519953 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m12:33:27.520353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Airport)
[0m12:33:27.520634 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m12:33:27.529047 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m12:33:27.529604 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m12:33:27.538495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:27.830203 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m12:33:27.830971 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.name
  where a.country_code is null
)

select * 
from Airport
    );
  
[0m12:33:28.216120 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8e00977e-0d65-47fb-baea-b14f64b08f4c&page=queryresults
[0m12:33:28.217205 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8e00977e-0d65-47fb-baea-b14f64b08f4c&page=queryresults
[0m12:33:28.228175 [debug] [Thread-1 (]: Database Error in model Airport (models/int/Airport.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_country_iso_codes was not found in location us-central1
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:33:28.230141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53dc101f-4cd7-478e-b25e-a1d6f27cd066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1511ce750>]}
[0m12:33:28.230749 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Airport ............... [[31mERROR[0m in 0.71s]
[0m12:33:28.231196 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m12:33:28.231535 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport' to be skipped because of status 'error'.  Reason: Database Error in model Airport (models/int/Airport.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_country_iso_codes was not found in location us-central1
  compiled code at target/run/air_travel/models/int/Airport.sql.
[0m12:33:28.232802 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:28.234045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:28.234262 [debug] [MainThread]: Connection 'model.air_travel.Airport' was properly closed.
[0m12:33:28.234459 [info ] [MainThread]: 
[0m12:33:28.234673 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m12:33:28.235135 [debug] [MainThread]: Command end result
[0m12:33:28.254463 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:33:28.255572 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:33:28.258589 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:33:28.258739 [info ] [MainThread]: 
[0m12:33:28.258919 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:33:28.259063 [info ] [MainThread]: 
[0m12:33:28.259236 [error] [MainThread]: [31mFailure in model Airport (models/int/Airport.sql)[0m
[0m12:33:28.259398 [error] [MainThread]:   Database Error in model Airport (models/int/Airport.sql)
  Not found: Table cs378-fa2025:dbt_air_travel_tmp.tmp_airport_country_iso_codes was not found in location us-central1
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:33:28.259515 [info ] [MainThread]: 
[0m12:33:28.259650 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport.sql
[0m12:33:28.259768 [info ] [MainThread]: 
[0m12:33:28.259912 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:33:28.262081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8847208, "process_in_blocks": "0", "process_kernel_time": 0.218222, "process_mem_max_rss": "383582208", "process_out_blocks": "0", "process_user_time": 1.656873}
[0m12:33:28.262292 [debug] [MainThread]: Command `dbt run` failed at 12:33:28.262252 after 2.88 seconds
[0m12:33:28.262462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15113b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150360910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a65810>]}
[0m12:33:28.262618 [debug] [MainThread]: Flushing usage events
[0m12:33:28.466199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:40.537134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112173750>]}


============================== 12:33:40.538761 | 58f3ef05-da72-47fd-a0ec-61ec6e547723 ==============================
[0m12:33:40.538761 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:33:40.539015 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'False', 'printer_width': '80', 'fail_fast': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'version_check': 'True', 'invocation_command': 'dbt run --select tmp_airport_country_iso_codes', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None'}
[0m12:33:41.344281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58f3ef05-da72-47fd-a0ec-61ec6e547723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11109cc30>]}
[0m12:33:41.363027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58f3ef05-da72-47fd-a0ec-61ec6e547723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbc2360>]}
[0m12:33:41.363228 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:33:41.435949 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:33:41.475156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:33:41.475300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:33:41.477617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:33:41.491883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58f3ef05-da72-47fd-a0ec-61ec6e547723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15824e650>]}
[0m12:33:41.525550 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:33:41.526383 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:33:41.532499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58f3ef05-da72-47fd-a0ec-61ec6e547723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbce8a0>]}
[0m12:33:41.532666 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:33:41.532796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58f3ef05-da72-47fd-a0ec-61ec6e547723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fe41550>]}
[0m12:33:41.533467 [info ] [MainThread]: 
[0m12:33:41.533596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:41.533693 [info ] [MainThread]: 
[0m12:33:41.533888 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:33:41.534217 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:33:41.534380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:41.855718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:33:41.856285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:42.129612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:33:42.131188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:42.400937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:33:42.403030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:42.676228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58f3ef05-da72-47fd-a0ec-61ec6e547723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1583ef860>]}
[0m12:33:42.676824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:42.679999 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_iso_codes
[0m12:33:42.680526 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_country_iso_codes .. [RUN]
[0m12:33:42.680910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_country_iso_codes)
[0m12:33:42.681212 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_iso_codes
[0m12:33:42.688921 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_iso_codes"
[0m12:33:42.689656 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_iso_codes
[0m12:33:42.712370 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_country_iso_codes"
[0m12:33:42.712954 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_country_iso_codes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_country_iso_codes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`
      
    
    

    
    OPTIONS()
    as (
      with tmp_orphan_country as (
    select distinct country as airport_country_name
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`
    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)
),
tmp_airport_country_iso_codes as (
    select airport_country_name,
      AI.GENERATE(
        ('What is the iso code for the country ', airport_country_name, '? If it does not have an iso code, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from tmp_orphan_country
)
select airport_country_name, llm_response.iso_code as mapped_iso_code
from tmp_airport_country_iso_codes
    );
  
[0m12:33:42.713192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:43.374487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e156f035-505e-4567-970e-415898be783f&page=queryresults
[0m12:33:50.971679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58f3ef05-da72-47fd-a0ec-61ec6e547723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1584ce450>]}
[0m12:33:50.972368 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_country_iso_codes  [[32mCREATE TABLE (20.0 rows, 47.8 KiB processed)[0m in 8.29s]
[0m12:33:50.972839 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_iso_codes
[0m12:33:50.973928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:50.975300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:50.975523 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_country_iso_codes' was properly closed.
[0m12:33:50.975733 [info ] [MainThread]: 
[0m12:33:50.975966 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m12:33:50.976395 [debug] [MainThread]: Command end result
[0m12:33:50.997183 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:33:50.998250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:33:51.001186 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:33:51.001330 [info ] [MainThread]: 
[0m12:33:51.001504 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:51.001632 [info ] [MainThread]: 
[0m12:33:51.001777 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:33:51.003887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.490347, "process_in_blocks": "0", "process_kernel_time": 0.231599, "process_mem_max_rss": "391774208", "process_out_blocks": "0", "process_user_time": 1.663285}
[0m12:33:51.004088 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:51.004048 after 10.49 seconds
[0m12:33:51.004240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15843b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1584aaf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1584ab070>]}
[0m12:33:51.004387 [debug] [MainThread]: Flushing usage events
[0m12:33:51.204113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:54.485378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039886e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d3750>]}


============================== 12:33:54.486976 | 50b6f0e9-2780-47e4-ab35-ba720b9033ab ==============================
[0m12:33:54.486976 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:33:54.487219 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'False', 'fail_fast': 'False', 'introspect': 'True', 'debug': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_format': 'default', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'invocation_command': 'dbt run --select Airport', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m12:33:55.289156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50b6f0e9-2780-47e4-ab35-ba720b9033ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b2cc30>]}
[0m12:33:55.308305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50b6f0e9-2780-47e4-ab35-ba720b9033ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a7c2360>]}
[0m12:33:55.308514 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:33:55.382350 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:33:55.421662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:33:55.421801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:33:55.424129 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:33:55.438231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50b6f0e9-2780-47e4-ab35-ba720b9033ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ad4a650>]}
[0m12:33:55.471972 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:33:55.472801 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:33:55.478709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50b6f0e9-2780-47e4-ab35-ba720b9033ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a7ce8a0>]}
[0m12:33:55.478880 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:33:55.479007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50b6f0e9-2780-47e4-ab35-ba720b9033ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a941550>]}
[0m12:33:55.479664 [info ] [MainThread]: 
[0m12:33:55.479793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:55.479889 [info ] [MainThread]: 
[0m12:33:55.480092 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:33:55.480440 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:33:55.480600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:55.798485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:33:55.799030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:56.045241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:33:56.046354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:56.328544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:33:56.330277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:56.588073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50b6f0e9-2780-47e4-ab35-ba720b9033ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8eb860>]}
[0m12:33:56.588952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:56.593253 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m12:33:56.593973 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m12:33:56.594449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Airport)
[0m12:33:56.594745 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m12:33:56.603630 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m12:33:56.604391 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m12:33:56.613880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:56.938197 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m12:33:56.938753 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.name
  where a.country_code is null
)

select * 
from Airport
    );
  
[0m12:33:57.403612 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:bf3be20a-4880-483c-9e82-2d2e79d1cf25&page=queryresults
[0m12:33:57.491087 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:bf3be20a-4880-483c-9e82-2d2e79d1cf25&page=queryresults
[0m12:33:57.501882 [debug] [Thread-1 (]: Database Error in model Airport (models/int/Airport.sql)
  Name data_source not found inside a at [17:25]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:33:57.503441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50b6f0e9-2780-47e4-ab35-ba720b9033ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c9c4d10>]}
[0m12:33:57.503992 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Airport ............... [[31mERROR[0m in 0.91s]
[0m12:33:57.504389 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m12:33:57.504704 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport' to be skipped because of status 'error'.  Reason: Database Error in model Airport (models/int/Airport.sql)
  Name data_source not found inside a at [17:25]
  compiled code at target/run/air_travel/models/int/Airport.sql.
[0m12:33:57.505920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:57.507094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:57.507301 [debug] [MainThread]: Connection 'model.air_travel.Airport' was properly closed.
[0m12:33:57.507480 [info ] [MainThread]: 
[0m12:33:57.507670 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m12:33:57.508086 [debug] [MainThread]: Command end result
[0m12:33:57.525731 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:33:57.526761 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:33:57.529761 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:33:57.529939 [info ] [MainThread]: 
[0m12:33:57.530120 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:33:57.530261 [info ] [MainThread]: 
[0m12:33:57.530433 [error] [MainThread]: [31mFailure in model Airport (models/int/Airport.sql)[0m
[0m12:33:57.530603 [error] [MainThread]:   Database Error in model Airport (models/int/Airport.sql)
  Name data_source not found inside a at [17:25]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:33:57.530731 [info ] [MainThread]: 
[0m12:33:57.530866 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport.sql
[0m12:33:57.530973 [info ] [MainThread]: 
[0m12:33:57.531106 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:33:57.533272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0715282, "process_in_blocks": "0", "process_kernel_time": 0.21204, "process_mem_max_rss": "384057344", "process_out_blocks": "0", "process_user_time": 1.652037}
[0m12:33:57.533482 [debug] [MainThread]: Command `dbt run` failed at 12:33:57.533444 after 3.07 seconds
[0m12:33:57.533648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c9371d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100694550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a860910>]}
[0m12:33:57.533801 [debug] [MainThread]: Flushing usage events
[0m12:33:57.735434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:15.672498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e8c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd7750>]}


============================== 12:34:15.674095 | 2f13cbc1-a8af-4492-b50e-349b8e9e8897 ==============================
[0m12:34:15.674095 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:34:15.674341 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'static_parser': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select Airport', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m12:34:16.479350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f13cbc1-a8af-4492-b50e-349b8e9e8897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104030c30>]}
[0m12:34:16.498291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f13cbc1-a8af-4492-b50e-349b8e9e8897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347c2360>]}
[0m12:34:16.498523 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:34:16.573214 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:34:16.613263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:34:16.613511 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport.sql
[0m12:34:16.693257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:34:16.697783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f13cbc1-a8af-4492-b50e-349b8e9e8897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13554a150>]}
[0m12:34:16.729654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:34:16.730497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:34:16.737345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f13cbc1-a8af-4492-b50e-349b8e9e8897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347ce8a0>]}
[0m12:34:16.737541 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:34:16.737669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f13cbc1-a8af-4492-b50e-349b8e9e8897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1352edb70>]}
[0m12:34:16.738386 [info ] [MainThread]: 
[0m12:34:16.738518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:34:16.738610 [info ] [MainThread]: 
[0m12:34:16.738804 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:34:16.739164 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:34:16.739336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:17.080954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:34:17.081506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:17.345197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:34:17.346994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:17.648954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:34:17.651356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:17.922795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f13cbc1-a8af-4492-b50e-349b8e9e8897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135d17c70>]}
[0m12:34:17.923346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:17.925981 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m12:34:17.926360 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m12:34:17.926635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.Airport)
[0m12:34:17.926845 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m12:34:17.932362 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m12:34:17.932802 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m12:34:17.941010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:18.235135 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m12:34:18.235627 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.name
  where a.country_code is null
)

select * 
from Airport
    );
  
[0m12:34:18.755253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c2c8d7e3-7f19-4fc2-a679-f7de834314e4&page=queryresults
[0m12:34:18.859714 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c2c8d7e3-7f19-4fc2-a679-f7de834314e4&page=queryresults
[0m12:34:18.873468 [debug] [Thread-1 (]: Database Error in model Airport (models/int/Airport.sql)
  Name name not found inside c at [25:20]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:34:18.875331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f13cbc1-a8af-4492-b50e-349b8e9e8897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135d19a90>]}
[0m12:34:18.875953 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Airport ............... [[31mERROR[0m in 0.95s]
[0m12:34:18.876413 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m12:34:18.876805 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport' to be skipped because of status 'error'.  Reason: Database Error in model Airport (models/int/Airport.sql)
  Name name not found inside c at [25:20]
  compiled code at target/run/air_travel/models/int/Airport.sql.
[0m12:34:18.878142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:18.879284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:18.879472 [debug] [MainThread]: Connection 'model.air_travel.Airport' was properly closed.
[0m12:34:18.879657 [info ] [MainThread]: 
[0m12:34:18.879856 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m12:34:18.880282 [debug] [MainThread]: Command end result
[0m12:34:18.899902 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:34:18.901060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:34:18.904244 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:34:18.904402 [info ] [MainThread]: 
[0m12:34:18.904587 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:34:18.904732 [info ] [MainThread]: 
[0m12:34:18.904909 [error] [MainThread]: [31mFailure in model Airport (models/int/Airport.sql)[0m
[0m12:34:18.905066 [error] [MainThread]:   Database Error in model Airport (models/int/Airport.sql)
  Name name not found inside c at [25:20]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:34:18.905186 [info ] [MainThread]: 
[0m12:34:18.905332 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport.sql
[0m12:34:18.905445 [info ] [MainThread]: 
[0m12:34:18.905583 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:34:18.907793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.258735, "process_in_blocks": "0", "process_kernel_time": 0.219373, "process_mem_max_rss": "398508032", "process_out_blocks": "0", "process_user_time": 1.711266}
[0m12:34:18.908000 [debug] [MainThread]: Command `dbt run` failed at 12:34:18.907959 after 3.26 seconds
[0m12:34:18.908176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dd8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dba7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dbb250>]}
[0m12:34:18.908336 [debug] [MainThread]: Flushing usage events
[0m12:34:19.118046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:08.621898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046986e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e3750>]}


============================== 12:35:08.623590 | a8415a96-bd50-424f-bf68-2875085d81ea ==============================
[0m12:35:08.623590 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:35:08.623820 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select Country', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'write_json': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'indirect_selection': 'eager'}
[0m12:35:09.447636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8415a96-bd50-424f-bf68-2875085d81ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483cc30>]}
[0m12:35:09.466906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8415a96-bd50-424f-bf68-2875085d81ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b3be360>]}
[0m12:35:09.467127 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:35:09.541784 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:35:09.581847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:09.581991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:09.584341 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:35:09.598745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8415a96-bd50-424f-bf68-2875085d81ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c14e650>]}
[0m12:35:09.632237 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:35:09.633080 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:35:09.639170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8415a96-bd50-424f-bf68-2875085d81ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b3ce8a0>]}
[0m12:35:09.639360 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:35:09.639490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8415a96-bd50-424f-bf68-2875085d81ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b63d550>]}
[0m12:35:09.640180 [info ] [MainThread]: 
[0m12:35:09.640310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:09.640404 [info ] [MainThread]: 
[0m12:35:09.640590 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:35:09.640947 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:35:09.641118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:10.066995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:35:10.067549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:10.376163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:35:10.377207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:10.649288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:35:10.650803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:10.936456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8415a96-bd50-424f-bf68-2875085d81ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2eb860>]}
[0m12:35:10.937194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:10.940688 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m12:35:10.941220 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Country ........................ [RUN]
[0m12:35:10.941627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Country)
[0m12:35:10.941929 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m12:35:10.950217 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m12:35:10.950983 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m12:35:10.960400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:11.250600 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Country"
[0m12:35:11.251396 [debug] [Thread-1 (]: On model.air_travel.Country: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Country"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Country`
      
    
    

    
    OPTIONS()
    as (
      with Country as (
    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` 
    group by iso_code, name, _data_source, _load_time
)

select *
from Country
where iso_code is not null 
union all
select t.mapped_iso_code, c.name, c.dafif_codes, c._data_source, c._load_time 
from Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes` t 
on c.name = t.name
where t.mapped_iso_code is not null
and c.iso_code is null
    );
  
[0m12:35:11.696858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:54ea088e-70ac-45d8-a886-b7c124d0d321&page=queryresults
[0m12:35:13.968055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8415a96-bd50-424f-bf68-2875085d81ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3c7110>]}
[0m12:35:13.968717 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Country ................... [[32mCREATE TABLE (245.0 rows, 10.7 KiB processed)[0m in 3.03s]
[0m12:35:13.969175 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m12:35:13.970201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:13.971436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:13.971631 [debug] [MainThread]: Connection 'model.air_travel.Country' was properly closed.
[0m12:35:13.971827 [info ] [MainThread]: 
[0m12:35:13.972032 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m12:35:13.972479 [debug] [MainThread]: Command end result
[0m12:35:13.992418 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:35:13.993511 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:35:13.996370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:35:13.996509 [info ] [MainThread]: 
[0m12:35:13.996679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:13.996806 [info ] [MainThread]: 
[0m12:35:13.996952 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:35:13.999036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4021673, "process_in_blocks": "0", "process_kernel_time": 0.255074, "process_mem_max_rss": "389513216", "process_out_blocks": "0", "process_user_time": 1.692144}
[0m12:35:13.999242 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:13.999201 after 5.40 seconds
[0m12:35:13.999400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c33ae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3c1b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3c2fd0>]}
[0m12:35:13.999570 [debug] [MainThread]: Flushing usage events
[0m12:35:14.219511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:17.068242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a473750>]}


============================== 12:35:17.069994 | a1e20334-d806-467d-a6a9-cf4480fa89da ==============================
[0m12:35:17.069994 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:35:17.070233 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'empty': 'False', 'use_colors': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select Airport', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'cache_selected_only': 'False', 'static_parser': 'True', 'debug': 'False'}
[0m12:35:17.883953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1e20334-d806-467d-a6a9-cf4480fa89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108accc30>]}
[0m12:35:17.903011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1e20334-d806-467d-a6a9-cf4480fa89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378be360>]}
[0m12:35:17.903228 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:35:17.978002 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:35:18.017428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:18.017570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:18.019936 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:35:18.033516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1e20334-d806-467d-a6a9-cf4480fa89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f4a650>]}
[0m12:35:18.067059 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:35:18.067928 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:35:18.074062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1e20334-d806-467d-a6a9-cf4480fa89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378ce8a0>]}
[0m12:35:18.074240 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:35:18.074359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e20334-d806-467d-a6a9-cf4480fa89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b3d550>]}
[0m12:35:18.075068 [info ] [MainThread]: 
[0m12:35:18.075196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:18.075289 [info ] [MainThread]: 
[0m12:35:18.075486 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:35:18.075850 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:35:18.076020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:18.408139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:35:18.408698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:18.659797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:35:18.660997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:18.950532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:35:18.952849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:19.257176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e20334-d806-467d-a6a9-cf4480fa89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1500eb860>]}
[0m12:35:19.257803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:19.260991 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m12:35:19.261515 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m12:35:19.261904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Airport)
[0m12:35:19.262184 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m12:35:19.271068 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m12:35:19.271866 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m12:35:19.281211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:19.625336 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m12:35:19.626187 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.name
  where a.country_code is null
)

select * 
from Airport
    );
  
[0m12:35:19.991231 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0d9a56b3-db8e-4d62-b449-1e7e38af80d3&page=queryresults
[0m12:35:20.093001 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0d9a56b3-db8e-4d62-b449-1e7e38af80d3&page=queryresults
[0m12:35:20.106472 [debug] [Thread-1 (]: Database Error in model Airport (models/int/Airport.sql)
  Name name not found inside c at [25:20]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:35:20.108553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1e20334-d806-467d-a6a9-cf4480fa89da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1501c6810>]}
[0m12:35:20.109266 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Airport ............... [[31mERROR[0m in 0.85s]
[0m12:35:20.109735 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m12:35:20.110077 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport' to be skipped because of status 'error'.  Reason: Database Error in model Airport (models/int/Airport.sql)
  Name name not found inside c at [25:20]
  compiled code at target/run/air_travel/models/int/Airport.sql.
[0m12:35:20.111465 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:20.112792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:20.113019 [debug] [MainThread]: Connection 'model.air_travel.Airport' was properly closed.
[0m12:35:20.113220 [info ] [MainThread]: 
[0m12:35:20.113429 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m12:35:20.113860 [debug] [MainThread]: Command end result
[0m12:35:20.132775 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:35:20.133881 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:35:20.136831 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:35:20.136993 [info ] [MainThread]: 
[0m12:35:20.137173 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:35:20.137307 [info ] [MainThread]: 
[0m12:35:20.137481 [error] [MainThread]: [31mFailure in model Airport (models/int/Airport.sql)[0m
[0m12:35:20.137633 [error] [MainThread]:   Database Error in model Airport (models/int/Airport.sql)
  Name name not found inside c at [25:20]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:35:20.137750 [info ] [MainThread]: 
[0m12:35:20.137889 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport.sql
[0m12:35:20.138003 [info ] [MainThread]: 
[0m12:35:20.138140 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:35:20.140338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.096719, "process_in_blocks": "0", "process_kernel_time": 0.22387, "process_mem_max_rss": "381304832", "process_out_blocks": "0", "process_user_time": 1.668568}
[0m12:35:20.140547 [debug] [MainThread]: Command `dbt run` failed at 12:35:20.140508 after 3.10 seconds
[0m12:35:20.140716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15013b120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137a50910>]}
[0m12:35:20.140873 [debug] [MainThread]: Flushing usage events
[0m12:35:20.351750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:02.968205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042406e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d73750>]}


============================== 12:37:02.969838 | 5eaea612-fdb4-4456-9104-870072d72691 ==============================
[0m12:37:02.969838 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:37:02.970079 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'invocation_command': 'dbt run --select Airport', 'fail_fast': 'False', 'printer_width': '80', 'empty': 'False', 'introspect': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'debug': 'False', 'target_path': 'None'}
[0m12:37:03.813572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5eaea612-fdb4-4456-9104-870072d72691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e4c30>]}
[0m12:37:03.832510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5eaea612-fdb4-4456-9104-870072d72691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e4be360>]}
[0m12:37:03.832719 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:37:03.906972 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:37:03.947817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:03.948075 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport.sql
[0m12:37:04.027750 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:37:04.032332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5eaea612-fdb4-4456-9104-870072d72691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f352150>]}
[0m12:37:04.064126 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:37:04.065000 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:37:04.071971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5eaea612-fdb4-4456-9104-870072d72691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e4ce8a0>]}
[0m12:37:04.072159 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:37:04.072282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eaea612-fdb4-4456-9104-870072d72691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e7f5b70>]}
[0m12:37:04.073001 [info ] [MainThread]: 
[0m12:37:04.073132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:04.073230 [info ] [MainThread]: 
[0m12:37:04.073412 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:37:04.073745 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:37:04.073894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:04.423344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:37:04.424000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:04.853213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:37:04.855123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:05.189643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:37:05.190717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:05.537130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eaea612-fdb4-4456-9104-870072d72691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fad0390>]}
[0m12:37:05.538159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:05.542149 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m12:37:05.542696 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m12:37:05.543081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Airport)
[0m12:37:05.543374 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m12:37:05.550743 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m12:37:05.551451 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m12:37:05.561357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:05.880986 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m12:37:05.881880 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.airport_country_name
  where a.country_code is null
)

select * 
from Airport
    );
  
[0m12:37:06.281625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8ee5e75b-fd16-49b3-a418-8bdc1d9532b8&page=queryresults
[0m12:37:06.427780 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8ee5e75b-fd16-49b3-a418-8bdc1d9532b8&page=queryresults
[0m12:37:06.439704 [debug] [Thread-1 (]: Database Error in model Airport (models/int/Airport.sql)
  Name country_code not found inside a at [26:11]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:37:06.442360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5eaea612-fdb4-4456-9104-870072d72691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa1f4d0>]}
[0m12:37:06.443038 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Airport ............... [[31mERROR[0m in 0.90s]
[0m12:37:06.443510 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m12:37:06.443843 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport' to be skipped because of status 'error'.  Reason: Database Error in model Airport (models/int/Airport.sql)
  Name country_code not found inside a at [26:11]
  compiled code at target/run/air_travel/models/int/Airport.sql.
[0m12:37:06.445109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:06.446303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:06.446509 [debug] [MainThread]: Connection 'model.air_travel.Airport' was properly closed.
[0m12:37:06.446704 [info ] [MainThread]: 
[0m12:37:06.446913 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m12:37:06.447361 [debug] [MainThread]: Command end result
[0m12:37:06.466352 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:37:06.467430 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:37:06.470557 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:37:06.470720 [info ] [MainThread]: 
[0m12:37:06.470902 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:37:06.471043 [info ] [MainThread]: 
[0m12:37:06.471214 [error] [MainThread]: [31mFailure in model Airport (models/int/Airport.sql)[0m
[0m12:37:06.471370 [error] [MainThread]:   Database Error in model Airport (models/int/Airport.sql)
  Name country_code not found inside a at [26:11]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:37:06.471488 [info ] [MainThread]: 
[0m12:37:06.471623 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport.sql
[0m12:37:06.471738 [info ] [MainThread]: 
[0m12:37:06.471878 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:37:06.474088 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.529615, "process_in_blocks": "0", "process_kernel_time": 0.24421, "process_mem_max_rss": "398245888", "process_out_blocks": "0", "process_user_time": 1.751007}
[0m12:37:06.474311 [debug] [MainThread]: Command `dbt run` failed at 12:37:06.474268 after 3.53 seconds
[0m12:37:06.474489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fad8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12faa8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12faab2f0>]}
[0m12:37:06.474648 [debug] [MainThread]: Flushing usage events
[0m12:37:06.699989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:16.719474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111073750>]}


============================== 12:40:16.721105 | 5504d1b2-3de0-48d5-873a-db17b37c0cbd ==============================
[0m12:40:16.721105 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:40:16.721346 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'quiet': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'empty': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'no_print': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select Airport', 'static_parser': 'True'}
[0m12:40:17.538464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5504d1b2-3de0-48d5-873a-db17b37c0cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ccc30>]}
[0m12:40:17.557595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5504d1b2-3de0-48d5-873a-db17b37c0cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dec2360>]}
[0m12:40:17.557812 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:40:17.632205 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:40:17.672362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:17.672606 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport.sql
[0m12:40:17.753003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:40:17.757507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5504d1b2-3de0-48d5-873a-db17b37c0cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ec4e150>]}
[0m12:40:17.789102 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:40:17.789985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:40:17.797052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5504d1b2-3de0-48d5-873a-db17b37c0cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dece8a0>]}
[0m12:40:17.797229 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:40:17.797357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5504d1b2-3de0-48d5-873a-db17b37c0cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e9f1b70>]}
[0m12:40:17.798037 [info ] [MainThread]: 
[0m12:40:17.798169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:17.798279 [info ] [MainThread]: 
[0m12:40:17.798466 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:40:17.798800 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:40:17.798965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:18.139737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:40:18.140282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:18.428107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:40:18.429873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:18.735208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:40:18.736269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:19.087257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5504d1b2-3de0-48d5-873a-db17b37c0cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fcd47a0>]}
[0m12:40:19.088047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:19.091569 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m12:40:19.092092 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m12:40:19.092478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.Airport)
[0m12:40:19.092752 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m12:40:19.099775 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m12:40:19.100443 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m12:40:19.109943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:19.397661 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m12:40:19.398168 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a.data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.airport_country_name
  where c.mapped_iso_code is not null
)

select * 
from Airport
    );
  
[0m12:40:19.821755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a76d0012-e732-4cbc-84e8-1191cb1c0a32&page=queryresults
[0m12:40:20.026648 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a76d0012-e732-4cbc-84e8-1191cb1c0a32&page=queryresults
[0m12:40:20.038622 [debug] [Thread-1 (]: Database Error in model Airport (models/int/Airport.sql)
  Name data_source not found inside a at [24:25]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:40:20.040423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5504d1b2-3de0-48d5-873a-db17b37c0cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fc1b4d0>]}
[0m12:40:20.041051 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Airport ............... [[31mERROR[0m in 0.95s]
[0m12:40:20.041520 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m12:40:20.042023 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport' to be skipped because of status 'error'.  Reason: Database Error in model Airport (models/int/Airport.sql)
  Name data_source not found inside a at [24:25]
  compiled code at target/run/air_travel/models/int/Airport.sql.
[0m12:40:20.043476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:20.044723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:20.044939 [debug] [MainThread]: Connection 'model.air_travel.Airport' was properly closed.
[0m12:40:20.045137 [info ] [MainThread]: 
[0m12:40:20.045348 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m12:40:20.045780 [debug] [MainThread]: Command end result
[0m12:40:20.065162 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:40:20.066251 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:40:20.069296 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:40:20.069446 [info ] [MainThread]: 
[0m12:40:20.069640 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:40:20.069782 [info ] [MainThread]: 
[0m12:40:20.069956 [error] [MainThread]: [31mFailure in model Airport (models/int/Airport.sql)[0m
[0m12:40:20.070108 [error] [MainThread]:   Database Error in model Airport (models/int/Airport.sql)
  Name data_source not found inside a at [24:25]
  compiled code at target/run/air_travel/models/int/Airport.sql
[0m12:40:20.070223 [info ] [MainThread]: 
[0m12:40:20.070361 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport.sql
[0m12:40:20.070475 [info ] [MainThread]: 
[0m12:40:20.070616 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:40:20.072865 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3768299, "process_in_blocks": "0", "process_kernel_time": 0.237919, "process_mem_max_rss": "389201920", "process_out_blocks": "0", "process_user_time": 1.722357}
[0m12:40:20.073084 [debug] [MainThread]: Command `dbt run` failed at 12:40:20.073043 after 3.38 seconds
[0m12:40:20.073259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fcd8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fcb8a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fcbb2f0>]}
[0m12:40:20.073417 [debug] [MainThread]: Flushing usage events
[0m12:40:20.318902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:41.253773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066886e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d3750>]}


============================== 12:40:41.255503 | 99c66a55-80ed-447d-8fed-8b7ffd137df3 ==============================
[0m12:40:41.255503 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:40:41.255750 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'empty': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select Airport', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'fail_fast': 'False', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'partial_parse': 'True'}
[0m12:40:42.074214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99c66a55-80ed-447d-8fed-8b7ffd137df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682cc30>]}
[0m12:40:42.093101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99c66a55-80ed-447d-8fed-8b7ffd137df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238c2360>]}
[0m12:40:42.093313 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:40:42.166423 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:40:42.206286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:42.206553 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport.sql
[0m12:40:42.287375 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:40:42.291985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99c66a55-80ed-447d-8fed-8b7ffd137df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f4a150>]}
[0m12:40:42.323917 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:40:42.324781 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:40:42.331697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99c66a55-80ed-447d-8fed-8b7ffd137df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238ce8a0>]}
[0m12:40:42.331905 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m12:40:42.332030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99c66a55-80ed-447d-8fed-8b7ffd137df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bf1b70>]}
[0m12:40:42.332727 [info ] [MainThread]: 
[0m12:40:42.332852 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:42.332946 [info ] [MainThread]: 
[0m12:40:42.333124 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:40:42.333465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:40:42.333618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:42.673424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:40:42.673969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:42.942668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:40:42.945188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:43.219510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:40:43.220946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:43.570094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99c66a55-80ed-447d-8fed-8b7ffd137df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124edc940>]}
[0m12:40:43.571181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:43.575027 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m12:40:43.575506 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m12:40:43.575863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Airport)
[0m12:40:43.576135 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m12:40:43.583572 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m12:40:43.584402 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m12:40:43.594142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:43.925407 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m12:40:43.926259 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.airport_country_name
  where c.mapped_iso_code is not null
)

select distinct * 
from Airport
    );
  
[0m12:40:44.297506 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7f27823f-5696-4882-9dec-740b53e1fc73&page=queryresults
[0m12:40:46.261086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99c66a55-80ed-447d-8fed-8b7ffd137df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e1bc50>]}
[0m12:40:46.261606 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Airport ................... [[32mCREATE TABLE (4.0k rows, 629.7 KiB processed)[0m in 2.68s]
[0m12:40:46.261974 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m12:40:46.262698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:46.263688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:46.263854 [debug] [MainThread]: Connection 'model.air_travel.Airport' was properly closed.
[0m12:40:46.264015 [info ] [MainThread]: 
[0m12:40:46.264185 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.93 seconds (3.93s).
[0m12:40:46.264557 [debug] [MainThread]: Command end result
[0m12:40:46.280884 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:40:46.281872 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:40:46.284635 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:40:46.284768 [info ] [MainThread]: 
[0m12:40:46.284939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:46.285069 [info ] [MainThread]: 
[0m12:40:46.285221 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:40:46.287341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.057623, "process_in_blocks": "0", "process_kernel_time": 0.239394, "process_mem_max_rss": "393265152", "process_out_blocks": "0", "process_user_time": 1.767495}
[0m12:40:46.287546 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:46.287504 after 5.06 seconds
[0m12:40:46.287700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124ee5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103360550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12631c230>]}
[0m12:40:46.287846 [debug] [MainThread]: Flushing usage events
[0m12:40:46.498870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:33.412340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103edc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d27750>]}


============================== 13:28:33.413929 | 4fd109cc-e244-4f98-8785-306d1b332537 ==============================
[0m13:28:33.413929 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:28:33.414177 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'static_parser': 'True', 'write_json': 'True', 'empty': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --select models/tmp/tmp_airline_country_mapped.sql models/tmp/tmp_airport_all.sql models/tmp/tmp_airport_country_iso_codes.sql models/tmp/tmp_airport_duplicates_embeddings.sql models/tmp/tmp_airport_duplicates.sql models/tmp/tmp_airport_establishment_broad_categories_mapped.sql models/tmp/tmp_airport_establishment_canonical_categories.sql models/tmp/tmp_airport_establishment_raw_categories.sql models/tmp/tmp_airport_establishment_sub_categories_mapped.sql models/tmp/tmp_airport_establishment_unique.sql models/tmp/tmp_airport_inference_results_embeddings.sql models/tmp/tmp_airport_inference_results.sql models/tmp/tmp_airport_llm.sql models/tmp/tmp_airport_refined.sql models/tmp/tmp_airport_vector_search_results.sql models/tmp/tmp_country_iso_codes.sql --exclude tmp_airport_llm', 'printer_width': '80', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False'}
[0m13:28:34.292779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fd109cc-e244-4f98-8785-306d1b332537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104080c30>]}
[0m13:28:34.311611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fd109cc-e244-4f98-8785-306d1b332537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12adbe360>]}
[0m13:28:34.311813 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:28:34.386122 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:28:34.428184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:34.428331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:34.430678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m13:28:34.444818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fd109cc-e244-4f98-8785-306d1b332537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd4a650>]}
[0m13:28:34.478299 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:28:34.479111 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:28:34.485173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fd109cc-e244-4f98-8785-306d1b332537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12adce8a0>]}
[0m13:28:34.485345 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m13:28:34.485468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd109cc-e244-4f98-8785-306d1b332537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b841550>]}
[0m13:28:34.493337 [info ] [MainThread]: 
[0m13:28:34.493605 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:28:34.493738 [info ] [MainThread]: 
[0m13:28:34.493953 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:28:34.495631 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:28:34.495786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:34.935085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:28:34.935689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:35.247752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:28:35.249171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:35.548776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:28:35.550566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:35.849873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd109cc-e244-4f98-8785-306d1b332537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12beef860>]}
[0m13:28:35.850693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:35.854367 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m13:28:35.854874 [info ] [Thread-1 (]: 1 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_all ............... [RUN]
[0m13:28:35.855277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_all)
[0m13:28:35.855570 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_all
[0m13:28:35.864011 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_all"
[0m13:28:35.864805 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_all
[0m13:28:35.874144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:36.166215 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_all"
[0m13:28:36.166877 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_all: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_all"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_all as (
    select distinct al.llm_icao as icao, a.iata, a.name, a.city, al.llm_state_prov as state_prov, 
        a.country, a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, 
        a.timezone_name, a.type, a.source, 'openflights,llm' as _data_source, a._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm` al
    on a.name = al.name and a.country = al.country
    where a.iata is not null
    and al.llm_icao is not null
)

select * from tmp_airport_all
    );
  
[0m13:28:36.668411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4bf4a938-eb6f-4a20-b833-85e1715b4c0f&page=queryresults
[0m13:28:38.649104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd109cc-e244-4f98-8785-306d1b332537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bfd7050>]}
[0m13:28:38.649711 [info ] [Thread-1 (]: 1 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_all .......... [[32mCREATE TABLE (4.7k rows, 1.6 MiB processed)[0m in 2.79s]
[0m13:28:38.650122 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m13:28:38.650389 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:28:38.650785 [info ] [Thread-1 (]: 2 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [RUN]
[0m13:28:38.651182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_all, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m13:28:38.651399 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:28:38.652568 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:28:38.653123 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:28:38.654741 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:28:38.655216 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_canonical_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_canonical_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_canonical_categories as (
    select 'Quick Service & Grab-and-Go' as broad_category, 'National/International Fast Food Chains' as sub_category,
    select 'Quick Service & Grab-and-Go' as broad_category, 'Coffee & Beverage Shops' as sub_category,
    select 'Quick Service & Grab-and-Go' as broad_category, 'Snack Kiosks' as sub_category,
    select 'Quick Service & Grab-and-Go' as broad_category, 'Pre-Packaged Foods' as sub_category,
    select 'Fast Casual' as broad_category, 'Gourmet Burgers & Sandwiches' as sub_category,
    select 'Fast Casual' as broad_category, 'Build-Your-Own Concepts' as sub_category,
    select 'Fast Casual' as broad_category, 'Pizzerias' as sub_category,
    select 'Full-Service Dining' as broad_category, 'Casual Dining Restaurants' as sub_category,
    select 'Full-Service Dining' as broad_category, 'Upscale & Chef-Driven Restaurants' as sub_category,
    select 'Full-Service Dining' as broad_category, 'Themed Restaurants & Sports Bars' as sub_category,
    select 'Bars & Lounges' as broad_category, 'Wine Bars' as sub_category,
    select 'Bars & Lounges' as broad_category, 'Craft Beer Pubs' as sub_category,
    select 'Bars & Lounges' as broad_category, 'Cocktail Lounges' as sub_category,
    select 'Travel Essentials & Convenience' as broad_category, 'Newsstands & Bookstores' as sub_category,
    select 'Travel Essentials & Convenience' as broad_category, 'Pharmacies & Personal Care' as sub_category,
    select 'Travel Essentials & Convenience' as broad_category, 'Travel Gear & Luggage' as sub_category,
    select 'Specialty Retail' as broad_category, 'Electronics' as sub_category,
    select 'Specialty Retail' as broad_category, 'Local Souvenirs & Gifts' as sub_category,
    select 'Specialty Retail' as broad_category, 'Apparel & Accessories' as sub_category,
    select 'Luxury & High-End Goods' as broad_category, 'Confectionery & Gourmet Foods' as sub_category,
    select 'Luxury & High-End Goods' as broad_category, 'Designer Fashion' as sub_category,
    select 'Luxury & High-End Goods' as broad_category, 'Jewelry & Watches' as sub_category,
    select 'Luxury & High-End Goods' as broad_category, 'High-End Cosmetics' as sub_category,
    select 'Duty-Free' as broad_category, 'Liquor & Tobacco' as sub_category,
    select 'Duty-Free' as broad_category, 'Fragrances & Cosmetics' as sub_category,
    select 'Duty-Free' as broad_category, 'Luxury Accessories & Confectionery' as sub_category,
    select 'Passenger Comfort & Wellness' as broad_category, 'Spas & Salons' as sub_category,
    select 'Passenger Comfort & Wellness' as broad_category, 'Pay-Per-Use Lounges' as sub_category,
    select 'Passenger Comfort & Wellness' as broad_category, 'Yoga & Meditation Rooms' as sub_category,
    select 'Passenger Comfort & Wellness' as broad_category, 'Shower Facilities' as sub_category,
    select 'Financial & Business Services' as broad_category, 'Currency Exchan' as sub_category,
    select 'Financial & Business Services' as broad_category, 'ATMs & Banking Services' as sub_category,
    select 'Financial & Business Services' as broad_category, 'Business Centers & Work Pods' as sub_category,
    select 'Practical & Convenience Services' as broad_category, 'Luggage Storage & Wrapping' as sub_category,
    select 'Practical & Convenience Services' as broad_category, 'Postal & Shipping Services' as sub_category,
    select 'Practical & Convenience Services' as broad_category, 'Pet Relief & Care Areas' as sub_category,
    select 'Practical & Convenience Services' as broad_category, 'Vending Machines (non-F&B)' as sub_category,
)

select * 
from tmp_airport_establishment_canonical_categories
    );
  
[0m13:28:38.655532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:39.125628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1b183a60-6dae-4d0f-8281-440a62562a64&page=queryresults
[0m13:28:39.127112 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1b183a60-6dae-4d0f-8281-440a62562a64&page=queryresults
[0m13:28:39.141597 [debug] [Thread-1 (]: Database Error in model tmp_airport_establishment_canonical_categories (models/tmp/tmp_airport_establishment_canonical_categories.sql)
  Syntax error: Expected ")" but got keyword SELECT at [16:5]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_canonical_categories.sql
[0m13:28:39.142137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd109cc-e244-4f98-8785-306d1b332537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bfb5650>]}
[0m13:28:39.142760 [error] [Thread-1 (]: 2 of 15 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [[31mERROR[0m in 0.49s]
[0m13:28:39.143218 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:28:39.143500 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m13:28:39.143871 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_canonical_categories' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_establishment_canonical_categories (models/tmp/tmp_airport_establishment_canonical_categories.sql)
  Syntax error: Expected ")" but got keyword SELECT at [16:5]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_canonical_categories.sql.
[0m13:28:39.144246 [info ] [Thread-1 (]: 3 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [RUN]
[0m13:28:39.145165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_canonical_categories, now model.air_travel.tmp_airport_establishment_unique)
[0m13:28:39.145480 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m13:28:39.147349 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:28:39.147866 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m13:28:39.149913 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:28:39.150384 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_unique: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_unique"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_unique as
  select distinct business, category, dining, _data_source, _load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
  order by category, business

select * from tmp_airport_establishment_unique
    );
  
[0m13:28:39.150637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:39.402064 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6dbb7fca-6612-499a-8602-3ce1322df422&page=queryresults
[0m13:28:39.403358 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6dbb7fca-6612-499a-8602-3ce1322df422&page=queryresults
[0m13:28:39.412599 [debug] [Thread-1 (]: Database Error in model tmp_airport_establishment_unique (models/tmp/tmp_airport_establishment_unique.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_unique.sql
[0m13:28:39.413355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd109cc-e244-4f98-8785-306d1b332537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb6b930>]}
[0m13:28:39.414097 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [[31mERROR[0m in 0.27s]
[0m13:28:39.414587 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m13:28:39.414900 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_country_iso_codes
[0m13:28:39.415328 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_unique' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_establishment_unique (models/tmp/tmp_airport_establishment_unique.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_unique.sql.
[0m13:28:39.415791 [info ] [Thread-1 (]: 4 of 15 START sql table model dbt_air_travel_tmp.tmp_country_iso_codes ......... [RUN]
[0m13:28:39.416399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_unique, now model.air_travel.tmp_country_iso_codes)
[0m13:28:39.416705 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_country_iso_codes
[0m13:28:39.419285 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_country_iso_codes"
[0m13:28:39.420071 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_country_iso_codes
[0m13:28:39.421452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:39.714978 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_country_iso_codes"
[0m13:28:39.717251 [debug] [Thread-1 (]: On model.air_travel.tmp_country_iso_codes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_country_iso_codes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes`
      
    
    

    
    OPTIONS()
    as (
      with tmp_country_iso_codes as (
    select
      name,
      AI.GENERATE(
        ('What is the iso code for country ', name, '? If it does not have one, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
    where iso_code is null
  )
select name, llm_response.iso_code as mapped_iso_code
from tmp_country_iso_codes
    );
  
[0m13:28:40.251444 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9af19701-f86c-42a2-ad5f-6b603521c838&page=queryresults
[0m13:28:47.527538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd109cc-e244-4f98-8785-306d1b332537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa9d4d0>]}
[0m13:28:47.528783 [info ] [Thread-1 (]: 4 of 15 OK created sql table model dbt_air_travel_tmp.tmp_country_iso_codes .... [[32mCREATE TABLE (20.0 rows, 4.0 KiB processed)[0m in 8.11s]
[0m13:28:47.529581 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_country_iso_codes
[0m13:28:47.530007 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates
[0m13:28:47.530596 [info ] [Thread-1 (]: 5 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_duplicates ........ [RUN]
[0m13:28:47.531252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_country_iso_codes, now model.air_travel.tmp_airport_duplicates)
[0m13:28:47.531642 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates
[0m13:28:47.534384 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates"
[0m13:28:47.535184 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates
[0m13:28:47.536766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:47.825116 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_duplicates"
[0m13:28:47.827003 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_duplicates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_duplicates"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_duplicates as (
    select * 
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao in
        (select icao
        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
        group by icao
        having count(*) > 1)
)

select * from tmp_airport_duplicates
    );
  
[0m13:28:48.238354 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:029e8858-944a-4c3b-bfc6-fceb88ccada1&page=queryresults
[0m13:28:50.069803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd109cc-e244-4f98-8785-306d1b332537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc2d940>]}
[0m13:28:50.070770 [info ] [Thread-1 (]: 5 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_duplicates ... [[32mCREATE TABLE (1.2k rows, 712.6 KiB processed)[0m in 2.54s]
[0m13:28:50.071381 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates
[0m13:28:50.071766 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:28:50.072294 [info ] [Thread-1 (]: 6 of 15 SKIP relation dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [[33mSKIP[0m]
[0m13:28:50.072909 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:28:50.073319 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airline_country_mapped
[0m13:28:50.073756 [info ] [Thread-1 (]: 7 of 15 START sql table model dbt_air_travel_tmp.tmp_airline_country_mapped .... [RUN]
[0m13:28:50.074188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates, now model.air_travel.tmp_airline_country_mapped)
[0m13:28:50.074510 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airline_country_mapped
[0m13:28:50.077158 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airline_country_mapped"
[0m13:28:50.077989 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airline_country_mapped
[0m13:28:50.079876 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airline_country_mapped"
[0m13:28:50.080506 [debug] [Thread-1 (]: On model.air_travel.tmp_airline_country_mapped: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airline_country_mapped"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped`
      
    
    

    
    OPTIONS()
    as (
      with airline_orphan_countries as (
    select distinct country
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)
),
tmp_airline_countries_mapped as (
    select
      country,
      AI.GENERATE(
        ('If ', country, ' is a recognized country, return its iso code. If it is not a recognized country, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from airline_orphan_countries
  )
  select country as original_country, llm_response.iso_code as mapped_iso_code
  from tmp_airline_countries_mapped
    );
  
[0m13:28:50.080837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:50.696682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:59599aac-3467-4e69-ac03-261883628e58&page=queryresults
[0m13:29:03.880010 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:29:05.032695 [error] [MainThread]: CANCEL query model.air_travel.tmp_airline_country_mapped ....................... [[31mCANCEL[0m]
[0m13:29:05.033141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:07.158482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:07.159195 [debug] [MainThread]: Connection 'model.air_travel.tmp_airline_country_mapped' was properly closed.
[0m13:29:07.159684 [info ] [MainThread]: 
[0m13:29:07.159988 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 32.67 seconds (32.67s).
[0m13:29:07.160381 [error] [MainThread]: Encountered an error:

[0m13:29:07.163978 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 421, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 338, in run_queue
    self.handle_job_queue(pool, callback)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/run.py", line 853, in handle_job_queue
    node = self.job_queue.get()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 199, in get
    self.not_empty.wait()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 587, in run
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 604, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 541, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 454, in execute_nodes
    self._cancel_connections(pool)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 412, in _cancel_connections
    pool.join()
    ~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/pool.py", line 669, in join
    p.join()
    ~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 1094, in join
    self._handle.join(timeout)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyboardInterrupt

[0m13:29:07.168158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 33.78041, "process_in_blocks": "0", "process_kernel_time": 0.291371, "process_mem_max_rss": "390742016", "process_out_blocks": "0", "process_user_time": 2.070603}
[0m13:29:07.168538 [debug] [MainThread]: Command `dbt run` failed at 13:29:07.168463 after 33.78 seconds
[0m13:29:07.168796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc39070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fbf91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd3ea50>]}
[0m13:29:07.169049 [debug] [MainThread]: Flushing usage events
[0m13:29:07.422277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:36.395576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105773750>]}


============================== 13:32:36.397227 | e5d12a00-5dee-472f-bbba-4d118b96ad43 ==============================
[0m13:32:36.397227 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:32:36.397470 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'invocation_command': 'dbt run --select tmp_airport_establishment_canonical_categories', 'static_parser': 'True', 'introspect': 'True', 'fail_fast': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_format': 'default', 'profiles_dir': '/Users/scohen/.dbt'}
[0m13:32:37.215862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5d12a00-5dee-472f-bbba-4d118b96ad43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ccc30>]}
[0m13:32:37.234644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5d12a00-5dee-472f-bbba-4d118b96ad43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5be360>]}
[0m13:32:37.234846 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:32:37.309606 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:32:37.349630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:32:37.349870 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_canonical_categories.sql
[0m13:32:37.429267 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m13:32:37.433832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5d12a00-5dee-472f-bbba-4d118b96ad43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cd4a150>]}
[0m13:32:37.465851 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:32:37.466686 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:32:37.473832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5d12a00-5dee-472f-bbba-4d118b96ad43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5ce8a0>]}
[0m13:32:37.474040 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m13:32:37.474169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d12a00-5dee-472f-bbba-4d118b96ad43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c8f1d30>]}
[0m13:32:37.474899 [info ] [MainThread]: 
[0m13:32:37.475029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:32:37.475128 [info ] [MainThread]: 
[0m13:32:37.475314 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:32:37.475705 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:32:37.475874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:37.868464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:32:37.869017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:38.173958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:32:38.176039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:38.453512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:32:38.455534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:38.792191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d12a00-5dee-472f-bbba-4d118b96ad43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e513c70>]}
[0m13:32:38.792817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:38.796069 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:32:38.796561 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [RUN]
[0m13:32:38.796908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m13:32:38.797181 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:32:38.802469 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:32:38.803085 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:32:38.826467 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:32:38.827120 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_canonical_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_canonical_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_canonical_categories as (
    select 'Quick Service & Grab-and-Go' as broad_category, 'National/International Fast Food Chains' as sub_category,
    'Quick Service & Grab-and-Go' as broad_category, 'Coffee & Beverage Shops' as sub_category,
    'Quick Service & Grab-and-Go' as broad_category, 'Snack Kiosks' as sub_category,
    'Quick Service & Grab-and-Go' as broad_category, 'Pre-Packaged Foods' as sub_category,
    'Fast Casual' as broad_category, 'Gourmet Burgers & Sandwiches' as sub_category,
    'Fast Casual' as broad_category, 'Build-Your-Own Concepts' as sub_category,
    'Fast Casual' as broad_category, 'Pizzerias' as sub_category,
    'Full-Service Dining' as broad_category, 'Casual Dining Restaurants' as sub_category,
    'Full-Service Dining' as broad_category, 'Upscale & Chef-Driven Restaurants' as sub_category,
    'Full-Service Dining' as broad_category, 'Themed Restaurants & Sports Bars' as sub_category,
    'Bars & Lounges' as broad_category, 'Wine Bars' as sub_category,
    'Bars & Lounges' as broad_category, 'Craft Beer Pubs' as sub_category,
    'Bars & Lounges' as broad_category, 'Cocktail Lounges' as sub_category,
    'Travel Essentials & Convenience' as broad_category, 'Newsstands & Bookstores' as sub_category,
    'Travel Essentials & Convenience' as broad_category, 'Pharmacies & Personal Care' as sub_category,
    'Travel Essentials & Convenience' as broad_category, 'Travel Gear & Luggage' as sub_category,
    'Specialty Retail' as broad_category, 'Electronics' as sub_category,
    'Specialty Retail' as broad_category, 'Local Souvenirs & Gifts' as sub_category,
    'Specialty Retail' as broad_category, 'Apparel & Accessories' as sub_category,
    'Luxury & High-End Goods' as broad_category, 'Confectionery & Gourmet Foods' as sub_category,
    'Luxury & High-End Goods' as broad_category, 'Designer Fashion' as sub_category,
    'Luxury & High-End Goods' as broad_category, 'Jewelry & Watches' as sub_category,
    'Luxury & High-End Goods' as broad_category, 'High-End Cosmetics' as sub_category,
    'Duty-Free' as broad_category, 'Liquor & Tobacco' as sub_category,
    'Duty-Free' as broad_category, 'Fragrances & Cosmetics' as sub_category,
    'Duty-Free' as broad_category, 'Luxury Accessories & Confectionery' as sub_category,
    'Passenger Comfort & Wellness' as broad_category, 'Spas & Salons' as sub_category,
    'Passenger Comfort & Wellness' as broad_category, 'Pay-Per-Use Lounges' as sub_category,
    'Passenger Comfort & Wellness' as broad_category, 'Yoga & Meditation Rooms' as sub_category,
    'Passenger Comfort & Wellness' as broad_category, 'Shower Facilities' as sub_category,
    'Financial & Business Services' as broad_category, 'Currency Exchan' as sub_category,
    'Financial & Business Services' as broad_category, 'ATMs & Banking Services' as sub_category,
    'Financial & Business Services' as broad_category, 'Business Centers & Work Pods' as sub_category,
    'Practical & Convenience Services' as broad_category, 'Luggage Storage & Wrapping' as sub_category,
    'Practical & Convenience Services' as broad_category, 'Postal & Shipping Services' as sub_category,
    'Practical & Convenience Services' as broad_category, 'Pet Relief & Care Areas' as sub_category,
    'Practical & Convenience Services' as broad_category, 'Vending Machines (non-F&B)' as sub_category,
)

select * 
from tmp_airport_establishment_canonical_categories
    );
  
[0m13:32:38.827413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:39.361191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:dd5624cd-d64e-4352-bef5-d58a37db4947&page=queryresults
[0m13:32:39.493370 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:dd5624cd-d64e-4352-bef5-d58a37db4947&page=queryresults
[0m13:32:39.506488 [debug] [Thread-1 (]: Database Error in model tmp_airport_establishment_canonical_categories (models/tmp/tmp_airport_establishment_canonical_categories.sql)
  CREATE TABLE has columns with duplicate name broad_category at [14:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_canonical_categories.sql
[0m13:32:39.508353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d12a00-5dee-472f-bbba-4d118b96ad43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e521a90>]}
[0m13:32:39.508943 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [[31mERROR[0m in 0.71s]
[0m13:32:39.509577 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:32:39.509990 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_canonical_categories' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_establishment_canonical_categories (models/tmp/tmp_airport_establishment_canonical_categories.sql)
  CREATE TABLE has columns with duplicate name broad_category at [14:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_canonical_categories.sql.
[0m13:32:39.511376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:39.512591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:39.512808 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_canonical_categories' was properly closed.
[0m13:32:39.513005 [info ] [MainThread]: 
[0m13:32:39.513217 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m13:32:39.513654 [debug] [MainThread]: Command end result
[0m13:32:39.532630 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:32:39.533632 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:32:39.536768 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:32:39.536916 [info ] [MainThread]: 
[0m13:32:39.537091 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:32:39.537232 [info ] [MainThread]: 
[0m13:32:39.537420 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_canonical_categories (models/tmp/tmp_airport_establishment_canonical_categories.sql)[0m
[0m13:32:39.537587 [error] [MainThread]:   Database Error in model tmp_airport_establishment_canonical_categories (models/tmp/tmp_airport_establishment_canonical_categories.sql)
  CREATE TABLE has columns with duplicate name broad_category at [14:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_canonical_categories.sql
[0m13:32:39.537705 [info ] [MainThread]: 
[0m13:32:39.537850 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_canonical_categories.sql
[0m13:32:39.537968 [info ] [MainThread]: 
[0m13:32:39.538112 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:32:39.540324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1683626, "process_in_blocks": "0", "process_kernel_time": 0.236814, "process_mem_max_rss": "394772480", "process_out_blocks": "0", "process_user_time": 1.702463}
[0m13:32:39.540530 [debug] [MainThread]: Command `dbt run` failed at 13:32:39.540491 after 3.17 seconds
[0m13:32:39.540700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e5e4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e5c72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e5c76b0>]}
[0m13:32:39.540854 [debug] [MainThread]: Flushing usage events
[0m13:32:39.767744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:52.969766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bf86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e73750>]}


============================== 13:41:52.971420 | e3e967a9-271c-4d10-bbca-6189848c48e9 ==============================
[0m13:41:52.971420 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:41:52.971664 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'printer_width': '80', 'log_format': 'default', 'fail_fast': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tmp_airport_establishment_canonical_categories', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'write_json': 'True', 'empty': 'False', 'use_colors': 'True', 'partial_parse': 'True'}
[0m13:41:53.787051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3e967a9-271c-4d10-bbca-6189848c48e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eccc30>]}
[0m13:41:53.805803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3e967a9-271c-4d10-bbca-6189848c48e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1506be360>]}
[0m13:41:53.806004 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:41:53.882578 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:41:53.922800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:41:53.923039 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_canonical_categories.sql
[0m13:41:54.002913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m13:41:54.007543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3e967a9-271c-4d10-bbca-6189848c48e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15144a150>]}
[0m13:41:54.039844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:41:54.040697 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:41:54.047823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3e967a9-271c-4d10-bbca-6189848c48e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1506ce8a0>]}
[0m13:41:54.048004 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m13:41:54.048132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e967a9-271c-4d10-bbca-6189848c48e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1511f5d30>]}
[0m13:41:54.048841 [info ] [MainThread]: 
[0m13:41:54.048965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:41:54.049058 [info ] [MainThread]: 
[0m13:41:54.049253 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:41:54.049578 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:41:54.049722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:54.493362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:41:54.493913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:54.797691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:41:54.799858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:55.110478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:41:55.112466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:55.409847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e967a9-271c-4d10-bbca-6189848c48e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15201bc70>]}
[0m13:41:55.410743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:55.415332 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:41:55.416012 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [RUN]
[0m13:41:55.416411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m13:41:55.416703 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:41:55.422706 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:41:55.423381 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:41:55.447724 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:41:55.448402 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_canonical_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_canonical_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_canonical_categories as (
    select 'Quick Service & Grab-and-Go' as broad_category, 'National/International Fast Food Chains' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Coffee & Beverage Shops' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Snack Kiosks' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Pre-Packaged Foods' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Gourmet Burgers & Sandwiches' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Build-Your-Own Concepts' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Pizzerias' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Casual Dining Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Upscale & Chef-Driven Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Themed Restaurants & Sports Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Wine Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Craft Beer Pubs' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Cocktail Lounges' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Newsstands & Bookstores' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Pharmacies & Personal Care' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Travel Gear & Luggage' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Electronics' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Local Souvenirs & Gifts' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Apparel & Accessories' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Confectionery & Gourmet Foods' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Designer Fashion' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Jewelry & Watches' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'High-End Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Liquor & Tobacco' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Fragrances & Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Luxury Accessories & Confectionery' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Spas & Salons' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Pay-Per-Use Lounges' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Yoga & Meditation Rooms' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Shower Facilities' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Currency Exchan' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'ATMs & Banking Services' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Business Centers & Work Pods' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Luggage Storage & Wrapping' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Postal & Shipping Services' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Pet Relief & Care Areas' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Vending Machines (non-F&B)' as sub_category
)

select * 
from tmp_airport_establishment_canonical_categories
    );
  
[0m13:41:55.448728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:56.017669 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:63a3692c-8c07-46e7-8260-701f0f891298&page=queryresults
[0m13:41:57.744815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e967a9-271c-4d10-bbca-6189848c48e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15201fa10>]}
[0m13:41:57.745222 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [[32mCREATE TABLE (37.0 rows, 0 processed)[0m in 2.33s]
[0m13:41:57.745533 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:41:57.746194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:57.747064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:57.747210 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_canonical_categories' was properly closed.
[0m13:41:57.747351 [info ] [MainThread]: 
[0m13:41:57.747500 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m13:41:57.747809 [debug] [MainThread]: Command end result
[0m13:41:57.762643 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:41:57.763599 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:41:57.766182 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:41:57.766317 [info ] [MainThread]: 
[0m13:41:57.766475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:41:57.766588 [info ] [MainThread]: 
[0m13:41:57.766714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:41:57.768784 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8228436, "process_in_blocks": "0", "process_kernel_time": 0.251303, "process_mem_max_rss": "391675904", "process_out_blocks": "0", "process_user_time": 1.723136}
[0m13:41:57.769001 [debug] [MainThread]: Command `dbt run` succeeded at 13:41:57.768960 after 4.82 seconds
[0m13:41:57.769161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1520e5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1520efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15441c230>]}
[0m13:41:57.769313 [debug] [MainThread]: Flushing usage events
[0m13:41:57.989073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:18.872048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105873750>]}


============================== 13:42:18.873650 | ffec9cd8-6c7c-4277-beff-c1849c7e03d1 ==============================
[0m13:42:18.873650 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:42:18.873909 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'empty': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --select models/tmp/tmp_airline_country_mapped.sql models/tmp/tmp_airport_all.sql models/tmp/tmp_airport_country_iso_codes.sql models/tmp/tmp_airport_duplicates_embeddings.sql models/tmp/tmp_airport_duplicates.sql models/tmp/tmp_airport_establishment_broad_categories_mapped.sql models/tmp/tmp_airport_establishment_canonical_categories.sql models/tmp/tmp_airport_establishment_raw_categories.sql models/tmp/tmp_airport_establishment_sub_categories_mapped.sql models/tmp/tmp_airport_establishment_unique.sql models/tmp/tmp_airport_inference_results_embeddings.sql models/tmp/tmp_airport_inference_results.sql models/tmp/tmp_airport_llm.sql models/tmp/tmp_airport_refined.sql models/tmp/tmp_airport_vector_search_results.sql models/tmp/tmp_country_iso_codes.sql --exclude tmp_airport_llm', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'log_format': 'default', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True'}
[0m13:42:19.689661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffec9cd8-6c7c-4277-beff-c1849c7e03d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10474cc30>]}
[0m13:42:19.708738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffec9cd8-6c7c-4277-beff-c1849c7e03d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a0be360>]}
[0m13:42:19.708960 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:42:19.784443 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:42:19.824505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:42:19.824647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:42:19.827032 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m13:42:19.840572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffec9cd8-6c7c-4277-beff-c1849c7e03d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b94a650>]}
[0m13:42:19.875799 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:42:19.876683 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:42:19.883097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffec9cd8-6c7c-4277-beff-c1849c7e03d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a0ce8a0>]}
[0m13:42:19.883304 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m13:42:19.883434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffec9cd8-6c7c-4277-beff-c1849c7e03d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a33d550>]}
[0m13:42:19.891463 [info ] [MainThread]: 
[0m13:42:19.891613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:42:19.891708 [info ] [MainThread]: 
[0m13:42:19.891898 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:42:19.893661 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:42:19.893839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:20.259319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:42:20.260063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:20.556830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:42:20.558620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:20.854615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:42:20.856460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:21.148214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffec9cd8-6c7c-4277-beff-c1849c7e03d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12baf3860>]}
[0m13:42:21.149086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:42:21.153703 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m13:42:21.154449 [info ] [Thread-1 (]: 1 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_all ............... [RUN]
[0m13:42:21.154948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_all)
[0m13:42:21.155309 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_all
[0m13:42:21.164522 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_all"
[0m13:42:21.165210 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_all
[0m13:42:21.174794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:21.510923 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_all"
[0m13:42:21.511619 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_all: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_all"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_all as (
    select distinct al.llm_icao as icao, a.iata, a.name, a.city, al.llm_state_prov as state_prov, 
        a.country, a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, 
        a.timezone_name, a.type, a.source, 'openflights,llm' as _data_source, a._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm` al
    on a.name = al.name and a.country = al.country
    where a.iata is not null
    and al.llm_icao is not null
)

select * from tmp_airport_all
    );
  
[0m13:42:22.029111 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8115f6a5-cd37-404a-8181-d07b395d293d&page=queryresults
[0m13:42:23.945131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffec9cd8-6c7c-4277-beff-c1849c7e03d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bbe3110>]}
[0m13:42:23.945630 [info ] [Thread-1 (]: 1 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_all .......... [[32mCREATE TABLE (4.7k rows, 1.6 MiB processed)[0m in 2.79s]
[0m13:42:23.946001 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m13:42:23.946236 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:42:23.946544 [info ] [Thread-1 (]: 2 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [RUN]
[0m13:42:23.946874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_all, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m13:42:23.947139 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:42:23.948254 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:42:23.948743 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:42:23.950126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:24.272252 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:42:24.274598 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_canonical_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_canonical_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_canonical_categories as (
    select 'Quick Service & Grab-and-Go' as broad_category, 'National/International Fast Food Chains' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Coffee & Beverage Shops' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Snack Kiosks' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Pre-Packaged Foods' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Gourmet Burgers & Sandwiches' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Build-Your-Own Concepts' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Pizzerias' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Casual Dining Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Upscale & Chef-Driven Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Themed Restaurants & Sports Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Wine Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Craft Beer Pubs' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Cocktail Lounges' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Newsstands & Bookstores' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Pharmacies & Personal Care' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Travel Gear & Luggage' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Electronics' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Local Souvenirs & Gifts' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Apparel & Accessories' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Confectionery & Gourmet Foods' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Designer Fashion' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Jewelry & Watches' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'High-End Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Liquor & Tobacco' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Fragrances & Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Luxury Accessories & Confectionery' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Spas & Salons' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Pay-Per-Use Lounges' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Yoga & Meditation Rooms' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Shower Facilities' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Currency Exchan' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'ATMs & Banking Services' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Business Centers & Work Pods' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Luggage Storage & Wrapping' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Postal & Shipping Services' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Pet Relief & Care Areas' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Vending Machines (non-F&B)' as sub_category
)

select * 
from tmp_airport_establishment_canonical_categories
    );
  
[0m13:42:24.690103 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1ff79dc1-7001-4b4d-9c8a-ea14e7d9e1c2&page=queryresults
[0m13:42:26.273442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffec9cd8-6c7c-4277-beff-c1849c7e03d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bbc12e0>]}
[0m13:42:26.274286 [info ] [Thread-1 (]: 2 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [[32mCREATE TABLE (37.0 rows, 0 processed)[0m in 2.33s]
[0m13:42:26.274800 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:42:26.275143 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m13:42:26.275644 [info ] [Thread-1 (]: 3 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [RUN]
[0m13:42:26.276101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_canonical_categories, now model.air_travel.tmp_airport_establishment_unique)
[0m13:42:26.276423 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m13:42:26.278804 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:42:26.279516 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m13:42:26.281934 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:42:26.282655 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_unique: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_unique"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_unique as
  select distinct business, category, dining, _data_source, _load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
  order by category, business

select * from tmp_airport_establishment_unique
    );
  
[0m13:42:26.282983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:26.545517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1452cb30-c41e-443a-83a8-4133163e7a6d&page=queryresults
[0m13:42:26.546936 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1452cb30-c41e-443a-83a8-4133163e7a6d&page=queryresults
[0m13:42:26.556749 [debug] [Thread-1 (]: Database Error in model tmp_airport_establishment_unique (models/tmp/tmp_airport_establishment_unique.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_unique.sql
[0m13:42:26.557285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffec9cd8-6c7c-4277-beff-c1849c7e03d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12de14730>]}
[0m13:42:26.557973 [error] [Thread-1 (]: 3 of 15 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [[31mERROR[0m in 0.28s]
[0m13:42:26.558500 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m13:42:26.558818 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_country_iso_codes
[0m13:42:26.559193 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_unique' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_establishment_unique (models/tmp/tmp_airport_establishment_unique.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_unique.sql.
[0m13:42:26.559596 [info ] [Thread-1 (]: 4 of 15 START sql table model dbt_air_travel_tmp.tmp_country_iso_codes ......... [RUN]
[0m13:42:26.560649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_unique, now model.air_travel.tmp_country_iso_codes)
[0m13:42:26.561031 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_country_iso_codes
[0m13:42:26.562985 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_country_iso_codes"
[0m13:42:26.563526 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_country_iso_codes
[0m13:42:26.564843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:26.856580 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_country_iso_codes"
[0m13:42:26.858750 [debug] [Thread-1 (]: On model.air_travel.tmp_country_iso_codes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_country_iso_codes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes`
      
    
    

    
    OPTIONS()
    as (
      with tmp_country_iso_codes as (
    select
      name,
      AI.GENERATE(
        ('What is the iso code for country ', name, '? If it does not have one, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
    where iso_code is null
  )
select name, llm_response.iso_code as mapped_iso_code
from tmp_country_iso_codes
    );
  
[0m13:42:27.352059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e8184c61-a709-457e-9b85-2bd90c77d044&page=queryresults
[0m13:42:29.343858 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:42:30.118735 [error] [MainThread]: CANCEL query model.air_travel.tmp_country_iso_codes ............................ [[31mCANCEL[0m]
[0m13:42:30.119666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:42:30.613549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:30.614418 [debug] [MainThread]: Connection 'model.air_travel.tmp_country_iso_codes' was properly closed.
[0m13:42:30.615061 [info ] [MainThread]: 
[0m13:42:30.615546 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 10.72 seconds (10.72s).
[0m13:42:30.616158 [error] [MainThread]: Encountered an error:

[0m13:42:30.620767 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 421, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 338, in run_queue
    self.handle_job_queue(pool, callback)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/run.py", line 853, in handle_job_queue
    node = self.job_queue.get()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 199, in get
    self.not_empty.wait()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 587, in run
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 604, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 541, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 454, in execute_nodes
    self._cancel_connections(pool)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 412, in _cancel_connections
    pool.join()
    ~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/pool.py", line 669, in join
    p.join()
    ~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 1094, in join
    self._handle.join(timeout)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyboardInterrupt

[0m13:42:30.625773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.776925, "process_in_blocks": "0", "process_kernel_time": 0.260703, "process_mem_max_rss": "394592256", "process_out_blocks": "0", "process_user_time": 1.921241}
[0m13:42:30.626331 [debug] [MainThread]: Command `dbt run` failed at 13:42:30.626234 after 11.78 seconds
[0m13:42:30.626682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e36c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e36c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f5400>]}
[0m13:42:30.626997 [debug] [MainThread]: Flushing usage events
[0m13:42:30.834228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:25.770708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110873750>]}


============================== 13:43:25.772351 | 8e6d8318-01bc-466c-b6b1-d826d5170895 ==============================
[0m13:43:25.772351 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:43:25.772577 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'fail_fast': 'False', 'introspect': 'True', 'empty': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt run --select tmp_airport_establishment_unique', 'profiles_dir': '/Users/scohen/.dbt', 'use_colors': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'printer_width': '80'}
[0m13:43:26.584300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e6d8318-01bc-466c-b6b1-d826d5170895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dccc30>]}
[0m13:43:26.603501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e6d8318-01bc-466c-b6b1-d826d5170895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d6be360>]}
[0m13:43:26.603731 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:43:26.677949 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:43:26.717134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:26.717272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:26.719586 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m13:43:26.733579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e6d8318-01bc-466c-b6b1-d826d5170895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dd4e650>]}
[0m13:43:26.767642 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:43:26.768519 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:43:26.774544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e6d8318-01bc-466c-b6b1-d826d5170895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d6ce8a0>]}
[0m13:43:26.774719 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m13:43:26.774849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e6d8318-01bc-466c-b6b1-d826d5170895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d93d550>]}
[0m13:43:26.775511 [info ] [MainThread]: 
[0m13:43:26.775642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:26.775738 [info ] [MainThread]: 
[0m13:43:26.775951 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:43:26.776295 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:43:26.776469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:27.120290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:43:27.120838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:27.415358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:43:27.417453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:27.707135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:43:27.708146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:28.050224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e6d8318-01bc-466c-b6b1-d826d5170895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14deef860>]}
[0m13:43:28.050936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:28.054095 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m13:43:28.054552 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [RUN]
[0m13:43:28.054896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_establishment_unique)
[0m13:43:28.055166 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m13:43:28.063434 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:43:28.064304 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m13:43:28.087090 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:43:28.087628 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_unique: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_unique"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_unique as
  select distinct business, category, dining, _data_source, _load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
  order by category, business

select * from tmp_airport_establishment_unique
    );
  
[0m13:43:28.087847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:28.331422 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1b64a9e9-e236-478b-99be-c94d2bcf9f93&page=queryresults
[0m13:43:28.332745 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1b64a9e9-e236-478b-99be-c94d2bcf9f93&page=queryresults
[0m13:43:28.344362 [debug] [Thread-1 (]: Database Error in model tmp_airport_establishment_unique (models/tmp/tmp_airport_establishment_unique.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_unique.sql
[0m13:43:28.346677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e6d8318-01bc-466c-b6b1-d826d5170895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dfca8d0>]}
[0m13:43:28.347370 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [[31mERROR[0m in 0.29s]
[0m13:43:28.348146 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m13:43:28.348608 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_unique' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_establishment_unique (models/tmp/tmp_airport_establishment_unique.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_unique.sql.
[0m13:43:28.350327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:28.351979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:28.352293 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_unique' was properly closed.
[0m13:43:28.352534 [info ] [MainThread]: 
[0m13:43:28.352764 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m13:43:28.353297 [debug] [MainThread]: Command end result
[0m13:43:28.372904 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:43:28.373939 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:43:28.377168 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:43:28.377357 [info ] [MainThread]: 
[0m13:43:28.377542 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:43:28.377681 [info ] [MainThread]: 
[0m13:43:28.377883 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_unique (models/tmp/tmp_airport_establishment_unique.sql)[0m
[0m13:43:28.378062 [error] [MainThread]:   Database Error in model tmp_airport_establishment_unique (models/tmp/tmp_airport_establishment_unique.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_unique.sql
[0m13:43:28.378191 [info ] [MainThread]: 
[0m13:43:28.378341 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_unique.sql
[0m13:43:28.378461 [info ] [MainThread]: 
[0m13:43:28.378603 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:43:28.380867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6336968, "process_in_blocks": "0", "process_kernel_time": 0.217258, "process_mem_max_rss": "383696896", "process_out_blocks": "0", "process_user_time": 1.64185}
[0m13:43:28.381112 [debug] [MainThread]: Command `dbt run` failed at 13:43:28.381066 after 2.63 seconds
[0m13:43:28.381301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14df3ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10286c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d860910>]}
[0m13:43:28.381475 [debug] [MainThread]: Flushing usage events
[0m13:43:28.614440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:43.838480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060dc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f27750>]}


============================== 13:43:43.840220 | b0037c66-aeeb-45d8-85d3-3a7de749e407 ==============================
[0m13:43:43.840220 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:43:43.840466 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'target_path': 'None', 'invocation_command': 'dbt run --select tmp_airport_establishment_unique', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True', 'printer_width': '80', 'empty': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'cache_selected_only': 'False', 'static_parser': 'True'}
[0m13:43:44.675286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0037c66-aeeb-45d8-85d3-3a7de749e407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106280c30>]}
[0m13:43:44.694203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0037c66-aeeb-45d8-85d3-3a7de749e407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fbe360>]}
[0m13:43:44.694422 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:43:44.768800 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:43:44.808899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:44.809140 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_unique.sql
[0m13:43:44.891353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m13:43:44.896025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0037c66-aeeb-45d8-85d3-3a7de749e407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d4a150>]}
[0m13:43:44.928195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:43:44.929084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:43:44.936067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0037c66-aeeb-45d8-85d3-3a7de749e407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fce8a0>]}
[0m13:43:44.936250 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m13:43:44.936376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0037c66-aeeb-45d8-85d3-3a7de749e407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123af1d30>]}
[0m13:43:44.937104 [info ] [MainThread]: 
[0m13:43:44.937230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:44.937327 [info ] [MainThread]: 
[0m13:43:44.937507 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:43:44.937866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:43:44.938032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:45.499070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:43:45.499608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:45.781714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:43:45.783291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:46.076819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:43:46.078139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:46.363814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0037c66-aeeb-45d8-85d3-3a7de749e407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1251d42c0>]}
[0m13:43:46.364818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:46.368812 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m13:43:46.369357 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [RUN]
[0m13:43:46.369758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_establishment_unique)
[0m13:43:46.370050 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m13:43:46.376705 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:43:46.377359 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m13:43:46.401531 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:43:46.402104 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_unique: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_unique"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_unique as (
  select distinct business, category, dining, _data_source, _load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
  order by category, business
)
select * 
from tmp_airport_establishment_unique
    );
  
[0m13:43:46.402330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:47.021058 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e9427215-85b8-41a0-81c3-aea0f59c98cd&page=queryresults
[0m13:43:48.675817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0037c66-aeeb-45d8-85d3-3a7de749e407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12511fdd0>]}
[0m13:43:48.676389 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [[32mCREATE TABLE (1.1k rows, 74.4 KiB processed)[0m in 2.31s]
[0m13:43:48.676769 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m13:43:48.677535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:48.678463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:48.678617 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_unique' was properly closed.
[0m13:43:48.678767 [info ] [MainThread]: 
[0m13:43:48.678932 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m13:43:48.679290 [debug] [MainThread]: Command end result
[0m13:43:48.696395 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:43:48.697586 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:43:48.700360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:43:48.700499 [info ] [MainThread]: 
[0m13:43:48.700673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:48.700806 [info ] [MainThread]: 
[0m13:43:48.700953 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:43:48.703051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8885345, "process_in_blocks": "0", "process_kernel_time": 0.26149, "process_mem_max_rss": "391020544", "process_out_blocks": "0", "process_user_time": 1.745026}
[0m13:43:48.703262 [debug] [MainThread]: Command `dbt run` succeeded at 13:43:48.703223 after 4.89 seconds
[0m13:43:48.703415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1251e5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1251f4c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1251f7d90>]}
[0m13:43:48.703566 [debug] [MainThread]: Flushing usage events
[0m13:43:48.906381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:00.803098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085146e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935f750>]}


============================== 13:44:00.804683 | 8b0efaae-dac8-4d54-8344-eec733a48b01 ==============================
[0m13:44:00.804683 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:44:00.804943 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default', 'fail_fast': 'False', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select models/tmp/tmp_airline_country_mapped.sql models/tmp/tmp_airport_all.sql models/tmp/tmp_airport_country_iso_codes.sql models/tmp/tmp_airport_duplicates_embeddings.sql models/tmp/tmp_airport_duplicates.sql models/tmp/tmp_airport_establishment_broad_categories_mapped.sql models/tmp/tmp_airport_establishment_canonical_categories.sql models/tmp/tmp_airport_establishment_raw_categories.sql models/tmp/tmp_airport_establishment_sub_categories_mapped.sql models/tmp/tmp_airport_establishment_unique.sql models/tmp/tmp_airport_inference_results_embeddings.sql models/tmp/tmp_airport_inference_results.sql models/tmp/tmp_airport_llm.sql models/tmp/tmp_airport_refined.sql models/tmp/tmp_airport_vector_search_results.sql models/tmp/tmp_country_iso_codes.sql --exclude tmp_airport_llm', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'empty': 'False', 'use_experimental_parser': 'False'}
[0m13:44:01.626636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b8c30>]}
[0m13:44:01.645380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1395be360>]}
[0m13:44:01.645590 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:44:01.719324 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:44:01.758519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:01.758654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:01.760990 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m13:44:01.774773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139b4a650>]}
[0m13:44:01.808849 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:44:01.809734 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:44:01.815867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1395ce8a0>]}
[0m13:44:01.816044 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m13:44:01.816165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139841550>]}
[0m13:44:01.824500 [info ] [MainThread]: 
[0m13:44:01.824666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:01.824763 [info ] [MainThread]: 
[0m13:44:01.824967 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:44:01.826783 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:44:01.826970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:02.168922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:44:02.169666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:02.442905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:44:02.445163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:02.778669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:44:02.779668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:03.066773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139cf3860>]}
[0m13:44:03.067753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:03.071873 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m13:44:03.072407 [info ] [Thread-1 (]: 1 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_all ............... [RUN]
[0m13:44:03.072789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_all)
[0m13:44:03.073071 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_all
[0m13:44:03.081512 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_all"
[0m13:44:03.082104 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_all
[0m13:44:03.091197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:03.408788 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_all"
[0m13:44:03.409458 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_all: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_all"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_all as (
    select distinct al.llm_icao as icao, a.iata, a.name, a.city, al.llm_state_prov as state_prov, 
        a.country, a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, 
        a.timezone_name, a.type, a.source, 'openflights,llm' as _data_source, a._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm` al
    on a.name = al.name and a.country = al.country
    where a.iata is not null
    and al.llm_icao is not null
)

select * from tmp_airport_all
    );
  
[0m13:44:03.713351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:30ce0acd-b7ab-4f32-b790-247786266cae&page=queryresults
[0m13:44:05.579482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139dd71d0>]}
[0m13:44:05.580139 [info ] [Thread-1 (]: 1 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_all .......... [[32mCREATE TABLE (4.7k rows, 1.6 MiB processed)[0m in 2.51s]
[0m13:44:05.580608 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m13:44:05.580898 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:44:05.581343 [info ] [Thread-1 (]: 2 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [RUN]
[0m13:44:05.581803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_all, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m13:44:05.582113 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:44:05.583373 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:44:05.583979 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:44:05.585642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:05.864196 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:44:05.866810 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_canonical_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_canonical_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_canonical_categories as (
    select 'Quick Service & Grab-and-Go' as broad_category, 'National/International Fast Food Chains' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Coffee & Beverage Shops' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Snack Kiosks' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Pre-Packaged Foods' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Gourmet Burgers & Sandwiches' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Build-Your-Own Concepts' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Pizzerias' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Casual Dining Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Upscale & Chef-Driven Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Themed Restaurants & Sports Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Wine Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Craft Beer Pubs' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Cocktail Lounges' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Newsstands & Bookstores' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Pharmacies & Personal Care' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Travel Gear & Luggage' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Electronics' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Local Souvenirs & Gifts' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Apparel & Accessories' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Confectionery & Gourmet Foods' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Designer Fashion' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Jewelry & Watches' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'High-End Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Liquor & Tobacco' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Fragrances & Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Luxury Accessories & Confectionery' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Spas & Salons' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Pay-Per-Use Lounges' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Yoga & Meditation Rooms' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Shower Facilities' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Currency Exchan' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'ATMs & Banking Services' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Business Centers & Work Pods' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Luggage Storage & Wrapping' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Postal & Shipping Services' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Pet Relief & Care Areas' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Vending Machines (non-F&B)' as sub_category
)

select * 
from tmp_airport_establishment_canonical_categories
    );
  
[0m13:44:06.170117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ef461c16-133c-458d-b51b-29d09e5a903c&page=queryresults
[0m13:44:07.674159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139dc0cb0>]}
[0m13:44:07.675200 [info ] [Thread-1 (]: 2 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [[32mCREATE TABLE (37.0 rows, 0 processed)[0m in 2.09s]
[0m13:44:07.676277 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:44:07.676923 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m13:44:07.677555 [info ] [Thread-1 (]: 3 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [RUN]
[0m13:44:07.678129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_canonical_categories, now model.air_travel.tmp_airport_establishment_unique)
[0m13:44:07.678519 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m13:44:07.681084 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:44:07.681848 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m13:44:07.683464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:07.947765 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:44:07.949647 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_unique: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_unique"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_unique as (
  select distinct business, category, dining, _data_source, _load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
  order by category, business
)
select * 
from tmp_airport_establishment_unique
    );
  
[0m13:44:08.311245 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2f3cab26-344b-43a7-bf89-d52ee67c77ec&page=queryresults
[0m13:44:10.063167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b64ea30>]}
[0m13:44:10.064117 [info ] [Thread-1 (]: 3 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [[32mCREATE TABLE (1.1k rows, 74.4 KiB processed)[0m in 2.38s]
[0m13:44:10.064737 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m13:44:10.065125 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_country_iso_codes
[0m13:44:10.065597 [info ] [Thread-1 (]: 4 of 15 START sql table model dbt_air_travel_tmp.tmp_country_iso_codes ......... [RUN]
[0m13:44:10.066038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_unique, now model.air_travel.tmp_country_iso_codes)
[0m13:44:10.066429 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_country_iso_codes
[0m13:44:10.068903 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_country_iso_codes"
[0m13:44:10.069699 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_country_iso_codes
[0m13:44:10.071334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:10.351656 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_country_iso_codes"
[0m13:44:10.353796 [debug] [Thread-1 (]: On model.air_travel.tmp_country_iso_codes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_country_iso_codes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes`
      
    
    

    
    OPTIONS()
    as (
      with tmp_country_iso_codes as (
    select
      name,
      AI.GENERATE(
        ('What is the iso code for country ', name, '? If it does not have one, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
    where iso_code is null
  )
select name, llm_response.iso_code as mapped_iso_code
from tmp_country_iso_codes
    );
  
[0m13:44:10.778755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f1bc962a-6cbf-4a24-b86d-c8e82551ec65&page=queryresults
[0m13:44:17.747892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139b0d9d0>]}
[0m13:44:17.748930 [info ] [Thread-1 (]: 4 of 15 OK created sql table model dbt_air_travel_tmp.tmp_country_iso_codes .... [[32mCREATE TABLE (20.0 rows, 4.0 KiB processed)[0m in 7.68s]
[0m13:44:17.749525 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_country_iso_codes
[0m13:44:17.749930 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates
[0m13:44:17.750708 [info ] [Thread-1 (]: 5 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_duplicates ........ [RUN]
[0m13:44:17.751628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_country_iso_codes, now model.air_travel.tmp_airport_duplicates)
[0m13:44:17.752004 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates
[0m13:44:17.754776 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates"
[0m13:44:17.755525 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates
[0m13:44:17.757120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:18.046487 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_duplicates"
[0m13:44:18.047775 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_duplicates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_duplicates"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_duplicates as (
    select * 
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao in
        (select icao
        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
        group by icao
        having count(*) > 1)
)

select * from tmp_airport_duplicates
    );
  
[0m13:44:18.457500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:aefc82de-1c66-4d59-8074-670d4b283df7&page=queryresults
[0m13:44:20.307240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a6ab8c0>]}
[0m13:44:20.308235 [info ] [Thread-1 (]: 5 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_duplicates ... [[32mCREATE TABLE (1.2k rows, 712.6 KiB processed)[0m in 2.56s]
[0m13:44:20.308838 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates
[0m13:44:20.309229 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:44:20.309797 [info ] [Thread-1 (]: 6 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [RUN]
[0m13:44:20.310374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates, now model.air_travel.tmp_airport_establishment_raw_categories)
[0m13:44:20.310713 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:44:20.313145 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m13:44:20.313964 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:44:20.315845 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m13:44:20.316468 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_raw_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_raw_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`
      
    
    

    
    OPTIONS()
    as (
      with airport_establishment_raw_categories as
  select distinct business, category
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
  where category not in ('Airline', 'Airline Service', 'Airline Services', 'Airline Check-in', 'Airline Ticketing',
      'Airline Gate / Check-in', 'Airline Lounge', 'Airport Lounge', 'Airport Service', 'Airport Services', 'Air Freight', 'Car Rental',
      'Information Kiosk', 'Information Service', 'Parking', 'Transportation Service')
    );
  
[0m13:44:20.316784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:20.560620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6fe1f40d-951a-4382-817c-4957ef91d383&page=queryresults
[0m13:44:20.562084 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6fe1f40d-951a-4382-817c-4957ef91d383&page=queryresults
[0m13:44:20.574120 [debug] [Thread-1 (]: Database Error in model tmp_airport_establishment_raw_categories (models/tmp/tmp_airport_establishment_raw_categories.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_raw_categories.sql
[0m13:44:20.574756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b0efaae-dac8-4d54-8344-eec733a48b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139d90470>]}
[0m13:44:20.575372 [error] [Thread-1 (]: 6 of 15 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [[31mERROR[0m in 0.26s]
[0m13:44:20.575849 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:44:20.576161 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airline_country_mapped
[0m13:44:20.576533 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_raw_categories' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_establishment_raw_categories (models/tmp/tmp_airport_establishment_raw_categories.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_raw_categories.sql.
[0m13:44:20.576915 [info ] [Thread-1 (]: 7 of 15 START sql table model dbt_air_travel_tmp.tmp_airline_country_mapped .... [RUN]
[0m13:44:20.578046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_raw_categories, now model.air_travel.tmp_airline_country_mapped)
[0m13:44:20.578421 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airline_country_mapped
[0m13:44:20.580682 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airline_country_mapped"
[0m13:44:20.581319 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airline_country_mapped
[0m13:44:20.582986 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airline_country_mapped"
[0m13:44:20.583516 [debug] [Thread-1 (]: On model.air_travel.tmp_airline_country_mapped: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airline_country_mapped"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped`
      
    
    

    
    OPTIONS()
    as (
      with airline_orphan_countries as (
    select distinct country
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)
),
tmp_airline_countries_mapped as (
    select
      country,
      AI.GENERATE(
        ('If ', country, ' is a recognized country, return its iso code. If it is not a recognized country, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from airline_orphan_countries
  )
  select country as original_country, llm_response.iso_code as mapped_iso_code
  from tmp_airline_countries_mapped
    );
  
[0m13:44:20.583822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.057155 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1e7671ad-5e14-4e31-b65a-c1c3d5eb6326&page=queryresults
[0m13:44:23.544659 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:44:24.601668 [error] [MainThread]: CANCEL query model.air_travel.tmp_airline_country_mapped ....................... [[31mCANCEL[0m]
[0m13:44:24.601964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:25.125645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:25.126264 [debug] [MainThread]: Connection 'model.air_travel.tmp_airline_country_mapped' was properly closed.
[0m13:44:25.126701 [info ] [MainThread]: 
[0m13:44:25.127016 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 23.30 seconds (23.30s).
[0m13:44:25.127455 [error] [MainThread]: Encountered an error:

[0m13:44:25.130792 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 421, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 338, in run_queue
    self.handle_job_queue(pool, callback)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/run.py", line 853, in handle_job_queue
    node = self.job_queue.get()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 199, in get
    self.not_empty.wait()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 587, in run
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 604, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 541, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 454, in execute_nodes
    self._cancel_connections(pool)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 412, in _cancel_connections
    pool.join()
    ~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/pool.py", line 669, in join
    p.join()
    ~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 1094, in join
    self._handle.join(timeout)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyboardInterrupt

[0m13:44:25.135417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 24.355833, "process_in_blocks": "0", "process_kernel_time": 0.279028, "process_mem_max_rss": "390742016", "process_out_blocks": "0", "process_user_time": 2.194939}
[0m13:44:25.135837 [debug] [MainThread]: Command `dbt run` failed at 13:44:25.135761 after 24.36 seconds
[0m13:44:25.136124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13aa46c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a6daab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a6da990>]}
[0m13:44:25.136392 [debug] [MainThread]: Flushing usage events
[0m13:44:25.389729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:54.741245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103db86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c039d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c03750>]}


============================== 13:44:54.742853 | d3adb46c-d284-43cc-a956-24d5d8e3a7dc ==============================
[0m13:44:54.742853 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:44:54.743080 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'printer_width': '80', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select tmp_airport_establishment_raw_categories', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_colors': 'True', 'empty': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'quiet': 'False'}
[0m13:44:55.550035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3adb46c-d284-43cc-a956-24d5d8e3a7dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f5cc30>]}
[0m13:44:55.568792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3adb46c-d284-43cc-a956-24d5d8e3a7dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a1be360>]}
[0m13:44:55.568991 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:44:55.643058 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:44:55.682499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:55.682644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:55.684997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m13:44:55.698774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3adb46c-d284-43cc-a956-24d5d8e3a7dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b04a650>]}
[0m13:44:55.732430 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:44:55.733258 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:44:55.739211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3adb46c-d284-43cc-a956-24d5d8e3a7dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a1ce8a0>]}
[0m13:44:55.739384 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m13:44:55.739507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3adb46c-d284-43cc-a956-24d5d8e3a7dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a341550>]}
[0m13:44:55.740207 [info ] [MainThread]: 
[0m13:44:55.740332 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:55.740427 [info ] [MainThread]: 
[0m13:44:55.740610 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:44:55.740982 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:44:55.741153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:56.062617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:44:56.063179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:56.350502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:44:56.351584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:56.629289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:44:56.630858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:56.932463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3adb46c-d284-43cc-a956-24d5d8e3a7dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1eb860>]}
[0m13:44:56.933104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:56.936257 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:44:56.936781 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [RUN]
[0m13:44:56.937161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_establishment_raw_categories)
[0m13:44:56.937453 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:44:56.945520 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m13:44:56.946419 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:44:56.969116 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m13:44:56.969620 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_raw_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_raw_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`
      
    
    

    
    OPTIONS()
    as (
      with airport_establishment_raw_categories as
  select distinct business, category
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
  where category not in ('Airline', 'Airline Service', 'Airline Services', 'Airline Check-in', 'Airline Ticketing',
      'Airline Gate / Check-in', 'Airline Lounge', 'Airport Lounge', 'Airport Service', 'Airport Services', 'Air Freight', 'Car Rental',
      'Information Kiosk', 'Information Service', 'Parking', 'Transportation Service')
    );
  
[0m13:44:56.969847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:57.220518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:28a962ac-8e8d-49ec-a534-812521835f28&page=queryresults
[0m13:44:57.221823 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:28a962ac-8e8d-49ec-a534-812521835f28&page=queryresults
[0m13:44:57.234212 [debug] [Thread-1 (]: Database Error in model tmp_airport_establishment_raw_categories (models/tmp/tmp_airport_establishment_raw_categories.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_raw_categories.sql
[0m13:44:57.236186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3adb46c-d284-43cc-a956-24d5d8e3a7dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b3d2990>]}
[0m13:44:57.236780 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [[31mERROR[0m in 0.30s]
[0m13:44:57.237267 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:44:57.237753 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_raw_categories' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_establishment_raw_categories (models/tmp/tmp_airport_establishment_raw_categories.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_raw_categories.sql.
[0m13:44:57.239248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:57.240526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:57.240757 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_raw_categories' was properly closed.
[0m13:44:57.240974 [info ] [MainThread]: 
[0m13:44:57.241226 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m13:44:57.241830 [debug] [MainThread]: Command end result
[0m13:44:57.261219 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:44:57.262310 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:44:57.265479 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:44:57.265640 [info ] [MainThread]: 
[0m13:44:57.265816 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:44:57.265949 [info ] [MainThread]: 
[0m13:44:57.266127 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_raw_categories (models/tmp/tmp_airport_establishment_raw_categories.sql)[0m
[0m13:44:57.266287 [error] [MainThread]:   Database Error in model tmp_airport_establishment_raw_categories (models/tmp/tmp_airport_establishment_raw_categories.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:3]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_establishment_raw_categories.sql
[0m13:44:57.266404 [info ] [MainThread]: 
[0m13:44:57.266544 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_raw_categories.sql
[0m13:44:57.266660 [info ] [MainThread]: 
[0m13:44:57.266799 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:44:57.269019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.553152, "process_in_blocks": "0", "process_kernel_time": 0.210214, "process_mem_max_rss": "383057920", "process_out_blocks": "0", "process_user_time": 1.645004}
[0m13:44:57.269237 [debug] [MainThread]: Command `dbt run` failed at 13:44:57.269197 after 2.55 seconds
[0m13:44:57.269403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b33f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a7c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a260910>]}
[0m13:44:57.269559 [debug] [MainThread]: Flushing usage events
[0m13:44:57.512274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:32.522512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ac6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f7750>]}


============================== 13:45:32.524149 | 1e93cb13-884e-4fc1-b245-77bbf4febb02 ==============================
[0m13:45:32.524149 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:45:32.524394 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'no_print': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'profiles_dir': '/Users/scohen/.dbt', 'invocation_command': 'dbt run --select tmp_airport_establishment_raw_categories', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'fail_fast': 'False', 'version_check': 'True'}
[0m13:45:33.342885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e93cb13-884e-4fc1-b245-77bbf4febb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b50c30>]}
[0m13:45:33.361724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e93cb13-884e-4fc1-b245-77bbf4febb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117762360>]}
[0m13:45:33.361935 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:45:33.435030 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:45:33.475286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:45:33.475531 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_raw_categories.sql
[0m13:45:33.555605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m13:45:33.560173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e93cb13-884e-4fc1-b245-77bbf4febb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bea150>]}
[0m13:45:33.592369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:45:33.593209 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:45:33.600283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e93cb13-884e-4fc1-b245-77bbf4febb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11776e8a0>]}
[0m13:45:33.600461 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m13:45:33.600581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e93cb13-884e-4fc1-b245-77bbf4febb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117991d30>]}
[0m13:45:33.601284 [info ] [MainThread]: 
[0m13:45:33.601405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:33.601496 [info ] [MainThread]: 
[0m13:45:33.601678 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:45:33.602042 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:45:33.602219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:33.938211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:45:33.938735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:34.220640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:45:34.223377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:34.515975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:45:34.516848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:34.805453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e93cb13-884e-4fc1-b245-77bbf4febb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e61bf0>]}
[0m13:45:34.806262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:34.809886 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:45:34.810363 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [RUN]
[0m13:45:34.810714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_establishment_raw_categories)
[0m13:45:34.811004 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:45:34.817730 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m13:45:34.818419 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:45:34.842111 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m13:45:34.842694 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_raw_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_raw_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`
      
    
    

    
    OPTIONS()
    as (
      with airport_establishment_raw_categories as (
  select distinct business, category
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
  where category not in ('Airline', 'Airline Service', 'Airline Services', 'Airline Check-in', 'Airline Ticketing',
      'Airline Gate / Check-in', 'Airline Lounge', 'Airport Lounge', 'Airport Service', 'Airport Services', 'Air Freight', 'Car Rental',
      'Information Kiosk', 'Information Service', 'Parking', 'Transportation Service')
)

select * 
from airport_establishment_raw_categories
    );
  
[0m13:45:34.842925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:35.349281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:07631c60-5da2-4554-9aa9-93dd620e236d&page=queryresults
[0m13:45:39.109512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e93cb13-884e-4fc1-b245-77bbf4febb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ebfb90>]}
[0m13:45:39.109895 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [[32mCREATE TABLE (853.0 rows, 29.3 KiB processed)[0m in 4.30s]
[0m13:45:39.110193 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:45:39.110819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:39.111632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:39.111772 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_raw_categories' was properly closed.
[0m13:45:39.111903 [info ] [MainThread]: 
[0m13:45:39.112040 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m13:45:39.112341 [debug] [MainThread]: Command end result
[0m13:45:39.126078 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:45:39.126998 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:45:39.129448 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:45:39.129575 [info ] [MainThread]: 
[0m13:45:39.129722 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:45:39.129829 [info ] [MainThread]: 
[0m13:45:39.129955 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:45:39.131808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6333175, "process_in_blocks": "0", "process_kernel_time": 0.251428, "process_mem_max_rss": "389939200", "process_out_blocks": "0", "process_user_time": 1.729443}
[0m13:45:39.131989 [debug] [MainThread]: Command `dbt run` succeeded at 13:45:39.131953 after 6.63 seconds
[0m13:45:39.132132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f85f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f474d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f8fbb0>]}
[0m13:45:39.132265 [debug] [MainThread]: Flushing usage events
[0m13:45:39.338478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:51.123032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056179d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105617750>]}


============================== 13:45:51.124627 | 25661409-01d5-4e17-a495-7861a59d1ab9 ==============================
[0m13:45:51.124627 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:45:51.124877 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'static_parser': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select models/tmp/tmp_airline_country_mapped.sql models/tmp/tmp_airport_all.sql models/tmp/tmp_airport_country_iso_codes.sql models/tmp/tmp_airport_duplicates_embeddings.sql models/tmp/tmp_airport_duplicates.sql models/tmp/tmp_airport_establishment_broad_categories_mapped.sql models/tmp/tmp_airport_establishment_canonical_categories.sql models/tmp/tmp_airport_establishment_raw_categories.sql models/tmp/tmp_airport_establishment_sub_categories_mapped.sql models/tmp/tmp_airport_establishment_unique.sql models/tmp/tmp_airport_inference_results_embeddings.sql models/tmp/tmp_airport_inference_results.sql models/tmp/tmp_airport_llm.sql models/tmp/tmp_airport_refined.sql models/tmp/tmp_airport_vector_search_results.sql models/tmp/tmp_country_iso_codes.sql --exclude tmp_airport_llm', 'profiles_dir': '/Users/scohen/.dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_cache_events': 'False'}
[0m13:45:51.930922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104970c30>]}
[0m13:45:51.950084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241be360>]}
[0m13:45:51.950302 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:45:52.025486 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:45:52.065269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:45:52.065416 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:45:52.067789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m13:45:52.081507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12474a650>]}
[0m13:45:52.114568 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:45:52.115349 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:45:52.121395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241ce8a0>]}
[0m13:45:52.121565 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m13:45:52.121686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124441550>]}
[0m13:45:52.129826 [info ] [MainThread]: 
[0m13:45:52.130021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:52.130137 [info ] [MainThread]: 
[0m13:45:52.130341 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:45:52.132001 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:45:52.132178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:52.478413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:45:52.479119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:52.745676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:45:52.748627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:53.017508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:45:53.018744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:53.294578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1248ef860>]}
[0m13:45:53.295272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:53.298821 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m13:45:53.299362 [info ] [Thread-1 (]: 1 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_all ............... [RUN]
[0m13:45:53.299753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_all)
[0m13:45:53.300050 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_all
[0m13:45:53.308406 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_all"
[0m13:45:53.309020 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_all
[0m13:45:53.317988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:53.635535 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_all"
[0m13:45:53.636206 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_all: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_all"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_all as (
    select distinct al.llm_icao as icao, a.iata, a.name, a.city, al.llm_state_prov as state_prov, 
        a.country, a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, 
        a.timezone_name, a.type, a.source, 'openflights,llm' as _data_source, a._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm` al
    on a.name = al.name and a.country = al.country
    where a.iata is not null
    and al.llm_icao is not null
)

select * from tmp_airport_all
    );
  
[0m13:45:54.015441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f2666b0c-b625-4591-bf25-61bc12bdaee3&page=queryresults
[0m13:45:56.132852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249d3290>]}
[0m13:45:56.133243 [info ] [Thread-1 (]: 1 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_all .......... [[32mCREATE TABLE (4.7k rows, 1.6 MiB processed)[0m in 2.83s]
[0m13:45:56.133537 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m13:45:56.133719 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:45:56.133968 [info ] [Thread-1 (]: 2 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [RUN]
[0m13:45:56.134354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_all, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m13:45:56.134563 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:45:56.135417 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:45:56.135790 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:45:56.136877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:56.393571 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:45:56.395416 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_canonical_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_canonical_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_canonical_categories as (
    select 'Quick Service & Grab-and-Go' as broad_category, 'National/International Fast Food Chains' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Coffee & Beverage Shops' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Snack Kiosks' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Pre-Packaged Foods' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Gourmet Burgers & Sandwiches' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Build-Your-Own Concepts' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Pizzerias' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Casual Dining Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Upscale & Chef-Driven Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Themed Restaurants & Sports Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Wine Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Craft Beer Pubs' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Cocktail Lounges' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Newsstands & Bookstores' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Pharmacies & Personal Care' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Travel Gear & Luggage' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Electronics' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Local Souvenirs & Gifts' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Apparel & Accessories' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Confectionery & Gourmet Foods' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Designer Fashion' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Jewelry & Watches' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'High-End Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Liquor & Tobacco' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Fragrances & Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Luxury Accessories & Confectionery' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Spas & Salons' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Pay-Per-Use Lounges' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Yoga & Meditation Rooms' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Shower Facilities' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Currency Exchan' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'ATMs & Banking Services' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Business Centers & Work Pods' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Luggage Storage & Wrapping' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Postal & Shipping Services' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Pet Relief & Care Areas' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Vending Machines (non-F&B)' as sub_category
)

select * 
from tmp_airport_establishment_canonical_categories
    );
  
[0m13:45:56.727307 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:51b03677-d0f2-4d6f-be3f-603a2f639ea8&page=queryresults
[0m13:45:58.397222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249b52e0>]}
[0m13:45:58.398088 [info ] [Thread-1 (]: 2 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [[32mCREATE TABLE (37.0 rows, 0 processed)[0m in 2.26s]
[0m13:45:58.398629 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:45:58.398977 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m13:45:58.399463 [info ] [Thread-1 (]: 3 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [RUN]
[0m13:45:58.399909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_canonical_categories, now model.air_travel.tmp_airport_establishment_unique)
[0m13:45:58.400216 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m13:45:58.402534 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:45:58.403210 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m13:45:58.404546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:58.682144 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:45:58.684323 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_unique: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_unique"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_unique as (
  select distinct business, category, dining, _data_source, _load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
  order by category, business
)
select * 
from tmp_airport_establishment_unique
    );
  
[0m13:45:59.081896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a6a9f2fb-acfc-4569-970f-faf40267ae38&page=queryresults
[0m13:46:00.726259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12580c730>]}
[0m13:46:00.727291 [info ] [Thread-1 (]: 3 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [[32mCREATE TABLE (1.1k rows, 74.4 KiB processed)[0m in 2.33s]
[0m13:46:00.727935 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m13:46:00.728331 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_country_iso_codes
[0m13:46:00.728891 [info ] [Thread-1 (]: 4 of 15 START sql table model dbt_air_travel_tmp.tmp_country_iso_codes ......... [RUN]
[0m13:46:00.729517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_unique, now model.air_travel.tmp_country_iso_codes)
[0m13:46:00.729861 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_country_iso_codes
[0m13:46:00.732297 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_country_iso_codes"
[0m13:46:00.733053 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_country_iso_codes
[0m13:46:00.734730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:01.014833 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_country_iso_codes"
[0m13:46:01.016631 [debug] [Thread-1 (]: On model.air_travel.tmp_country_iso_codes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_country_iso_codes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes`
      
    
    

    
    OPTIONS()
    as (
      with tmp_country_iso_codes as (
    select
      name,
      AI.GENERATE(
        ('What is the iso code for country ', name, '? If it does not have one, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
    where iso_code is null
  )
select name, llm_response.iso_code as mapped_iso_code
from tmp_country_iso_codes
    );
  
[0m13:46:01.437968 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ff23f0c8-130b-4880-bbe0-d167bd0ce566&page=queryresults
[0m13:48:02.697564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f10d50>]}
[0m13:48:02.698498 [info ] [Thread-1 (]: 4 of 15 OK created sql table model dbt_air_travel_tmp.tmp_country_iso_codes .... [[32mCREATE TABLE (20.0 rows, 4.0 KiB processed)[0m in 121.97s]
[0m13:48:02.699047 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_country_iso_codes
[0m13:48:02.699395 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates
[0m13:48:02.699910 [info ] [Thread-1 (]: 5 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_duplicates ........ [RUN]
[0m13:48:02.700464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_country_iso_codes, now model.air_travel.tmp_airport_duplicates)
[0m13:48:02.700864 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates
[0m13:48:02.703467 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates"
[0m13:48:02.704146 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates
[0m13:48:02.705622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:03.045228 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_duplicates"
[0m13:48:03.047355 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_duplicates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_duplicates"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_duplicates as (
    select * 
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao in
        (select icao
        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
        group by icao
        having count(*) > 1)
)

select * from tmp_airport_duplicates
    );
  
[0m13:48:03.419755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e2d45d10-fa3f-4fe2-b882-71e79397523f&page=queryresults
[0m13:48:05.476201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125fbb930>]}
[0m13:48:05.477000 [info ] [Thread-1 (]: 5 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_duplicates ... [[32mCREATE TABLE (1.2k rows, 712.6 KiB processed)[0m in 2.78s]
[0m13:48:05.477494 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates
[0m13:48:05.477810 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:48:05.478291 [info ] [Thread-1 (]: 6 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [RUN]
[0m13:48:05.478821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates, now model.air_travel.tmp_airport_establishment_raw_categories)
[0m13:48:05.479213 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:48:05.481366 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m13:48:05.482090 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:48:05.483416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:05.743290 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m13:48:05.745350 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_raw_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_raw_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`
      
    
    

    
    OPTIONS()
    as (
      with airport_establishment_raw_categories as (
  select distinct business, category
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
  where category not in ('Airline', 'Airline Service', 'Airline Services', 'Airline Check-in', 'Airline Ticketing',
      'Airline Gate / Check-in', 'Airline Lounge', 'Airport Lounge', 'Airport Service', 'Airport Services', 'Air Freight', 'Car Rental',
      'Information Kiosk', 'Information Service', 'Parking', 'Transportation Service')
)

select * 
from airport_establishment_raw_categories
    );
  
[0m13:48:06.111094 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f0eb25a9-f7bb-4200-972f-9b642a33170b&page=queryresults
[0m13:48:07.885261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125df2090>]}
[0m13:48:07.886155 [info ] [Thread-1 (]: 6 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [[32mCREATE TABLE (853.0 rows, 29.3 KiB processed)[0m in 2.41s]
[0m13:48:07.886688 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:48:07.887026 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airline_country_mapped
[0m13:48:07.887514 [info ] [Thread-1 (]: 7 of 15 START sql table model dbt_air_travel_tmp.tmp_airline_country_mapped .... [RUN]
[0m13:48:07.888063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_raw_categories, now model.air_travel.tmp_airline_country_mapped)
[0m13:48:07.888460 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airline_country_mapped
[0m13:48:07.891210 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airline_country_mapped"
[0m13:48:07.891948 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airline_country_mapped
[0m13:48:07.893651 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airline_country_mapped"
[0m13:48:07.894209 [debug] [Thread-1 (]: On model.air_travel.tmp_airline_country_mapped: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airline_country_mapped"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped`
      
    
    

    
    OPTIONS()
    as (
      with airline_orphan_countries as (
    select distinct country
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)
),
tmp_airline_countries_mapped as (
    select
      country,
      AI.GENERATE(
        ('If ', country, ' is a recognized country, return its iso code. If it is not a recognized country, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from airline_orphan_countries
  )
  select country as original_country, llm_response.iso_code as mapped_iso_code
  from tmp_airline_countries_mapped
    );
  
[0m13:48:07.894513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:10.566300 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4f3ea4d0-ef6f-4702-911b-2548998e8f2b&page=queryresults
[0m13:48:55.826669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124368650>]}
[0m13:48:55.827421 [info ] [Thread-1 (]: 7 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airline_country_mapped  [[32mCREATE TABLE (88.0 rows, 68.9 KiB processed)[0m in 47.94s]
[0m13:48:55.827826 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airline_country_mapped
[0m13:48:55.828093 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:48:55.828460 [info ] [Thread-1 (]: 8 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_duplicates_embeddings  [RUN]
[0m13:48:55.828822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airline_country_mapped, now model.air_travel.tmp_airport_duplicates_embeddings)
[0m13:48:55.829075 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:48:55.831042 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m13:48:55.831715 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:48:55.832812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:56.142773 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m13:48:56.145063 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_duplicates_embeddings: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_duplicates_embeddings"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_duplicates_embeddings as (
      select icao, iata, name, ml_generate_embedding_result as embedding
      from
      ML.GENERATE_EMBEDDING(
        model air_travel_model.embedding_model,
        (select icao, iata, name, concat(icao, ',', iata, ',', name) as content
        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`),
        struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type)
      )
  )

  select * from tmp_airport_duplicates_embeddings
    );
  
[0m13:48:56.542593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:30b55792-df57-4c5e-915d-e147a8e6b867&page=queryresults
[0m13:49:00.059235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125df34d0>]}
[0m13:49:00.060310 [info ] [Thread-1 (]: 8 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_duplicates_embeddings  [[32mCREATE TABLE (1.2k rows, 39.6 KiB processed)[0m in 4.23s]
[0m13:49:00.061059 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:49:00.061834 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results
[0m13:49:00.062469 [info ] [Thread-1 (]: 9 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_inference_results . [RUN]
[0m13:49:00.063034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates_embeddings, now model.air_travel.tmp_airport_inference_results)
[0m13:49:00.063352 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results
[0m13:49:00.065738 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results"
[0m13:49:00.066509 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results
[0m13:49:00.068054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:00.327376 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_inference_results"
[0m13:49:00.329707 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_inference_results: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_inference_results"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_inference_results as (
    select icao,
      AI.GENERATE(
        ('What are the iata code and name of the airport that has the icao code of ', icao, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iata STRING, name STRING') as llm_response
    from (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)
)
select icao, llm_response.iata as iata, llm_response.name as name
from tmp_airport_inference_results
    );
  
[0m13:49:00.742269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9ff7c5fa-7b27-4393-98f2-132070442ad7&page=queryresults
[0m13:56:56.605257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125df3f50>]}
[0m13:56:56.606131 [info ] [Thread-1 (]: 9 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_inference_results  [[32mCREATE TABLE (480.0 rows, 6.7 KiB processed)[0m in 476.54s]
[0m13:56:56.606632 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results
[0m13:56:56.606962 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:56:56.607468 [info ] [Thread-1 (]: 10 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_mapped  [RUN]
[0m13:56:56.608019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results, now model.air_travel.tmp_airport_establishment_broad_categories_mapped)
[0m13:56:56.608400 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:56:56.611100 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_mapped"
[0m13:56:56.611907 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:56:56.613925 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_broad_categories_mapped"
[0m13:56:56.614465 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_broad_categories_mapped: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_broad_categories_mapped"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_mapped`
      
    
    

    
    OPTIONS()
    as (
      with canonical_categories as (
    select ARRAY_AGG(distinct broad_category) AS broad_categories
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`
),
tmp_airport_establishment_broad_categories_mapped as (
    select
      business,
      category as raw_category,
      AI.GENERATE(
        ('Map the business ', business, ' to its most fitting broad category from this canonical category list:',
          broad_categories),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'broad_category STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`
    cross join canonical_categories
  )
select business, raw_category, llm_response.broad_category as broad_category
from tmp_airport_establishment_broad_categories_mapped
    );
  
[0m13:56:56.614767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:57.105991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:808e40ca-fca2-4762-8187-bd2144d0e55e&page=queryresults
[0m13:59:14.568525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f7c770>]}
[0m13:59:14.569703 [info ] [Thread-1 (]: 10 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_mapped  [[32mCREATE TABLE (853.0 rows, 23.0 KiB processed)[0m in 137.96s]
[0m13:59:14.570609 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:59:14.571005 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:59:14.571537 [info ] [Thread-1 (]: 11 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_inference_results_embeddings  [RUN]
[0m13:59:14.572209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_broad_categories_mapped, now model.air_travel.tmp_airport_inference_results_embeddings)
[0m13:59:14.572677 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:59:14.575373 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results_embeddings"
[0m13:59:14.576234 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:59:14.578449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:14.890257 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_inference_results_embeddings"
[0m13:59:14.891993 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_inference_results_embeddings: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_inference_results_embeddings"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results_embeddings`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_inference_results_embeddings as (
  select icao, iata, name, ml_generate_embedding_result as embedding
  from
    ML.GENERATE_EMBEDDING(
      model air_travel_model.embedding_model,
      (select icao, iata, name, concat(icao, ',', iata, ',', name) as content
       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results`
       where iata is not null
       and name != 'Unknown'),
       struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type)
    )
)

select * from tmp_airport_inference_results_embeddings
    );
  
[0m13:59:15.339724 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:555ee022-b935-4704-9414-5d89fff49bfa&page=queryresults
[0m13:59:18.108523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125df3c50>]}
[0m13:59:18.109639 [info ] [Thread-1 (]: 11 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_inference_results_embeddings  [[32mCREATE TABLE (120.0 rows, 6.2 KiB processed)[0m in 3.54s]
[0m13:59:18.110339 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:59:18.111272 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m13:59:18.111928 [info ] [Thread-1 (]: 12 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_sub_categories_mapped  [RUN]
[0m13:59:18.112592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results_embeddings, now model.air_travel.tmp_airport_establishment_sub_categories_mapped)
[0m13:59:18.112964 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m13:59:18.115884 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_sub_categories_mapped"
[0m13:59:18.116718 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m13:59:18.119274 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_sub_categories_mapped"
[0m13:59:18.120006 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_sub_categories_mapped: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_sub_categories_mapped"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_sub_categories_mapped`
      
    
    

    
    OPTIONS()
    as (
      with tmp_establishment_categories as (
    select m.business, m.broad_category,
      array_agg(distinct c.sub_category) AS sub_categories
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_mapped` m
    join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories` c
    on m.broad_category = c.broad_category
    where m.broad_category is not null
    group by m.business, m.broad_category
),
tmp_airport_establishment_sub_categories_mapped as (
    select
      business,
      broad_category,
      AI.GENERATE(
        ('Map the airport concession ', business, ' with broad category ', broad_category,
        ' to its most fitting sub category based on this canonical list of subcategories: ', sub_categories),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'sub_category STRING') as llm_response
    from tmp_establishment_categories
  )
select business, broad_category, llm_response.sub_category as sub_category
from tmp_airport_establishment_sub_categories_mapped
    );
  
[0m13:59:18.120509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:18.720728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2ba2cdff-9a5c-4a83-b5a6-0234ff8cc6ba&page=queryresults
[0m14:02:07.255362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f7d910>]}
[0m14:02:07.256198 [info ] [Thread-1 (]: 12 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_sub_categories_mapped  [[32mCREATE TABLE (830.0 rows, 36.2 KiB processed)[0m in 169.14s]
[0m14:02:07.256704 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m14:02:07.257127 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_vector_search_results
[0m14:02:07.257596 [info ] [Thread-1 (]: 13 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_vector_search_results  [RUN]
[0m14:02:07.258151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_sub_categories_mapped, now model.air_travel.tmp_airport_vector_search_results)
[0m14:02:07.258578 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_vector_search_results
[0m14:02:07.260813 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_vector_search_results"
[0m14:02:07.261612 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_vector_search_results
[0m14:02:07.262958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:07.558603 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_vector_search_results"
[0m14:02:07.559956 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_vector_search_results: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_vector_search_results"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_vector_search_results as (
  select base.icao as base_icao, base.iata as base_iata, base.name as base_name,
    query.icao as query_icao, query.iata as query_iata, query.name as query_name,
    distance
  from
    vector_search(
      table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`, -- this is the base (i.e what's in the Airport table)
      'embedding',
      table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results_embeddings`, -- this is the query (i.e. results from LLM inference)
      'embedding',
      top_k => 1,
      distance_type => 'COSINE')
  where query.icao = base.icao
  order by distance
)

select * 
from tmp_airport_vector_search_results
    );
  
[0m14:02:07.960862 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:bcac69d6-b3ec-4dad-b6c1-776063ed226d&page=queryresults
[0m14:02:10.080125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125df3c50>]}
[0m14:02:10.081272 [info ] [Thread-1 (]: 13 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_vector_search_results  [[32mCREATE TABLE (82.0 rows, 7.5 MiB processed)[0m in 2.82s]
[0m14:02:10.081815 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_vector_search_results
[0m14:02:10.083437 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m14:02:10.084137 [info ] [Thread-1 (]: 14 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_refined .......... [RUN]
[0m14:02:10.084654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_vector_search_results, now model.air_travel.tmp_airport_refined)
[0m14:02:10.084983 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_refined
[0m14:02:10.088281 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_refined"
[0m14:02:10.089256 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_refined
[0m14:02:10.091061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:10.355800 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_refined"
[0m14:02:10.357698 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_refined: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_refined"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_refined as (
    select *
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao not in (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)
    union all
    select * from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
    where concat(icao, ',', iata, ',', name) in
      (select concat(base_icao, ',', base_iata, ',', base_name)
       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`
       where distance < 0.08)
)

select * from tmp_airport_refined
    );
  
[0m14:02:10.652065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7f729178-3049-45c7-9bc2-307743e68753&page=queryresults
[0m14:02:12.679100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125df13d0>]}
[0m14:02:12.680101 [info ] [Thread-1 (]: 14 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_refined ..... [[32mCREATE TABLE (3.5k rows, 892.9 KiB processed)[0m in 2.59s]
[0m14:02:12.680779 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m14:02:12.681596 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_iso_codes
[0m14:02:12.682158 [info ] [Thread-1 (]: 15 of 15 START sql table model dbt_air_travel_tmp.tmp_airport_country_iso_codes  [RUN]
[0m14:02:12.682609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_refined, now model.air_travel.tmp_airport_country_iso_codes)
[0m14:02:12.682945 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_iso_codes
[0m14:02:12.685626 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_iso_codes"
[0m14:02:12.686331 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_iso_codes
[0m14:02:12.688102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:12.980328 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_country_iso_codes"
[0m14:02:12.981685 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_country_iso_codes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_country_iso_codes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`
      
    
    

    
    OPTIONS()
    as (
      with tmp_orphan_country as (
    select distinct country as airport_country_name
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`
    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)
),
tmp_airport_country_iso_codes as (
    select airport_country_name,
      AI.GENERATE(
        ('What is the iso code for the country ', airport_country_name, '? If it does not have an iso code, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from tmp_orphan_country
)
select airport_country_name, llm_response.iso_code as mapped_iso_code
from tmp_airport_country_iso_codes
    );
  
[0m14:02:13.302994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0009c119-e231-405e-ba29-8a75110aadb6&page=queryresults
[0m14:02:19.877720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25661409-01d5-4e17-a495-7861a59d1ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e9d1f0>]}
[0m14:02:19.878638 [info ] [Thread-1 (]: 15 of 15 OK created sql table model dbt_air_travel_tmp.tmp_airport_country_iso_codes  [[32mCREATE TABLE (19.0 rows, 41.7 KiB processed)[0m in 7.19s]
[0m14:02:19.879455 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_iso_codes
[0m14:02:19.880596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:02:19.882091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:19.882332 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_country_iso_codes' was properly closed.
[0m14:02:19.882639 [info ] [MainThread]: 
[0m14:02:19.882877 [info ] [MainThread]: Finished running 15 table models in 0 hours 16 minutes and 27.75 seconds (987.75s).
[0m14:02:19.884625 [debug] [MainThread]: Command end result
[0m14:02:20.010548 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:02:20.011444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:02:20.014032 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m14:02:20.014143 [info ] [MainThread]: 
[0m14:02:20.014275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:20.014381 [info ] [MainThread]: 
[0m14:02:20.014498 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m14:02:20.016228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 988.9398, "process_in_blocks": "0", "process_kernel_time": 0.486257, "process_mem_max_rss": "401276928", "process_out_blocks": "0", "process_user_time": 3.506587}
[0m14:02:20.016411 [debug] [MainThread]: Command `dbt run` succeeded at 14:02:20.016377 after 988.94 seconds
[0m14:02:20.016550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124760230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f7c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f7c1d0>]}
[0m14:02:20.016683 [debug] [MainThread]: Flushing usage events
[0m14:02:20.292169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:43.948683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e506e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9b750>]}


============================== 14:32:43.950375 | 85e045da-d918-432f-a3ce-bb5b60a19547 ==============================
[0m14:32:43.950375 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m14:32:43.950608 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --select Flight_Routes', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error': 'None', 'empty': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'introspect': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m14:32:44.879327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85e045da-d918-432f-a3ce-bb5b60a19547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff4c30>]}
[0m14:32:44.899812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85e045da-d918-432f-a3ce-bb5b60a19547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132cbe360>]}
[0m14:32:44.900117 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:32:44.980348 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m14:32:45.025155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:32:45.025434 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Flight_Routes.sql
[0m14:32:45.025569 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airline.sql
[0m14:32:45.091007 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.Airline' (models/int/Airline.sql) depends on a node named 'tmp_airline_countries_mapped' which was not found
[0m14:32:45.092778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1709825, "process_in_blocks": "0", "process_kernel_time": 0.241606, "process_mem_max_rss": "377946112", "process_out_blocks": "0", "process_user_time": 1.410332}
[0m14:32:45.093012 [debug] [MainThread]: Command `dbt run` failed at 14:32:45.092975 after 1.17 seconds
[0m14:32:45.093161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132c6b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133a4a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133c755e0>]}
[0m14:32:45.093293 [debug] [MainThread]: Flushing usage events
[0m14:32:45.331185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:46.692367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11051c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111873750>]}


============================== 14:34:46.694187 | 8a05d75d-0abc-4524-92dc-da825ac50bb2 ==============================
[0m14:34:46.694187 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m14:34:46.694440 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select Flight_Routes', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error': 'None', 'printer_width': '80', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:34:47.599058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a05d75d-0abc-4524-92dc-da825ac50bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106c0c30>]}
[0m14:34:47.619859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a05d75d-0abc-4524-92dc-da825ac50bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1681be360>]}
[0m14:34:47.620104 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:34:47.700191 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m14:34:47.743626 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:34:47.743893 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Flight_Routes.sql
[0m14:34:47.743995 [debug] [MainThread]: Partial parsing: deleted file: air_travel://models/int/Airline.sql
[0m14:34:47.831043 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m14:34:47.835977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a05d75d-0abc-4524-92dc-da825ac50bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16874a150>]}
[0m14:34:47.871450 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:34:47.872399 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:34:47.880216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a05d75d-0abc-4524-92dc-da825ac50bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1681ce8a0>]}
[0m14:34:47.880454 [info ] [MainThread]: Found 33 models, 9 data tests, 9 sources, 514 macros
[0m14:34:47.880586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a05d75d-0abc-4524-92dc-da825ac50bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1683f60b0>]}
[0m14:34:47.881357 [info ] [MainThread]: 
[0m14:34:47.881493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:47.881590 [info ] [MainThread]: 
[0m14:34:47.881785 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:34:47.882182 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m14:34:47.882367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:48.245609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m14:34:48.246107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:48.589641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m14:34:48.591868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:48.877725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m14:34:48.878745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:49.187446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a05d75d-0abc-4524-92dc-da825ac50bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168fd0600>]}
[0m14:34:49.188021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:34:49.190753 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Routes
[0m14:34:49.191251 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Flight_Routes .................. [RUN]
[0m14:34:49.191623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Flight_Routes)
[0m14:34:49.191901 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Routes
[0m14:34:49.196992 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Routes"
[0m14:34:49.197380 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Routes
[0m14:34:49.221389 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Flight_Routes"
[0m14:34:49.221981 [debug] [Thread-1 (]: On model.air_travel.Flight_Routes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Flight_Routes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
      
    
    

    
    OPTIONS()
    as (
      with Flight_Routes as (
  select distinct r.airline_id, a1.icao as source_airport_icao, 
    a2.icao as dest_airport_icao, r.codeshare, r.stops, r.equipment, 
    r._data_source, r._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes` r
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a1
  on r.source_airport = a1.iata
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a2
  on r.dest_airport = a2.iata
)

select * 
from Flight_Routes
    );
  
[0m14:34:49.222208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:49.782230 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e811ba91-95d9-472b-8605-640ef2ff19f3&page=queryresults
[0m14:34:51.638605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a05d75d-0abc-4524-92dc-da825ac50bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168f23650>]}
[0m14:34:51.639180 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Flight_Routes ............. [[32mCREATE TABLE (18.4k rows, 3.6 MiB processed)[0m in 2.45s]
[0m14:34:51.639616 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Routes
[0m14:34:51.640565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:34:51.641854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:51.642053 [debug] [MainThread]: Connection 'model.air_travel.Flight_Routes' was properly closed.
[0m14:34:51.642236 [info ] [MainThread]: 
[0m14:34:51.642439 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m14:34:51.642854 [debug] [MainThread]: Command end result
[0m14:34:51.660504 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:34:51.661562 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:34:51.664603 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m14:34:51.664744 [info ] [MainThread]: 
[0m14:34:51.664925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:51.665051 [info ] [MainThread]: 
[0m14:34:51.665191 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:34:51.667430 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.002841, "process_in_blocks": "0", "process_kernel_time": 0.292515, "process_mem_max_rss": "393461760", "process_out_blocks": "0", "process_user_time": 1.86204}
[0m14:34:51.667644 [debug] [MainThread]: Command `dbt run` succeeded at 14:34:51.667603 after 5.00 seconds
[0m14:34:51.667808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168fde0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168fecaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168fefcf0>]}
[0m14:34:51.667973 [debug] [MainThread]: Flushing usage events
[0m14:34:51.894575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:55.174217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a3750>]}


============================== 16:27:55.175899 | 59f5f1be-3239-4908-8987-f46b6edc3856 ==============================
[0m16:27:55.175899 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:27:55.176140 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select Airline', 'target_path': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'version_check': 'True', 'profiles_dir': '/Users/scohen/.dbt'}
[0m16:27:56.046903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59f5f1be-3239-4908-8987-f46b6edc3856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107afcc30>]}
[0m16:27:56.066283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59f5f1be-3239-4908-8987-f46b6edc3856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d8be360>]}
[0m16:27:56.066530 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:27:56.140718 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:27:56.185269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:27:56.185503 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airline.sql
[0m16:27:56.244387 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.Airline' (models/int/Airline.sql) depends on a node named 'tmp_airline_countries_mapped' which was not found
[0m16:27:56.246089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0973366, "process_in_blocks": "0", "process_kernel_time": 0.22307, "process_mem_max_rss": "380616704", "process_out_blocks": "0", "process_user_time": 1.316637}
[0m16:27:56.246308 [debug] [MainThread]: Command `dbt run` failed at 16:27:56.246270 after 1.10 seconds
[0m16:27:56.246468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d86b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d86b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e1795e0>]}
[0m16:27:56.246598 [debug] [MainThread]: Flushing usage events
[0m16:27:56.487218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:28:24.630827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106873750>]}


============================== 16:28:24.632411 | 488db849-4fa0-43a3-905a-da8f84dc15a0 ==============================
[0m16:28:24.632411 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:28:24.632651 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'invocation_command': 'dbt run --select Airline', 'target_path': 'None'}
[0m16:28:25.439574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '488db849-4fa0-43a3-905a-da8f84dc15a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4cc30>]}
[0m16:28:25.458239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '488db849-4fa0-43a3-905a-da8f84dc15a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363be360>]}
[0m16:28:25.458453 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:28:25.533549 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:28:25.573074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:28:25.573291 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airline.sql
[0m16:28:25.632836 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.Airline' (models/int/Airline.sql) depends on a node named 'tmp_airline_countries_mapped' which was not found
[0m16:28:25.634596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0273321, "process_in_blocks": "0", "process_kernel_time": 0.193718, "process_mem_max_rss": "383713280", "process_out_blocks": "0", "process_user_time": 1.309135}
[0m16:28:25.634813 [debug] [MainThread]: Command `dbt run` failed at 16:28:25.634775 after 1.03 seconds
[0m16:28:25.634967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13636b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13636b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c795e0>]}
[0m16:28:25.635103 [debug] [MainThread]: Flushing usage events
[0m16:28:25.844741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:28:38.104176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061606e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fab9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fab750>]}


============================== 16:28:38.105867 | e6be014b-b3d4-450a-a02c-d86c6b9f7c40 ==============================
[0m16:28:38.105867 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:28:38.106112 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --select tmp_airline_countries_mapped', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'empty': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'False', 'warn_error': 'None'}
[0m16:28:38.914833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6be014b-b3d4-450a-a02c-d86c6b9f7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106304c30>]}
[0m16:28:38.933844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6be014b-b3d4-450a-a02c-d86c6b9f7c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232be360>]}
[0m16:28:38.934059 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:28:39.008719 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:28:39.048433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:28:39.048660 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airline.sql
[0m16:28:39.108184 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.Airline' (models/int/Airline.sql) depends on a node named 'tmp_airline_countries_mapped' which was not found
[0m16:28:39.109929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0298159, "process_in_blocks": "0", "process_kernel_time": 0.194491, "process_mem_max_rss": "377176064", "process_out_blocks": "0", "process_user_time": 1.30858}
[0m16:28:39.110164 [debug] [MainThread]: Command `dbt run` failed at 16:28:39.110125 after 1.03 seconds
[0m16:28:39.110355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12326b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12326b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b795e0>]}
[0m16:28:39.110496 [debug] [MainThread]: Flushing usage events
[0m16:28:39.309879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:48.264074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107773750>]}


============================== 16:49:48.265732 | 2c85edbd-1cf9-4339-84ca-9b96fb845c6a ==============================
[0m16:49:48.265732 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:49:48.265969 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'empty': 'False', 'target_path': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'static_parser': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_format': 'default', 'quiet': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'no_print': 'None', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'invocation_command': 'dbt run --select tmp_airline_country_mapped', 'partial_parse': 'True', 'cache_selected_only': 'False'}
[0m16:49:49.085484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c85edbd-1cf9-4339-84ca-9b96fb845c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668cc30>]}
[0m16:49:49.104249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c85edbd-1cf9-4339-84ca-9b96fb845c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135ebe360>]}
[0m16:49:49.104463 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:49:49.179506 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:49:49.219757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:49:49.219983 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airline.sql
[0m16:49:49.300855 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m16:49:49.305442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c85edbd-1cf9-4339-84ca-9b96fb845c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c4a150>]}
[0m16:49:49.338081 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m16:49:49.339194 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m16:49:49.347190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c85edbd-1cf9-4339-84ca-9b96fb845c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135ece8a0>]}
[0m16:49:49.347380 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m16:49:49.347507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c85edbd-1cf9-4339-84ca-9b96fb845c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1368f12b0>]}
[0m16:49:49.348197 [info ] [MainThread]: 
[0m16:49:49.348331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:49.348428 [info ] [MainThread]: 
[0m16:49:49.348618 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:49:49.348946 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m16:49:49.349096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:49.901104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m16:49:49.901669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:50.243183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m16:49:50.245656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:50.576087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m16:49:50.578635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:50.914034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c85edbd-1cf9-4339-84ca-9b96fb845c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13741fc70>]}
[0m16:49:50.914746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:50.918209 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airline_country_mapped
[0m16:49:50.918768 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airline_country_mapped ..... [RUN]
[0m16:49:50.919148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airline_country_mapped)
[0m16:49:50.919432 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airline_country_mapped
[0m16:49:50.926310 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airline_country_mapped"
[0m16:49:50.927972 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airline_country_mapped
[0m16:49:50.937303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:51.256860 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airline_country_mapped"
[0m16:49:51.257459 [debug] [Thread-1 (]: On model.air_travel.tmp_airline_country_mapped: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airline_country_mapped"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped`
      
    
    

    
    OPTIONS()
    as (
      with airline_orphan_countries as (
    select distinct country
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)
),
tmp_airline_countries_mapped as (
    select
      country,
      AI.GENERATE(
        ('If ', country, ' is a recognized country, return its iso code. If it is not a recognized country, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from airline_orphan_countries
  )
  select country as original_country, llm_response.iso_code as mapped_iso_code
  from tmp_airline_countries_mapped
    );
  
[0m16:49:51.803399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:02f748b9-485d-4518-a571-1ee1444c0d93&page=queryresults
[0m16:51:52.387760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c85edbd-1cf9-4339-84ca-9b96fb845c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13743bd10>]}
[0m16:51:52.388277 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airline_country_mapped  [[32mCREATE TABLE (88.0 rows, 68.9 KiB processed)[0m in 121.47s]
[0m16:51:52.388655 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airline_country_mapped
[0m16:51:52.389608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:51:52.390884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:52.391117 [debug] [MainThread]: Connection 'model.air_travel.tmp_airline_country_mapped' was properly closed.
[0m16:51:52.391324 [info ] [MainThread]: 
[0m16:51:52.391514 [info ] [MainThread]: Finished running 1 table model in 0 hours 2 minutes and 3.04 seconds (123.04s).
[0m16:51:52.391877 [debug] [MainThread]: Command end result
[0m16:51:52.410052 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m16:51:52.411660 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m16:51:52.415081 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m16:51:52.415265 [info ] [MainThread]: 
[0m16:51:52.415452 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:51:52.415586 [info ] [MainThread]: 
[0m16:51:52.415733 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:51:52.417963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 124.17809, "process_in_blocks": "0", "process_kernel_time": 0.262517, "process_mem_max_rss": "393740288", "process_out_blocks": "0", "process_user_time": 1.801727}
[0m16:51:52.418248 [debug] [MainThread]: Command `dbt run` succeeded at 16:51:52.418207 after 124.18 seconds
[0m16:51:52.418413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1374e5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1374f49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140c30190>]}
[0m16:51:52.418559 [debug] [MainThread]: Flushing usage events
[0m16:51:52.707988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:43.983106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a73750>]}


============================== 17:38:43.984686 | 950e22e8-23ce-44a6-b238-d43d88e440c5 ==============================
[0m17:38:43.984686 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m17:38:43.984917 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/scohen/.dbt', 'introspect': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select Airline', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'use_colors': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'quiet': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None'}
[0m17:38:44.844422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '950e22e8-23ce-44a6-b238-d43d88e440c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ccc30>]}
[0m17:38:44.863661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '950e22e8-23ce-44a6-b238-d43d88e440c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168ac2360>]}
[0m17:38:44.863867 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m17:38:44.938050 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m17:38:44.982237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:44.982376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:44.984812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m17:38:44.999072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '950e22e8-23ce-44a6-b238-d43d88e440c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a14a650>]}
[0m17:38:45.032573 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m17:38:45.033560 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m17:38:45.040488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '950e22e8-23ce-44a6-b238-d43d88e440c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168ace8a0>]}
[0m17:38:45.040670 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m17:38:45.040798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '950e22e8-23ce-44a6-b238-d43d88e440c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168c41e10>]}
[0m17:38:45.041499 [info ] [MainThread]: 
[0m17:38:45.041632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:45.041733 [info ] [MainThread]: 
[0m17:38:45.041923 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:38:45.042279 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m17:38:45.042428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:45.492731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m17:38:45.493303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:45.795669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m17:38:45.797719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:46.067537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m17:38:46.070223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:46.370077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '950e22e8-23ce-44a6-b238-d43d88e440c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a2f3d40>]}
[0m17:38:46.370863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:46.374864 [debug] [Thread-1 (]: Began running node model.air_travel.Airline
[0m17:38:46.375393 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airline ........................ [RUN]
[0m17:38:46.375768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.Airline)
[0m17:38:46.376061 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airline
[0m17:38:46.399055 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airline"
[0m17:38:46.400437 [debug] [Thread-1 (]: Began executing node model.air_travel.Airline
[0m17:38:46.421630 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airline"
[0m17:38:46.422213 [debug] [Thread-1 (]: On model.air_travel.Airline: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airline"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
      
    
    

    
    OPTIONS()
    as (
      with airline_country_joined as (
  select a.id, a.name, a.alias, a.icao, a.iata, a.callsign, 
    a.country as country_name, c.iso_code as country_code, a.active, 
    a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines` a left join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null 
),
Airline as (
    select acj.id, acj.name, acj.alias, acj.icao, acj.iata, acj.callsign, 
        acj.country_name, amc.mapped_iso_code as country_code, 
        acj.active, acj._data_source, acj._load_time 
    from airline_country_joined acj join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped` amc
    on acj.country_name = amc.original_country
    where acj.country_code is null
    and acj.country_name is not null
)

select *
from Airline
    );
  
[0m17:38:46.422418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:47.018945 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:411416c8-eb5c-42c9-b5ef-9d1c52c9be2f&page=queryresults
[0m17:38:48.630069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '950e22e8-23ce-44a6-b238-d43d88e440c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a3df650>]}
[0m17:38:48.630658 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Airline ................... [[32mCREATE TABLE (0.0 rows, 473.5 KiB processed)[0m in 2.25s]
[0m17:38:48.631058 [debug] [Thread-1 (]: Finished running node model.air_travel.Airline
[0m17:38:48.631982 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:48.633160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:48.633354 [debug] [MainThread]: Connection 'model.air_travel.Airline' was properly closed.
[0m17:38:48.633539 [info ] [MainThread]: 
[0m17:38:48.633734 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m17:38:48.634144 [debug] [MainThread]: Command end result
[0m17:38:48.653765 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m17:38:48.654896 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m17:38:48.658019 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m17:38:48.658169 [info ] [MainThread]: 
[0m17:38:48.658340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:48.658464 [info ] [MainThread]: 
[0m17:38:48.658602 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:38:48.660650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.70234, "process_in_blocks": "0", "process_kernel_time": 0.250668, "process_mem_max_rss": "392904704", "process_out_blocks": "0", "process_user_time": 1.666977}
[0m17:38:48.660860 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:48.660822 after 4.70 seconds
[0m17:38:48.661014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a33fd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a3db430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a3dafd0>]}
[0m17:38:48.661170 [debug] [MainThread]: Flushing usage events
[0m17:38:48.884626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:56.517719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112373750>]}


============================== 17:39:56.519327 | bc57d337-5ac7-466d-b72e-9be7ec190b4f ==============================
[0m17:39:56.519327 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m17:39:56.519583 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'partial_parse': 'True', 'printer_width': '80', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'invocation_command': 'dbt run --select models/tmp/tmp_airline_country_mapped.sql models/tmp/tmp_airport_all.sql models/tmp/tmp_airport_country_iso_codes.sql models/tmp/tmp_airport_duplicates_embeddings.sql models/tmp/tmp_airport_duplicates.sql models/tmp/tmp_airport_establishment_broad_categories_mapped.sql models/tmp/tmp_airport_establishment_canonical_categories.sql models/tmp/tmp_airport_establishment_raw_categories.sql models/tmp/tmp_airport_establishment_sub_categories_mapped.sql models/tmp/tmp_airport_establishment_unique.sql models/tmp/tmp_airport_inference_results_embeddings.sql models/tmp/tmp_airport_inference_results.sql models/tmp/tmp_airport_llm.sql models/tmp/tmp_airport_refined.sql models/tmp/tmp_airport_vector_search_results.sql models/tmp/tmp_country_iso_codes.sql --exclude tmp_airport_llm,tmp_country_iso_codes,tmp_airport_vector_search_results', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'False'}
[0m17:39:57.334348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc57d337-5ac7-466d-b72e-9be7ec190b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111ccc30>]}
[0m17:39:57.353532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc57d337-5ac7-466d-b72e-9be7ec190b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fcc2360>]}
[0m17:39:57.353760 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m17:39:57.426020 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m17:39:57.465987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:39:57.466130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:39:57.468498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m17:39:57.482709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc57d337-5ac7-466d-b72e-9be7ec190b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158c4e650>]}
[0m17:39:57.516854 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m17:39:57.517714 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m17:39:57.523748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc57d337-5ac7-466d-b72e-9be7ec190b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fcce8a0>]}
[0m17:39:57.523922 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m17:39:57.524054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc57d337-5ac7-466d-b72e-9be7ec190b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fe3de10>]}
[0m17:39:57.532022 [warn ] [MainThread]: The selection criterion 'tmp_airport_llm,tmp_country_iso_codes,tmp_airport_vector_search_results' does not match any enabled nodes
[0m17:39:57.532856 [info ] [MainThread]: 
[0m17:39:57.533002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:39:57.533101 [info ] [MainThread]: 
[0m17:39:57.533306 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:39:57.535200 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m17:39:57.535374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:57.875153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m17:39:57.876028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:58.183621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m17:39:58.186685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:58.461929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m17:39:58.464117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:58.751248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc57d337-5ac7-466d-b72e-9be7ec190b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158df3d40>]}
[0m17:39:58.751908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:58.754999 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m17:39:58.755478 [info ] [Thread-1 (]: 1 of 16 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [RUN]
[0m17:39:58.755827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m17:39:58.756101 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m17:39:58.762445 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m17:39:58.764525 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m17:39:58.773123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:59.056019 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m17:39:59.057692 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_canonical_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_canonical_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_canonical_categories as (
    select 'Quick Service & Grab-and-Go' as broad_category, 'National/International Fast Food Chains' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Coffee & Beverage Shops' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Snack Kiosks' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Pre-Packaged Foods' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Gourmet Burgers & Sandwiches' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Build-Your-Own Concepts' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Pizzerias' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Casual Dining Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Upscale & Chef-Driven Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Themed Restaurants & Sports Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Wine Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Craft Beer Pubs' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Cocktail Lounges' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Newsstands & Bookstores' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Pharmacies & Personal Care' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Travel Gear & Luggage' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Electronics' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Local Souvenirs & Gifts' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Apparel & Accessories' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Confectionery & Gourmet Foods' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Designer Fashion' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Jewelry & Watches' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'High-End Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Liquor & Tobacco' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Fragrances & Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Luxury Accessories & Confectionery' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Spas & Salons' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Pay-Per-Use Lounges' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Yoga & Meditation Rooms' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Shower Facilities' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Currency Exchan' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'ATMs & Banking Services' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Business Centers & Work Pods' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Luggage Storage & Wrapping' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Postal & Shipping Services' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Pet Relief & Care Areas' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Vending Machines (non-F&B)' as sub_category
)

select * 
from tmp_airport_establishment_canonical_categories
    );
  
[0m17:39:59.397442 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ddad88c3-ae25-4124-91ce-d6180ac3e906&page=queryresults
[0m17:40:01.003808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc57d337-5ac7-466d-b72e-9be7ec190b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158edb590>]}
[0m17:40:01.004456 [info ] [Thread-1 (]: 1 of 16 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [[32mCREATE TABLE (37.0 rows, 0 processed)[0m in 2.25s]
[0m17:40:01.004887 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m17:40:01.005151 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m17:40:01.005524 [info ] [Thread-1 (]: 2 of 16 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [RUN]
[0m17:40:01.005864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_canonical_categories, now model.air_travel.tmp_airport_establishment_unique)
[0m17:40:01.006093 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m17:40:01.007984 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m17:40:01.008511 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m17:40:01.010053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:01.288111 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_unique"
[0m17:40:01.291078 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_unique: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_unique"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_unique as (
  select distinct business, category, dining, _data_source, _load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
  order by category, business
)
select * 
from tmp_airport_establishment_unique
    );
  
[0m17:40:01.666529 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0e06d33b-c0dc-4eda-98df-b5e49c7ec3b0&page=queryresults
[0m17:40:03.595661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc57d337-5ac7-466d-b72e-9be7ec190b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158ebc100>]}
[0m17:40:03.596652 [info ] [Thread-1 (]: 2 of 16 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [[32mCREATE TABLE (1.1k rows, 74.4 KiB processed)[0m in 2.59s]
[0m17:40:03.597269 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m17:40:03.597664 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_llm
[0m17:40:03.598175 [info ] [Thread-1 (]: 3 of 16 START sql table model dbt_air_travel_tmp.tmp_airport_llm ............... [RUN]
[0m17:40:03.598702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_unique, now model.air_travel.tmp_airport_llm)
[0m17:40:03.599019 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_llm
[0m17:40:03.601506 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_llm"
[0m17:40:03.603078 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_llm
[0m17:40:03.605156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:03.862032 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_llm"
[0m17:40:03.865194 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_llm: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_llm"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_llm as (
    select
      name,
      country,
      iata,
      AI.GENERATE(
        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'icao STRING, state_prov STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
    where iata is not null
  )
select name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov
from tmp_airport_llm
    );
  
[0m17:40:04.330430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:36ab0181-3c3a-460b-807a-26d157b17430&page=queryresults
[0m17:40:15.051726 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m17:40:15.803229 [error] [MainThread]: CANCEL query model.air_travel.tmp_airport_llm .................................. [[31mCANCEL[0m]
[0m17:40:15.804482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:21.223716 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_llm"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_llm as (
    select
      name,
      country,
      iata,
      AI.GENERATE(
        ('What are the icao code and state/province for airport ', name, ' in country ', country, ' which has an iata code of ', iata, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'icao STRING, state_prov STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
    where iata is not null
  )
select name, country, iata, llm_response.icao as llm_icao, llm_response.state_prov as llm_state_prov
from tmp_airport_llm
    );
  
[0m17:40:21.224259 [debug] [Thread-1 (]: BigQuery adapter: 499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/36ab0181-3c3a-460b-807a-26d157b17430?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: User requested cancellation

Location: us-central1
Job ID: 36ab0181-3c3a-460b-807a-26d157b17430

[0m17:40:21.232601 [debug] [Thread-1 (]: Database Error in model tmp_airport_llm (models/tmp/tmp_airport_llm.sql)
  499 GET https://bigquery.googleapis.com/bigquery/v2/projects/cs378-fa2025/queries/36ab0181-3c3a-460b-807a-26d157b17430?maxResults=0&location=us-central1&prettyPrint=false: Job execution was cancelled: User requested cancellation
  
  Location: us-central1
  Job ID: 36ab0181-3c3a-460b-807a-26d157b17430
  
  compiled code at target/run/air_travel/models/tmp/tmp_airport_llm.sql
[0m17:40:21.233014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc57d337-5ac7-466d-b72e-9be7ec190b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15db1adf0>]}
[0m17:40:21.233484 [error] [Thread-1 (]: 3 of 16 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_llm ...... [[31mERROR[0m in 17.63s]
[0m17:40:21.233852 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_llm
[0m17:40:21.234145 [info ] [MainThread]: 
[0m17:40:21.234507 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m17:40:21.234722 [info ] [MainThread]: 
[0m17:40:21.234942 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:40:21.235146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:21.235303 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_llm' was properly closed.
[0m17:40:21.235487 [info ] [MainThread]: 
[0m17:40:21.235662 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 23.70 seconds (23.70s).
[0m17:40:21.235945 [error] [MainThread]: Encountered an error:

[0m17:40:21.237579 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 587, in run
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 604, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 541, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 421, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 338, in run_queue
    self.handle_job_queue(pool, callback)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/run.py", line 853, in handle_job_queue
    node = self.job_queue.get()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 199, in get
    self.not_empty.wait()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

[0m17:40:21.240677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 24.746536, "process_in_blocks": "0", "process_kernel_time": 0.258318, "process_mem_max_rss": "392364032", "process_out_blocks": "0", "process_user_time": 1.83921}
[0m17:40:21.241023 [debug] [MainThread]: Command `dbt run` failed at 17:40:21.240961 after 24.75 seconds
[0m17:40:21.241265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dd97ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dd97bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123fd4e0>]}
[0m17:40:21.241541 [debug] [MainThread]: Flushing usage events
[0m17:40:21.458673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:41:34.580174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085346e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937f750>]}


============================== 17:41:34.581834 | 05af29c2-746e-406c-903d-61601f225fb6 ==============================
[0m17:41:34.581834 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m17:41:34.582103 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'invocation_command': 'dbt run --select models/tmp/tmp_airline_country_mapped.sql models/tmp/tmp_airport_all.sql models/tmp/tmp_airport_country_iso_codes.sql models/tmp/tmp_airport_duplicates_embeddings.sql models/tmp/tmp_airport_duplicates.sql models/tmp/tmp_airport_establishment_broad_categories_mapped.sql models/tmp/tmp_airport_establishment_canonical_categories.sql models/tmp/tmp_airport_establishment_raw_categories.sql models/tmp/tmp_airport_establishment_sub_categories_mapped.sql models/tmp/tmp_airport_establishment_unique.sql models/tmp/tmp_airport_inference_results_embeddings.sql models/tmp/tmp_airport_inference_results.sql models/tmp/tmp_airport_llm.sql models/tmp/tmp_airport_refined.sql models/tmp/tmp_airport_vector_search_results.sql models/tmp/tmp_country_iso_codes.sql --exclude tmp_airport_llm tmp_country_iso_codes tmp_airport_vector_search_results', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'version_check': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False'}
[0m17:41:35.396757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d8c30>]}
[0m17:41:35.415577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f3c2360>]}
[0m17:41:35.415780 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m17:41:35.489962 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m17:41:35.530176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:41:35.530320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:41:35.532637 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m17:41:35.546952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa4e650>]}
[0m17:41:35.580386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m17:41:35.581172 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m17:41:35.587217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f3ce8a0>]}
[0m17:41:35.587383 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m17:41:35.587513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f641e10>]}
[0m17:41:35.595970 [info ] [MainThread]: 
[0m17:41:35.596249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:35.596361 [info ] [MainThread]: 
[0m17:41:35.596574 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:41:35.598305 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m17:41:35.598472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:35.923148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m17:41:35.923710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:36.184464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m17:41:36.185365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:36.441991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m17:41:36.443273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:36.723686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fcf3d40>]}
[0m17:41:36.724345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:36.727761 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airline_country_mapped
[0m17:41:36.728220 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_air_travel_tmp.tmp_airline_country_mapped .... [RUN]
[0m17:41:36.728562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airline_country_mapped)
[0m17:41:36.728827 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airline_country_mapped
[0m17:41:36.737035 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airline_country_mapped"
[0m17:41:36.738745 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airline_country_mapped
[0m17:41:36.748126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:37.051340 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airline_country_mapped"
[0m17:41:37.052051 [debug] [Thread-1 (]: On model.air_travel.tmp_airline_country_mapped: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airline_country_mapped"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped`
      
    
    

    
    OPTIONS()
    as (
      with airline_orphan_countries as (
    select distinct country
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)
),
tmp_airline_countries_mapped as (
    select
      country,
      AI.GENERATE(
        ('If ', country, ' is a recognized country, return its iso code. If it is not a recognized country, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from airline_orphan_countries
  )
  select country as original_country, llm_response.iso_code as mapped_iso_code
  from tmp_airline_countries_mapped
    );
  
[0m17:41:37.392721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f8edd4d8-07ed-4e63-8b81-e49d9db64e58&page=queryresults
[0m17:43:37.414860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fddb7d0>]}
[0m17:43:37.415483 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airline_country_mapped  [[32mCREATE TABLE (88.0 rows, 68.9 KiB processed)[0m in 120.69s]
[0m17:43:37.415910 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airline_country_mapped
[0m17:43:37.416173 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m17:43:37.416560 [info ] [Thread-1 (]: 2 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_all ............... [RUN]
[0m17:43:37.416926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airline_country_mapped, now model.air_travel.tmp_airport_all)
[0m17:43:37.417163 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_all
[0m17:43:37.419113 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_all"
[0m17:43:37.421245 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_all
[0m17:43:37.422860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:37.692397 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_all"
[0m17:43:37.694567 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_all: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_all"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_all as (
    select distinct al.llm_icao as icao, a.iata, a.name, a.city, al.llm_state_prov as state_prov, 
        a.country, a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, 
        a.timezone_name, a.type, a.source, 'openflights,llm' as _data_source, a._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm` al
    on a.name = al.name and a.country = al.country
    where a.iata is not null
    and al.llm_icao is not null
)

select * from tmp_airport_all
    );
  
[0m17:43:38.044553 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4ad0fee5-4749-483e-b77c-b10ae76315ad&page=queryresults
[0m17:43:39.994119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fdbcaa0>]}
[0m17:43:39.995387 [info ] [Thread-1 (]: 2 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_all .......... [[32mCREATE TABLE (4.7k rows, 1.6 MiB processed)[0m in 2.58s]
[0m17:43:39.996024 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m17:43:39.996432 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m17:43:39.997039 [info ] [Thread-1 (]: 3 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [RUN]
[0m17:43:39.997697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_all, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m17:43:39.998097 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m17:43:39.999680 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m17:43:40.000465 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m17:43:40.002045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:40.266808 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m17:43:40.268917 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_canonical_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_canonical_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_canonical_categories as (
    select 'Quick Service & Grab-and-Go' as broad_category, 'National/International Fast Food Chains' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Coffee & Beverage Shops' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Snack Kiosks' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Pre-Packaged Foods' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Gourmet Burgers & Sandwiches' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Build-Your-Own Concepts' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Pizzerias' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Casual Dining Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Upscale & Chef-Driven Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Themed Restaurants & Sports Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Wine Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Craft Beer Pubs' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Cocktail Lounges' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Newsstands & Bookstores' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Pharmacies & Personal Care' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Travel Gear & Luggage' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Electronics' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Local Souvenirs & Gifts' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Apparel & Accessories' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Confectionery & Gourmet Foods' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Designer Fashion' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Jewelry & Watches' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'High-End Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Liquor & Tobacco' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Fragrances & Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Luxury Accessories & Confectionery' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Spas & Salons' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Pay-Per-Use Lounges' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Yoga & Meditation Rooms' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Shower Facilities' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Currency Exchan' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'ATMs & Banking Services' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Business Centers & Work Pods' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Luggage Storage & Wrapping' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Postal & Shipping Services' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Pet Relief & Care Areas' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Vending Machines (non-F&B)' as sub_category
)

select * 
from tmp_airport_establishment_canonical_categories
    );
  
[0m17:43:40.553306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:94710734-b629-4602-9a34-13ea2dd3dadf&page=queryresults
[0m17:43:42.268706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fdd74d0>]}
[0m17:43:42.269745 [info ] [Thread-1 (]: 3 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [[32mCREATE TABLE (37.0 rows, 0 processed)[0m in 2.27s]
[0m17:43:42.270492 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m17:43:42.270876 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m17:43:42.271612 [info ] [Thread-1 (]: 4 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [RUN]
[0m17:43:42.272310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_canonical_categories, now model.air_travel.tmp_airport_establishment_unique)
[0m17:43:42.272683 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m17:43:42.275285 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m17:43:42.275996 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m17:43:42.277613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:42.549899 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_unique"
[0m17:43:42.550680 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_unique: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_unique"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_unique as (
  select distinct business, category, dining, _data_source, _load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
  order by category, business
)
select * 
from tmp_airport_establishment_unique
    );
  
[0m17:43:42.955579 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:086fd625-6a25-41aa-a5e7-18457b2ed1af&page=queryresults
[0m17:43:44.689223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa78fd0>]}
[0m17:43:44.690142 [info ] [Thread-1 (]: 4 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [[32mCREATE TABLE (1.1k rows, 74.4 KiB processed)[0m in 2.42s]
[0m17:43:44.690656 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m17:43:44.690985 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates
[0m17:43:44.691476 [info ] [Thread-1 (]: 5 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_duplicates ........ [RUN]
[0m17:43:44.692030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_unique, now model.air_travel.tmp_airport_duplicates)
[0m17:43:44.692429 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates
[0m17:43:44.695046 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates"
[0m17:43:44.696761 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates
[0m17:43:44.698290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:45.033626 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_duplicates"
[0m17:43:45.037152 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_duplicates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_duplicates"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_duplicates as (
    select * 
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao in
        (select icao
        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
        group by icao
        having count(*) > 1)
)

select * from tmp_airport_duplicates
    );
  
[0m17:43:45.415193 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b5c58d03-d2f2-4526-b510-fa07760e7171&page=queryresults
[0m17:43:47.240295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f950d70>]}
[0m17:43:47.241357 [info ] [Thread-1 (]: 5 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_duplicates ... [[32mCREATE TABLE (1.2k rows, 712.6 KiB processed)[0m in 2.55s]
[0m17:43:47.242047 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates
[0m17:43:47.242740 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_raw_categories
[0m17:43:47.243592 [info ] [Thread-1 (]: 6 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [RUN]
[0m17:43:47.244334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates, now model.air_travel.tmp_airport_establishment_raw_categories)
[0m17:43:47.244705 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_raw_categories
[0m17:43:47.246888 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m17:43:47.248351 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_raw_categories
[0m17:43:47.249136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:47.498945 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m17:43:47.501416 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_raw_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_raw_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`
      
    
    

    
    OPTIONS()
    as (
      with airport_establishment_raw_categories as (
  select distinct business, category
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
  where category not in ('Airline', 'Airline Service', 'Airline Services', 'Airline Check-in', 'Airline Ticketing',
      'Airline Gate / Check-in', 'Airline Lounge', 'Airport Lounge', 'Airport Service', 'Airport Services', 'Air Freight', 'Car Rental',
      'Information Kiosk', 'Information Service', 'Parking', 'Transportation Service')
)

select * 
from airport_establishment_raw_categories
    );
  
[0m17:43:47.872699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:efc2c911-564b-4953-84ca-25937b1aad37&page=queryresults
[0m17:43:49.401977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ab6ed50>]}
[0m17:43:49.402730 [info ] [Thread-1 (]: 6 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [[32mCREATE TABLE (853.0 rows, 29.3 KiB processed)[0m in 2.16s]
[0m17:43:49.403246 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_raw_categories
[0m17:43:49.403561 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates_embeddings
[0m17:43:49.404031 [info ] [Thread-1 (]: 7 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_duplicates_embeddings  [RUN]
[0m17:43:49.404526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_raw_categories, now model.air_travel.tmp_airport_duplicates_embeddings)
[0m17:43:49.404849 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates_embeddings
[0m17:43:49.407062 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m17:43:49.408767 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates_embeddings
[0m17:43:49.410278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:49.653219 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m17:43:49.655144 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_duplicates_embeddings: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_duplicates_embeddings"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates_embeddings`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_duplicates_embeddings as (
      select icao, iata, name, ml_generate_embedding_result as embedding
      from
      ML.GENERATE_EMBEDDING(
        model air_travel_model.embedding_model,
        (select icao, iata, name, concat(icao, ',', iata, ',', name) as content
        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`),
        struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type)
      )
  )

  select * from tmp_airport_duplicates_embeddings
    );
  
[0m17:43:50.022523 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:19c04508-2502-4953-b4d7-cc339d296878&page=queryresults
[0m17:43:54.138884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ab6fb90>]}
[0m17:43:54.140035 [info ] [Thread-1 (]: 7 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_duplicates_embeddings  [[32mCREATE TABLE (1.2k rows, 39.6 KiB processed)[0m in 4.73s]
[0m17:43:54.140871 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates_embeddings
[0m17:43:54.141297 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results
[0m17:43:54.141889 [info ] [Thread-1 (]: 8 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_inference_results . [RUN]
[0m17:43:54.142497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates_embeddings, now model.air_travel.tmp_airport_inference_results)
[0m17:43:54.142887 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results
[0m17:43:54.145704 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results"
[0m17:43:54.147466 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results
[0m17:43:54.149342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:54.412684 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_inference_results"
[0m17:43:54.415324 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_inference_results: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_inference_results"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_inference_results as (
    select icao,
      AI.GENERATE(
        ('What are the iata code and name of the airport that has the icao code of ', icao, '?'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iata STRING, name STRING') as llm_response
    from (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)
)
select icao, llm_response.iata as iata, llm_response.name as name
from tmp_airport_inference_results
    );
  
[0m17:43:54.734415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:94a369f9-27cd-44d8-81fe-6a75189ac83f&page=queryresults
[0m17:51:53.624484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ab6fdd0>]}
[0m17:51:53.625296 [info ] [Thread-1 (]: 8 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_inference_results  [[32mCREATE TABLE (480.0 rows, 6.7 KiB processed)[0m in 479.48s]
[0m17:51:53.625871 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results
[0m17:51:53.626258 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m17:51:53.626646 [info ] [Thread-1 (]: 9 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_mapped  [RUN]
[0m17:51:53.626926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results, now model.air_travel.tmp_airport_establishment_broad_categories_mapped)
[0m17:51:53.627175 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m17:51:53.629622 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_mapped"
[0m17:51:53.630728 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m17:51:53.632685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:53.911482 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_broad_categories_mapped"
[0m17:51:53.913062 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_broad_categories_mapped: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_broad_categories_mapped"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_mapped`
      
    
    

    
    OPTIONS()
    as (
      with canonical_categories as (
    select ARRAY_AGG(distinct broad_category) AS broad_categories
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`
),
tmp_airport_establishment_broad_categories_mapped as (
    select
      business,
      category as raw_category,
      AI.GENERATE(
        ('Map the business ', business, ' to its most fitting broad category from this canonical category list:',
          broad_categories),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'broad_category STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`
    cross join canonical_categories
  )
select business, raw_category, llm_response.broad_category as broad_category
from tmp_airport_establishment_broad_categories_mapped
    );
  
[0m17:51:54.293581 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:18bd692d-9b31-4651-842b-3256ce6abee3&page=queryresults
[0m17:54:44.913539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ab6eed0>]}
[0m17:54:44.914486 [info ] [Thread-1 (]: 9 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_mapped  [[32mCREATE TABLE (853.0 rows, 23.0 KiB processed)[0m in 171.29s]
[0m17:54:44.915032 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m17:54:44.915361 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results_embeddings
[0m17:54:44.915775 [info ] [Thread-1 (]: 10 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_inference_results_embeddings  [RUN]
[0m17:54:44.916221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_broad_categories_mapped, now model.air_travel.tmp_airport_inference_results_embeddings)
[0m17:54:44.916625 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results_embeddings
[0m17:54:44.919143 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results_embeddings"
[0m17:54:44.921117 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results_embeddings
[0m17:54:44.922986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:45.194949 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_inference_results_embeddings"
[0m17:54:45.197300 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_inference_results_embeddings: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_inference_results_embeddings"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results_embeddings`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_inference_results_embeddings as (
  select icao, iata, name, ml_generate_embedding_result as embedding
  from
    ML.GENERATE_EMBEDDING(
      model air_travel_model.embedding_model,
      (select icao, iata, name, concat(icao, ',', iata, ',', name) as content
       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_inference_results`
       where iata is not null
       and name != 'Unknown'),
       struct(true as flatten_json_output, 'SEMANTIC_SIMILARITY' as task_type)
    )
)

select * from tmp_airport_inference_results_embeddings
    );
  
[0m17:54:45.615720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:123d8291-a7e4-45c8-9861-ac6b5a967360&page=queryresults
[0m17:54:48.079683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ab6fdd0>]}
[0m17:54:48.080513 [info ] [Thread-1 (]: 10 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_inference_results_embeddings  [[32mCREATE TABLE (88.0 rows, 5.3 KiB processed)[0m in 3.16s]
[0m17:54:48.081022 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results_embeddings
[0m17:54:48.081354 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m17:54:48.081776 [info ] [Thread-1 (]: 11 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_sub_categories_mapped  [RUN]
[0m17:54:48.082228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results_embeddings, now model.air_travel.tmp_airport_establishment_sub_categories_mapped)
[0m17:54:48.082620 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m17:54:48.085235 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_sub_categories_mapped"
[0m17:54:48.087126 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m17:54:48.088637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:48.359525 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_sub_categories_mapped"
[0m17:54:48.361584 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_sub_categories_mapped: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_sub_categories_mapped"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_sub_categories_mapped`
      
    
    

    
    OPTIONS()
    as (
      with tmp_establishment_categories as (
    select m.business, m.broad_category,
      array_agg(distinct c.sub_category) AS sub_categories
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_mapped` m
    join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories` c
    on m.broad_category = c.broad_category
    where m.broad_category is not null
    group by m.business, m.broad_category
),
tmp_airport_establishment_sub_categories_mapped as (
    select
      business,
      broad_category,
      AI.GENERATE(
        ('Map the airport concession ', business, ' with broad category ', broad_category,
        ' to its most fitting sub category based on this canonical list of subcategories: ', sub_categories),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'sub_category STRING') as llm_response
    from tmp_establishment_categories
  )
select business, broad_category, llm_response.sub_category as sub_category
from tmp_airport_establishment_sub_categories_mapped
    );
  
[0m17:54:48.788984 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:80eaffcf-d2cc-472f-b8c8-6c1b4da7eb3f&page=queryresults
[0m17:57:12.090383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ab6fe30>]}
[0m17:57:12.091457 [info ] [Thread-1 (]: 11 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_sub_categories_mapped  [[32mCREATE TABLE (830.0 rows, 36.1 KiB processed)[0m in 144.01s]
[0m17:57:12.092154 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m17:57:12.093082 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m17:57:12.093705 [info ] [Thread-1 (]: 12 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_refined .......... [RUN]
[0m17:57:12.094283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_sub_categories_mapped, now model.air_travel.tmp_airport_refined)
[0m17:57:12.094670 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_refined
[0m17:57:12.097855 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_refined"
[0m17:57:12.099634 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_refined
[0m17:57:12.102042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:12.390054 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_refined"
[0m17:57:12.392434 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_refined: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_refined"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_refined as (
    select *
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao not in (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)
    union all
    select * from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
    where concat(icao, ',', iata, ',', name) in
      (select concat(base_icao, ',', base_iata, ',', base_name)
       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`
       where distance < 0.08)
)

select * from tmp_airport_refined
    );
  
[0m17:57:12.769009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e728a60a-435d-47c6-a157-5e379f9d410c&page=queryresults
[0m17:57:14.508977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ac8dc10>]}
[0m17:57:14.509927 [info ] [Thread-1 (]: 12 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_refined ..... [[32mCREATE TABLE (3.5k rows, 892.9 KiB processed)[0m in 2.41s]
[0m17:57:14.510514 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m17:57:14.511398 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_iso_codes
[0m17:57:14.511939 [info ] [Thread-1 (]: 13 of 13 START sql table model dbt_air_travel_tmp.tmp_airport_country_iso_codes  [RUN]
[0m17:57:14.512286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_refined, now model.air_travel.tmp_airport_country_iso_codes)
[0m17:57:14.512563 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_iso_codes
[0m17:57:14.515159 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_iso_codes"
[0m17:57:14.515952 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_iso_codes
[0m17:57:14.517537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:14.762329 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_country_iso_codes"
[0m17:57:14.764763 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_country_iso_codes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_country_iso_codes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`
      
    
    

    
    OPTIONS()
    as (
      with tmp_orphan_country as (
    select distinct country as airport_country_name
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`
    where country not in (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country`)
),
tmp_airport_country_iso_codes as (
    select airport_country_name,
      AI.GENERATE(
        ('What is the iso code for the country ', airport_country_name, '? If it does not have an iso code, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'iso_code STRING') as llm_response
    from tmp_orphan_country
)
select airport_country_name, llm_response.iso_code as mapped_iso_code
from tmp_airport_country_iso_codes
    );
  
[0m17:57:15.226970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e2c1c61c-f9cd-4ea4-9103-2980eb562e80&page=queryresults
[0m18:01:16.012753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05af29c2-746e-406c-903d-61601f225fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ab6fdd0>]}
[0m18:01:16.014019 [info ] [Thread-1 (]: 13 of 13 OK created sql table model dbt_air_travel_tmp.tmp_airport_country_iso_codes  [[32mCREATE TABLE (19.0 rows, 41.7 KiB processed)[0m in 241.50s]
[0m18:01:16.014716 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_iso_codes
[0m18:01:16.016189 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:16.018015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:16.018295 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_country_iso_codes' was properly closed.
[0m18:01:16.018628 [info ] [MainThread]: 
[0m18:01:16.018894 [info ] [MainThread]: Finished running 13 table models in 0 hours 19 minutes and 40.42 seconds (1180.42s).
[0m18:01:16.020709 [debug] [MainThread]: Command end result
[0m18:01:16.043778 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m18:01:16.044928 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m18:01:16.048475 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m18:01:16.048645 [info ] [MainThread]: 
[0m18:01:16.048842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:16.048989 [info ] [MainThread]: 
[0m18:01:16.049150 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m18:01:16.051426 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1181.4795, "process_in_blocks": "0", "process_kernel_time": 0.520202, "process_mem_max_rss": "389808128", "process_out_blocks": "0", "process_user_time": 3.365306}
[0m18:01:16.051642 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:16.051601 after 1181.48 seconds
[0m18:01:16.051817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f56c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ac8da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ac8d5b0>]}
[0m18:01:16.051979 [debug] [MainThread]: Flushing usage events
[0m18:01:16.329800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:06:49.060986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a73750>]}


============================== 09:06:49.062651 | 861955d9-b3a1-4eab-a58d-5623aaa97c0f ==============================
[0m09:06:49.062651 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:06:49.062888 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --exclude tag:llm', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'log_format': 'default', 'version_check': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:06:49.929328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ccc30>]}
[0m09:06:49.948364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1c2360>]}
[0m09:06:49.948572 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:06:50.024616 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:06:50.068078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 10 files changed.
[0m09:06:50.068339 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_llm.sql
[0m09:06:50.068483 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_sub_categories_mapped.sql
[0m09:06:50.068635 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_country_iso_codes.sql
[0m09:06:50.068766 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_inference_results_embeddings.sql
[0m09:06:50.068895 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_vector_search_results.sql
[0m09:06:50.069014 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_inference_results.sql
[0m09:06:50.069118 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_country_iso_codes.sql
[0m09:06:50.069223 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airline_country_mapped.sql
[0m09:06:50.069328 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_broad_categories_mapped.sql
[0m09:06:50.069434 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_duplicates_embeddings.sql
[0m09:06:50.156823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:06:50.161327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f84b450>]}
[0m09:06:50.193878 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:06:50.194712 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:06:50.202431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1ce8a0>]}
[0m09:06:50.202625 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m09:06:50.202756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f4f2270>]}
[0m09:06:50.203860 [info ] [MainThread]: 
[0m09:06:50.203994 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:06:50.204092 [info ] [MainThread]: 
[0m09:06:50.204277 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:06:50.206077 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:06:50.206222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:06:50.618367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:06:50.952072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:06:51.367033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:06:51.367573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:06:51.667459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:06:51.670455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:06:51.944662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:06:51.946499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:06:52.231905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fab97e0>]}
[0m09:06:52.232695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:06:52.237186 [debug] [Thread-1 (]: Began running node model.air_travel.aircrafts
[0m09:06:52.237922 [info ] [Thread-1 (]: 1 of 24 START sql table model dbt_air_travel_stg.aircrafts ..................... [RUN]
[0m09:06:52.238377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.aircrafts)
[0m09:06:52.238668 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircrafts
[0m09:06:52.245082 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircrafts"
[0m09:06:52.246794 [debug] [Thread-1 (]: Began executing node model.air_travel.aircrafts
[0m09:06:52.256979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:06:52.559113 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.aircrafts"
[0m09:06:52.561109 [debug] [Thread-1 (]: On model.air_travel.aircrafts: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.aircrafts"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
      
    
    

    
    OPTIONS()
    as (
      with stg_aircrafts as (
    select aircraft_name as name,
        case iata_code when '\\N' then null else iata_code end as iata,
        case icao_code when '\\N' then null else icao_code end as icao,
        _data_source,
        _load_time
  from `cs378-fa2025`.`air_travel_raw`.`aircrafts`
)

select * from stg_aircrafts
    );
  
[0m09:06:53.097246 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8bef0868-e981-4c6e-ac6b-2cebdf79c5d5&page=queryresults
[0m09:06:55.370170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fb3ff50>]}
[0m09:06:55.370532 [info ] [Thread-1 (]: 1 of 24 OK created sql table model dbt_air_travel_stg.aircrafts ................ [[32mCREATE TABLE (246.0 rows, 12.5 KiB processed)[0m in 3.13s]
[0m09:06:55.370812 [debug] [Thread-1 (]: Finished running node model.air_travel.aircrafts
[0m09:06:55.370978 [debug] [Thread-1 (]: Began running node model.air_travel.airlines
[0m09:06:55.371218 [info ] [Thread-1 (]: 2 of 24 START sql table model dbt_air_travel_stg.airlines ...................... [RUN]
[0m09:06:55.371457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircrafts, now model.air_travel.airlines)
[0m09:06:55.371612 [debug] [Thread-1 (]: Began compiling node model.air_travel.airlines
[0m09:06:55.372806 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airlines"
[0m09:06:55.373952 [debug] [Thread-1 (]: Began executing node model.air_travel.airlines
[0m09:06:55.375021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:06:55.618013 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airlines"
[0m09:06:55.621367 [debug] [Thread-1 (]: On model.air_travel.airlines: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airlines"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
      
    
    

    
    OPTIONS()
    as (
      with stg_airlines as (
  select airline_id as id,
    name,
    case alias
        when '\\N' then null
        else alias
        end as alias,
    case iata
        when '' then null
        else iata
        end as iata,
    case icao
        when '' then null
        else icao
        end as icao,
    case callsign
        when '\\N' then null
        else callsign
        end as callsign,
    case country
        when '\\N' then null
        else country end as country,
    active, _data_source, _load_time
  from `cs378-fa2025`.`air_travel_raw`.`airlines`
)

select * from stg_airlines
    );
  
[0m09:06:56.082395 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0c3ed907-94b1-411a-afba-1c69f96a1444&page=queryresults
[0m09:06:58.326174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbee2b0>]}
[0m09:06:58.327326 [info ] [Thread-1 (]: 2 of 24 OK created sql table model dbt_air_travel_stg.airlines ................. [[32mCREATE TABLE (6.2k rows, 489.7 KiB processed)[0m in 2.95s]
[0m09:06:58.328085 [debug] [Thread-1 (]: Finished running node model.air_travel.airlines
[0m09:06:58.328569 [debug] [Thread-1 (]: Began running node model.air_travel.airport_maps
[0m09:06:58.329427 [info ] [Thread-1 (]: 3 of 24 START sql table model dbt_air_travel_stg.airport_maps .................. [RUN]
[0m09:06:58.330206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airlines, now model.air_travel.airport_maps)
[0m09:06:58.330586 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_maps
[0m09:06:58.333490 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_maps"
[0m09:06:58.334278 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_maps
[0m09:06:58.336009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:06:58.605846 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airport_maps"
[0m09:06:58.607112 [debug] [Thread-1 (]: On model.air_travel.airport_maps: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airport_maps"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
      
    
    

    
    OPTIONS()
    as (
      with stg_airport_maps as (
  select airport, terminal, business,
      case category
        when 'Airline Services' then 'Airline Service'
        when 'Airline Services' then 'Airline Service'
        when 'Cafe' then 'Coffee Shop'
        when 'Financial Services' then 'Financial Service'
        when 'Retail/Dining' then 'Retail / Dining'
        when 'Things To Do' then 'Things to Do'
        when 'Transportation' then 'Transportation Service'
        when 'Vending' then 'Vending Machine'
        when 'Service' then 'Services'
        else category end as category,
      location, dining, menu_items, _data_source, _load_time
    from `cs378-fa2025`.`air_travel_raw`.`airport_maps`
)

select * from stg_airport_maps
    );
  
[0m09:06:59.140066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:42dabb62-fe6c-4408-9b1d-c09f1eee351f&page=queryresults
[0m09:07:01.095228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f332d50>]}
[0m09:07:01.096240 [info ] [Thread-1 (]: 3 of 24 OK created sql table model dbt_air_travel_stg.airport_maps ............. [[32mCREATE TABLE (1.5k rows, 163.3 KiB processed)[0m in 2.76s]
[0m09:07:01.096854 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_maps
[0m09:07:01.097255 [debug] [Thread-1 (]: Began running node model.air_travel.airport_reviews
[0m09:07:01.097739 [info ] [Thread-1 (]: 4 of 24 START sql table model dbt_air_travel_stg.airport_reviews ............... [RUN]
[0m09:07:01.098098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_maps, now model.air_travel.airport_reviews)
[0m09:07:01.098447 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_reviews
[0m09:07:01.100947 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_reviews"
[0m09:07:01.102029 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_reviews
[0m09:07:01.103592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:01.351295 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airport_reviews"
[0m09:07:01.352903 [debug] [Thread-1 (]: On model.air_travel.airport_reviews: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airport_reviews"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`
      
    
    

    
    OPTIONS()
    as (
      with stg_airport_reviews as (
	select id,
	    safe_cast(threadRef as INTEGER) as review_thread,
	    airportRef as airport_id,
	    airportIdent as airport_code,
	    safe_cast(split(date, ' ')[0] as DATE) as review_date,
	    memberNickname as review_author,
	    subject as review_subject,
	    body as review_details,
	    broad_category,
        sub_category,
        sentiment,
        language,
	    _data_source,
	    _load_time
	from `cs378-fa2025`.`air_travel_raw`.`airport_reviews`
)

select * from stg_airport_reviews
    );
  
[0m09:07:01.829105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f6df247b-ae81-4a23-8fa7-0d76615c9ea7&page=queryresults
[0m09:07:04.152363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fb9a7d0>]}
[0m09:07:04.153371 [info ] [Thread-1 (]: 4 of 24 OK created sql table model dbt_air_travel_stg.airport_reviews .......... [[32mCREATE TABLE (14.8k rows, 5.4 MiB processed)[0m in 3.05s]
[0m09:07:04.154363 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_reviews
[0m09:07:04.155045 [debug] [Thread-1 (]: Began running node model.air_travel.airports
[0m09:07:04.155665 [info ] [Thread-1 (]: 5 of 24 START sql table model dbt_air_travel_stg.airports ...................... [RUN]
[0m09:07:04.156225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_reviews, now model.air_travel.airports)
[0m09:07:04.156595 [debug] [Thread-1 (]: Began compiling node model.air_travel.airports
[0m09:07:04.159328 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airports"
[0m09:07:04.160128 [debug] [Thread-1 (]: Began executing node model.air_travel.airports
[0m09:07:04.161713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:04.417906 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.airports"
[0m09:07:04.419823 [debug] [Thread-1 (]: On model.air_travel.airports: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.airports"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
      
    
    

    
    OPTIONS()
    as (
      with stg_airports as (
	select safe_cast(airport_id as INTEGER) as id,
	    airport_name as name,
	    airport_city as city,
	    airport_country as country,
	    case iata
		    when '\\N' then null
		    else iata
		    end as iata,
	    case icao
		    when '\\N' then null
		    else icao
		    end as icao,
	    latitude,
	    longitude,
	    altitude,
	    safe_cast(timezone as INTEGER) as timezone_delta,
        daylight_savings_time,
        case tz_database_timezone
		    when '\\N' then null
		    else tz_database_timezone
		    end as timezone_name,
	    case type
		    when '\\N' then null
		    else type
		    end as type,
	    case source
		    when '\\N' then null
		    else source
		    end as source,
	    _data_source,
	    _load_time
	from `cs378-fa2025`.`air_travel_raw`.`airports`    
)

select * from stg_airports
    );
  
[0m09:07:04.775913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4cc62afc-4dc6-45bc-ac52-970c7dafb48e&page=queryresults
[0m09:07:06.926561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fc1d630>]}
[0m09:07:06.927464 [info ] [Thread-1 (]: 5 of 24 OK created sql table model dbt_air_travel_stg.airports ................. [[32mCREATE TABLE (12.7k rows, 1.7 MiB processed)[0m in 2.77s]
[0m09:07:06.927965 [debug] [Thread-1 (]: Finished running node model.air_travel.airports
[0m09:07:06.928304 [debug] [Thread-1 (]: Began running node model.air_travel.countries
[0m09:07:06.928780 [info ] [Thread-1 (]: 6 of 24 START sql table model dbt_air_travel_stg.countries ..................... [RUN]
[0m09:07:06.929302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airports, now model.air_travel.countries)
[0m09:07:06.929695 [debug] [Thread-1 (]: Began compiling node model.air_travel.countries
[0m09:07:06.932217 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.countries"
[0m09:07:06.933002 [debug] [Thread-1 (]: Began executing node model.air_travel.countries
[0m09:07:06.934437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:07.198534 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.countries"
[0m09:07:07.200676 [debug] [Thread-1 (]: On model.air_travel.countries: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.countries"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
      
    
    

    
    OPTIONS()
    as (
      with stg_countries as (
    select country_name as name,
    case iso_code
      when '\\N' then null
      else iso_code
      end as iso_code,
    dafif_code,
    _data_source,
    _load_time
    from `cs378-fa2025`.`air_travel_raw`.`countries`
)

select * from stg_countries
    );
  
[0m09:07:07.741817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b3600508-2d7f-4914-8241-a6ce77facbd1&page=queryresults
[0m09:07:09.520532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1617f96d0>]}
[0m09:07:09.520971 [info ] [Thread-1 (]: 6 of 24 OK created sql table model dbt_air_travel_stg.countries ................ [[32mCREATE TABLE (261.0 rows, 10.5 KiB processed)[0m in 2.59s]
[0m09:07:09.521317 [debug] [Thread-1 (]: Finished running node model.air_travel.countries
[0m09:07:09.521534 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m09:07:09.521873 [info ] [Thread-1 (]: 7 of 24 START sql table model dbt_air_travel_stg.flight_delays ................. [RUN]
[0m09:07:09.522225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.countries, now model.air_travel.flight_delays)
[0m09:07:09.522418 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m09:07:09.524098 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m09:07:09.524616 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m09:07:09.525641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:09.781087 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_delays"
[0m09:07:09.782252 [debug] [Thread-1 (]: On model.air_travel.flight_delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_delays as (
    select event_month, carrier, carrier_name, airport_code,
        split(city_state, ',')[0] as airport_city, 
        split(city_state, ',')[1] as airport_state,
        airport_name, 
        * except (event_month, carrier, carrier_name, airport_code, airport_name, city_state)
    from
        (select date(year, month, 01) as event_month, 
            carrier, carrier_name, airport as airport_code,
            split(airport_name, ':')[0] as city_state, 
            split(airport_name, ':')[1] as airport_name,
            safe_cast(arr_flights as INTEGER) as arr_total, 
            safe_cast(arr_cancelled as INTEGER) as arr_cancelled,
            safe_cast(arr_diverted as INTEGER) as arr_diverted, 
            safe_cast(arr_delay as INTEGER) as arr_delay_min,
            safe_cast(weather_delay as INTEGER) as weather_delay_min, 
            safe_cast(nas_delay as INTEGER) as nas_delay_min,
            safe_cast(late_aircraft_delay as INTEGER) as late_aircraft_delay_min, 
            _data_source, _load_time
          from `cs378-fa2025`.`air_travel_raw`.`flight_delays`)
)

select * from stg_flight_delays
    );
  
[0m09:07:10.200575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5997da2a-d60e-46b3-8953-f91acb0592f5&page=queryresults
[0m09:07:15.119178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1617f9f70>]}
[0m09:07:15.120123 [info ] [Thread-1 (]: 7 of 24 OK created sql table model dbt_air_travel_stg.flight_delays ............ [[32mCREATE TABLE (381.2k rows, 64.1 MiB processed)[0m in 5.60s]
[0m09:07:15.120729 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m09:07:15.121111 [debug] [Thread-1 (]: Began running node model.air_travel.flight_routes
[0m09:07:15.121649 [info ] [Thread-1 (]: 8 of 24 START sql table model dbt_air_travel_stg.flight_routes ................. [RUN]
[0m09:07:15.122102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_delays, now model.air_travel.flight_routes)
[0m09:07:15.122415 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_routes
[0m09:07:15.124927 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_routes"
[0m09:07:15.125695 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_routes
[0m09:07:15.127277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:15.387257 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_routes"
[0m09:07:15.389500 [debug] [Thread-1 (]: On model.air_travel.flight_routes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_routes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_routes as (
  select airline_code,
    safe_cast(airline_id as INTEGER) as airline_id,
    source_airport,
    case source_airport_id
      when '\\N' then null
      else safe_cast(source_airport_id as INTEGER)
      end as source_airport_id,
    dest_airport,
    case dest_airport_id
      when '\\N' then null
      else safe_cast(dest_airport_id as INTEGER)
      end as dest_airport_id,
    codeshare,
    stops,
    equipment,
    _data_source,
    _load_time
  from `cs378-fa2025`.`air_travel_raw`.`flight_routes`
)

select * from stg_flight_routes
    );
  
[0m09:07:15.934497 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:dede2dc0-9a9f-4ea9-8a60-5ef9ee44aaeb&page=queryresults
[0m09:07:18.081813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f846330>]}
[0m09:07:18.082793 [info ] [Thread-1 (]: 8 of 24 OK created sql table model dbt_air_travel_stg.flight_routes ............ [[32mCREATE TABLE (67.7k rows, 4.4 MiB processed)[0m in 2.96s]
[0m09:07:18.083886 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_routes
[0m09:07:18.084385 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m09:07:18.085002 [info ] [Thread-1 (]: 9 of 24 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [RUN]
[0m09:07:18.085573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_routes, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m09:07:18.085964 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m09:07:18.087673 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m09:07:18.089703 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m09:07:18.091259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:18.331934 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m09:07:18.334053 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_canonical_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_canonical_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_canonical_categories`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_canonical_categories as (
    select 'Quick Service & Grab-and-Go' as broad_category, 'National/International Fast Food Chains' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Coffee & Beverage Shops' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Snack Kiosks' as sub_category
	union all
    select 'Quick Service & Grab-and-Go' as broad_category, 'Pre-Packaged Foods' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Gourmet Burgers & Sandwiches' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Build-Your-Own Concepts' as sub_category
	union all
    select 'Fast Casual' as broad_category, 'Pizzerias' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Casual Dining Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Upscale & Chef-Driven Restaurants' as sub_category
	union all
    select 'Full-Service Dining' as broad_category, 'Themed Restaurants & Sports Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Wine Bars' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Craft Beer Pubs' as sub_category
	union all
    select 'Bars & Lounges' as broad_category, 'Cocktail Lounges' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Newsstands & Bookstores' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Pharmacies & Personal Care' as sub_category
	union all
    select 'Travel Essentials & Convenience' as broad_category, 'Travel Gear & Luggage' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Electronics' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Local Souvenirs & Gifts' as sub_category
	union all
    select 'Specialty Retail' as broad_category, 'Apparel & Accessories' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Confectionery & Gourmet Foods' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Designer Fashion' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'Jewelry & Watches' as sub_category
	union all
    select 'Luxury & High-End Goods' as broad_category, 'High-End Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Liquor & Tobacco' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Fragrances & Cosmetics' as sub_category
	union all
    select 'Duty-Free' as broad_category, 'Luxury Accessories & Confectionery' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Spas & Salons' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Pay-Per-Use Lounges' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Yoga & Meditation Rooms' as sub_category
	union all
    select 'Passenger Comfort & Wellness' as broad_category, 'Shower Facilities' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Currency Exchan' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'ATMs & Banking Services' as sub_category
	union all
    select 'Financial & Business Services' as broad_category, 'Business Centers & Work Pods' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Luggage Storage & Wrapping' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Postal & Shipping Services' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Pet Relief & Care Areas' as sub_category
	union all
    select 'Practical & Convenience Services' as broad_category, 'Vending Machines (non-F&B)' as sub_category
)

select * 
from tmp_airport_establishment_canonical_categories
    );
  
[0m09:07:18.699234 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:54368694-de27-4df2-9c1b-2c859e9169b6&page=queryresults
[0m09:07:20.276979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fb36210>]}
[0m09:07:20.277311 [info ] [Thread-1 (]: 9 of 24 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_canonical_categories  [[32mCREATE TABLE (37.0 rows, 0 processed)[0m in 2.19s]
[0m09:07:20.277572 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m09:07:20.277717 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_traffic
[0m09:07:20.277916 [info ] [Thread-1 (]: 10 of 24 START sql table model dbt_air_travel_stg.tsa_traffic .................. [RUN]
[0m09:07:20.278116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_canonical_categories, now model.air_travel.tsa_traffic)
[0m09:07:20.278237 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_traffic
[0m09:07:20.279266 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_traffic"
[0m09:07:20.279600 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_traffic
[0m09:07:20.280232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:20.489945 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tsa_traffic"
[0m09:07:20.490843 [debug] [Thread-1 (]: On model.air_travel.tsa_traffic: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tsa_traffic"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`
      
    
    

    
    OPTIONS()
    as (
      with stg_tsa_traffic as (
  select safe_cast(event_date as DATE format 'MM/DD/YYYY') as event_date,
    safe_cast(event_hour as INTEGER) as event_hour,
    airport_code,
    airport_name,
    airport_city,
    airport_state,
    security_checkpoint,
    safe_cast(total_traffic as INTEGER) as total_traffic,
    _data_source,
    _load_time
  from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic`
)

select * from stg_tsa_traffic
    );
  
[0m09:07:21.053668 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c09d1f7e-b2e4-4eff-8744-3bafd7f3e086&page=queryresults
[0m09:07:23.310264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fa84590>]}
[0m09:07:23.311066 [info ] [Thread-1 (]: 10 of 24 OK created sql table model dbt_air_travel_stg.tsa_traffic ............. [[32mCREATE TABLE (23.4k rows, 2.2 MiB processed)[0m in 3.03s]
[0m09:07:23.311514 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_traffic
[0m09:07:23.311811 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m09:07:23.312229 [info ] [Thread-1 (]: 11 of 24 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [RUN]
[0m09:07:23.312627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tsa_traffic, now model.air_travel.tmp_airport_establishment_unique)
[0m09:07:23.312905 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m09:07:23.315073 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m09:07:23.315777 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m09:07:23.317083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:23.553569 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_unique"
[0m09:07:23.554276 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_unique: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_unique"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_establishment_unique as (
  select distinct business, category, dining, _data_source, _load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
  order by category, business
)
select * 
from tmp_airport_establishment_unique
    );
  
[0m09:07:24.229057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6aef310d-8231-4584-aa76-7a8e9303cb34&page=queryresults
[0m09:07:25.868204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f6c96d0>]}
[0m09:07:25.868985 [info ] [Thread-1 (]: 11 of 24 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_unique  [[32mCREATE TABLE (1.1k rows, 74.4 KiB processed)[0m in 2.56s]
[0m09:07:25.869494 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m09:07:25.869816 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m09:07:25.870307 [info ] [Thread-1 (]: 12 of 24 START sql table model dbt_air_travel_tmp.tmp_airport_all .............. [RUN]
[0m09:07:25.870859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_unique, now model.air_travel.tmp_airport_all)
[0m09:07:25.871258 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_all
[0m09:07:25.873779 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_all"
[0m09:07:25.874582 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_all
[0m09:07:25.876071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:26.111508 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_all"
[0m09:07:26.112561 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_all: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_all"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_all as (
    select distinct al.llm_icao as icao, a.iata, a.name, a.city, al.llm_state_prov as state_prov, 
        a.country, a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, 
        a.timezone_name, a.type, a.source, 'openflights,llm' as _data_source, a._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airports` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_llm` al
    on a.name = al.name and a.country = al.country
    where a.iata is not null
    and al.llm_icao is not null
)

select * from tmp_airport_all
    );
  
[0m09:07:26.480015 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:af36b199-f377-4fc3-b63f-be89ee78085b&page=queryresults
[0m09:07:28.635935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f4a3830>]}
[0m09:07:28.636827 [info ] [Thread-1 (]: 12 of 24 OK created sql table model dbt_air_travel_tmp.tmp_airport_all ......... [[32mCREATE TABLE (4.7k rows, 1.6 MiB processed)[0m in 2.76s]
[0m09:07:28.637415 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m09:07:28.637792 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m09:07:28.638350 [info ] [Thread-1 (]: 13 of 24 START sql table model dbt_air_travel_int.Country ...................... [RUN]
[0m09:07:28.638983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_all, now model.air_travel.Country)
[0m09:07:28.639369 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m09:07:28.641967 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m09:07:28.643544 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m09:07:28.645083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:28.902066 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Country"
[0m09:07:28.905157 [debug] [Thread-1 (]: On model.air_travel.Country: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Country"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Country`
      
    
    

    
    OPTIONS()
    as (
      with Country as (
    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` 
    group by iso_code, name, _data_source, _load_time
)

select *
from Country
where iso_code is not null 
union all
select t.mapped_iso_code, c.name, c.dafif_codes, c._data_source, c._load_time 
from Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes` t 
on c.name = t.name
where t.mapped_iso_code is not null
and c.iso_code is null
    );
  
[0m09:07:29.246669 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7d180de6-7dcb-4174-83a6-31c9572a57b8&page=queryresults
[0m09:07:31.011139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f36eb70>]}
[0m09:07:31.012167 [info ] [Thread-1 (]: 13 of 24 OK created sql table model dbt_air_travel_int.Country ................. [[32mCREATE TABLE (240.0 rows, 10.7 KiB processed)[0m in 2.37s]
[0m09:07:31.012698 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m09:07:31.013049 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_raw_categories
[0m09:07:31.013623 [info ] [Thread-1 (]: 14 of 24 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [RUN]
[0m09:07:31.014105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Country, now model.air_travel.tmp_airport_establishment_raw_categories)
[0m09:07:31.014426 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_raw_categories
[0m09:07:31.016861 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m09:07:31.019229 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_raw_categories
[0m09:07:31.020759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:31.299753 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m09:07:31.303036 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_raw_categories: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_raw_categories"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_raw_categories`
      
    
    

    
    OPTIONS()
    as (
      with airport_establishment_raw_categories as (
  select distinct business, category
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique`
  where category not in ('Airline', 'Airline Service', 'Airline Services', 'Airline Check-in', 'Airline Ticketing',
      'Airline Gate / Check-in', 'Airline Lounge', 'Airport Lounge', 'Airport Service', 'Airport Services', 'Air Freight', 'Car Rental',
      'Information Kiosk', 'Information Service', 'Parking', 'Transportation Service')
)

select * 
from airport_establishment_raw_categories
    );
  
[0m09:07:31.644417 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:177ecdc2-77af-4bce-aa7a-b7dfce5c0a79&page=queryresults
[0m09:07:33.140522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057591f0>]}
[0m09:07:33.141566 [info ] [Thread-1 (]: 14 of 24 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_raw_categories  [[32mCREATE TABLE (853.0 rows, 29.3 KiB processed)[0m in 2.13s]
[0m09:07:33.142190 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_raw_categories
[0m09:07:33.142555 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates
[0m09:07:33.143054 [info ] [Thread-1 (]: 15 of 24 START sql table model dbt_air_travel_tmp.tmp_airport_duplicates ....... [RUN]
[0m09:07:33.143642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_raw_categories, now model.air_travel.tmp_airport_duplicates)
[0m09:07:33.144038 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates
[0m09:07:33.146699 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates"
[0m09:07:33.147518 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates
[0m09:07:33.149098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:33.410123 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_duplicates"
[0m09:07:33.413422 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_duplicates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_duplicates"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_duplicates as (
    select * 
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao in
        (select icao
        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
        group by icao
        having count(*) > 1)
)

select * from tmp_airport_duplicates
    );
  
[0m09:07:33.853478 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ef8a7326-e1a4-4daa-b58c-b63b007590de&page=queryresults
[0m09:07:35.574034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b6e030>]}
[0m09:07:35.575122 [info ] [Thread-1 (]: 15 of 24 OK created sql table model dbt_air_travel_tmp.tmp_airport_duplicates .. [[32mCREATE TABLE (1.2k rows, 712.6 KiB processed)[0m in 2.43s]
[0m09:07:35.575764 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates
[0m09:07:35.576162 [debug] [Thread-1 (]: Began running node model.air_travel.Airline
[0m09:07:35.576737 [info ] [Thread-1 (]: 16 of 24 START sql table model dbt_air_travel_int.Airline ...................... [RUN]
[0m09:07:35.577453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates, now model.air_travel.Airline)
[0m09:07:35.577905 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airline
[0m09:07:35.580801 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airline"
[0m09:07:35.581606 [debug] [Thread-1 (]: Began executing node model.air_travel.Airline
[0m09:07:35.583185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:35.833921 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airline"
[0m09:07:35.836001 [debug] [Thread-1 (]: On model.air_travel.Airline: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airline"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
      
    
    

    
    OPTIONS()
    as (
      with airline_country_joined as (
  select a.id, a.name, a.alias, a.icao, a.iata, a.callsign, 
    a.country as country_name, c.iso_code as country_code, a.active, 
    a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines` a left join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null 
),
Airline as (
    select acj.id, acj.name, acj.alias, acj.icao, acj.iata, acj.callsign, 
        acj.country_name, amc.mapped_iso_code as country_code, 
        acj.active, acj._data_source, acj._load_time 
    from airline_country_joined acj join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped` amc
    on acj.country_name = amc.original_country
    where acj.country_code is null
    and acj.country_name is not null
)

select *
from Airline
    );
  
[0m09:07:36.209826 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6b7f7693-04e0-4b8a-8515-5389dcdc7fce&page=queryresults
[0m09:07:37.972424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780acf0>]}
[0m09:07:37.973282 [info ] [Thread-1 (]: 16 of 24 OK created sql table model dbt_air_travel_int.Airline ................. [[32mCREATE TABLE (0.0 rows, 473.4 KiB processed)[0m in 2.39s]
[0m09:07:37.973790 [debug] [Thread-1 (]: Finished running node model.air_travel.Airline
[0m09:07:37.974125 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Establishment
[0m09:07:37.974589 [info ] [Thread-1 (]: 17 of 24 START sql table model dbt_air_travel_int.Airport_Establishment ........ [RUN]
[0m09:07:37.975040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airline, now model.air_travel.Airport_Establishment)
[0m09:07:37.975358 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Establishment
[0m09:07:37.977781 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Establishment"
[0m09:07:37.978523 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Establishment
[0m09:07:37.980176 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Establishment"
[0m09:07:37.980713 [debug] [Thread-1 (]: On model.air_travel.Airport_Establishment: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Establishment"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Establishment as
(
  select distinct e.business, m.broad_category, m.sub_category,
    case when m.broad_category in ('Fast Casual', 'Full-Service Dining') then True else False end as dining,
    'airport.guide,llm' as _data_source, e._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique` e 
  join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_sub_categories_mapped` m
  on e.business = m.business
)

select * from Airport_Establishment
    );
  
[0m09:07:37.981148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:38.667156 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ec0e536c-4f84-4c75-8cee-229ecb376335&page=queryresults
[0m09:07:40.396959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767c290>]}
[0m09:07:40.398175 [info ] [Thread-1 (]: 17 of 24 OK created sql table model dbt_air_travel_int.Airport_Establishment ... [[32mCREATE TABLE (830.0 rows, 81.4 KiB processed)[0m in 2.42s]
[0m09:07:40.399049 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Establishment
[0m09:07:40.399471 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m09:07:40.400054 [info ] [Thread-1 (]: 18 of 24 START sql table model dbt_air_travel_tmp.tmp_airport_refined .......... [RUN]
[0m09:07:40.400720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Establishment, now model.air_travel.tmp_airport_refined)
[0m09:07:40.401186 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_refined
[0m09:07:40.404285 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_refined"
[0m09:07:40.405100 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_refined
[0m09:07:40.406755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:40.630163 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_refined"
[0m09:07:40.632091 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_refined: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_refined"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_refined as (
    select *
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_all`
    where icao not in (select distinct icao from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`)
    union all
    select * from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_duplicates`
    where concat(icao, ',', iata, ',', name) in
      (select concat(base_icao, ',', base_iata, ',', base_name)
       from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_vector_search_results`
       where distance < 0.08)
)

select * from tmp_airport_refined
    );
  
[0m09:07:41.021282 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:77defc8b-3f1d-4a54-a8e9-8399ec21289a&page=queryresults
[0m09:07:42.873463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1617fa570>]}
[0m09:07:42.874481 [info ] [Thread-1 (]: 18 of 24 OK created sql table model dbt_air_travel_tmp.tmp_airport_refined ..... [[32mCREATE TABLE (3.5k rows, 892.9 KiB processed)[0m in 2.47s]
[0m09:07:42.875626 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m09:07:42.876097 [debug] [Thread-1 (]: Began running node model.air_travel.Food_Beverage
[0m09:07:42.876725 [info ] [Thread-1 (]: 19 of 24 START sql table model dbt_air_travel_int.Food_Beverage ................ [RUN]
[0m09:07:42.877400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_refined, now model.air_travel.Food_Beverage)
[0m09:07:42.877872 [debug] [Thread-1 (]: Began compiling node model.air_travel.Food_Beverage
[0m09:07:42.880694 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Food_Beverage"
[0m09:07:42.881642 [debug] [Thread-1 (]: Began executing node model.air_travel.Food_Beverage
[0m09:07:42.883654 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Food_Beverage"
[0m09:07:42.884267 [debug] [Thread-1 (]: On model.air_travel.Food_Beverage: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Food_Beverage"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
      
    
    

    
    OPTIONS()
    as (
      with Food_Beverage as (
  select distinct business, menu_item
  from
    (select e.business, split(m.menu_items, ',') as menu_items
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment` e join `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps` m
    on e.business = m.business
    where e.dining = True) t, unnest(t.menu_items) as menu_item
  order by business
)

select * 
from Food_Beverage
    );
  
[0m09:07:42.884594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:43.275713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:029ee0ab-4803-474e-80ee-2249f48a1d32&page=queryresults
[0m09:07:45.043602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575a450>]}
[0m09:07:45.044829 [info ] [Thread-1 (]: 19 of 24 OK created sql table model dbt_air_travel_int.Food_Beverage ........... [[32mCREATE TABLE (476.0 rows, 60.7 KiB processed)[0m in 2.17s]
[0m09:07:45.045676 [debug] [Thread-1 (]: Finished running node model.air_travel.Food_Beverage
[0m09:07:45.046088 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m09:07:45.046597 [info ] [Thread-1 (]: 20 of 24 START sql table model dbt_air_travel_int.Airport ...................... [RUN]
[0m09:07:45.047038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Food_Beverage, now model.air_travel.Airport)
[0m09:07:45.047368 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m09:07:45.050493 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m09:07:45.051286 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m09:07:45.052855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:45.305315 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m09:07:45.308583 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.airport_country_name
  where c.mapped_iso_code is not null
)

select distinct * 
from Airport
    );
  
[0m09:07:45.733401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a324ab76-cb29-408f-b48d-ef6e1cd2dcf4&page=queryresults
[0m09:07:47.793617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1617fb2f0>]}
[0m09:07:47.794685 [info ] [Thread-1 (]: 20 of 24 OK created sql table model dbt_air_travel_int.Airport ................. [[32mCREATE TABLE (3.5k rows, 542.9 KiB processed)[0m in 2.75s]
[0m09:07:47.795408 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m09:07:47.796805 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Concessions
[0m09:07:47.797452 [info ] [Thread-1 (]: 21 of 24 START sql table model dbt_air_travel_int.Airport_Concessions .......... [RUN]
[0m09:07:47.797971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport, now model.air_travel.Airport_Concessions)
[0m09:07:47.798309 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Concessions
[0m09:07:47.801264 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Concessions"
[0m09:07:47.802032 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Concessions
[0m09:07:47.803936 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Concessions"
[0m09:07:47.804572 [debug] [Thread-1 (]: On model.air_travel.Airport_Concessions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Concessions"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Concessions as (
  select distinct a.icao as airport_icao, m.terminal, m.business, m.location, m._data_source, m._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps` m join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a
  on upper(m.airport) = a.iata
  where a.country = 'United States'
  and m.business not in
    (select business from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`)
  order by m.business
)

select * 
with Airport_Concessions
    );
  
[0m09:07:47.804910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:48.030591 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:cd4ae9db-0b80-4df1-b22a-4233c77d9e5a&page=queryresults
[0m09:07:48.031787 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:cd4ae9db-0b80-4df1-b22a-4233c77d9e5a&page=queryresults
[0m09:07:48.042070 [debug] [Thread-1 (]: Database Error in model Airport_Concessions (models/int/Airport_Concessions.sql)
  Syntax error: Expected ")" but got keyword WITH at [25:1]
  compiled code at target/run/air_travel/models/int/Airport_Concessions.sql
[0m09:07:48.042674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105759cd0>]}
[0m09:07:48.043249 [error] [Thread-1 (]: 21 of 24 ERROR creating sql table model dbt_air_travel_int.Airport_Concessions . [[31mERROR[0m in 0.24s]
[0m09:07:48.043711 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Concessions
[0m09:07:48.044013 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Reviews
[0m09:07:48.044411 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport_Concessions' to be skipped because of status 'error'.  Reason: Database Error in model Airport_Concessions (models/int/Airport_Concessions.sql)
  Syntax error: Expected ")" but got keyword WITH at [25:1]
  compiled code at target/run/air_travel/models/int/Airport_Concessions.sql.
[0m09:07:48.044821 [info ] [Thread-1 (]: 22 of 24 START sql table model dbt_air_travel_int.Airport_Reviews .............. [RUN]
[0m09:07:48.045765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Concessions, now model.air_travel.Airport_Reviews)
[0m09:07:48.046021 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Reviews
[0m09:07:48.048177 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Reviews"
[0m09:07:48.048756 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Reviews
[0m09:07:48.050827 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Reviews"
[0m09:07:48.051607 [debug] [Thread-1 (]: On model.air_travel.Airport_Reviews: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Reviews"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Reviews`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Review as
    select distinct r.id, r.review_thread, r.review_date, r.review_author,
      r.review_subject, r.review_details, a.icao as airport_icao, r.broad_category, r.sub_category, r.sentiment,
      r.language, r._data_source, r._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews` r join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a
    on a.icao = r.airport_code

select * from Airport_Review
    );
  
[0m09:07:48.051884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:48.270331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4535c801-7f5f-42cf-a416-e890ff95abf5&page=queryresults
[0m09:07:48.271507 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4535c801-7f5f-42cf-a416-e890ff95abf5&page=queryresults
[0m09:07:48.280971 [debug] [Thread-1 (]: Database Error in model Airport_Reviews (models/int/Airport_Reviews.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:5]
  compiled code at target/run/air_travel/models/int/Airport_Reviews.sql
[0m09:07:48.281538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1617e7cb0>]}
[0m09:07:48.282130 [error] [Thread-1 (]: 22 of 24 ERROR creating sql table model dbt_air_travel_int.Airport_Reviews ..... [[31mERROR[0m in 0.24s]
[0m09:07:48.282789 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Reviews
[0m09:07:48.283139 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Routes
[0m09:07:48.283513 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport_Reviews' to be skipped because of status 'error'.  Reason: Database Error in model Airport_Reviews (models/int/Airport_Reviews.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:5]
  compiled code at target/run/air_travel/models/int/Airport_Reviews.sql.
[0m09:07:48.283873 [info ] [Thread-1 (]: 23 of 24 START sql table model dbt_air_travel_int.Flight_Routes ................ [RUN]
[0m09:07:48.284332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Reviews, now model.air_travel.Flight_Routes)
[0m09:07:48.284606 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Routes
[0m09:07:48.287745 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Routes"
[0m09:07:48.289086 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Routes
[0m09:07:48.290459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:48.535251 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Flight_Routes"
[0m09:07:48.535813 [debug] [Thread-1 (]: On model.air_travel.Flight_Routes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Flight_Routes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
      
    
    

    
    OPTIONS()
    as (
      with Flight_Routes as (
  select distinct r.airline_id, a1.icao as source_airport_icao, 
    a2.icao as dest_airport_icao, r.codeshare, r.stops, r.equipment, 
    r._data_source, r._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes` r
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a1
  on r.source_airport = a1.iata
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a2
  on r.dest_airport = a2.iata
)

select * 
from Flight_Routes
    );
  
[0m09:07:48.905966 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5849208d-9c44-42c4-b555-daecf92e7017&page=queryresults
[0m09:07:50.643280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fa389b0>]}
[0m09:07:50.927035 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m09:07:50.932135 [info ] [Thread-1 (]: 23 of 24 OK created sql table model dbt_air_travel_int.Flight_Routes ........... [[32mCREATE TABLE (13.3k rows, 3.6 MiB processed)[0m in 2.36s]
[0m09:07:50.933378 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Routes
[0m09:07:50.933803 [debug] [Thread-1 (]: Began running node model.air_travel.TSA_Traffic
[0m09:07:50.934320 [info ] [Thread-1 (]: 24 of 24 START sql table model dbt_air_travel_int.TSA_Traffic .................. [RUN]
[0m09:07:50.934816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Flight_Routes, now model.air_travel.TSA_Traffic)
[0m09:07:50.935135 [debug] [Thread-1 (]: Began compiling node model.air_travel.TSA_Traffic
[0m09:07:50.938155 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.TSA_Traffic"
[0m09:07:50.938860 [debug] [Thread-1 (]: Began executing node model.air_travel.TSA_Traffic
[0m09:07:50.940642 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.TSA_Traffic"
[0m09:07:50.941236 [debug] [Thread-1 (]: On model.air_travel.TSA_Traffic: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.TSA_Traffic"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
      
    
    

    
    OPTIONS()
    as (
      with TSA_Traffic as (
  select distinct t.event_date, t.event_hour, a.icao as airport_icao, t.security_checkpoint, t.total_traffic,
    t._data_source, t._load_time
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a join `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic` t
  on a.iata = t.airport_code
  and a.city = t.airport_city
  where a.country = 'United States'
  and t.event_date is not null
  and t.event_hour is not null
  and a.icao is not null
  and t.security_checkpoint is not null
)

select * 
from TSA_Traffic
    );
  
[0m09:07:50.941530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:51.391495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:417bba17-3aed-482d-9c00-1d976c6a07a8&page=queryresults
[0m09:07:51.466947 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:417bba17-3aed-482d-9c00-1d976c6a07a8&page=queryresults
[0m09:07:51.473944 [debug] [Thread-1 (]: Database Error in model TSA_Traffic (models/int/TSA_Traffic.sql)
  Name country not found inside a at [20:11]
  compiled code at target/run/air_travel/models/int/TSA_Traffic.sql
[0m09:07:51.474400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '861955d9-b3a1-4eab-a58d-5623aaa97c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fb35d90>]}
[0m09:07:51.474896 [error] [Thread-1 (]: 24 of 24 ERROR creating sql table model dbt_air_travel_int.TSA_Traffic ......... [[31mERROR[0m in 0.54s]
[0m09:07:51.475290 [debug] [Thread-1 (]: Finished running node model.air_travel.TSA_Traffic
[0m09:07:51.475636 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.TSA_Traffic' to be skipped because of status 'error'.  Reason: Database Error in model TSA_Traffic (models/int/TSA_Traffic.sql)
  Name country not found inside a at [20:11]
  compiled code at target/run/air_travel/models/int/TSA_Traffic.sql.
[0m09:07:51.476597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:07:51.477945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:51.478179 [debug] [MainThread]: Connection 'model.air_travel.TSA_Traffic' was properly closed.
[0m09:07:51.478449 [info ] [MainThread]: 
[0m09:07:51.478676 [info ] [MainThread]: Finished running 24 table models in 0 hours 1 minutes and 1.27 seconds (61.27s).
[0m09:07:51.480934 [debug] [MainThread]: Command end result
[0m09:07:51.500676 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:07:51.501817 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:07:51.505361 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:07:51.505520 [info ] [MainThread]: 
[0m09:07:51.505696 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:07:51.505842 [info ] [MainThread]: 
[0m09:07:51.506017 [error] [MainThread]: [31mFailure in model Airport_Concessions (models/int/Airport_Concessions.sql)[0m
[0m09:07:51.506177 [error] [MainThread]:   Database Error in model Airport_Concessions (models/int/Airport_Concessions.sql)
  Syntax error: Expected ")" but got keyword WITH at [25:1]
  compiled code at target/run/air_travel/models/int/Airport_Concessions.sql
[0m09:07:51.506295 [info ] [MainThread]: 
[0m09:07:51.506433 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport_Concessions.sql
[0m09:07:51.506547 [info ] [MainThread]: 
[0m09:07:51.506691 [error] [MainThread]: [31mFailure in model Airport_Reviews (models/int/Airport_Reviews.sql)[0m
[0m09:07:51.506838 [error] [MainThread]:   Database Error in model Airport_Reviews (models/int/Airport_Reviews.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:5]
  compiled code at target/run/air_travel/models/int/Airport_Reviews.sql
[0m09:07:51.506950 [info ] [MainThread]: 
[0m09:07:51.507090 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport_Reviews.sql
[0m09:07:51.507199 [info ] [MainThread]: 
[0m09:07:51.507335 [error] [MainThread]: [31mFailure in model TSA_Traffic (models/int/TSA_Traffic.sql)[0m
[0m09:07:51.507475 [error] [MainThread]:   Database Error in model TSA_Traffic (models/int/TSA_Traffic.sql)
  Name country not found inside a at [20:11]
  compiled code at target/run/air_travel/models/int/TSA_Traffic.sql
[0m09:07:51.507585 [info ] [MainThread]: 
[0m09:07:51.507723 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/TSA_Traffic.sql
[0m09:07:51.507840 [info ] [MainThread]: 
[0m09:07:51.507980 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=24
[0m09:07:51.510123 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 62.47677, "process_in_blocks": "0", "process_kernel_time": 0.439142, "process_mem_max_rss": "398426112", "process_out_blocks": "0", "process_user_time": 3.777717}
[0m09:07:51.510315 [debug] [MainThread]: Command `dbt run` failed at 09:07:51.510278 after 62.48 seconds
[0m09:07:51.510480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f45f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f6cb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fb35d90>]}
[0m09:07:51.510632 [debug] [MainThread]: Flushing usage events
[0m09:07:51.701350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:11.435894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10553f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10553f750>]}


============================== 09:08:11.437476 | 8bef7438-fcb5-4bc2-9f5e-b5d6225d60c9 ==============================
[0m09:08:11.437476 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:08:11.437721 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'log_cache_events': 'False', 'empty': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'printer_width': '80', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select Airport_Concessions', 'debug': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m09:08:12.276556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bef7438-fcb5-4bc2-9f5e-b5d6225d60c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104898c30>]}
[0m09:08:12.295640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bef7438-fcb5-4bc2-9f5e-b5d6225d60c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a9c2360>]}
[0m09:08:12.295866 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:08:12.371163 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:08:12.411521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:08:12.411660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:08:12.413999 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:08:12.428905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bef7438-fcb5-4bc2-9f5e-b5d6225d60c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12af4a650>]}
[0m09:08:12.463417 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:08:12.464342 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:08:12.470756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bef7438-fcb5-4bc2-9f5e-b5d6225d60c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a9ce8a0>]}
[0m09:08:12.470932 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m09:08:12.471055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bef7438-fcb5-4bc2-9f5e-b5d6225d60c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ab41e10>]}
[0m09:08:12.471879 [info ] [MainThread]: 
[0m09:08:12.472058 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:08:12.472165 [info ] [MainThread]: 
[0m09:08:12.472366 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:08:12.472734 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:08:12.472869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:12.880881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:08:12.881422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:13.143898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:08:13.145967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:13.372970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:08:13.375614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:13.689794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bef7438-fcb5-4bc2-9f5e-b5d6225d60c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b8f3d40>]}
[0m09:08:13.690597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:08:13.694961 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Concessions
[0m09:08:13.695614 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport_Concessions ............ [RUN]
[0m09:08:13.696042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.Airport_Concessions)
[0m09:08:13.696342 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Concessions
[0m09:08:13.704520 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Concessions"
[0m09:08:13.705150 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Concessions
[0m09:08:13.729226 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Concessions"
[0m09:08:13.729852 [debug] [Thread-1 (]: On model.air_travel.Airport_Concessions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Concessions"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Concessions as (
  select distinct a.icao as airport_icao, m.terminal, m.business, m.location, m._data_source, m._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps` m join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a
  on upper(m.airport) = a.iata
  where a.country = 'United States'
  and m.business not in
    (select business from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`)
  order by m.business
)

select * 
with Airport_Concessions
    );
  
[0m09:08:13.730073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:13.948274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6ece8361-7867-4c09-9aad-5931e2311cc2&page=queryresults
[0m09:08:13.949154 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6ece8361-7867-4c09-9aad-5931e2311cc2&page=queryresults
[0m09:08:13.959466 [debug] [Thread-1 (]: Database Error in model Airport_Concessions (models/int/Airport_Concessions.sql)
  Syntax error: Expected ")" but got keyword WITH at [25:1]
  compiled code at target/run/air_travel/models/int/Airport_Concessions.sql
[0m09:08:13.961522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bef7438-fcb5-4bc2-9f5e-b5d6225d60c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b9e2f90>]}
[0m09:08:13.962163 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Airport_Concessions ... [[31mERROR[0m in 0.26s]
[0m09:08:13.962639 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Concessions
[0m09:08:13.962980 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport_Concessions' to be skipped because of status 'error'.  Reason: Database Error in model Airport_Concessions (models/int/Airport_Concessions.sql)
  Syntax error: Expected ")" but got keyword WITH at [25:1]
  compiled code at target/run/air_travel/models/int/Airport_Concessions.sql.
[0m09:08:13.964240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:08:13.965460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:13.965674 [debug] [MainThread]: Connection 'model.air_travel.Airport_Concessions' was properly closed.
[0m09:08:13.965875 [info ] [MainThread]: 
[0m09:08:13.966085 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m09:08:13.966511 [debug] [MainThread]: Command end result
[0m09:08:13.987225 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:08:13.988285 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:08:13.991228 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:08:13.991379 [info ] [MainThread]: 
[0m09:08:13.991552 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:08:13.991702 [info ] [MainThread]: 
[0m09:08:13.991885 [error] [MainThread]: [31mFailure in model Airport_Concessions (models/int/Airport_Concessions.sql)[0m
[0m09:08:13.992050 [error] [MainThread]:   Database Error in model Airport_Concessions (models/int/Airport_Concessions.sql)
  Syntax error: Expected ")" but got keyword WITH at [25:1]
  compiled code at target/run/air_travel/models/int/Airport_Concessions.sql
[0m09:08:13.992176 [info ] [MainThread]: 
[0m09:08:13.992315 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport_Concessions.sql
[0m09:08:13.992429 [info ] [MainThread]: 
[0m09:08:13.992567 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:08:13.994771 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5824187, "process_in_blocks": "0", "process_kernel_time": 0.24037, "process_mem_max_rss": "385531904", "process_out_blocks": "0", "process_user_time": 1.647575}
[0m09:08:13.994989 [debug] [MainThread]: Command `dbt run` failed at 09:08:13.994947 after 2.58 seconds
[0m09:08:13.995162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b9431d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1013bc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104837f70>]}
[0m09:08:13.995317 [debug] [MainThread]: Flushing usage events
[0m09:08:14.188633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:48.199915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106473750>]}


============================== 09:10:48.201563 | 983968f2-ff24-4911-979c-ce522d3a6885 ==============================
[0m09:10:48.201563 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:10:48.201821 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select Airport_Reviews', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'introspect': 'True', 'profiles_dir': '/Users/scohen/.dbt'}
[0m09:10:49.013312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '983968f2-ff24-4911-979c-ce522d3a6885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ccc30>]}
[0m09:10:49.032083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '983968f2-ff24-4911-979c-ce522d3a6885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c3be360>]}
[0m09:10:49.032289 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:10:49.105830 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:10:49.145963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:10:49.146217 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport_Concessions.sql
[0m09:10:49.226562 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:10:49.231082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '983968f2-ff24-4911-979c-ce522d3a6885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c94a150>]}
[0m09:10:49.263111 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:10:49.263978 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:10:49.271054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '983968f2-ff24-4911-979c-ce522d3a6885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c3ce8a0>]}
[0m09:10:49.271230 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m09:10:49.271352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '983968f2-ff24-4911-979c-ce522d3a6885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5f1ef0>]}
[0m09:10:49.272067 [info ] [MainThread]: 
[0m09:10:49.272191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:10:49.272285 [info ] [MainThread]: 
[0m09:10:49.272469 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:10:49.272806 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:10:49.272967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:49.623037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:10:49.623573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:49.925328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:10:49.927275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:50.209002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:10:50.211155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:50.461382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '983968f2-ff24-4911-979c-ce522d3a6885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cbd1bf0>]}
[0m09:10:50.462257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:10:50.466380 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Reviews
[0m09:10:50.466982 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport_Reviews ................ [RUN]
[0m09:10:50.467424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.Airport_Reviews)
[0m09:10:50.467782 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Reviews
[0m09:10:50.475165 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Reviews"
[0m09:10:50.475991 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Reviews
[0m09:10:50.500370 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Reviews"
[0m09:10:50.500905 [debug] [Thread-1 (]: On model.air_travel.Airport_Reviews: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Reviews"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Reviews`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Review as
    select distinct r.id, r.review_thread, r.review_date, r.review_author,
      r.review_subject, r.review_details, a.icao as airport_icao, r.broad_category, r.sub_category, r.sentiment,
      r.language, r._data_source, r._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews` r join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a
    on a.icao = r.airport_code

select * from Airport_Review
    );
  
[0m09:10:50.501117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:50.720486 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:aa63c401-f5dd-4e1a-abc0-43069ccc36f3&page=queryresults
[0m09:10:50.721758 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:aa63c401-f5dd-4e1a-abc0-43069ccc36f3&page=queryresults
[0m09:10:50.733443 [debug] [Thread-1 (]: Database Error in model Airport_Reviews (models/int/Airport_Reviews.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:5]
  compiled code at target/run/air_travel/models/int/Airport_Reviews.sql
[0m09:10:50.735320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '983968f2-ff24-4911-979c-ce522d3a6885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cf27950>]}
[0m09:10:50.735918 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Airport_Reviews ....... [[31mERROR[0m in 0.27s]
[0m09:10:50.736362 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Reviews
[0m09:10:50.736701 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport_Reviews' to be skipped because of status 'error'.  Reason: Database Error in model Airport_Reviews (models/int/Airport_Reviews.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:5]
  compiled code at target/run/air_travel/models/int/Airport_Reviews.sql.
[0m09:10:50.737966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:10:50.739173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:50.739390 [debug] [MainThread]: Connection 'model.air_travel.Airport_Reviews' was properly closed.
[0m09:10:50.739584 [info ] [MainThread]: 
[0m09:10:50.739794 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m09:10:50.740233 [debug] [MainThread]: Command end result
[0m09:10:50.759531 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:10:50.760614 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:10:50.763695 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:10:50.763841 [info ] [MainThread]: 
[0m09:10:50.764019 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:10:50.764154 [info ] [MainThread]: 
[0m09:10:50.764317 [error] [MainThread]: [31mFailure in model Airport_Reviews (models/int/Airport_Reviews.sql)[0m
[0m09:10:50.764470 [error] [MainThread]:   Database Error in model Airport_Reviews (models/int/Airport_Reviews.sql)
  Syntax error: Expected "(" but got keyword SELECT at [15:5]
  compiled code at target/run/air_travel/models/int/Airport_Reviews.sql
[0m09:10:50.764587 [info ] [MainThread]: 
[0m09:10:50.764727 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport_Reviews.sql
[0m09:10:50.764841 [info ] [MainThread]: 
[0m09:10:50.764979 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:10:50.767189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.591349, "process_in_blocks": "0", "process_kernel_time": 0.233549, "process_mem_max_rss": "387219456", "process_out_blocks": "0", "process_user_time": 1.692881}
[0m09:10:50.767399 [debug] [MainThread]: Command `dbt run` failed at 09:10:50.767359 after 2.59 seconds
[0m09:10:50.767574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cfe0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cfe8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cfea3f0>]}
[0m09:10:50.767729 [debug] [MainThread]: Flushing usage events
[0m09:10:50.976621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:11:20.576785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f546e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107373750>]}


============================== 09:11:20.578412 | 4bf594c0-8fbe-4395-8f56-17cdf218e24f ==============================
[0m09:11:20.578412 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:11:20.578654 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select Airport_Reviews', 'version_check': 'True', 'debug': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False'}
[0m09:11:21.384103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bf594c0-8fbe-4395-8f56-17cdf218e24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ccc30>]}
[0m09:11:21.402827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bf594c0-8fbe-4395-8f56-17cdf218e24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e6be360>]}
[0m09:11:21.403030 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:11:21.476578 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:11:21.515995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:11:21.516236 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport_Reviews.sql
[0m09:11:21.596495 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:11:21.601091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bf594c0-8fbe-4395-8f56-17cdf218e24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee4a150>]}
[0m09:11:21.633053 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:11:21.633880 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:11:21.640909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bf594c0-8fbe-4395-8f56-17cdf218e24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e6ce8a0>]}
[0m09:11:21.641090 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m09:11:21.641221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bf594c0-8fbe-4395-8f56-17cdf218e24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e8f5ef0>]}
[0m09:11:21.641891 [info ] [MainThread]: 
[0m09:11:21.642024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:11:21.642120 [info ] [MainThread]: 
[0m09:11:21.642317 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:11:21.642634 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:11:21.642792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:21.946759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:11:21.947344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:22.199877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:11:22.202237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:22.448714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:11:22.449809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:22.698341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bf594c0-8fbe-4395-8f56-17cdf218e24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13870d570>]}
[0m09:11:22.698997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:11:22.702314 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Reviews
[0m09:11:22.702845 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport_Reviews ................ [RUN]
[0m09:11:22.703236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.Airport_Reviews)
[0m09:11:22.703515 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Reviews
[0m09:11:22.710025 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Reviews"
[0m09:11:22.710983 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Reviews
[0m09:11:22.734182 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Reviews"
[0m09:11:22.734753 [debug] [Thread-1 (]: On model.air_travel.Airport_Reviews: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Reviews"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Reviews`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Review as (
    select distinct r.id, r.review_thread, r.review_date, r.review_author,
      r.review_subject, r.review_details, a.icao as airport_icao, r.broad_category, r.sub_category, r.sentiment,
      r.language, r._data_source, r._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews` r join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a
    on a.icao = r.airport_code
)

select * 
from Airport_Review
    );
  
[0m09:11:22.734972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:23.438240 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:921992b5-ac4b-4879-9327-296ede5002ae&page=queryresults
[0m09:11:25.532301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf594c0-8fbe-4395-8f56-17cdf218e24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13872be90>]}
[0m09:11:25.532809 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Airport_Reviews ........... [[32mCREATE TABLE (3.9k rows, 5.1 MiB processed)[0m in 2.83s]
[0m09:11:25.533199 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Reviews
[0m09:11:25.534054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:11:25.535173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:25.535366 [debug] [MainThread]: Connection 'model.air_travel.Airport_Reviews' was properly closed.
[0m09:11:25.535547 [info ] [MainThread]: 
[0m09:11:25.535738 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m09:11:25.536144 [debug] [MainThread]: Command end result
[0m09:11:25.553803 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:11:25.554917 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:11:25.557802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:11:25.557940 [info ] [MainThread]: 
[0m09:11:25.558108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:11:25.558229 [info ] [MainThread]: 
[0m09:11:25.558368 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:11:25.560416 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0070066, "process_in_blocks": "0", "process_kernel_time": 0.232502, "process_mem_max_rss": "399081472", "process_out_blocks": "0", "process_user_time": 1.720908}
[0m09:11:25.560619 [debug] [MainThread]: Command `dbt run` succeeded at 09:11:25.560580 after 5.01 seconds
[0m09:11:25.560776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1387d9ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1387e7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1387e7cf0>]}
[0m09:11:25.560924 [debug] [MainThread]: Flushing usage events
[0m09:11:25.751107 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:11:52.809863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040146e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f73750>]}


============================== 09:11:52.811493 | 4c45b3f7-ae17-43f1-958b-a7c184831cf2 ==============================
[0m09:11:52.811493 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:11:52.811733 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'introspect': 'True', 'empty': 'False', 'target_path': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --select TSA_Traffic', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m09:11:53.626857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c45b3f7-ae17-43f1-958b-a7c184831cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b8c30>]}
[0m09:11:53.645718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c45b3f7-ae17-43f1-958b-a7c184831cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d1c2360>]}
[0m09:11:53.645928 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:11:53.719477 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:11:53.760362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:11:53.760510 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:11:53.762871 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:11:53.776763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c45b3f7-ae17-43f1-958b-a7c184831cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e04a650>]}
[0m09:11:53.809945 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:11:53.810738 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:11:53.816719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c45b3f7-ae17-43f1-958b-a7c184831cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d1ce8a0>]}
[0m09:11:53.816904 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m09:11:53.817031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c45b3f7-ae17-43f1-958b-a7c184831cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d441e10>]}
[0m09:11:53.817751 [info ] [MainThread]: 
[0m09:11:53.817879 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:11:53.817971 [info ] [MainThread]: 
[0m09:11:53.818150 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:11:53.818515 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:11:53.818681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:54.106802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:11:54.107342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:54.417810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:11:54.420493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:54.695818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:11:54.697254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:54.943085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c45b3f7-ae17-43f1-958b-a7c184831cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e1f3860>]}
[0m09:11:54.943632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:11:54.946373 [debug] [Thread-1 (]: Began running node model.air_travel.TSA_Traffic
[0m09:11:54.946849 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.TSA_Traffic .................... [RUN]
[0m09:11:54.947210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.TSA_Traffic)
[0m09:11:54.947484 [debug] [Thread-1 (]: Began compiling node model.air_travel.TSA_Traffic
[0m09:11:54.955166 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.TSA_Traffic"
[0m09:11:54.955782 [debug] [Thread-1 (]: Began executing node model.air_travel.TSA_Traffic
[0m09:11:54.978907 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.TSA_Traffic"
[0m09:11:54.979502 [debug] [Thread-1 (]: On model.air_travel.TSA_Traffic: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.TSA_Traffic"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
      
    
    

    
    OPTIONS()
    as (
      with TSA_Traffic as (
  select distinct t.event_date, t.event_hour, a.icao as airport_icao, t.security_checkpoint, t.total_traffic,
    t._data_source, t._load_time
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a join `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic` t
  on a.iata = t.airport_code
  and a.city = t.airport_city
  where a.country = 'United States'
  and t.event_date is not null
  and t.event_hour is not null
  and a.icao is not null
  and t.security_checkpoint is not null
)

select * 
from TSA_Traffic
    );
  
[0m09:11:54.979728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:55.592377 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1704a2bf-1b3b-4c81-841a-80a128b47566&page=queryresults
[0m09:11:55.682697 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1704a2bf-1b3b-4c81-841a-80a128b47566&page=queryresults
[0m09:11:55.695575 [debug] [Thread-1 (]: Database Error in model TSA_Traffic (models/int/TSA_Traffic.sql)
  Name country not found inside a at [20:11]
  compiled code at target/run/air_travel/models/int/TSA_Traffic.sql
[0m09:11:55.697375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c45b3f7-ae17-43f1-958b-a7c184831cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e2df050>]}
[0m09:11:55.698019 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.TSA_Traffic ........... [[31mERROR[0m in 0.75s]
[0m09:11:55.698482 [debug] [Thread-1 (]: Finished running node model.air_travel.TSA_Traffic
[0m09:11:55.698823 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.TSA_Traffic' to be skipped because of status 'error'.  Reason: Database Error in model TSA_Traffic (models/int/TSA_Traffic.sql)
  Name country not found inside a at [20:11]
  compiled code at target/run/air_travel/models/int/TSA_Traffic.sql.
[0m09:11:55.700223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:11:55.701685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:55.701925 [debug] [MainThread]: Connection 'model.air_travel.TSA_Traffic' was properly closed.
[0m09:11:55.702140 [info ] [MainThread]: 
[0m09:11:55.702369 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m09:11:55.702824 [debug] [MainThread]: Command end result
[0m09:11:55.721859 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:11:55.722864 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:11:55.725832 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:11:55.725975 [info ] [MainThread]: 
[0m09:11:55.726138 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:11:55.726274 [info ] [MainThread]: 
[0m09:11:55.726444 [error] [MainThread]: [31mFailure in model TSA_Traffic (models/int/TSA_Traffic.sql)[0m
[0m09:11:55.726598 [error] [MainThread]:   Database Error in model TSA_Traffic (models/int/TSA_Traffic.sql)
  Name country not found inside a at [20:11]
  compiled code at target/run/air_travel/models/int/TSA_Traffic.sql
[0m09:11:55.726713 [info ] [MainThread]: 
[0m09:11:55.726851 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/TSA_Traffic.sql
[0m09:11:55.726960 [info ] [MainThread]: 
[0m09:11:55.727099 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:11:55.729318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9431386, "process_in_blocks": "0", "process_kernel_time": 0.232954, "process_mem_max_rss": "384794624", "process_out_blocks": "0", "process_user_time": 1.638344}
[0m09:11:55.729536 [debug] [MainThread]: Command `dbt run` failed at 09:11:55.729496 after 2.94 seconds
[0m09:11:55.729708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e243120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d14550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d260910>]}
[0m09:11:55.729868 [debug] [MainThread]: Flushing usage events
[0m09:11:55.920043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:14:57.145801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10543b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10543b750>]}


============================== 09:14:57.147438 | cd33e1e7-4d7e-45fa-8fea-7d2333e79eaa ==============================
[0m09:14:57.147438 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:14:57.147682 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'log_format': 'default', 'invocation_command': 'dbt run --select TSA_Traffic', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'fail_fast': 'False', 'introspect': 'True'}
[0m09:14:57.965572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd33e1e7-4d7e-45fa-8fea-7d2333e79eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104794c30>]}
[0m09:14:57.984447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd33e1e7-4d7e-45fa-8fea-7d2333e79eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bc2360>]}
[0m09:14:57.984661 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:14:58.058554 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:14:58.099014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:14:58.099255 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/TSA_Traffic.sql
[0m09:14:58.179632 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:14:58.184250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd33e1e7-4d7e-45fa-8fea-7d2333e79eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12294a150>]}
[0m09:14:58.216911 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:14:58.217771 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:14:58.224845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd33e1e7-4d7e-45fa-8fea-7d2333e79eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bce8a0>]}
[0m09:14:58.225022 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m09:14:58.225149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd33e1e7-4d7e-45fa-8fea-7d2333e79eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121df1ef0>]}
[0m09:14:58.225824 [info ] [MainThread]: 
[0m09:14:58.225959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:14:58.226053 [info ] [MainThread]: 
[0m09:14:58.226239 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:14:58.226540 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:14:58.226687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:58.696929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:14:58.697450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:14:58.963493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:14:58.966494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:14:59.216561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:14:59.217875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:14:59.481904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd33e1e7-4d7e-45fa-8fea-7d2333e79eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123017ba0>]}
[0m09:14:59.482278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:14:59.484170 [debug] [Thread-1 (]: Began running node model.air_travel.TSA_Traffic
[0m09:14:59.484473 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.TSA_Traffic .................... [RUN]
[0m09:14:59.484713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.TSA_Traffic)
[0m09:14:59.484893 [debug] [Thread-1 (]: Began compiling node model.air_travel.TSA_Traffic
[0m09:14:59.489339 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.TSA_Traffic"
[0m09:14:59.489769 [debug] [Thread-1 (]: Began executing node model.air_travel.TSA_Traffic
[0m09:14:59.509643 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.TSA_Traffic"
[0m09:14:59.510257 [debug] [Thread-1 (]: On model.air_travel.TSA_Traffic: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.TSA_Traffic"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
      
    
    

    
    OPTIONS()
    as (
      with TSA_Traffic as (
  select distinct t.event_date, t.event_hour, a.icao as airport_icao, 
    t.security_checkpoint, t.total_traffic, t._data_source, t._load_time
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a join `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic` t
  on a.iata = t.airport_code
  and a.city = t.airport_city
  where a.country_code = 'US'
  and t.event_date is not null
  and t.event_hour is not null
  and a.icao is not null
  and t.security_checkpoint is not null
)

select * 
from TSA_Traffic
    );
  
[0m09:14:59.510465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:00.015784 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:330ad9f7-cc99-4c9f-acfb-9da2ee65061f&page=queryresults
[0m09:15:01.891355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd33e1e7-4d7e-45fa-8fea-7d2333e79eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b48350>]}
[0m09:15:01.891742 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.TSA_Traffic ............... [[32mCREATE TABLE (372.0 rows, 1.3 MiB processed)[0m in 2.41s]
[0m09:15:01.892022 [debug] [Thread-1 (]: Finished running node model.air_travel.TSA_Traffic
[0m09:15:01.892598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:15:01.893360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:01.893489 [debug] [MainThread]: Connection 'model.air_travel.TSA_Traffic' was properly closed.
[0m09:15:01.893615 [info ] [MainThread]: 
[0m09:15:01.893741 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m09:15:01.894014 [debug] [MainThread]: Command end result
[0m09:15:01.907307 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:15:01.908185 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:15:01.910565 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:15:01.910686 [info ] [MainThread]: 
[0m09:15:01.910833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:15:01.910939 [info ] [MainThread]: 
[0m09:15:01.911062 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:15:01.912903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7910113, "process_in_blocks": "0", "process_kernel_time": 0.240648, "process_mem_max_rss": "391921664", "process_out_blocks": "0", "process_user_time": 1.681872}
[0m09:15:01.913087 [debug] [MainThread]: Command `dbt run` succeeded at 09:15:01.913055 after 4.79 seconds
[0m09:15:01.913222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230ddff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c60910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230ed6d0>]}
[0m09:15:01.913353 [debug] [MainThread]: Flushing usage events
[0m09:15:02.119860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:15.559715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a73750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a73890>]}


============================== 09:15:15.561296 | 846d7ff3-e00e-4ac5-be78-04f48260a9e7 ==============================
[0m09:15:15.561296 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:15:15.561537 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_cache_events': 'False', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'False', 'invocation_command': 'dbt run --select models/int/Airline.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Reviews.sql models/int/Airport.sql models/int/Country.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/TSA_Traffic.sql', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m09:15:16.364086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107accc30>]}
[0m09:15:16.382874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e8be360>]}
[0m09:15:16.383081 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:15:16.458174 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:15:16.497561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:15:16.497700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:15:16.500077 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:15:16.513790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ed4a650>]}
[0m09:15:16.548948 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:15:16.549782 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:15:16.555755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e8ce8a0>]}
[0m09:15:16.555934 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m09:15:16.556059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ea41e10>]}
[0m09:15:16.560710 [info ] [MainThread]: 
[0m09:15:16.560839 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:15:16.560934 [info ] [MainThread]: 
[0m09:15:16.561123 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:15:16.562698 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:15:16.562887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:16.838634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:15:16.839276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:17.096038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:15:17.098061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:17.372280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:15:17.373840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:17.617812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eef3d40>]}
[0m09:15:17.618578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:15:17.623052 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Establishment
[0m09:15:17.623704 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_air_travel_int.Airport_Establishment .......... [RUN]
[0m09:15:17.624230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.Airport_Establishment)
[0m09:15:17.624688 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Establishment
[0m09:15:17.633356 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Establishment"
[0m09:15:17.634159 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Establishment
[0m09:15:17.644008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:17.943109 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Establishment"
[0m09:15:17.943634 [debug] [Thread-1 (]: On model.air_travel.Airport_Establishment: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Establishment"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Establishment as
(
  select distinct e.business, m.broad_category, m.sub_category,
    case when m.broad_category in ('Fast Casual', 'Full-Service Dining') then True else False end as dining,
    'airport.guide,llm' as _data_source, e._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique` e 
  join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_sub_categories_mapped` m
  on e.business = m.business
)

select * from Airport_Establishment
    );
  
[0m09:15:18.345893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6851028c-7aab-4554-a5a9-aab6a2cf8b5c&page=queryresults
[0m09:15:20.314201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14efe3a10>]}
[0m09:15:20.314872 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_air_travel_int.Airport_Establishment ..... [[32mCREATE TABLE (830.0 rows, 81.4 KiB processed)[0m in 2.69s]
[0m09:15:20.315353 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Establishment
[0m09:15:20.315640 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m09:15:20.316086 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_air_travel_int.Country ........................ [RUN]
[0m09:15:20.316557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Establishment, now model.air_travel.Country)
[0m09:15:20.316847 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m09:15:20.318961 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m09:15:20.319571 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m09:15:20.321178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:20.576113 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Country"
[0m09:15:20.578414 [debug] [Thread-1 (]: On model.air_travel.Country: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Country"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Country`
      
    
    

    
    OPTIONS()
    as (
      with Country as (
    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` 
    group by iso_code, name, _data_source, _load_time
)

select *
from Country
where iso_code is not null 
union all
select t.mapped_iso_code, c.name, c.dafif_codes, c._data_source, c._load_time 
from Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes` t 
on c.name = t.name
where t.mapped_iso_code is not null
and c.iso_code is null
    );
  
[0m09:15:21.007915 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:126e4764-beb5-4576-a636-4d38e59bc740&page=queryresults
[0m09:15:23.089482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14efc50d0>]}
[0m09:15:23.090424 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_air_travel_int.Country ................... [[32mCREATE TABLE (240.0 rows, 10.7 KiB processed)[0m in 2.77s]
[0m09:15:23.091036 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m09:15:23.091414 [debug] [Thread-1 (]: Began running node model.air_travel.Food_Beverage
[0m09:15:23.091993 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_air_travel_int.Food_Beverage .................. [RUN]
[0m09:15:23.092532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Country, now model.air_travel.Food_Beverage)
[0m09:15:23.092919 [debug] [Thread-1 (]: Began compiling node model.air_travel.Food_Beverage
[0m09:15:23.095600 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Food_Beverage"
[0m09:15:23.096370 [debug] [Thread-1 (]: Began executing node model.air_travel.Food_Beverage
[0m09:15:23.098430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:23.344463 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Food_Beverage"
[0m09:15:23.347233 [debug] [Thread-1 (]: On model.air_travel.Food_Beverage: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Food_Beverage"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
      
    
    

    
    OPTIONS()
    as (
      with Food_Beverage as (
  select distinct business, menu_item
  from
    (select e.business, split(m.menu_items, ',') as menu_items
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment` e join `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps` m
    on e.business = m.business
    where e.dining = True) t, unnest(t.menu_items) as menu_item
  order by business
)

select * 
from Food_Beverage
    );
  
[0m09:15:23.669369 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c819b870-ee19-47e1-8657-e148b2adf6a1&page=queryresults
[0m09:15:25.725001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14efddef0>]}
[0m09:15:25.725893 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_air_travel_int.Food_Beverage ............. [[32mCREATE TABLE (476.0 rows, 60.7 KiB processed)[0m in 2.63s]
[0m09:15:25.726392 [debug] [Thread-1 (]: Finished running node model.air_travel.Food_Beverage
[0m09:15:25.726703 [debug] [Thread-1 (]: Began running node model.air_travel.Airline
[0m09:15:25.727152 [info ] [Thread-1 (]: 4 of 9 START sql table model dbt_air_travel_int.Airline ........................ [RUN]
[0m09:15:25.727591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Food_Beverage, now model.air_travel.Airline)
[0m09:15:25.727902 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airline
[0m09:15:25.730667 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airline"
[0m09:15:25.731455 [debug] [Thread-1 (]: Began executing node model.air_travel.Airline
[0m09:15:25.733007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:25.993532 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airline"
[0m09:15:25.995335 [debug] [Thread-1 (]: On model.air_travel.Airline: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airline"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
      
    
    

    
    OPTIONS()
    as (
      with airline_country_joined as (
  select a.id, a.name, a.alias, a.icao, a.iata, a.callsign, 
    a.country as country_name, c.iso_code as country_code, a.active, 
    a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines` a left join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null 
),
Airline as (
    select acj.id, acj.name, acj.alias, acj.icao, acj.iata, acj.callsign, 
        acj.country_name, amc.mapped_iso_code as country_code, 
        acj.active, acj._data_source, acj._load_time 
    from airline_country_joined acj join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped` amc
    on acj.country_name = amc.original_country
    where acj.country_code is null
    and acj.country_name is not null
)

select *
from Airline
    );
  
[0m09:15:26.333836 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7dd38a8b-8904-499c-b4b8-5281be80c52b&page=queryresults
[0m09:15:28.091431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151b18250>]}
[0m09:15:28.092487 [info ] [Thread-1 (]: 4 of 9 OK created sql table model dbt_air_travel_int.Airline ................... [[32mCREATE TABLE (0.0 rows, 473.4 KiB processed)[0m in 2.36s]
[0m09:15:28.093473 [debug] [Thread-1 (]: Finished running node model.air_travel.Airline
[0m09:15:28.094140 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m09:15:28.094758 [info ] [Thread-1 (]: 5 of 9 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m09:15:28.095338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airline, now model.air_travel.Airport)
[0m09:15:28.095713 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m09:15:28.098847 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m09:15:28.099656 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m09:15:28.101271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:28.350886 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m09:15:28.353121 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.airport_country_name
  where c.mapped_iso_code is not null
)

select distinct * 
from Airport
    );
  
[0m09:15:28.687194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0f8ecbac-562f-4493-867c-d286c76a1542&page=queryresults
[0m09:15:30.429964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151ba77e0>]}
[0m09:15:30.430946 [info ] [Thread-1 (]: 5 of 9 OK created sql table model dbt_air_travel_int.Airport ................... [[32mCREATE TABLE (3.5k rows, 542.9 KiB processed)[0m in 2.33s]
[0m09:15:30.431544 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m09:15:30.432403 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Concessions
[0m09:15:30.432808 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_air_travel_int.Airport_Concessions ............ [RUN]
[0m09:15:30.433134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport, now model.air_travel.Airport_Concessions)
[0m09:15:30.433415 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Concessions
[0m09:15:30.436160 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Concessions"
[0m09:15:30.436943 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Concessions
[0m09:15:30.439262 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Concessions"
[0m09:15:30.439833 [debug] [Thread-1 (]: On model.air_travel.Airport_Concessions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Concessions"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Concessions as (
  select distinct a.icao as airport_icao, m.terminal, m.business, m.location, m._data_source, m._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps` m join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a
  on upper(m.airport) = a.iata
  where a.country = 'United States'
  and m.business not in
    (select business from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`)
  order by m.business
)

select * 
from Airport_Concessions
    );
  
[0m09:15:30.440121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:30.942936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e2f91f8f-d740-4543-914f-12c6eb629269&page=queryresults
[0m09:15:31.010740 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e2f91f8f-d740-4543-914f-12c6eb629269&page=queryresults
[0m09:15:31.024941 [debug] [Thread-1 (]: Database Error in model Airport_Concessions (models/int/Airport_Concessions.sql)
  Name country not found inside a at [18:11]
  compiled code at target/run/air_travel/models/int/Airport_Concessions.sql
[0m09:15:31.025475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151b0f710>]}
[0m09:15:31.026012 [error] [Thread-1 (]: 6 of 9 ERROR creating sql table model dbt_air_travel_int.Airport_Concessions ... [[31mERROR[0m in 0.59s]
[0m09:15:31.026447 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Concessions
[0m09:15:31.026709 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Reviews
[0m09:15:31.027065 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport_Concessions' to be skipped because of status 'error'.  Reason: Database Error in model Airport_Concessions (models/int/Airport_Concessions.sql)
  Name country not found inside a at [18:11]
  compiled code at target/run/air_travel/models/int/Airport_Concessions.sql.
[0m09:15:31.027442 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_air_travel_int.Airport_Reviews ................ [RUN]
[0m09:15:31.028395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Concessions, now model.air_travel.Airport_Reviews)
[0m09:15:31.028734 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Reviews
[0m09:15:31.030875 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Reviews"
[0m09:15:31.031437 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Reviews
[0m09:15:31.032769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:31.247028 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Reviews"
[0m09:15:31.248630 [debug] [Thread-1 (]: On model.air_travel.Airport_Reviews: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Reviews"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Reviews`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Review as (
    select distinct r.id, r.review_thread, r.review_date, r.review_author,
      r.review_subject, r.review_details, a.icao as airport_icao, r.broad_category, r.sub_category, r.sentiment,
      r.language, r._data_source, r._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews` r join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a
    on a.icao = r.airport_code
)

select * 
from Airport_Review
    );
  
[0m09:15:31.542051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:95e9b551-54aa-4547-b0d9-a8838809d6a6&page=queryresults
[0m09:15:33.313706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151b899d0>]}
[0m09:15:33.314734 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_air_travel_int.Airport_Reviews ........... [[32mCREATE TABLE (3.9k rows, 5.1 MiB processed)[0m in 2.29s]
[0m09:15:33.315828 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Reviews
[0m09:15:33.316274 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Routes
[0m09:15:33.316870 [info ] [Thread-1 (]: 8 of 9 START sql table model dbt_air_travel_int.Flight_Routes .................. [RUN]
[0m09:15:33.317443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Reviews, now model.air_travel.Flight_Routes)
[0m09:15:33.317801 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Routes
[0m09:15:33.320811 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Routes"
[0m09:15:33.321586 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Routes
[0m09:15:33.323204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:33.571777 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Flight_Routes"
[0m09:15:33.573648 [debug] [Thread-1 (]: On model.air_travel.Flight_Routes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Flight_Routes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
      
    
    

    
    OPTIONS()
    as (
      with Flight_Routes as (
  select distinct r.airline_id, a1.icao as source_airport_icao, 
    a2.icao as dest_airport_icao, r.codeshare, r.stops, r.equipment, 
    r._data_source, r._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes` r
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a1
  on r.source_airport = a1.iata
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a2
  on r.dest_airport = a2.iata
)

select * 
from Flight_Routes
    );
  
[0m09:15:33.910730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c8a92acf-151a-44d2-9786-36221d854444&page=queryresults
[0m09:15:35.944610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151bd3050>]}
[0m09:15:35.945761 [info ] [Thread-1 (]: 8 of 9 OK created sql table model dbt_air_travel_int.Flight_Routes ............. [[32mCREATE TABLE (13.3k rows, 3.6 MiB processed)[0m in 2.63s]
[0m09:15:35.946635 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Routes
[0m09:15:35.947046 [debug] [Thread-1 (]: Began running node model.air_travel.TSA_Traffic
[0m09:15:35.947632 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_air_travel_int.TSA_Traffic .................... [RUN]
[0m09:15:35.948218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Flight_Routes, now model.air_travel.TSA_Traffic)
[0m09:15:35.948594 [debug] [Thread-1 (]: Began compiling node model.air_travel.TSA_Traffic
[0m09:15:35.951445 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.TSA_Traffic"
[0m09:15:35.952166 [debug] [Thread-1 (]: Began executing node model.air_travel.TSA_Traffic
[0m09:15:35.953935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:36.223028 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.TSA_Traffic"
[0m09:15:36.225135 [debug] [Thread-1 (]: On model.air_travel.TSA_Traffic: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.TSA_Traffic"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
      
    
    

    
    OPTIONS()
    as (
      with TSA_Traffic as (
  select distinct t.event_date, t.event_hour, a.icao as airport_icao, 
    t.security_checkpoint, t.total_traffic, t._data_source, t._load_time
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a join `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic` t
  on a.iata = t.airport_code
  and a.city = t.airport_city
  where a.country_code = 'US'
  and t.event_date is not null
  and t.event_hour is not null
  and a.icao is not null
  and t.security_checkpoint is not null
)

select * 
from TSA_Traffic
    );
  
[0m09:15:36.574585 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:465ae8ea-6866-46fe-b22b-66c8a42bf7d1&page=queryresults
[0m09:15:38.638133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846d7ff3-e00e-4ac5-be78-04f48260a9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151bd3bf0>]}
[0m09:15:38.638906 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_air_travel_int.TSA_Traffic ............... [[32mCREATE TABLE (372.0 rows, 1.3 MiB processed)[0m in 2.69s]
[0m09:15:38.639393 [debug] [Thread-1 (]: Finished running node model.air_travel.TSA_Traffic
[0m09:15:38.640470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:15:38.641883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:38.642077 [debug] [MainThread]: Connection 'model.air_travel.TSA_Traffic' was properly closed.
[0m09:15:38.642331 [info ] [MainThread]: 
[0m09:15:38.642539 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 22.08 seconds (22.08s).
[0m09:15:38.643716 [debug] [MainThread]: Command end result
[0m09:15:38.663709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:15:38.664829 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:15:38.668151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:15:38.668315 [info ] [MainThread]: 
[0m09:15:38.668492 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:15:38.668640 [info ] [MainThread]: 
[0m09:15:38.668825 [error] [MainThread]: [31mFailure in model Airport_Concessions (models/int/Airport_Concessions.sql)[0m
[0m09:15:38.668988 [error] [MainThread]:   Database Error in model Airport_Concessions (models/int/Airport_Concessions.sql)
  Name country not found inside a at [18:11]
  compiled code at target/run/air_travel/models/int/Airport_Concessions.sql
[0m09:15:38.669111 [info ] [MainThread]: 
[0m09:15:38.669252 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport_Concessions.sql
[0m09:15:38.669371 [info ] [MainThread]: 
[0m09:15:38.669595 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=9
[0m09:15:38.671923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 23.135944, "process_in_blocks": "0", "process_kernel_time": 0.28369, "process_mem_max_rss": "389136384", "process_out_blocks": "0", "process_user_time": 2.333112}
[0m09:15:38.672184 [debug] [MainThread]: Command `dbt run` failed at 09:15:38.672131 after 23.14 seconds
[0m09:15:38.672383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ecd3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151f57830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151f57770>]}
[0m09:15:38.672560 [debug] [MainThread]: Flushing usage events
[0m09:15:38.908449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:07.372521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106273750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106273890>]}


============================== 09:16:07.374205 | de96f50f-adca-43aa-af11-0cdfe131cdc8 ==============================
[0m09:16:07.374205 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:16:07.374456 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'target_path': 'None', 'partial_parse': 'True', 'write_json': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'invocation_command': 'dbt run --select models/int/Airline.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Reviews.sql models/int/Airport.sql models/int/Country.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/TSA_Traffic.sql', 'profiles_dir': '/Users/scohen/.dbt', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'empty': 'False'}
[0m09:16:08.181438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ccc30>]}
[0m09:16:08.200873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dbe360>]}
[0m09:16:08.201093 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:16:08.274487 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:16:08.313814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:16:08.314053 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport_Concessions.sql
[0m09:16:08.394084 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:16:08.398669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c4a150>]}
[0m09:16:08.430801 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:16:08.431637 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:16:08.438542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dce8a0>]}
[0m09:16:08.438725 [info ] [MainThread]: Found 34 models, 9 data tests, 9 sources, 514 macros
[0m09:16:08.438847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135ff1ef0>]}
[0m09:16:08.443616 [info ] [MainThread]: 
[0m09:16:08.443742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:16:08.443906 [info ] [MainThread]: 
[0m09:16:08.444148 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:16:08.446036 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:16:08.446200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:08.839540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:16:08.840127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:09.090757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:16:09.092565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:09.337869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:16:09.339028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:09.583561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137319570>]}
[0m09:16:09.584132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:16:09.587258 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Establishment
[0m09:16:09.587794 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_air_travel_int.Airport_Establishment .......... [RUN]
[0m09:16:09.588191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Airport_Establishment)
[0m09:16:09.588476 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Establishment
[0m09:16:09.594949 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Establishment"
[0m09:16:09.595569 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Establishment
[0m09:16:09.604681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:09.864077 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Establishment"
[0m09:16:09.864686 [debug] [Thread-1 (]: On model.air_travel.Airport_Establishment: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Establishment"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Establishment as
(
  select distinct e.business, m.broad_category, m.sub_category,
    case when m.broad_category in ('Fast Casual', 'Full-Service Dining') then True else False end as dining,
    'airport.guide,llm' as _data_source, e._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique` e 
  join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_sub_categories_mapped` m
  on e.business = m.business
)

select * from Airport_Establishment
    );
  
[0m09:16:10.227277 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:755bdc07-5f11-4f7f-be4b-5654c8ab5b4b&page=queryresults
[0m09:16:12.050620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137448290>]}
[0m09:16:12.051290 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_air_travel_int.Airport_Establishment ..... [[32mCREATE TABLE (830.0 rows, 81.4 KiB processed)[0m in 2.46s]
[0m09:16:12.051735 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Establishment
[0m09:16:12.051996 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m09:16:12.052394 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_air_travel_int.Country ........................ [RUN]
[0m09:16:12.052825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Establishment, now model.air_travel.Country)
[0m09:16:12.053114 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m09:16:12.055136 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m09:16:12.055666 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m09:16:12.057188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:12.291104 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Country"
[0m09:16:12.293251 [debug] [Thread-1 (]: On model.air_travel.Country: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Country"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Country`
      
    
    

    
    OPTIONS()
    as (
      with Country as (
    select iso_code, name, array_agg(ifnull(dafif_code, 'Unknown')) as dafif_codes, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`countries` 
    group by iso_code, name, _data_source, _load_time
)

select *
from Country
where iso_code is not null 
union all
select t.mapped_iso_code, c.name, c.dafif_codes, c._data_source, c._load_time 
from Country c join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_country_iso_codes` t 
on c.name = t.name
where t.mapped_iso_code is not null
and c.iso_code is null
    );
  
[0m09:16:12.618619 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a572bfc5-5420-45c3-b941-6c11cee63a2a&page=queryresults
[0m09:16:14.467224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1373de0a0>]}
[0m09:16:14.468126 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_air_travel_int.Country ................... [[32mCREATE TABLE (240.0 rows, 10.7 KiB processed)[0m in 2.41s]
[0m09:16:14.468705 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m09:16:14.469022 [debug] [Thread-1 (]: Began running node model.air_travel.Food_Beverage
[0m09:16:14.469508 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_air_travel_int.Food_Beverage .................. [RUN]
[0m09:16:14.470020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Country, now model.air_travel.Food_Beverage)
[0m09:16:14.470340 [debug] [Thread-1 (]: Began compiling node model.air_travel.Food_Beverage
[0m09:16:14.472893 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Food_Beverage"
[0m09:16:14.473644 [debug] [Thread-1 (]: Began executing node model.air_travel.Food_Beverage
[0m09:16:14.475677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:14.705843 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Food_Beverage"
[0m09:16:14.707651 [debug] [Thread-1 (]: On model.air_travel.Food_Beverage: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Food_Beverage"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
      
    
    

    
    OPTIONS()
    as (
      with Food_Beverage as (
  select distinct business, menu_item
  from
    (select e.business, split(m.menu_items, ',') as menu_items
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment` e join `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps` m
    on e.business = m.business
    where e.dining = True) t, unnest(t.menu_items) as menu_item
  order by business
)

select * 
from Food_Beverage
    );
  
[0m09:16:15.077471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:fac66469-0cec-4acd-a79b-d32497151c03&page=queryresults
[0m09:16:17.092649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1373aa670>]}
[0m09:16:17.093663 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_air_travel_int.Food_Beverage ............. [[32mCREATE TABLE (476.0 rows, 60.7 KiB processed)[0m in 2.62s]
[0m09:16:17.094756 [debug] [Thread-1 (]: Finished running node model.air_travel.Food_Beverage
[0m09:16:17.095192 [debug] [Thread-1 (]: Began running node model.air_travel.Airline
[0m09:16:17.095767 [info ] [Thread-1 (]: 4 of 9 START sql table model dbt_air_travel_int.Airline ........................ [RUN]
[0m09:16:17.096341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Food_Beverage, now model.air_travel.Airline)
[0m09:16:17.096731 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airline
[0m09:16:17.099775 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airline"
[0m09:16:17.100557 [debug] [Thread-1 (]: Began executing node model.air_travel.Airline
[0m09:16:17.102135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:17.329995 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airline"
[0m09:16:17.332083 [debug] [Thread-1 (]: On model.air_travel.Airline: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airline"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
      
    
    

    
    OPTIONS()
    as (
      with airline_country_joined as (
  select a.id, a.name, a.alias, a.icao, a.iata, a.callsign, 
    a.country as country_name, c.iso_code as country_code, a.active, 
    a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines` a left join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null 
),
Airline as (
    select acj.id, acj.name, acj.alias, acj.icao, acj.iata, acj.callsign, 
        acj.country_name, amc.mapped_iso_code as country_code, 
        acj.active, acj._data_source, acj._load_time 
    from airline_country_joined acj join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped` amc
    on acj.country_name = amc.original_country
    where acj.country_code is null
    and acj.country_name is not null
)

select *
from Airline
    );
  
[0m09:16:17.637599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:13a153f3-b973-48d0-b8d3-a966f38f277f&page=queryresults
[0m09:16:19.485530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1680f8b50>]}
[0m09:16:19.486362 [info ] [Thread-1 (]: 4 of 9 OK created sql table model dbt_air_travel_int.Airline ................... [[32mCREATE TABLE (0.0 rows, 473.4 KiB processed)[0m in 2.39s]
[0m09:16:19.486820 [debug] [Thread-1 (]: Finished running node model.air_travel.Airline
[0m09:16:19.487116 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m09:16:19.487513 [info ] [Thread-1 (]: 5 of 9 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m09:16:19.487918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airline, now model.air_travel.Airport)
[0m09:16:19.488199 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m09:16:19.490907 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m09:16:19.491560 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m09:16:19.492865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:19.717756 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m09:16:19.719963 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes` c
  on a.country = c.airport_country_name
  where c.mapped_iso_code is not null
)

select distinct * 
from Airport
    );
  
[0m09:16:20.196285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6f736f5d-316c-4013-b7bf-e9614200f23c&page=queryresults
[0m09:16:21.966539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137415b70>]}
[0m09:16:21.967531 [info ] [Thread-1 (]: 5 of 9 OK created sql table model dbt_air_travel_int.Airport ................... [[32mCREATE TABLE (3.5k rows, 542.9 KiB processed)[0m in 2.48s]
[0m09:16:21.968695 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m09:16:21.969753 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Concessions
[0m09:16:21.970370 [info ] [Thread-1 (]: 6 of 9 START sql table model dbt_air_travel_int.Airport_Concessions ............ [RUN]
[0m09:16:21.970855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport, now model.air_travel.Airport_Concessions)
[0m09:16:21.971196 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Concessions
[0m09:16:21.974201 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Concessions"
[0m09:16:21.975034 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Concessions
[0m09:16:21.977614 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Concessions"
[0m09:16:21.978463 [debug] [Thread-1 (]: On model.air_travel.Airport_Concessions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Concessions"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Concessions as (
  select distinct a.icao as airport_icao, m.terminal, m.business, m.location, m._data_source, m._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps` m join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a
  on upper(m.airport) = a.iata
  where a.country_code = 'US'
  and m.business not in
    (select business from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`)
  order by m.business
)

select * 
from Airport_Concessions
    );
  
[0m09:16:21.978780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:22.449193 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4e6678c5-0922-4b8a-a9bd-093218b682b4&page=queryresults
[0m09:16:24.282483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1680c26f0>]}
[0m09:16:24.283318 [info ] [Thread-1 (]: 6 of 9 OK created sql table model dbt_air_travel_int.Airport_Concessions ....... [[32mCREATE TABLE (165.0 rows, 190.7 KiB processed)[0m in 2.31s]
[0m09:16:24.283826 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Concessions
[0m09:16:24.284146 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Reviews
[0m09:16:24.284606 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_air_travel_int.Airport_Reviews ................ [RUN]
[0m09:16:24.285066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Concessions, now model.air_travel.Airport_Reviews)
[0m09:16:24.285384 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Reviews
[0m09:16:24.287981 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Reviews"
[0m09:16:24.288707 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Reviews
[0m09:16:24.290063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:24.542909 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Reviews"
[0m09:16:24.545109 [debug] [Thread-1 (]: On model.air_travel.Airport_Reviews: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Reviews"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Reviews`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Review as (
    select distinct r.id, r.review_thread, r.review_date, r.review_author,
      r.review_subject, r.review_details, a.icao as airport_icao, r.broad_category, r.sub_category, r.sentiment,
      r.language, r._data_source, r._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews` r join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a
    on a.icao = r.airport_code
)

select * 
from Airport_Review
    );
  
[0m09:16:24.780958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2b8b5ef5-56e4-4234-8550-e7e1d0330cf4&page=queryresults
[0m09:16:26.653786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1680c3d70>]}
[0m09:16:26.654841 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_air_travel_int.Airport_Reviews ........... [[32mCREATE TABLE (3.9k rows, 5.1 MiB processed)[0m in 2.37s]
[0m09:16:26.655670 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Reviews
[0m09:16:26.656463 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Routes
[0m09:16:26.657072 [info ] [Thread-1 (]: 8 of 9 START sql table model dbt_air_travel_int.Flight_Routes .................. [RUN]
[0m09:16:26.657648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Reviews, now model.air_travel.Flight_Routes)
[0m09:16:26.658016 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Routes
[0m09:16:26.661047 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Routes"
[0m09:16:26.661802 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Routes
[0m09:16:26.663400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:26.914097 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Flight_Routes"
[0m09:16:26.916333 [debug] [Thread-1 (]: On model.air_travel.Flight_Routes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Flight_Routes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
      
    
    

    
    OPTIONS()
    as (
      with Flight_Routes as (
  select distinct r.airline_id, a1.icao as source_airport_icao, 
    a2.icao as dest_airport_icao, r.codeshare, r.stops, r.equipment, 
    r._data_source, r._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes` r
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a1
  on r.source_airport = a1.iata
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a2
  on r.dest_airport = a2.iata
)

select * 
from Flight_Routes
    );
  
[0m09:16:27.263144 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8661236c-9953-4199-a38d-a7f525728f1a&page=queryresults
[0m09:16:29.026822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1681fa7b0>]}
[0m09:16:29.027633 [info ] [Thread-1 (]: 8 of 9 OK created sql table model dbt_air_travel_int.Flight_Routes ............. [[32mCREATE TABLE (13.3k rows, 3.6 MiB processed)[0m in 2.37s]
[0m09:16:29.028132 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Routes
[0m09:16:29.028451 [debug] [Thread-1 (]: Began running node model.air_travel.TSA_Traffic
[0m09:16:29.028905 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_air_travel_int.TSA_Traffic .................... [RUN]
[0m09:16:29.029349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Flight_Routes, now model.air_travel.TSA_Traffic)
[0m09:16:29.029662 [debug] [Thread-1 (]: Began compiling node model.air_travel.TSA_Traffic
[0m09:16:29.032149 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.TSA_Traffic"
[0m09:16:29.032835 [debug] [Thread-1 (]: Began executing node model.air_travel.TSA_Traffic
[0m09:16:29.034192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:29.362608 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.TSA_Traffic"
[0m09:16:29.363124 [debug] [Thread-1 (]: On model.air_travel.TSA_Traffic: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.TSA_Traffic"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
      
    
    

    
    OPTIONS()
    as (
      with TSA_Traffic as (
  select distinct t.event_date, t.event_hour, a.icao as airport_icao, 
    t.security_checkpoint, t.total_traffic, t._data_source, t._load_time
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a join `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic` t
  on a.iata = t.airport_code
  and a.city = t.airport_city
  where a.country_code = 'US'
  and t.event_date is not null
  and t.event_hour is not null
  and a.icao is not null
  and t.security_checkpoint is not null
)

select * 
from TSA_Traffic
    );
  
[0m09:16:29.719672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a52995b8-ec41-4887-b54a-663f7df8bdb3&page=queryresults
[0m09:16:31.472265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de96f50f-adca-43aa-af11-0cdfe131cdc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136e70dd0>]}
[0m09:16:31.473119 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_air_travel_int.TSA_Traffic ............... [[32mCREATE TABLE (372.0 rows, 1.3 MiB processed)[0m in 2.44s]
[0m09:16:31.473645 [debug] [Thread-1 (]: Finished running node model.air_travel.TSA_Traffic
[0m09:16:31.474781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:16:31.476439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:31.476696 [debug] [MainThread]: Connection 'model.air_travel.TSA_Traffic' was properly closed.
[0m09:16:31.477006 [info ] [MainThread]: 
[0m09:16:31.477248 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 23.03 seconds (23.03s).
[0m09:16:31.478623 [debug] [MainThread]: Command end result
[0m09:16:31.499220 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:16:31.500437 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:16:31.503882 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:16:31.504042 [info ] [MainThread]: 
[0m09:16:31.504222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:16:31.504365 [info ] [MainThread]: 
[0m09:16:31.504518 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m09:16:31.506839 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.158113, "process_in_blocks": "0", "process_kernel_time": 0.299354, "process_mem_max_rss": "392675328", "process_out_blocks": "0", "process_user_time": 2.50509}
[0m09:16:31.507044 [debug] [MainThread]: Command `dbt run` succeeded at 09:16:31.507004 after 24.16 seconds
[0m09:16:31.507205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136bafc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1681fbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1681fbad0>]}
[0m09:16:31.507360 [debug] [MainThread]: Flushing usage events
[0m09:16:31.767577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:18.151546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115973750>]}


============================== 09:25:18.153203 | 95b17aa9-dfd2-48cd-9183-67b838103daa ==============================
[0m09:25:18.153203 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:25:18.153445 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select tmp_aircraft_icao', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'no_print': 'None', 'introspect': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'empty': 'False', 'warn_error': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'debug': 'False'}
[0m09:25:18.969923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95b17aa9-dfd2-48cd-9183-67b838103daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148ccc30>]}
[0m09:25:18.988796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95b17aa9-dfd2-48cd-9183-67b838103daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1457c2360>]}
[0m09:25:18.989012 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:25:19.065573 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:25:19.105813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:25:19.106035 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_aircraft_icao.sql
[0m09:25:19.186401 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:25:19.190957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95b17aa9-dfd2-48cd-9183-67b838103daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145e52150>]}
[0m09:25:19.222685 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:25:19.223546 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:25:19.230599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95b17aa9-dfd2-48cd-9183-67b838103daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1457ce8a0>]}
[0m09:25:19.230788 [info ] [MainThread]: Found 35 models, 9 data tests, 9 sources, 514 macros
[0m09:25:19.230911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95b17aa9-dfd2-48cd-9183-67b838103daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145af52b0>]}
[0m09:25:19.231618 [info ] [MainThread]: 
[0m09:25:19.231743 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:25:19.231837 [info ] [MainThread]: 
[0m09:25:19.232015 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:25:19.232372 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:25:19.232554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:19.657763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:25:19.658238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:19.895175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:25:19.896522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:20.196319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:25:20.198927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:20.489907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95b17aa9-dfd2-48cd-9183-67b838103daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146a1bc70>]}
[0m09:25:20.490750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:25:20.495059 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_aircraft_icao
[0m09:25:20.495743 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_aircraft_icao .............. [RUN]
[0m09:25:20.496174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_aircraft_icao)
[0m09:25:20.496462 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_aircraft_icao
[0m09:25:20.503240 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_aircraft_icao"
[0m09:25:20.503913 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_aircraft_icao
[0m09:25:20.528042 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_aircraft_icao"
[0m09:25:20.528675 [debug] [Thread-1 (]: On model.air_travel.tmp_aircraft_icao: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_aircraft_icao"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_aircraft_icao`
      
    
    

    
    OPTIONS()
    as (
      with tmp_aircraft_icao as (
    select
      name as aircraft_name,
      AI.GENERATE(
        ('What is the icao code of aircraft ', name, '? If it does not have one, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'aircraft_icao STRING') as llm_response
    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
    where icao is null
  )
select aircraft_name, llm_response.aircraft_icao
from tmp_aircraft_icao
    );
  
[0m09:25:20.528903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:21.080285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:17729664-6bdb-4faa-8143-955bffd050e5&page=queryresults
[0m09:25:26.734581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95b17aa9-dfd2-48cd-9183-67b838103daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147164590>]}
[0m09:25:26.735243 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_aircraft_icao ......... [[32mCREATE TABLE (14.0 rows, 6.2 KiB processed)[0m in 6.24s]
[0m09:25:26.735715 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_aircraft_icao
[0m09:25:26.736842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:25:26.738097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:26.738294 [debug] [MainThread]: Connection 'model.air_travel.tmp_aircraft_icao' was properly closed.
[0m09:25:26.738481 [info ] [MainThread]: 
[0m09:25:26.738690 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.51 seconds (7.51s).
[0m09:25:26.739129 [debug] [MainThread]: Command end result
[0m09:25:26.758164 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:25:26.759215 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:25:26.762036 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:25:26.762180 [info ] [MainThread]: 
[0m09:25:26.762360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:25:26.762497 [info ] [MainThread]: 
[0m09:25:26.762647 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:25:26.764820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.637137, "process_in_blocks": "0", "process_kernel_time": 0.25797, "process_mem_max_rss": "393838592", "process_out_blocks": "0", "process_user_time": 1.750704}
[0m09:25:26.765030 [debug] [MainThread]: Command `dbt run` succeeded at 09:25:26.764989 after 8.64 seconds
[0m09:25:26.765200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146ae5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114869810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11486bf70>]}
[0m09:25:26.765358 [debug] [MainThread]: Flushing usage events
[0m09:25:26.988264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:26:44.380017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042906e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050db9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050db750>]}


============================== 09:26:44.381672 | fa86739c-945b-4617-acf2-d135e3771bfd ==============================
[0m09:26:44.381672 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:26:44.381910 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'fail_fast': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select Aircraft', 'printer_width': '80', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'False', 'version_check': 'True', 'quiet': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'debug': 'False'}
[0m09:26:45.196074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa86739c-945b-4617-acf2-d135e3771bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104434c30>]}
[0m09:26:45.214744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa86739c-945b-4617-acf2-d135e3771bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227c2360>]}
[0m09:26:45.214948 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:26:45.288355 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:26:45.328545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:26:45.328773 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Aircraft.sql
[0m09:26:45.408528 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:26:45.413101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa86739c-945b-4617-acf2-d135e3771bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12504e150>]}
[0m09:26:45.445655 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:26:45.446519 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:26:45.453591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa86739c-945b-4617-acf2-d135e3771bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227ce8a0>]}
[0m09:26:45.453768 [info ] [MainThread]: Found 36 models, 9 data tests, 9 sources, 514 macros
[0m09:26:45.453900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa86739c-945b-4617-acf2-d135e3771bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122af12b0>]}
[0m09:26:45.454568 [info ] [MainThread]: 
[0m09:26:45.454696 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:26:45.454792 [info ] [MainThread]: 
[0m09:26:45.454978 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:26:45.455293 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:26:45.455449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:45.804375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:26:45.804864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:46.084519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:26:46.086575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:46.372233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:26:46.374216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:46.658248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa86739c-945b-4617-acf2-d135e3771bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12561fc70>]}
[0m09:26:46.658890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:26:46.662277 [debug] [Thread-1 (]: Began running node model.air_travel.Aircraft
[0m09:26:46.662744 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Aircraft ....................... [RUN]
[0m09:26:46.663081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Aircraft)
[0m09:26:46.663353 [debug] [Thread-1 (]: Began compiling node model.air_travel.Aircraft
[0m09:26:46.669888 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Aircraft"
[0m09:26:46.670685 [debug] [Thread-1 (]: Began executing node model.air_travel.Aircraft
[0m09:26:46.694278 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Aircraft"
[0m09:26:46.694786 [debug] [Thread-1 (]: On model.air_travel.Aircraft: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Aircraft"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
      
    
    

    
    OPTIONS()
    as (
      with Aircraft as (
    select icao, iata, name, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
)

select *
from Aircraft
    );
  
[0m09:26:46.694993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:47.199810 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:022017ca-6968-4213-8f77-3b80e4e290a5&page=queryresults
[0m09:26:48.789923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa86739c-945b-4617-acf2-d135e3771bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125d50590>]}
[0m09:26:48.790615 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Aircraft .................. [[32mCREATE TABLE (246.0 rows, 12.4 KiB processed)[0m in 2.13s]
[0m09:26:48.791092 [debug] [Thread-1 (]: Finished running node model.air_travel.Aircraft
[0m09:26:48.792196 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:26:48.793460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:26:48.793656 [debug] [MainThread]: Connection 'model.air_travel.Aircraft' was properly closed.
[0m09:26:48.793845 [info ] [MainThread]: 
[0m09:26:48.794051 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m09:26:48.794475 [debug] [MainThread]: Command end result
[0m09:26:48.813449 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:26:48.814524 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:26:48.817414 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:26:48.817562 [info ] [MainThread]: 
[0m09:26:48.817742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:26:48.817873 [info ] [MainThread]: 
[0m09:26:48.818024 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:26:48.820190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.465064, "process_in_blocks": "0", "process_kernel_time": 0.249173, "process_mem_max_rss": "399114240", "process_out_blocks": "0", "process_user_time": 1.7239}
[0m09:26:48.820400 [debug] [MainThread]: Command `dbt run` succeeded at 09:26:48.820359 after 4.47 seconds
[0m09:26:48.820556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1256e9ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1256ee350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1256efe30>]}
[0m09:26:48.820701 [debug] [MainThread]: Flushing usage events
[0m09:26:49.030413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:28.862497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108173750>]}


============================== 11:01:28.864116 | 8420113c-7bb2-4066-a36c-0a5172ed7ab8 ==============================
[0m11:01:28.864116 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:01:28.864357 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'partial_parse': 'True', 'printer_width': '80', 'debug': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_cache_events': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'invocation_command': 'dbt run --select Aircraft'}
[0m11:01:29.689015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8420113c-7bb2-4066-a36c-0a5172ed7ab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ccc30>]}
[0m11:01:29.708113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8420113c-7bb2-4066-a36c-0a5172ed7ab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1572c2360>]}
[0m11:01:29.708328 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:01:29.782692 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:01:29.823422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:29.823680 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Aircraft.sql
[0m11:01:29.882152 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.Aircraft' (models/int/Aircraft.sql) depends on a node named 'aircraft_icao' which was not found
[0m11:01:29.883891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0472229, "process_in_blocks": "0", "process_kernel_time": 0.214971, "process_mem_max_rss": "381747200", "process_out_blocks": "0", "process_user_time": 1.308953}
[0m11:01:29.884115 [debug] [MainThread]: Command `dbt run` failed at 11:01:29.884075 after 1.05 seconds
[0m11:01:29.884261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15726b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15726b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158b855e0>]}
[0m11:01:29.884389 [debug] [MainThread]: Flushing usage events
[0m11:01:30.113237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:45.083717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101146e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c73750>]}


============================== 11:01:45.085633 | c5441ecd-d301-4cf3-b7ff-cfc9e5bb08b8 ==============================
[0m11:01:45.085633 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:01:45.085870 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/scohen/.dbt', 'partial_parse': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select Aircraft', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'write_json': 'True', 'empty': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True'}
[0m11:01:45.900712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5441ecd-d301-4cf3-b7ff-cfc9e5bb08b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ccc30>]}
[0m11:01:45.919505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5441ecd-d301-4cf3-b7ff-cfc9e5bb08b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ffbe360>]}
[0m11:01:45.919754 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:01:45.993535 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:01:46.033740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:46.033998 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Aircraft.sql
[0m11:01:46.115300 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:01:46.119919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5441ecd-d301-4cf3-b7ff-cfc9e5bb08b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150552150>]}
[0m11:01:46.152551 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:01:46.153424 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:01:46.160862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5441ecd-d301-4cf3-b7ff-cfc9e5bb08b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ffce8a0>]}
[0m11:01:46.161051 [info ] [MainThread]: Found 36 models, 9 data tests, 9 sources, 514 macros
[0m11:01:46.161170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5441ecd-d301-4cf3-b7ff-cfc9e5bb08b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1502f1ef0>]}
[0m11:01:46.161883 [info ] [MainThread]: 
[0m11:01:46.162008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:46.162102 [info ] [MainThread]: 
[0m11:01:46.162287 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:01:46.162605 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:01:46.162748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:46.534054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:01:46.534598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:46.814392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:01:46.816330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:47.114553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:01:47.117798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:47.401663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5441ecd-d301-4cf3-b7ff-cfc9e5bb08b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1507d1bf0>]}
[0m11:01:47.402210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:47.405530 [debug] [Thread-1 (]: Began running node model.air_travel.Aircraft
[0m11:01:47.406025 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Aircraft ....................... [RUN]
[0m11:01:47.406393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.Aircraft)
[0m11:01:47.406633 [debug] [Thread-1 (]: Began compiling node model.air_travel.Aircraft
[0m11:01:47.412520 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Aircraft"
[0m11:01:47.413094 [debug] [Thread-1 (]: Began executing node model.air_travel.Aircraft
[0m11:01:47.421827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:47.683212 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Aircraft"
[0m11:01:47.683969 [debug] [Thread-1 (]: On model.air_travel.Aircraft: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Aircraft"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
      
    
    

    
    OPTIONS()
    as (
      with Aircraft as (
    select icao, iata, name, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
    where icao is not null
    union all
    select i.icao, a.iata, a.name, a._data_source, a._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_aircraft_icao` i
    on a.name = i.aircraft_name
    where a.icao is null
)

select *
from Aircraft
    );
  
[0m11:01:48.324051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d6a98504-fd13-42c2-9cfe-0e27e4af4bc4&page=queryresults
[0m11:01:48.434527 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d6a98504-fd13-42c2-9cfe-0e27e4af4bc4&page=queryresults
[0m11:01:48.449686 [debug] [Thread-1 (]: Database Error in model Aircraft (models/int/Aircraft.sql)
  Name icao not found inside i at [19:14]
  compiled code at target/run/air_travel/models/int/Aircraft.sql
[0m11:01:48.451558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5441ecd-d301-4cf3-b7ff-cfc9e5bb08b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c22150>]}
[0m11:01:48.452162 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Aircraft .............. [[31mERROR[0m in 1.04s]
[0m11:01:48.452585 [debug] [Thread-1 (]: Finished running node model.air_travel.Aircraft
[0m11:01:48.453013 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Aircraft' to be skipped because of status 'error'.  Reason: Database Error in model Aircraft (models/int/Aircraft.sql)
  Name icao not found inside i at [19:14]
  compiled code at target/run/air_travel/models/int/Aircraft.sql.
[0m11:01:48.454746 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:01:48.456071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:48.456281 [debug] [MainThread]: Connection 'model.air_travel.Aircraft' was properly closed.
[0m11:01:48.456478 [info ] [MainThread]: 
[0m11:01:48.456698 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m11:01:48.457155 [debug] [MainThread]: Command end result
[0m11:01:48.476520 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:01:48.477587 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:01:48.480637 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:01:48.480785 [info ] [MainThread]: 
[0m11:01:48.480956 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:01:48.481090 [info ] [MainThread]: 
[0m11:01:48.481263 [error] [MainThread]: [31mFailure in model Aircraft (models/int/Aircraft.sql)[0m
[0m11:01:48.481422 [error] [MainThread]:   Database Error in model Aircraft (models/int/Aircraft.sql)
  Name icao not found inside i at [19:14]
  compiled code at target/run/air_travel/models/int/Aircraft.sql
[0m11:01:48.481536 [info ] [MainThread]: 
[0m11:01:48.481675 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Aircraft.sql
[0m11:01:48.481788 [info ] [MainThread]: 
[0m11:01:48.481935 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:01:48.484150 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4241455, "process_in_blocks": "0", "process_kernel_time": 0.238958, "process_mem_max_rss": "388235264", "process_out_blocks": "0", "process_user_time": 1.725904}
[0m11:01:48.484359 [debug] [MainThread]: Command `dbt run` failed at 11:01:48.484319 after 3.42 seconds
[0m11:01:48.484533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150cd4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150e32b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150e32df0>]}
[0m11:01:48.484693 [debug] [MainThread]: Flushing usage events
[0m11:01:48.672762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:21.212435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087186e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095639d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109563750>]}


============================== 11:02:21.214076 | 3a8c5bea-fd2f-41a3-8db1-fc972cddd9c3 ==============================
[0m11:02:21.214076 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:02:21.214317 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --select Aircraft', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'printer_width': '80', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'partial_parse': 'True', 'use_colors': 'True'}
[0m11:02:22.031112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a8c5bea-fd2f-41a3-8db1-fc972cddd9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bcc30>]}
[0m11:02:22.050164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a8c5bea-fd2f-41a3-8db1-fc972cddd9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f4be360>]}
[0m11:02:22.050383 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:02:22.124638 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:02:22.164999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:02:22.165241 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Aircraft.sql
[0m11:02:22.246047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:02:22.250698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a8c5bea-fd2f-41a3-8db1-fc972cddd9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa4a150>]}
[0m11:02:22.283456 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:02:22.284316 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:02:22.291772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a8c5bea-fd2f-41a3-8db1-fc972cddd9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f4ce8a0>]}
[0m11:02:22.291976 [info ] [MainThread]: Found 36 models, 9 data tests, 9 sources, 514 macros
[0m11:02:22.292098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a8c5bea-fd2f-41a3-8db1-fc972cddd9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f7f1ef0>]}
[0m11:02:22.292803 [info ] [MainThread]: 
[0m11:02:22.292936 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:22.293034 [info ] [MainThread]: 
[0m11:02:22.293228 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:02:22.293552 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:02:22.293692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:22.742511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:02:22.743059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:23.015009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:02:23.016936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:23.300312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:02:23.303349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:23.569991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a8c5bea-fd2f-41a3-8db1-fc972cddd9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fdcdbf0>]}
[0m11:02:23.570855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:23.575140 [debug] [Thread-1 (]: Began running node model.air_travel.Aircraft
[0m11:02:23.575794 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Aircraft ....................... [RUN]
[0m11:02:23.576250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.Aircraft)
[0m11:02:23.576527 [debug] [Thread-1 (]: Began compiling node model.air_travel.Aircraft
[0m11:02:23.583656 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Aircraft"
[0m11:02:23.584470 [debug] [Thread-1 (]: Began executing node model.air_travel.Aircraft
[0m11:02:23.594468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:23.889422 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Aircraft"
[0m11:02:23.890011 [debug] [Thread-1 (]: On model.air_travel.Aircraft: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Aircraft"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
      
    
    

    
    OPTIONS()
    as (
      with Aircraft as (
    select icao, iata, name, _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
    where icao is not null
    union all
    select i.aircraft_icao as icao, a.iata, a.name, a._data_source, a._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_aircraft_icao` i
    on a.name = i.aircraft_name
    where a.icao is null
)

select *
from Aircraft
    );
  
[0m11:02:24.239738 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5aa21f85-967e-4717-a248-cb0c0f9ef550&page=queryresults
[0m11:02:26.238660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a8c5bea-fd2f-41a3-8db1-fc972cddd9c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139cb0590>]}
[0m11:02:26.239349 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Aircraft .................. [[32mCREATE TABLE (246.0 rows, 12.7 KiB processed)[0m in 2.66s]
[0m11:02:26.239825 [debug] [Thread-1 (]: Finished running node model.air_travel.Aircraft
[0m11:02:26.240939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:26.242339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:26.242564 [debug] [MainThread]: Connection 'model.air_travel.Aircraft' was properly closed.
[0m11:02:26.242767 [info ] [MainThread]: 
[0m11:02:26.242980 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m11:02:26.243418 [debug] [MainThread]: Command end result
[0m11:02:26.262624 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:02:26.263661 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:02:26.266530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:02:26.266669 [info ] [MainThread]: 
[0m11:02:26.266843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:26.266966 [info ] [MainThread]: 
[0m11:02:26.267108 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:02:26.269282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0804744, "process_in_blocks": "0", "process_kernel_time": 0.256351, "process_mem_max_rss": "394461184", "process_out_blocks": "0", "process_user_time": 1.7629}
[0m11:02:26.269496 [debug] [MainThread]: Command `dbt run` succeeded at 11:02:26.269455 after 5.08 seconds
[0m11:02:26.269666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1382e1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108855810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108857f70>]}
[0m11:02:26.269819 [debug] [MainThread]: Flushing usage events
[0m11:02:26.462096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:50:00.323768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068306e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108573750>]}


============================== 11:50:00.325446 | cba2fe43-ff6d-4c18-8866-11e838662a7b ==============================
[0m11:50:00.325446 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:50:00.325696 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'empty': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'cache_selected_only': 'False', 'quiet': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select Route_Equipment', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True'}
[0m11:50:01.149916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cba2fe43-ff6d-4c18-8866-11e838662a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bccc30>]}
[0m11:50:01.168710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cba2fe43-ff6d-4c18-8866-11e838662a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8c2360>]}
[0m11:50:01.168915 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:50:01.244548 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:50:01.285394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:50:01.285623 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Route_Equipment.sql
[0m11:50:01.365953 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:50:01.370575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cba2fe43-ff6d-4c18-8866-11e838662a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe4e150>]}
[0m11:50:01.403262 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:50:01.404128 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:50:01.411414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cba2fe43-ff6d-4c18-8866-11e838662a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8ce8a0>]}
[0m11:50:01.411596 [info ] [MainThread]: Found 37 models, 9 data tests, 9 sources, 514 macros
[0m11:50:01.411721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba2fe43-ff6d-4c18-8866-11e838662a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fbf12b0>]}
[0m11:50:01.412454 [info ] [MainThread]: 
[0m11:50:01.412584 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:50:01.412678 [info ] [MainThread]: 
[0m11:50:01.412866 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:50:01.413221 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:50:01.413381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:01.893821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:50:01.894370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:02.195610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:50:02.197429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:02.465904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:50:02.467692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:02.759651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba2fe43-ff6d-4c18-8866-11e838662a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138e0fc70>]}
[0m11:50:02.760337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:50:02.763731 [debug] [Thread-1 (]: Began running node model.air_travel.Route_Equipment
[0m11:50:02.764261 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Route_Equipment ................ [RUN]
[0m11:50:02.764651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Route_Equipment)
[0m11:50:02.764934 [debug] [Thread-1 (]: Began compiling node model.air_travel.Route_Equipment
[0m11:50:02.771349 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Route_Equipment"
[0m11:50:02.772029 [debug] [Thread-1 (]: Began executing node model.air_travel.Route_Equipment
[0m11:50:02.794905 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Route_Equipment"
[0m11:50:02.795410 [debug] [Thread-1 (]: On model.air_travel.Route_Equipment: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Route_Equipment"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
      
    
    

    
    OPTIONS()
    as (
      with Route_Equipment as (
  select airline_id, source_airport_icao, dest_airport_icao, equipment, _data_source, _load_time
  from (
    select airline_id, source_airport_icao, dest_airport_icao, split(trim(equipment), ' ') as equipment_array,
      _data_source, _load_time
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where equipment is not null) r, unnest(r.equipment_array) as equipment
)

select * 
from Route_Equipment
    );
  
[0m11:50:02.795622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:03.417781 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9badb155-69ec-43e3-863e-c92517671006&page=queryresults
[0m11:50:05.152021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba2fe43-ff6d-4c18-8866-11e838662a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139564650>]}
[0m11:50:05.152619 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Route_Equipment ........... [[32mCREATE TABLE (19.5k rows, 636.2 KiB processed)[0m in 2.39s]
[0m11:50:05.153077 [debug] [Thread-1 (]: Finished running node model.air_travel.Route_Equipment
[0m11:50:05.154026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:50:05.155236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:05.155434 [debug] [MainThread]: Connection 'model.air_travel.Route_Equipment' was properly closed.
[0m11:50:05.155620 [info ] [MainThread]: 
[0m11:50:05.155830 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m11:50:05.156255 [debug] [MainThread]: Command end result
[0m11:50:05.175451 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:50:05.176550 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:50:05.179479 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:50:05.179632 [info ] [MainThread]: 
[0m11:50:05.179810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:05.179940 [info ] [MainThread]: 
[0m11:50:05.180084 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:50:05.182315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8833866, "process_in_blocks": "0", "process_kernel_time": 0.253063, "process_mem_max_rss": "399589376", "process_out_blocks": "0", "process_user_time": 1.737236}
[0m11:50:05.182534 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:05.182492 after 4.88 seconds
[0m11:50:05.182708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138ee9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138ee2b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138ee0d70>]}
[0m11:50:05.182865 [debug] [MainThread]: Flushing usage events
[0m11:50:05.407826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:05.229726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a7750>]}


============================== 11:57:05.231364 | aab52e59-366f-4e73-ae61-917253e2ef13 ==============================
[0m11:57:05.231364 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:57:05.231601 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'introspect': 'True', 'partial_parse': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'printer_width': '80', 'use_colors': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'empty': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select Route_Equipment', 'version_check': 'True'}
[0m11:57:06.067607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aab52e59-366f-4e73-ae61-917253e2ef13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108800c30>]}
[0m11:57:06.086667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aab52e59-366f-4e73-ae61-917253e2ef13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e5be360>]}
[0m11:57:06.086887 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:57:06.163216 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:57:06.204060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:57:06.204321 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Route_Equipment.sql
[0m11:57:06.284364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:57:06.288973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aab52e59-366f-4e73-ae61-917253e2ef13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f64e150>]}
[0m11:57:06.321713 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:57:06.322568 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:57:06.329561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aab52e59-366f-4e73-ae61-917253e2ef13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e5ce8a0>]}
[0m11:57:06.329748 [info ] [MainThread]: Found 37 models, 9 data tests, 9 sources, 514 macros
[0m11:57:06.329870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aab52e59-366f-4e73-ae61-917253e2ef13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1f19b0>]}
[0m11:57:06.330640 [info ] [MainThread]: 
[0m11:57:06.330772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:57:06.330866 [info ] [MainThread]: 
[0m11:57:06.331055 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:57:06.331393 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:57:06.331552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:06.687592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:57:06.688107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:06.961394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:57:06.963296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:07.242515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:57:07.244336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:07.549981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aab52e59-366f-4e73-ae61-917253e2ef13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13850fc70>]}
[0m11:57:07.550838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:57:07.554576 [debug] [Thread-1 (]: Began running node model.air_travel.Route_Equipment
[0m11:57:07.555113 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Route_Equipment ................ [RUN]
[0m11:57:07.555513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Route_Equipment)
[0m11:57:07.555794 [debug] [Thread-1 (]: Began compiling node model.air_travel.Route_Equipment
[0m11:57:07.562468 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Route_Equipment"
[0m11:57:07.563177 [debug] [Thread-1 (]: Began executing node model.air_travel.Route_Equipment
[0m11:57:07.572869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:07.823496 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Route_Equipment"
[0m11:57:07.824351 [debug] [Thread-1 (]: On model.air_travel.Route_Equipment: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Route_Equipment"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
      
    
    

    
    OPTIONS()
    as (
      with Route_Equipment as (
    select airline_id, source_airport_icao, dest_airport_icao, equipment, _data_source, _load_time
    from (
        select airline_id, source_airport_icao, dest_airport_icao, split(trim(equipment), ' ') as equipment_array,
            _data_source, _load_time
        from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
        where equipment is not null) r, unnest(r.equipment_array) as equipment
    )
)

select distinct re.airline_id, re.source_airport_icao, re.dest_airport_icao,
    a.icao as icao_equipment, re._data_source, re._load_time
from Route_Equipment re join air_travel_int.Aircraft a
on re.equipment = a.iata
    );
  
[0m11:57:07.953940 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3acfa8e3-5be0-4097-9e93-9d7661fcbe35&page=queryresults
[0m11:57:07.955228 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3acfa8e3-5be0-4097-9e93-9d7661fcbe35&page=queryresults
[0m11:57:07.968653 [debug] [Thread-1 (]: Database Error in model Route_Equipment (models/int/Route_Equipment.sql)
  Syntax error: Unexpected ")" at [22:1]
  compiled code at target/run/air_travel/models/int/Route_Equipment.sql
[0m11:57:07.970869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aab52e59-366f-4e73-ae61-917253e2ef13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138521b50>]}
[0m11:57:07.971534 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Route_Equipment ....... [[31mERROR[0m in 0.41s]
[0m11:57:07.972030 [debug] [Thread-1 (]: Finished running node model.air_travel.Route_Equipment
[0m11:57:07.972424 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Route_Equipment' to be skipped because of status 'error'.  Reason: Database Error in model Route_Equipment (models/int/Route_Equipment.sql)
  Syntax error: Unexpected ")" at [22:1]
  compiled code at target/run/air_travel/models/int/Route_Equipment.sql.
[0m11:57:07.973711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:57:07.974915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:07.975105 [debug] [MainThread]: Connection 'model.air_travel.Route_Equipment' was properly closed.
[0m11:57:07.975293 [info ] [MainThread]: 
[0m11:57:07.975503 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m11:57:07.975921 [debug] [MainThread]: Command end result
[0m11:57:07.995717 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:57:07.996762 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:57:07.999902 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:57:08.000065 [info ] [MainThread]: 
[0m11:57:08.000237 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:57:08.000372 [info ] [MainThread]: 
[0m11:57:08.000546 [error] [MainThread]: [31mFailure in model Route_Equipment (models/int/Route_Equipment.sql)[0m
[0m11:57:08.000701 [error] [MainThread]:   Database Error in model Route_Equipment (models/int/Route_Equipment.sql)
  Syntax error: Unexpected ")" at [22:1]
  compiled code at target/run/air_travel/models/int/Route_Equipment.sql
[0m11:57:08.000817 [info ] [MainThread]: 
[0m11:57:08.000955 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Route_Equipment.sql
[0m11:57:08.001069 [info ] [MainThread]: 
[0m11:57:08.001218 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:57:08.003474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7972007, "process_in_blocks": "0", "process_kernel_time": 0.241819, "process_mem_max_rss": "387825664", "process_out_blocks": "0", "process_user_time": 1.739851}
[0m11:57:08.003699 [debug] [MainThread]: Command `dbt run` failed at 11:57:08.003658 after 2.80 seconds
[0m11:57:08.003874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1385dc890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138632e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138632d50>]}
[0m11:57:08.004031 [debug] [MainThread]: Flushing usage events
[0m11:57:08.215832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:32.993192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11192c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b73750>]}


============================== 11:58:32.994819 | df850f4d-47b1-4c35-b5dc-2e71192e3edd ==============================
[0m11:58:32.994819 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:58:32.995066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'invocation_command': 'dbt run --select Route_Equipment', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'quiet': 'False', 'empty': 'False', 'no_print': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'cache_selected_only': 'False', 'fail_fast': 'False', 'introspect': 'True'}
[0m11:58:33.811549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df850f4d-47b1-4c35-b5dc-2e71192e3edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111accc30>]}
[0m11:58:33.830422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df850f4d-47b1-4c35-b5dc-2e71192e3edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8be360>]}
[0m11:58:33.830627 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:58:33.904411 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:58:33.944602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:33.944849 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Route_Equipment.sql
[0m11:58:34.024377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:58:34.028950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df850f4d-47b1-4c35-b5dc-2e71192e3edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158852150>]}
[0m11:58:34.061147 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:58:34.061981 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:58:34.069101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df850f4d-47b1-4c35-b5dc-2e71192e3edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8ce8a0>]}
[0m11:58:34.069281 [info ] [MainThread]: Found 37 models, 9 data tests, 9 sources, 514 macros
[0m11:58:34.069400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df850f4d-47b1-4c35-b5dc-2e71192e3edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbf19b0>]}
[0m11:58:34.070114 [info ] [MainThread]: 
[0m11:58:34.070243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:34.070336 [info ] [MainThread]: 
[0m11:58:34.070520 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:58:34.070871 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:58:34.071058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:34.515980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:58:34.516513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:34.784042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:58:34.786982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:35.089925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:58:35.092365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:35.367654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df850f4d-47b1-4c35-b5dc-2e71192e3edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158dabad0>]}
[0m11:58:35.368252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:35.371536 [debug] [Thread-1 (]: Began running node model.air_travel.Route_Equipment
[0m11:58:35.372077 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Route_Equipment ................ [RUN]
[0m11:58:35.372459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.Route_Equipment)
[0m11:58:35.372740 [debug] [Thread-1 (]: Began compiling node model.air_travel.Route_Equipment
[0m11:58:35.379019 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Route_Equipment"
[0m11:58:35.379615 [debug] [Thread-1 (]: Began executing node model.air_travel.Route_Equipment
[0m11:58:35.388761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:35.668648 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Route_Equipment"
[0m11:58:35.669198 [debug] [Thread-1 (]: On model.air_travel.Route_Equipment: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Route_Equipment"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
      
    
    

    
    OPTIONS()
    as (
      with Route_Equipment as (
    select airline_id, source_airport_icao, dest_airport_icao, equipment, _data_source, _load_time
    from (
        select airline_id, source_airport_icao, dest_airport_icao, split(trim(equipment), ' ') as equipment_array,
            _data_source, _load_time
        from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
        where equipment is not null) r, unnest(r.equipment_array) as equipment
)

select distinct re.airline_id, re.source_airport_icao, re.dest_airport_icao,
    a.icao as icao_equipment, re._data_source, re._load_time
from Route_Equipment re join air_travel_int.Aircraft a
on re.equipment = a.iata
    );
  
[0m11:58:36.449312 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d7b1e4b8-83cf-44d8-912a-31263e8dfa48&page=queryresults
[0m11:58:38.196945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df850f4d-47b1-4c35-b5dc-2e71192e3edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15afbc650>]}
[0m11:58:38.197319 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Route_Equipment ........... [[32mCREATE TABLE (15.7k rows, 638.7 KiB processed)[0m in 2.82s]
[0m11:58:38.197614 [debug] [Thread-1 (]: Finished running node model.air_travel.Route_Equipment
[0m11:58:38.198294 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:38.199130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:38.199268 [debug] [MainThread]: Connection 'model.air_travel.Route_Equipment' was properly closed.
[0m11:58:38.199393 [info ] [MainThread]: 
[0m11:58:38.199528 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m11:58:38.199805 [debug] [MainThread]: Command end result
[0m11:58:38.213997 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:58:38.214958 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:58:38.217582 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:58:38.217732 [info ] [MainThread]: 
[0m11:58:38.217883 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:38.217993 [info ] [MainThread]: 
[0m11:58:38.218119 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:58:38.219956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.2507243, "process_in_blocks": "0", "process_kernel_time": 0.255069, "process_mem_max_rss": "397672448", "process_out_blocks": "0", "process_user_time": 1.730453}
[0m11:58:38.220142 [debug] [MainThread]: Command `dbt run` succeeded at 11:58:38.220105 after 5.25 seconds
[0m11:58:38.220278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158de9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158df3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158df2b70>]}
[0m11:58:38.220410 [debug] [MainThread]: Flushing usage events
[0m11:58:38.426878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:01:31.428733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c673750>]}


============================== 12:01:31.430489 | 10e2173c-4635-44c7-a5cd-447f1b6c5942 ==============================
[0m12:01:31.430489 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:01:31.430738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'use_colors': 'True', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select Flight_Delays', 'quiet': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'debug': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m12:01:32.249160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10e2173c-4635-44c7-a5cd-447f1b6c5942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ccc30>]}
[0m12:01:32.268379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10e2173c-4635-44c7-a5cd-447f1b6c5942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169cc2360>]}
[0m12:01:32.268600 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:01:32.344840 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:01:32.385498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:01:32.385727 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Flight_Delays.sql
[0m12:01:32.467017 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:01:32.471644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10e2173c-4635-44c7-a5cd-447f1b6c5942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a252150>]}
[0m12:01:32.504754 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:01:32.505618 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:01:32.512846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10e2173c-4635-44c7-a5cd-447f1b6c5942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169cce8a0>]}
[0m12:01:32.513043 [info ] [MainThread]: Found 38 models, 9 data tests, 9 sources, 514 macros
[0m12:01:32.513168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10e2173c-4635-44c7-a5cd-447f1b6c5942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169ef52b0>]}
[0m12:01:32.513910 [info ] [MainThread]: 
[0m12:01:32.514037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:01:32.514130 [info ] [MainThread]: 
[0m12:01:32.514311 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:01:32.514650 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:01:32.514799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:32.897089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:01:32.897654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:33.180122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:01:33.181985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:33.452269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:01:33.455441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:33.723630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10e2173c-4635-44c7-a5cd-447f1b6c5942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a61bc70>]}
[0m12:01:33.724243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:33.727500 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Delays
[0m12:01:33.728037 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Flight_Delays .................. [RUN]
[0m12:01:33.728429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.Flight_Delays)
[0m12:01:33.728709 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Delays
[0m12:01:33.735587 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Delays"
[0m12:01:33.736385 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Delays
[0m12:01:33.759415 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Flight_Delays"
[0m12:01:33.759937 [debug] [Thread-1 (]: On model.air_travel.Flight_Delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Flight_Delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
      
    
    

    
    OPTIONS()
    as (
      with Flight_Delays as (
  select distinct fd.event_month, al.id as airline_id, ap.icao as airport_icao,
    fd.arr_total, fd.arr_cancelled, fd.arr_diverted, fd.arr_delay_min,
    fd.weather_delay_min, fd.nas_delay_min, fd.late_aircraft_delay_min,
    fd._data_source, fd._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays` fd 
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap on fd.airport_code = ap.iata
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al on fd.carrier_name = al.name
  where ap.country_code = 'US'
  and fd.arr_total is not null
)

select *
from Flight_Delays
    );
  
[0m12:01:33.760153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:34.730591 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7382ff20-5cbc-456b-8b81-542ae95b1fa9&page=queryresults
[0m12:01:37.573238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10e2173c-4635-44c7-a5cd-447f1b6c5942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b548950>]}
[0m12:01:37.573851 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Flight_Delays ............. [[32mCREATE TABLE (0.0 rows, 43.9 MiB processed)[0m in 3.84s]
[0m12:01:37.574269 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Delays
[0m12:01:37.575340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:01:37.576601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:37.576797 [debug] [MainThread]: Connection 'model.air_travel.Flight_Delays' was properly closed.
[0m12:01:37.576985 [info ] [MainThread]: 
[0m12:01:37.577192 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m12:01:37.577637 [debug] [MainThread]: Command end result
[0m12:01:37.596403 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:01:37.597469 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:01:37.600398 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:01:37.600549 [info ] [MainThread]: 
[0m12:01:37.600731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:01:37.600870 [info ] [MainThread]: 
[0m12:01:37.601027 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:01:37.603209 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1988006, "process_in_blocks": "0", "process_kernel_time": 0.262141, "process_mem_max_rss": "397328384", "process_out_blocks": "0", "process_user_time": 1.760164}
[0m12:01:37.603411 [debug] [MainThread]: Command `dbt run` succeeded at 12:01:37.603371 after 6.20 seconds
[0m12:01:37.603567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a6e5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a6e3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a6e3f70>]}
[0m12:01:37.603714 [debug] [MainThread]: Flushing usage events
[0m12:01:37.814182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:51.836285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f73c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f739d0>]}


============================== 12:05:51.837927 | 3403a846-df74-4d4b-b9d4-83bbf259145e ==============================
[0m12:05:51.837927 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:05:51.838170 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'printer_width': '80', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'invocation_command': 'dbt docs generate', 'profiles_dir': '/Users/scohen/.dbt', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_format': 'default', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m12:05:52.653864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3403a846-df74-4d4b-b9d4-83bbf259145e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104accc30>]}
[0m12:05:52.672548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3403a846-df74-4d4b-b9d4-83bbf259145e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5be360>]}
[0m12:05:52.672752 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:05:52.748487 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:05:52.788810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:52.788954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:52.791317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:05:52.805345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3403a846-df74-4d4b-b9d4-83bbf259145e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c56b050>]}
[0m12:05:52.814072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3403a846-df74-4d4b-b9d4-83bbf259145e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cd64230>]}
[0m12:05:52.814260 [info ] [MainThread]: Found 38 models, 9 data tests, 9 sources, 514 macros
[0m12:05:52.814387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3403a846-df74-4d4b-b9d4-83bbf259145e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cbe2eb0>]}
[0m12:05:52.815521 [info ] [MainThread]: 
[0m12:05:52.815651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:05:52.815745 [info ] [MainThread]: 
[0m12:05:52.815927 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:05:52.818076 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:05:52.818241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:53.102073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:05:53.104431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:53.382962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:05:53.384907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:53.687626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3403a846-df74-4d4b-b9d4-83bbf259145e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cd4b110>]}
[0m12:05:53.688217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:53.691608 [debug] [Thread-1 (]: Began running node model.air_travel.aircrafts
[0m12:05:53.692046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.aircrafts)
[0m12:05:53.692356 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircrafts
[0m12:05:53.700204 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircrafts"
[0m12:05:53.700811 [debug] [Thread-1 (]: Began executing node model.air_travel.aircrafts
[0m12:05:53.701042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.702243 [debug] [Thread-1 (]: Finished running node model.air_travel.aircrafts
[0m12:05:53.702479 [debug] [Thread-1 (]: Began running node model.air_travel.airlines
[0m12:05:53.702753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircrafts, now model.air_travel.airlines)
[0m12:05:53.703054 [debug] [Thread-1 (]: Began compiling node model.air_travel.airlines
[0m12:05:53.704791 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airlines"
[0m12:05:53.705217 [debug] [Thread-1 (]: Began executing node model.air_travel.airlines
[0m12:05:53.705430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.706472 [debug] [Thread-1 (]: Finished running node model.air_travel.airlines
[0m12:05:53.706673 [debug] [Thread-1 (]: Began running node model.air_travel.airport_maps
[0m12:05:53.706910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airlines, now model.air_travel.airport_maps)
[0m12:05:53.707089 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_maps
[0m12:05:53.708696 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_maps"
[0m12:05:53.709003 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_maps
[0m12:05:53.709177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.710086 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_maps
[0m12:05:53.710273 [debug] [Thread-1 (]: Began running node model.air_travel.airport_reviews
[0m12:05:53.710463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_maps, now model.air_travel.airport_reviews)
[0m12:05:53.710659 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_reviews
[0m12:05:53.711918 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_reviews"
[0m12:05:53.712221 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_reviews
[0m12:05:53.712393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.713291 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_reviews
[0m12:05:53.713475 [debug] [Thread-1 (]: Began running node model.air_travel.airports
[0m12:05:53.713686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_reviews, now model.air_travel.airports)
[0m12:05:53.713852 [debug] [Thread-1 (]: Began compiling node model.air_travel.airports
[0m12:05:53.715285 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airports"
[0m12:05:53.715550 [debug] [Thread-1 (]: Began executing node model.air_travel.airports
[0m12:05:53.715704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.716519 [debug] [Thread-1 (]: Finished running node model.air_travel.airports
[0m12:05:53.716683 [debug] [Thread-1 (]: Began running node model.air_travel.countries
[0m12:05:53.716884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airports, now model.air_travel.countries)
[0m12:05:53.717035 [debug] [Thread-1 (]: Began compiling node model.air_travel.countries
[0m12:05:53.718128 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.countries"
[0m12:05:53.718385 [debug] [Thread-1 (]: Began executing node model.air_travel.countries
[0m12:05:53.718533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.719318 [debug] [Thread-1 (]: Finished running node model.air_travel.countries
[0m12:05:53.719483 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m12:05:53.719667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.countries, now model.air_travel.flight_delays)
[0m12:05:53.719819 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m12:05:53.720976 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m12:05:53.721221 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m12:05:53.721370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.722128 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m12:05:53.722279 [debug] [Thread-1 (]: Began running node model.air_travel.flight_routes
[0m12:05:53.722447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_delays, now model.air_travel.flight_routes)
[0m12:05:53.722588 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_routes
[0m12:05:53.723888 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_routes"
[0m12:05:53.724133 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_routes
[0m12:05:53.724274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.725011 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_routes
[0m12:05:53.725165 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m12:05:53.725341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_routes, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m12:05:53.725513 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m12:05:53.726314 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m12:05:53.726607 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m12:05:53.726757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.727539 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m12:05:53.727700 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_traffic
[0m12:05:53.727868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_canonical_categories, now model.air_travel.tsa_traffic)
[0m12:05:53.728007 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_traffic
[0m12:05:53.729377 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_traffic"
[0m12:05:53.729833 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_traffic
[0m12:05:53.729978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.730692 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_traffic
[0m12:05:53.730844 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_aircraft_icao
[0m12:05:53.731003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tsa_traffic, now model.air_travel.tmp_aircraft_icao)
[0m12:05:53.731155 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_aircraft_icao
[0m12:05:53.732141 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_aircraft_icao"
[0m12:05:53.732370 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_aircraft_icao
[0m12:05:53.732502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.733178 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_aircraft_icao
[0m12:05:53.733325 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:05:53.733477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_aircraft_icao, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m12:05:53.733616 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:05:53.737672 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m12:05:53.738236 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:05:53.738374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.739083 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m12:05:53.739224 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:05:53.739371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc, now test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d)
[0m12:05:53.739501 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:05:53.741190 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m12:05:53.741437 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:05:53.741568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.742215 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m12:05:53.742351 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m12:05:53.742484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d, now model.air_travel.tmp_airport_establishment_unique)
[0m12:05:53.742608 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m12:05:53.743474 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m12:05:53.743840 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m12:05:53.743964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.744880 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m12:05:53.745018 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:05:53.745165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_unique, now test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510)
[0m12:05:53.745310 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:05:53.746955 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m12:05:53.747162 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:05:53.747286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.747920 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m12:05:53.748053 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:05:53.748183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510, now test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587)
[0m12:05:53.748308 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:05:53.749900 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m12:05:53.750120 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:05:53.750242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.750859 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m12:05:53.750990 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_llm
[0m12:05:53.751378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587, now model.air_travel.tmp_airport_llm)
[0m12:05:53.751507 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_llm
[0m12:05:53.752442 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_llm"
[0m12:05:53.752783 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_llm
[0m12:05:53.752900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.753502 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_llm
[0m12:05:53.753630 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:05:53.753762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_llm, now test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0)
[0m12:05:53.753906 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:05:53.755538 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m12:05:53.755934 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:05:53.756060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.756701 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m12:05:53.756837 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_country_iso_codes
[0m12:05:53.756975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0, now model.air_travel.tmp_country_iso_codes)
[0m12:05:53.757107 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_country_iso_codes
[0m12:05:53.758269 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_country_iso_codes"
[0m12:05:53.758618 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_country_iso_codes
[0m12:05:53.758737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.759340 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_country_iso_codes
[0m12:05:53.759468 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:05:53.759625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_country_iso_codes, now test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414)
[0m12:05:53.759740 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:05:53.761256 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m12:05:53.761453 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:05:53.761569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.762159 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m12:05:53.762288 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:05:53.762418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414, now test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823)
[0m12:05:53.762550 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:05:53.764291 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m12:05:53.764513 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:05:53.764627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.765225 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m12:05:53.765350 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:05:53.765473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823, now test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81)
[0m12:05:53.765588 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:05:53.767043 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m12:05:53.767254 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:05:53.767370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.767942 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m12:05:53.768067 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:05:53.768186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81, now test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee)
[0m12:05:53.768299 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:05:53.769920 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m12:05:53.770107 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:05:53.770220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.770786 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m12:05:53.770907 [debug] [Thread-1 (]: Began running node model.air_travel.Aircraft
[0m12:05:53.771023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee, now model.air_travel.Aircraft)
[0m12:05:53.771135 [debug] [Thread-1 (]: Began compiling node model.air_travel.Aircraft
[0m12:05:53.772043 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Aircraft"
[0m12:05:53.772230 [debug] [Thread-1 (]: Began executing node model.air_travel.Aircraft
[0m12:05:53.772336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.772903 [debug] [Thread-1 (]: Finished running node model.air_travel.Aircraft
[0m12:05:53.773022 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_raw_categories
[0m12:05:53.773142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Aircraft, now model.air_travel.tmp_airport_establishment_raw_categories)
[0m12:05:53.773253 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_raw_categories
[0m12:05:53.773993 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m12:05:53.774188 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_raw_categories
[0m12:05:53.774301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.776061 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_raw_categories
[0m12:05:53.776182 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m12:05:53.776311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_raw_categories, now model.air_travel.tmp_airport_all)
[0m12:05:53.776453 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_all
[0m12:05:53.777294 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_all"
[0m12:05:53.777491 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_all
[0m12:05:53.777601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.778155 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m12:05:53.778276 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m12:05:53.778418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_all, now model.air_travel.Country)
[0m12:05:53.778531 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m12:05:53.779359 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m12:05:53.779562 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m12:05:53.779674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.780231 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m12:05:53.780355 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m12:05:53.780494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Country, now model.air_travel.tmp_airport_establishment_broad_categories_mapped)
[0m12:05:53.780612 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m12:05:53.781743 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_mapped"
[0m12:05:53.782062 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m12:05:53.782164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.782685 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m12:05:53.782796 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates
[0m12:05:53.782917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_broad_categories_mapped, now model.air_travel.tmp_airport_duplicates)
[0m12:05:53.783047 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates
[0m12:05:53.783872 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates"
[0m12:05:53.784084 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates
[0m12:05:53.784193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.784734 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates
[0m12:05:53.784848 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airline_country_mapped
[0m12:05:53.784970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates, now model.air_travel.tmp_airline_country_mapped)
[0m12:05:53.785114 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airline_country_mapped
[0m12:05:53.786208 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airline_country_mapped"
[0m12:05:53.786388 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airline_country_mapped
[0m12:05:53.786490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.787020 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airline_country_mapped
[0m12:05:53.787133 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m12:05:53.787262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airline_country_mapped, now model.air_travel.tmp_airport_establishment_sub_categories_mapped)
[0m12:05:53.787401 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m12:05:53.788314 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_sub_categories_mapped"
[0m12:05:53.788496 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m12:05:53.788599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.789115 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m12:05:53.789226 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates_embeddings
[0m12:05:53.789369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_sub_categories_mapped, now model.air_travel.tmp_airport_duplicates_embeddings)
[0m12:05:53.789493 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates_embeddings
[0m12:05:53.790273 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m12:05:53.790447 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates_embeddings
[0m12:05:53.790551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.791262 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates_embeddings
[0m12:05:53.791375 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results
[0m12:05:53.791485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates_embeddings, now model.air_travel.tmp_airport_inference_results)
[0m12:05:53.791587 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results
[0m12:05:53.792385 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results"
[0m12:05:53.792561 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results
[0m12:05:53.792662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.793163 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results
[0m12:05:53.793271 [debug] [Thread-1 (]: Began running node model.air_travel.Airline
[0m12:05:53.793383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results, now model.air_travel.Airline)
[0m12:05:53.793500 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airline
[0m12:05:53.794345 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airline"
[0m12:05:53.794518 [debug] [Thread-1 (]: Began executing node model.air_travel.Airline
[0m12:05:53.794617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.795115 [debug] [Thread-1 (]: Finished running node model.air_travel.Airline
[0m12:05:53.795225 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Establishment
[0m12:05:53.795341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airline, now model.air_travel.Airport_Establishment)
[0m12:05:53.795440 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Establishment
[0m12:05:53.796379 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Establishment"
[0m12:05:53.796553 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Establishment
[0m12:05:53.796652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.797157 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Establishment
[0m12:05:53.797280 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results_embeddings
[0m12:05:53.797394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Establishment, now model.air_travel.tmp_airport_inference_results_embeddings)
[0m12:05:53.797526 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results_embeddings
[0m12:05:53.798311 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results_embeddings"
[0m12:05:53.798478 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results_embeddings
[0m12:05:53.798578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.799088 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results_embeddings
[0m12:05:53.799206 [debug] [Thread-1 (]: Began running node model.air_travel.Food_Beverage
[0m12:05:53.799343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results_embeddings, now model.air_travel.Food_Beverage)
[0m12:05:53.799463 [debug] [Thread-1 (]: Began compiling node model.air_travel.Food_Beverage
[0m12:05:53.800379 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Food_Beverage"
[0m12:05:53.800554 [debug] [Thread-1 (]: Began executing node model.air_travel.Food_Beverage
[0m12:05:53.800665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.801186 [debug] [Thread-1 (]: Finished running node model.air_travel.Food_Beverage
[0m12:05:53.801296 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_vector_search_results
[0m12:05:53.801405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Food_Beverage, now model.air_travel.tmp_airport_vector_search_results)
[0m12:05:53.801504 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_vector_search_results
[0m12:05:53.802366 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_vector_search_results"
[0m12:05:53.802544 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_vector_search_results
[0m12:05:53.802647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.803159 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_vector_search_results
[0m12:05:53.803373 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m12:05:53.803517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_vector_search_results, now model.air_travel.tmp_airport_refined)
[0m12:05:53.803637 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_refined
[0m12:05:53.804516 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_refined"
[0m12:05:53.804684 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_refined
[0m12:05:53.804784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.805293 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m12:05:53.805484 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_iso_codes
[0m12:05:53.805613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_refined, now model.air_travel.tmp_airport_country_iso_codes)
[0m12:05:53.805721 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_iso_codes
[0m12:05:53.806757 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_iso_codes"
[0m12:05:53.807163 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_iso_codes
[0m12:05:53.807266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.807769 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_iso_codes
[0m12:05:53.807962 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m12:05:53.808076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_country_iso_codes, now model.air_travel.Airport)
[0m12:05:53.808185 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m12:05:53.809107 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m12:05:53.809293 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m12:05:53.809398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.809932 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m12:05:53.810137 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Concessions
[0m12:05:53.810259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport, now model.air_travel.Airport_Concessions)
[0m12:05:53.810366 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Concessions
[0m12:05:53.811334 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Concessions"
[0m12:05:53.811517 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Concessions
[0m12:05:53.811619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.812121 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Concessions
[0m12:05:53.812227 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Reviews
[0m12:05:53.812335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Concessions, now model.air_travel.Airport_Reviews)
[0m12:05:53.812432 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Reviews
[0m12:05:53.813162 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Reviews"
[0m12:05:53.813324 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Reviews
[0m12:05:53.813420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.813907 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Reviews
[0m12:05:53.814013 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Delays
[0m12:05:53.814116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Reviews, now model.air_travel.Flight_Delays)
[0m12:05:53.814211 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Delays
[0m12:05:53.815166 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Delays"
[0m12:05:53.815332 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Delays
[0m12:05:53.815431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.815917 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Delays
[0m12:05:53.816024 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Routes
[0m12:05:53.816126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Flight_Delays, now model.air_travel.Flight_Routes)
[0m12:05:53.816223 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Routes
[0m12:05:53.817065 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Routes"
[0m12:05:53.817222 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Routes
[0m12:05:53.817318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.817812 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Routes
[0m12:05:53.817917 [debug] [Thread-1 (]: Began running node model.air_travel.TSA_Traffic
[0m12:05:53.818058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Flight_Routes, now model.air_travel.TSA_Traffic)
[0m12:05:53.818167 [debug] [Thread-1 (]: Began compiling node model.air_travel.TSA_Traffic
[0m12:05:53.818902 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.TSA_Traffic"
[0m12:05:53.819189 [debug] [Thread-1 (]: Began executing node model.air_travel.TSA_Traffic
[0m12:05:53.819286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.819772 [debug] [Thread-1 (]: Finished running node model.air_travel.TSA_Traffic
[0m12:05:53.819879 [debug] [Thread-1 (]: Began running node model.air_travel.Route_Equipment
[0m12:05:53.819982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.TSA_Traffic, now model.air_travel.Route_Equipment)
[0m12:05:53.820076 [debug] [Thread-1 (]: Began compiling node model.air_travel.Route_Equipment
[0m12:05:53.820945 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Route_Equipment"
[0m12:05:53.821102 [debug] [Thread-1 (]: Began executing node model.air_travel.Route_Equipment
[0m12:05:53.821213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:53.821699 [debug] [Thread-1 (]: Finished running node model.air_travel.Route_Equipment
[0m12:05:53.822050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:53.822203 [debug] [MainThread]: Connection 'model.air_travel.Route_Equipment' was properly closed.
[0m12:05:53.823947 [debug] [MainThread]: Command end result
[0m12:05:53.937992 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:05:53.938880 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:05:53.941689 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:05:53.943515 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:05:53.943616 [info ] [MainThread]: Building catalog
[0m12:05:53.946732 [debug] [ThreadPool]: Acquiring new bigquery connection 'cs378-fa2025.information_schema'
[0m12:05:53.953981 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_stg`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('tsa_traffic')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('flight_delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airports')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('aircrafts')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('flight_routes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('countries')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airlines')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airport_reviews')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airport_maps')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:05:53.954357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:54.539402 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5fdbc62c-e438-4626-b8a9-2b5b37a190d3&page=queryresults
[0m12:05:56.096810 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_tmp`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_country_iso_codes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_raw_categories')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_duplicates_embeddings')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_inference_results')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_sub_categories_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_broad_categories_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_inference_results_embeddings')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airline_country_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_vector_search_results')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_aircraft_icao')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_refined')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_duplicates')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_llm')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_canonical_categories')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_all')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_country_iso_codes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_unique')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:05:56.097690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:56.568500 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:63a60fe5-139d-4aa6-97da-fa80be43f804&page=queryresults
[0m12:05:58.294058 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_int`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Establishment')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Flight_Delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Reviews')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Food_Beverage')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airline')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Concessions')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('TSA_Traffic')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Aircraft')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Flight_Routes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Country')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Route_Equipment')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:05:58.295218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:58.720231 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:010adc50-6f3c-43f6-bc21-f709efbf4cba&page=queryresults
[0m12:06:00.167968 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`air_travel_raw`.__TABLES__ tables
    left join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('tsa_traffic')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('aircrafts')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airport_reviews')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('countries')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airlines')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('flight_routes')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('flight_delays')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airport_maps')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airports')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:06:00.168601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:00.663926 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:fe4cedaf-960d-4827-af5f-58e8552f4b9c&page=queryresults
[0m12:06:02.595778 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:06:02.606813 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/scohen/UTCS/378/dbt/air_travel/target/catalog.json
[0m12:06:02.620546 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:06:02.621277 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:06:02.621387 [info ] [MainThread]: Catalog written to /Users/scohen/UTCS/378/dbt/air_travel/target/catalog.json
[0m12:06:02.623263 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 10.81069, "process_in_blocks": "0", "process_kernel_time": 0.270175, "process_mem_max_rss": "389185536", "process_out_blocks": "0", "process_user_time": 2.125572}
[0m12:06:02.623448 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:06:02.623412 after 10.81 seconds
[0m12:06:02.623554 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:06:02.623642 [debug] [MainThread]: Connection 'cs378-fa2025.information_schema' was properly closed.
[0m12:06:02.623746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e78ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c3bfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c3bfe30>]}
[0m12:06:02.623877 [debug] [MainThread]: Flushing usage events
[0m12:06:02.846583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:06:19.373590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109073c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090739d0>]}


============================== 12:06:19.375358 | e9cab012-ed87-44d1-bfda-1083babd4b4f ==============================
[0m12:06:19.375358 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:06:19.375638 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'empty': 'None', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'invocation_command': 'dbt docs serve --port 8181', 'write_json': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True'}
[0m12:06:20.195041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9cab012-ed87-44d1-bfda-1083babd4b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10825cc30>]}
[0m12:06:20.214476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9cab012-ed87-44d1-bfda-1083babd4b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0ba360>]}
[0m22:10:28.321259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1d06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b01b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b01b750>]}


============================== 22:10:28.323839 | 6577024d-fa24-4abd-90ef-02be4be94988 ==============================
[0m22:10:28.323839 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m22:10:28.324070 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'empty': 'False', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select flight_delays', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True'}
[0m22:10:30.085943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6577024d-fa24-4abd-90ef-02be4be94988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a374c30>]}
[0m22:10:30.104971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6577024d-fa24-4abd-90ef-02be4be94988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fbe360>]}
[0m22:10:30.105191 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m22:10:30.193699 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m22:10:30.249919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:10:30.250191 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/stg/flight_delays.sql
[0m22:10:30.373582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m22:10:30.378165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6577024d-fa24-4abd-90ef-02be4be94988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121824850>]}
[0m22:10:30.413163 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:10:30.414442 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:10:30.426251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6577024d-fa24-4abd-90ef-02be4be94988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fce8a0>]}
[0m22:10:30.426465 [info ] [MainThread]: Found 38 models, 9 data tests, 9 sources, 514 macros
[0m22:10:30.426597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6577024d-fa24-4abd-90ef-02be4be94988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12113e510>]}
[0m22:10:30.427394 [info ] [MainThread]: 
[0m22:10:30.427528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:10:30.427620 [info ] [MainThread]: 
[0m22:10:30.427816 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:10:30.428176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m22:10:30.428335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:30.779656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m22:10:30.780184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:31.073751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m22:10:31.075932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:31.376537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m22:10:31.378337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:31.665658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6577024d-fa24-4abd-90ef-02be4be94988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121734c80>]}
[0m22:10:31.666186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:31.670782 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m22:10:31.671222 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_stg.flight_delays .................. [RUN]
[0m22:10:31.671560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.flight_delays)
[0m22:10:31.671824 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m22:10:31.678093 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m22:10:31.678658 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m22:10:31.687601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:31.990450 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.flight_delays"
[0m22:10:31.991209 [debug] [Thread-1 (]: On model.air_travel.flight_delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.flight_delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`
      
    
    

    
    OPTIONS()
    as (
      with stg_flight_delays as (
    select event_month, carrier, carrier_name, airport_code,
        split(city_state, ',')[0] as airport_city, 
        split(city_state, ',')[1] as airport_state,
        airport_name, 
        * except (event_month, carrier, carrier_name, airport_code, airport_name, city_state)
    from
        (select date(year, month, 01) as event_month, 
            carrier, carrier_name, airport as airport_code,
            split(airport_name, ':')[0] as city_state, 
            split(airport_name, ':')[1] as airport_name,
            safe_cast(arr_flights as INTEGER) as arr_total, 
            safe_cast(arr_cancelled as INTEGER) as arr_cancelled,
            safe_cast(arr_diverted as INTEGER) as arr_diverted, 
            safe_cast(arr_delay as INTEGER) as arr_delay_min,
            safe_cast(carrier_delay as INTEGER) as carrier_delay_min, 
            safe_cast(weather_delay as INTEGER) as weather_delay_min, 
            safe_cast(nas_delay as INTEGER) as nas_delay_min,
            safe_cast(late_aircraft_delay as INTEGER) as late_aircraft_delay_min, 
            _data_source, _load_time
          from `cs378-fa2025`.`air_travel_raw`.`flight_delays`)
)

select * from stg_flight_delays
    );
  
[0m22:10:32.513335 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c69df71b-bb12-49f2-8738-f0e678212889&page=queryresults
[0m22:10:37.840402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6577024d-fa24-4abd-90ef-02be4be94988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12173d010>]}
[0m22:10:37.840960 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_stg.flight_delays ............. [[32mCREATE TABLE (381.2k rows, 67.0 MiB processed)[0m in 6.17s]
[0m22:10:37.841380 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m22:10:37.842336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:37.843421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:37.843592 [debug] [MainThread]: Connection 'model.air_travel.flight_delays' was properly closed.
[0m22:10:37.843754 [info ] [MainThread]: 
[0m22:10:37.843933 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.42 seconds (7.42s).
[0m22:10:37.844320 [debug] [MainThread]: Command end result
[0m22:10:37.950338 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:10:37.951240 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:10:37.953610 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m22:10:37.953733 [info ] [MainThread]: 
[0m22:10:37.953882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:37.953991 [info ] [MainThread]: 
[0m22:10:37.954117 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:10:37.961760 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.668345, "process_in_blocks": "0", "process_kernel_time": 0.468795, "process_mem_max_rss": "392200192", "process_out_blocks": "0", "process_user_time": 1.956344}
[0m22:10:37.962078 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:37.962032 after 9.67 seconds
[0m22:10:37.962246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f60310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121781e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121782170>]}
[0m22:10:37.962398 [debug] [MainThread]: Flushing usage events
[0m22:10:38.185624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:13:08.448173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b686e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b3750>]}


============================== 22:13:08.449796 | 76e21462-ed54-43bc-a63d-637fed4099b3 ==============================
[0m22:13:08.449796 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m22:13:08.450034 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select Flight_Delays', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80'}
[0m22:13:09.359910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76e21462-ed54-43bc-a63d-637fed4099b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0cc30>]}
[0m22:13:09.379396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76e21462-ed54-43bc-a63d-637fed4099b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8c2360>]}
[0m22:13:09.379641 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m22:13:09.457224 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m22:13:09.499521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:13:09.499778 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Flight_Delays.sql
[0m22:13:09.581815 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m22:13:09.586594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76e21462-ed54-43bc-a63d-637fed4099b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd52150>]}
[0m22:13:09.620955 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:13:09.621942 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:13:09.630035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76e21462-ed54-43bc-a63d-637fed4099b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8ce8a0>]}
[0m22:13:09.630240 [info ] [MainThread]: Found 38 models, 9 data tests, 9 sources, 514 macros
[0m22:13:09.630373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e21462-ed54-43bc-a63d-637fed4099b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11faf59b0>]}
[0m22:13:09.631106 [info ] [MainThread]: 
[0m22:13:09.631239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:13:09.631338 [info ] [MainThread]: 
[0m22:13:09.631526 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:13:09.631840 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m22:13:09.632000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:10.007664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m22:13:10.007981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:10.269857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m22:13:10.272173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:10.600495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m22:13:10.602403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:10.883345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e21462-ed54-43bc-a63d-637fed4099b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120017ad0>]}
[0m22:13:10.884089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:13:10.887388 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Delays
[0m22:13:10.888114 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Flight_Delays .................. [RUN]
[0m22:13:10.888471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.Flight_Delays)
[0m22:13:10.888718 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Delays
[0m22:13:10.894698 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Delays"
[0m22:13:10.896655 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Delays
[0m22:13:10.905671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:11.191606 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Flight_Delays"
[0m22:13:11.192547 [debug] [Thread-1 (]: On model.air_travel.Flight_Delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Flight_Delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
      
    
    

    
    OPTIONS()
    as (
      with Flight_Delays as (
  select distinct fd.event_month, al.id as airline_id, ap.icao as airport_icao,
    fd.arr_total, fd.arr_cancelled, fd.arr_diverted, fd.arr_delay_min,
    fd.carrier_delay_min, fd.weather_delay_min, fd.nas_delay_min, 
    fd.late_aircraft_delay_min, fd._data_source, fd._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays` fd 
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap on fd.airport_code = ap.iata
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al on fd.carrier_name = al.name
  where ap.country_code = 'US'
  and fd.arr_total is not null
)

select *
from Flight_Delays
    );
  
[0m22:13:11.778411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:17c4ebbc-7278-459b-bd50-b7bdb6f5271d&page=queryresults
[0m22:13:14.143668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e21462-ed54-43bc-a63d-637fed4099b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12036c710>]}
[0m22:13:14.144280 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Flight_Delays ............. [[32mCREATE TABLE (0.0 rows, 46.8 MiB processed)[0m in 3.25s]
[0m22:13:14.144688 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Delays
[0m22:13:14.145668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:13:14.146870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:14.147039 [debug] [MainThread]: Connection 'model.air_travel.Flight_Delays' was properly closed.
[0m22:13:14.147216 [info ] [MainThread]: 
[0m22:13:14.147404 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m22:13:14.147830 [debug] [MainThread]: Command end result
[0m22:13:14.166719 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:13:14.167911 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:13:14.170884 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m22:13:14.171022 [info ] [MainThread]: 
[0m22:13:14.171190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:13:14.171319 [info ] [MainThread]: 
[0m22:13:14.171469 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:13:14.173683 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.749314, "process_in_blocks": "0", "process_kernel_time": 0.29445, "process_mem_max_rss": "391643136", "process_out_blocks": "0", "process_user_time": 1.792231}
[0m22:13:14.173888 [debug] [MainThread]: Command `dbt run` succeeded at 22:13:14.173848 after 5.75 seconds
[0m22:13:14.174049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200ddf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200ed1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200eff70>]}
[0m22:13:14.174204 [debug] [MainThread]: Flushing usage events
[0m22:13:14.381136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:50.938087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aec46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0f750>]}


============================== 11:43:50.940436 | 1e208aea-6a7d-45e9-a3c2-220dd5840478 ==============================
[0m11:43:50.940436 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:43:50.940675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'debug': 'False', 'warn_error': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Reviews.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'fail_fast': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m11:43:52.629150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e208aea-6a7d-45e9-a3c2-220dd5840478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b068c30>]}
[0m11:43:52.648118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e208aea-6a7d-45e9-a3c2-220dd5840478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121cc6360>]}
[0m11:43:52.648326 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:43:52.732318 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:43:52.785680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:43:52.785930 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/schema.yml
[0m11:43:52.860671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:43:52.865316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e208aea-6a7d-45e9-a3c2-220dd5840478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122156150>]}
[0m11:43:52.900758 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:43:52.901677 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:43:52.916249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e208aea-6a7d-45e9-a3c2-220dd5840478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225e2d50>]}
[0m11:43:52.916455 [info ] [MainThread]: Found 38 models, 11 data tests, 9 sources, 514 macros
[0m11:43:52.916581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e208aea-6a7d-45e9-a3c2-220dd5840478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225160b0>]}
[0m11:43:52.923803 [info ] [MainThread]: 
[0m11:43:52.923996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:43:52.924104 [info ] [MainThread]: 
[0m11:43:52.924309 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:43:52.926697 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m11:43:52.926868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:53.251133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:43:53.252888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:53.542420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:43:53.544821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:53.830150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e208aea-6a7d-45e9-a3c2-220dd5840478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122610e20>]}
[0m11:43:53.830904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:53.836709 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:43:53.837188 [info ] [Thread-1 (]: 1 of 2 START test not_null_Country_iso_code .................................... [RUN]
[0m11:43:53.837569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m11:43:53.837849 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:43:53.851069 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:43:53.851746 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:43:53.863831 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:43:53.864298 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m11:43:53.864513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:54.541193 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3462d999-b23f-4e36-999b-1a536b2526df&page=queryresults
[0m11:43:55.196264 [info ] [Thread-1 (]: 1 of 2 PASS not_null_Country_iso_code .......................................... [[32mPASS[0m in 1.36s]
[0m11:43:55.196931 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:43:55.197205 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:43:55.197517 [info ] [Thread-1 (]: 2 of 2 START test unique_Country_iso_code ...................................... [RUN]
[0m11:43:55.197890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m11:43:55.198131 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:43:55.202147 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:43:55.202636 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:43:55.203776 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:43:55.204152 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:43:55.204382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.769658 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b630a243-cce9-4ac2-bca3-5ca46d343351&page=queryresults
[0m11:43:56.196798 [info ] [Thread-1 (]: 2 of 2 PASS unique_Country_iso_code ............................................ [[32mPASS[0m in 1.00s]
[0m11:43:56.197295 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:43:56.198156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:56.199275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:56.199433 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m11:43:56.199596 [info ] [MainThread]: 
[0m11:43:56.199771 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m11:43:56.200217 [debug] [MainThread]: Command end result
[0m11:43:56.219444 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:43:56.220598 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:43:56.223862 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:43:56.224033 [info ] [MainThread]: 
[0m11:43:56.224208 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:56.224347 [info ] [MainThread]: 
[0m11:43:56.224496 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:43:56.232918 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.321503, "process_in_blocks": "0", "process_kernel_time": 0.422466, "process_mem_max_rss": "392151040", "process_out_blocks": "0", "process_user_time": 1.815122}
[0m11:43:56.233144 [debug] [MainThread]: Command `dbt test` succeeded at 11:43:56.233104 after 5.32 seconds
[0m11:43:56.233304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc18a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224bb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224bb120>]}
[0m11:43:56.233451 [debug] [MainThread]: Flushing usage events
[0m11:43:56.458337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:46.544967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ff750>]}


============================== 11:45:46.546612 | ea7a2042-5065-424d-b2dd-d4854ce4ffec ==============================
[0m11:45:46.546612 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:45:46.546854 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'static_parser': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'empty': 'None', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'fail_fast': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Reviews.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/scohen/.dbt'}
[0m11:45:47.411949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea7a2042-5065-424d-b2dd-d4854ce4ffec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d58c30>]}
[0m11:45:47.431563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea7a2042-5065-424d-b2dd-d4854ce4ffec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9c2360>]}
[0m11:45:47.431839 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:45:47.509231 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:45:47.556845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:45:47.557235 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m11:45:47.638984 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:45:47.643987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea7a2042-5065-424d-b2dd-d4854ce4ffec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe5a550>]}
[0m11:45:47.680667 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:45:47.681600 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:45:47.692951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea7a2042-5065-424d-b2dd-d4854ce4ffec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202eef30>]}
[0m11:45:47.693163 [info ] [MainThread]: Found 38 models, 15 data tests, 9 sources, 514 macros
[0m11:45:47.693294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea7a2042-5065-424d-b2dd-d4854ce4ffec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb40c90>]}
[0m11:45:47.701695 [info ] [MainThread]: 
[0m11:45:47.701917 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:47.702028 [info ] [MainThread]: 
[0m11:45:47.702239 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:45:47.704763 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m11:45:47.704992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:47.992260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:45:47.993370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:48.282969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:45:48.285332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:48.540083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea7a2042-5065-424d-b2dd-d4854ce4ffec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12031d570>]}
[0m11:45:48.540682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:48.543923 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:45:48.544322 [info ] [Thread-1 (]: 1 of 6 START test not_null_Airline_id .......................................... [RUN]
[0m11:45:48.544699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m11:45:48.544989 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:45:48.556832 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:45:48.557447 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:45:48.569881 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:45:48.570398 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m11:45:48.570625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:49.230218 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d2043a55-e459-4831-922a-0b5b966223b1&page=queryresults
[0m11:45:49.720849 [info ] [Thread-1 (]: 1 of 6 PASS not_null_Airline_id ................................................ [[32mPASS[0m in 1.18s]
[0m11:45:49.721692 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:45:49.722111 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:45:49.722438 [info ] [Thread-1 (]: 2 of 6 START test not_null_Airport_icao ........................................ [RUN]
[0m11:45:49.722880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m11:45:49.723262 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:45:49.726919 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:45:49.727757 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:45:49.729268 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:45:49.729789 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m11:45:49.730076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:50.356917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4b96416f-2ad7-4274-bbaa-fe194164e48f&page=queryresults
[0m11:45:50.743172 [info ] [Thread-1 (]: 2 of 6 PASS not_null_Airport_icao .............................................. [[32mPASS[0m in 1.02s]
[0m11:45:50.744237 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:45:50.744887 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:45:50.745635 [info ] [Thread-1 (]: 3 of 6 START test not_null_Country_iso_code .................................... [RUN]
[0m11:45:50.746316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m11:45:50.746700 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:45:50.750763 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:45:50.751568 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:45:50.753313 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:45:50.753891 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m11:45:50.754211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:51.172536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0fec690f-568f-4c8c-845b-e4cbd53e6eb4&page=queryresults
[0m11:45:51.596731 [info ] [Thread-1 (]: 3 of 6 PASS not_null_Country_iso_code .......................................... [[32mPASS[0m in 0.85s]
[0m11:45:51.597760 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:45:51.598487 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:45:51.599259 [info ] [Thread-1 (]: 4 of 6 START test unique_Airline_id ............................................ [RUN]
[0m11:45:51.599766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Airline_id.cb196c2622)
[0m11:45:51.600097 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m11:45:51.606609 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:45:51.607398 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m11:45:51.608999 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:45:51.609535 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:45:51.609818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:52.180501 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4fdd6638-ddeb-4693-b542-881c1221ffea&page=queryresults
[0m11:45:52.568322 [info ] [Thread-1 (]: 4 of 6 PASS unique_Airline_id .................................................. [[32mPASS[0m in 0.97s]
[0m11:45:52.569428 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:45:52.569971 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:45:52.570479 [info ] [Thread-1 (]: 5 of 6 START test unique_Airport_icao .......................................... [RUN]
[0m11:45:52.571103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m11:45:52.571497 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:45:52.580165 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:45:52.580990 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:45:52.582732 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:45:52.583422 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:45:52.583824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:53.098051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1d0f1101-8667-45a5-a180-736cc77beaa4&page=queryresults
[0m11:45:53.441210 [info ] [Thread-1 (]: 5 of 6 PASS unique_Airport_icao ................................................ [[32mPASS[0m in 0.87s]
[0m11:45:53.442515 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:45:53.443092 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:45:53.443583 [info ] [Thread-1 (]: 6 of 6 START test unique_Country_iso_code ...................................... [RUN]
[0m11:45:53.444156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m11:45:53.444528 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:45:53.557539 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:45:53.557998 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:45:53.558754 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:45:53.559007 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:45:53.559142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:54.046402 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6d6e53b2-1d10-4a91-b44e-26e52af3c3ce&page=queryresults
[0m11:45:54.486538 [info ] [Thread-1 (]: 6 of 6 PASS unique_Country_iso_code ............................................ [[32mPASS[0m in 1.04s]
[0m11:45:54.487528 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:45:54.489540 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:54.491677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:54.491992 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m11:45:54.492296 [info ] [MainThread]: 
[0m11:45:54.492611 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 6.79 seconds (6.79s).
[0m11:45:54.493717 [debug] [MainThread]: Command end result
[0m11:45:54.518134 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:45:54.519286 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:45:54.522832 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:45:54.522980 [info ] [MainThread]: 
[0m11:45:54.523152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:54.523288 [info ] [MainThread]: 
[0m11:45:54.523442 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m11:45:54.525859 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.002392, "process_in_blocks": "0", "process_kernel_time": 0.302662, "process_mem_max_rss": "391413760", "process_out_blocks": "0", "process_user_time": 2.141952}
[0m11:45:54.526080 [debug] [MainThread]: Command `dbt test` succeeded at 11:45:54.526036 after 8.00 seconds
[0m11:45:54.526251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109904ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205b87e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205b8c00>]}
[0m11:45:54.526421 [debug] [MainThread]: Flushing usage events
[0m11:45:54.732851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:50:19.616466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a23c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0879d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b087750>]}


============================== 11:50:19.618105 | 2848cc20-2685-4900-8f9c-94bee91dc431 ==============================
[0m11:50:19.618105 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:50:19.618343 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Reviews.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'version_check': 'True', 'warn_error': 'None', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'target_path': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'static_parser': 'True', 'empty': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:50:20.436235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2848cc20-2685-4900-8f9c-94bee91dc431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e0c30>]}
[0m11:50:20.455087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2848cc20-2685-4900-8f9c-94bee91dc431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1210c6360>]}
[0m11:50:20.455299 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:50:20.528958 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:50:20.572788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:50:20.573055 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m11:50:20.647407 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:50:20.652029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2848cc20-2685-4900-8f9c-94bee91dc431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121563950>]}
[0m11:50:20.686145 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:50:20.686976 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:50:20.696759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2848cc20-2685-4900-8f9c-94bee91dc431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121946f30>]}
[0m11:50:20.696940 [info ] [MainThread]: Found 38 models, 16 data tests, 9 sources, 514 macros
[0m11:50:20.697068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2848cc20-2685-4900-8f9c-94bee91dc431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12182cbb0>]}
[0m11:50:20.704913 [info ] [MainThread]: 
[0m11:50:20.705223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:50:20.705353 [info ] [MainThread]: 
[0m11:50:20.705575 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:50:20.707783 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_tmp'
[0m11:50:20.707942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:21.016964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:50:21.020079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:21.401518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:50:21.403751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:21.700424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2848cc20-2685-4900-8f9c-94bee91dc431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219f1a50>]}
[0m11:50:21.701458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:50:21.705033 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:50:21.705399 [info ] [Thread-1 (]: 1 of 7 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m11:50:21.705720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m11:50:21.706362 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:50:21.713851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:21.719065 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:50:21.719405 [error] [Thread-1 (]: 1 of 7 ERROR dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[31mERROR[0m in 0.01s]
[0m11:50:21.719720 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:50:21.719929 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:50:21.720201 [debug] [Thread-4 (]: Marking all children of 'test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:50:21.720441 [info ] [Thread-1 (]: 2 of 7 START test not_null_Airline_id .......................................... [RUN]
[0m11:50:21.721083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m11:50:21.721274 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:50:21.725836 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:50:21.726250 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:50:21.736444 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:50:21.736969 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m11:50:21.737163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:22.206404 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:eab72f19-ea5f-413c-befa-02c89f134ab3&page=queryresults
[0m11:50:22.745143 [info ] [Thread-1 (]: 2 of 7 PASS not_null_Airline_id ................................................ [[32mPASS[0m in 1.02s]
[0m11:50:22.745709 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:50:22.745935 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:50:22.746117 [info ] [Thread-1 (]: 3 of 7 START test not_null_Airport_icao ........................................ [RUN]
[0m11:50:22.746418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m11:50:22.746663 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:50:22.749171 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:50:22.749778 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:50:22.750741 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:50:22.751038 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m11:50:22.751217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:23.378870 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8c3f9f05-1657-4603-8238-0dfabbfe2569&page=queryresults
[0m11:50:24.100589 [info ] [Thread-1 (]: 3 of 7 PASS not_null_Airport_icao .............................................. [[32mPASS[0m in 1.35s]
[0m11:50:24.102120 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:50:24.102703 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:50:24.103185 [info ] [Thread-1 (]: 4 of 7 START test not_null_Country_iso_code .................................... [RUN]
[0m11:50:24.103746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m11:50:24.104134 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:50:24.107940 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:50:24.108741 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:50:24.110373 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:50:24.110933 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m11:50:24.111253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:24.710875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7bd5479d-b98c-42d0-8a98-66f774d00d31&page=queryresults
[0m11:50:25.128471 [info ] [Thread-1 (]: 4 of 7 PASS not_null_Country_iso_code .......................................... [[32mPASS[0m in 1.02s]
[0m11:50:25.129681 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:50:25.130283 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:50:25.130759 [info ] [Thread-1 (]: 5 of 7 START test unique_Airline_id ............................................ [RUN]
[0m11:50:25.131300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Airline_id.cb196c2622)
[0m11:50:25.131657 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m11:50:25.140766 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:50:25.141539 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m11:50:25.142930 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:50:25.143392 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:50:25.143691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:25.678951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7c3702dd-f469-490a-abae-db5edbb2e2a0&page=queryresults
[0m11:50:26.190103 [info ] [Thread-1 (]: 5 of 7 PASS unique_Airline_id .................................................. [[32mPASS[0m in 1.06s]
[0m11:50:26.191194 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:50:26.191735 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:50:26.192393 [info ] [Thread-1 (]: 6 of 7 START test unique_Airport_icao .......................................... [RUN]
[0m11:50:26.193167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m11:50:26.193708 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:50:26.304249 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:50:26.304689 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:50:26.305398 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:50:26.305653 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:50:26.305795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:27.112633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:765f1aec-ddec-4908-8367-b63343ab26e0&page=queryresults
[0m11:50:27.560864 [info ] [Thread-1 (]: 6 of 7 PASS unique_Airport_icao ................................................ [[32mPASS[0m in 1.37s]
[0m11:50:27.561771 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:50:27.562184 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:50:27.562630 [info ] [Thread-1 (]: 7 of 7 START test unique_Country_iso_code ...................................... [RUN]
[0m11:50:27.563134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m11:50:27.563460 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:50:27.567775 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:50:27.568669 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:50:27.570212 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:50:27.570762 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:50:27.571037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:28.062487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1cb1f29f-f832-45a9-ab65-af32247b8ca6&page=queryresults
[0m11:50:28.403284 [info ] [Thread-1 (]: 7 of 7 PASS unique_Country_iso_code ............................................ [[32mPASS[0m in 0.84s]
[0m11:50:28.404314 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:50:28.406359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:50:28.408437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:28.408738 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m11:50:28.409025 [info ] [MainThread]: 
[0m11:50:28.409279 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 7.70 seconds (7.70s).
[0m11:50:28.410432 [debug] [MainThread]: Command end result
[0m11:50:28.434278 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:50:28.435564 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:50:28.439138 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:50:28.439303 [info ] [MainThread]: 
[0m11:50:28.439480 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:50:28.439623 [info ] [MainThread]: 
[0m11:50:28.439811 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)[0m
[0m11:50:28.439991 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:50:28.440128 [info ] [MainThread]: 
[0m11:50:28.440279 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m11:50:28.442645 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 8.849967, "process_in_blocks": "0", "process_kernel_time": 0.287713, "process_mem_max_rss": "392445952", "process_out_blocks": "0", "process_user_time": 2.118563}
[0m11:50:28.442860 [debug] [MainThread]: Command `dbt test` failed at 11:50:28.442821 after 8.85 seconds
[0m11:50:28.443036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af8cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d0d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d0c470>]}
[0m11:50:28.443198 [debug] [MainThread]: Flushing usage events
[0m11:50:28.710870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:53.794288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3bc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d207750>]}


============================== 11:53:53.795864 | 80736459-11ef-40e0-ad36-ea22f4db2965 ==============================
[0m11:53:53.795864 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:53:53.796107 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Reviews.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'log_format': 'default', 'debug': 'False', 'no_print': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'target_path': 'None', 'version_check': 'True', 'fail_fast': 'False', 'quiet': 'False', 'introspect': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m11:53:54.616154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80736459-11ef-40e0-ad36-ea22f4db2965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c560c30>]}
[0m11:53:54.634953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80736459-11ef-40e0-ad36-ea22f4db2965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230c2360>]}
[0m11:53:54.635165 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:53:54.707700 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:53:54.751600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:53:54.751831 [debug] [MainThread]: Partial parsing: added file: air_travel://macros/unique_combination_of_columns.sql
[0m11:53:54.780250 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:53:54.785008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80736459-11ef-40e0-ad36-ea22f4db2965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12355f450>]}
[0m11:53:54.819051 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:53:54.820109 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:53:54.830350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80736459-11ef-40e0-ad36-ea22f4db2965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238b88c0>]}
[0m11:53:54.830536 [info ] [MainThread]: Found 38 models, 16 data tests, 9 sources, 515 macros
[0m11:53:54.830662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80736459-11ef-40e0-ad36-ea22f4db2965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238d1010>]}
[0m11:53:54.838419 [info ] [MainThread]: 
[0m11:53:54.838602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:53:54.838711 [info ] [MainThread]: 
[0m11:53:54.839157 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:53:54.841442 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m11:53:54.841601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:55.122370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:53:55.124313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:55.377626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:53:55.379030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:55.639932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80736459-11ef-40e0-ad36-ea22f4db2965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12384f6c0>]}
[0m11:53:55.640782 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:55.645219 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:53:55.645822 [info ] [Thread-1 (]: 1 of 7 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m11:53:55.646311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m11:53:55.646677 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:53:55.661541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:55.664987 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:53:55.665368 [error] [Thread-1 (]: 1 of 7 ERROR dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[31mERROR[0m in 0.02s]
[0m11:53:55.665710 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:53:55.665919 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:53:55.666168 [debug] [Thread-4 (]: Marking all children of 'test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:53:55.666383 [info ] [Thread-1 (]: 2 of 7 START test not_null_Airline_id .......................................... [RUN]
[0m11:53:55.667053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m11:53:55.667292 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:53:55.672366 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:53:55.672896 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:53:55.683476 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:53:55.684021 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m11:53:55.684239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:56.272226 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4038c885-8a22-4995-a1b2-554928dfef1c&page=queryresults
[0m11:53:56.897263 [info ] [Thread-1 (]: 2 of 7 PASS not_null_Airline_id ................................................ [[32mPASS[0m in 1.23s]
[0m11:53:56.898130 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:53:56.898534 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:53:56.898998 [info ] [Thread-1 (]: 3 of 7 START test not_null_Airport_icao ........................................ [RUN]
[0m11:53:56.899527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m11:53:56.899888 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:53:56.903554 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:53:56.904367 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:53:56.906218 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:53:56.906798 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m11:53:56.907097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:57.500300 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:db261a65-a74e-4b1d-9f56-6742778c1153&page=queryresults
[0m11:53:57.927218 [info ] [Thread-1 (]: 3 of 7 PASS not_null_Airport_icao .............................................. [[32mPASS[0m in 1.03s]
[0m11:53:57.928196 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:53:57.928715 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:53:57.929182 [info ] [Thread-1 (]: 4 of 7 START test not_null_Country_iso_code .................................... [RUN]
[0m11:53:57.929725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m11:53:57.930088 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:53:57.934966 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:53:57.936075 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:53:57.937810 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:53:57.938730 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m11:53:57.939098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:58.423098 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:add1b0c6-009c-4b5d-b4ad-9f4fb24a1987&page=queryresults
[0m11:53:58.810344 [info ] [Thread-1 (]: 4 of 7 PASS not_null_Country_iso_code .......................................... [[32mPASS[0m in 0.88s]
[0m11:53:58.811593 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:53:58.812092 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:53:58.812479 [info ] [Thread-1 (]: 5 of 7 START test unique_Airline_id ............................................ [RUN]
[0m11:53:58.813428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Airline_id.cb196c2622)
[0m11:53:58.813894 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m11:53:58.820130 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:53:58.820980 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m11:53:58.822455 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:53:58.823050 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:53:58.823324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:59.241376 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1d34a5ec-2d95-4d65-ad3d-95b22dae275c&page=queryresults
[0m11:53:59.602379 [info ] [Thread-1 (]: 5 of 7 PASS unique_Airline_id .................................................. [[32mPASS[0m in 0.79s]
[0m11:53:59.603374 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:53:59.603876 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:53:59.604341 [info ] [Thread-1 (]: 6 of 7 START test unique_Airport_icao .......................................... [RUN]
[0m11:53:59.604914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m11:53:59.605289 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:53:59.610581 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:53:59.611668 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:53:59.613429 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:53:59.614125 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:53:59.614483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:00.162768 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a2f57833-f285-4b70-8e2f-4717c87199cc&page=queryresults
[0m11:54:00.677906 [info ] [Thread-1 (]: 6 of 7 PASS unique_Airport_icao ................................................ [[32mPASS[0m in 1.07s]
[0m11:54:00.678934 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:54:00.679469 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:54:00.679929 [info ] [Thread-1 (]: 7 of 7 START test unique_Country_iso_code ...................................... [RUN]
[0m11:54:00.680451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m11:54:00.680843 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:54:00.686528 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:54:00.687579 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:54:00.689500 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:54:00.690286 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:54:00.690650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:01.187090 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2270e654-0e06-42ad-b8ae-cb0d09736338&page=queryresults
[0m11:54:01.539103 [info ] [Thread-1 (]: 7 of 7 PASS unique_Country_iso_code ............................................ [[32mPASS[0m in 0.86s]
[0m11:54:01.540044 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:54:01.542243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:54:01.544472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:01.544795 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m11:54:01.545105 [info ] [MainThread]: 
[0m11:54:01.545440 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m11:54:01.546632 [debug] [MainThread]: Command end result
[0m11:54:01.572460 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:54:01.573581 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:54:01.577424 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:54:01.577592 [info ] [MainThread]: 
[0m11:54:01.577779 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:54:01.577920 [info ] [MainThread]: 
[0m11:54:01.578106 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)[0m
[0m11:54:01.578280 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:54:01.578420 [info ] [MainThread]: 
[0m11:54:01.578571 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m11:54:01.580935 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 7.809935, "process_in_blocks": "0", "process_kernel_time": 0.276443, "process_mem_max_rss": "391725056", "process_out_blocks": "0", "process_user_time": 1.988575}
[0m11:54:01.581146 [debug] [MainThread]: Command `dbt test` failed at 11:54:01.581106 after 7.81 seconds
[0m11:54:01.581320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d10ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237b26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237b2360>]}
[0m11:54:01.581476 [debug] [MainThread]: Flushing usage events
[0m11:54:01.794178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:22.147287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaf06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b93b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b93b750>]}


============================== 11:55:22.148876 | d45beb2e-7759-49ff-9190-592c032fda62 ==============================
[0m11:55:22.148876 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:55:22.149124 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'quiet': 'False', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Reviews.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'use_colors': 'True', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:55:22.968724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd45beb2e-7759-49ff-9190-592c032fda62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac94c30>]}
[0m11:55:22.987417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd45beb2e-7759-49ff-9190-592c032fda62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217c2360>]}
[0m11:55:22.987626 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:55:23.060439 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:55:23.104602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:55:23.104847 [debug] [MainThread]: Partial parsing: updated file: air_travel://macros/unique_combination_of_columns.sql
[0m11:55:23.133142 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m11:55:23.137867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd45beb2e-7759-49ff-9190-592c032fda62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c5a750>]}
[0m11:55:23.172535 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:55:23.173504 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:55:23.183709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd45beb2e-7759-49ff-9190-592c032fda62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fbc8c0>]}
[0m11:55:23.183904 [info ] [MainThread]: Found 38 models, 16 data tests, 9 sources, 516 macros
[0m11:55:23.184035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd45beb2e-7759-49ff-9190-592c032fda62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fd51d0>]}
[0m11:55:23.191603 [info ] [MainThread]: 
[0m11:55:23.191756 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:55:23.191858 [info ] [MainThread]: 
[0m11:55:23.192147 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:55:23.194525 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_int'
[0m11:55:23.194710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:23.463461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:55:23.465528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:23.740551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:55:23.742418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:24.031567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd45beb2e-7759-49ff-9190-592c032fda62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f4f790>]}
[0m11:55:24.032284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:24.037023 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:55:24.037600 [info ] [Thread-1 (]: 1 of 7 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m11:55:24.038080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m11:55:24.038470 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:55:24.053953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:24.057142 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:24.057470 [error] [Thread-1 (]: 1 of 7 ERROR dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[31mERROR[0m in 0.02s]
[0m11:55:24.057785 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:55:24.058004 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:55:24.058244 [debug] [Thread-4 (]: Marking all children of 'test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:55:24.058449 [info ] [Thread-1 (]: 2 of 7 START test not_null_Airline_id .......................................... [RUN]
[0m11:55:24.059056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m11:55:24.059249 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:55:24.064063 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:55:24.064517 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:55:24.075221 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:55:24.075693 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m11:55:24.075964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:24.645193 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f8fba7ed-40e6-4daa-9d5d-9d3f0a21b9c3&page=queryresults
[0m11:55:25.098020 [info ] [Thread-1 (]: 2 of 7 PASS not_null_Airline_id ................................................ [[32mPASS[0m in 1.04s]
[0m11:55:25.099106 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:55:25.099623 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:55:25.100096 [info ] [Thread-1 (]: 3 of 7 START test not_null_Airport_icao ........................................ [RUN]
[0m11:55:25.100639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m11:55:25.101017 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:55:25.105608 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:55:25.106585 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:55:25.108310 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:55:25.109002 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m11:55:25.109438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:25.565767 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:527ce802-015a-4845-9dce-349214e399e7&page=queryresults
[0m11:55:26.011337 [info ] [Thread-1 (]: 3 of 7 PASS not_null_Airport_icao .............................................. [[32mPASS[0m in 0.91s]
[0m11:55:26.012691 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:55:26.013194 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:55:26.013669 [info ] [Thread-1 (]: 4 of 7 START test not_null_Country_iso_code .................................... [RUN]
[0m11:55:26.014610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m11:55:26.015063 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:55:26.018873 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:55:26.019772 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:55:26.021468 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:55:26.022059 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m11:55:26.022348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:26.488620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6d30a86b-de00-4ec3-b58d-b6111e954a76&page=queryresults
[0m11:55:26.897797 [info ] [Thread-1 (]: 4 of 7 PASS not_null_Country_iso_code .......................................... [[32mPASS[0m in 0.88s]
[0m11:55:26.898721 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:55:26.899208 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:55:26.899624 [info ] [Thread-1 (]: 5 of 7 START test unique_Airline_id ............................................ [RUN]
[0m11:55:26.900131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Airline_id.cb196c2622)
[0m11:55:26.900488 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m11:55:26.907686 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:55:26.908867 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m11:55:26.910549 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:55:26.911078 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:55:26.911348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:27.409080 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:aff1ee49-04ac-4884-ae6a-5ec7c23aac2b&page=queryresults
[0m11:55:27.882558 [info ] [Thread-1 (]: 5 of 7 PASS unique_Airline_id .................................................. [[32mPASS[0m in 0.98s]
[0m11:55:27.883515 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:55:27.884014 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:55:27.884463 [info ] [Thread-1 (]: 6 of 7 START test unique_Airport_icao .......................................... [RUN]
[0m11:55:27.885027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m11:55:27.885411 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:55:27.890670 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:55:27.891646 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:55:27.893389 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:55:27.893964 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:55:27.894270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:28.330734 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c6d9407c-f97a-4ea7-80ac-af66bbbb1e8e&page=queryresults
[0m11:55:28.800337 [info ] [Thread-1 (]: 6 of 7 PASS unique_Airport_icao ................................................ [[32mPASS[0m in 0.92s]
[0m11:55:28.801255 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:55:28.801715 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:55:28.802129 [info ] [Thread-1 (]: 7 of 7 START test unique_Country_iso_code ...................................... [RUN]
[0m11:55:28.802629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m11:55:28.802975 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:55:28.808141 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:55:28.809000 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:55:28.810818 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:55:28.811590 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:55:28.811927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:29.251939 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5f1883f2-b583-4ab1-8014-3ec9df680a79&page=queryresults
[0m11:55:29.633120 [info ] [Thread-1 (]: 7 of 7 PASS unique_Country_iso_code ............................................ [[32mPASS[0m in 0.83s]
[0m11:55:29.633989 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:55:29.635776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:29.637713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:29.637976 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m11:55:29.638228 [info ] [MainThread]: 
[0m11:55:29.638493 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 6.45 seconds (6.45s).
[0m11:55:29.639641 [debug] [MainThread]: Command end result
[0m11:55:29.665050 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:55:29.666289 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:55:29.670041 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:55:29.670207 [info ] [MainThread]: 
[0m11:55:29.670383 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:55:29.670515 [info ] [MainThread]: 
[0m11:55:29.670688 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)[0m
[0m11:55:29.670851 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location (models/int/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:29.670979 [info ] [MainThread]: 
[0m11:55:29.671124 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m11:55:29.673450 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 7.549446, "process_in_blocks": "0", "process_kernel_time": 0.282643, "process_mem_max_rss": "390791168", "process_out_blocks": "0", "process_user_time": 1.991082}
[0m11:55:29.673658 [debug] [MainThread]: Command `dbt test` failed at 11:55:29.673618 after 7.55 seconds
[0m11:55:29.673831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b844a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ebe6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ebe360>]}
[0m11:55:29.673989 [debug] [MainThread]: Flushing usage events
[0m11:55:29.880494 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:31.176010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af086e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd53750>]}


============================== 11:59:31.177643 | 336a9ad3-96cb-4824-9993-fd3071f4816a ==============================
[0m11:59:31.177643 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:59:31.177884 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/scohen/.dbt', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt deps', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'empty': 'None'}
[0m11:59:31.219749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '336a9ad3-96cb-4824-9993-fd3071f4816a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0acc30>]}
[0m11:59:31.226985 [debug] [MainThread]: Set downloads directory='/var/folders/rx/yg59p7rs5g145mvld3t_0wsh0000gn/T/dbt-downloads-f_tr0636'
[0m11:59:31.227181 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:59:31.350187 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:59:31.350903 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:59:31.398624 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:59:31.407160 [info ] [MainThread]: Updating lock file in file path: /Users/scohen/UTCS/378/dbt/air_travel/package-lock.yml
[0m11:59:31.408413 [debug] [MainThread]: Set downloads directory='/var/folders/rx/yg59p7rs5g145mvld3t_0wsh0000gn/T/dbt-downloads-7ir3kxrw'
[0m11:59:31.410400 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:59:31.716459 [info ] [MainThread]: Installed from version 1.1.1
[0m11:59:31.716689 [info ] [MainThread]: Updated version available: 1.3.2
[0m11:59:31.716858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '336a9ad3-96cb-4824-9993-fd3071f4816a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf7ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf5a690>]}
[0m11:59:31.717029 [info ] [MainThread]: 
[0m11:59:31.717150 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:59:31.718579 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.566973, "process_in_blocks": "0", "process_kernel_time": 0.103743, "process_mem_max_rss": "118816768", "process_out_blocks": "0", "process_user_time": 0.55233}
[0m11:59:31.718836 [debug] [MainThread]: Command `dbt deps` succeeded at 11:59:31.718748 after 0.57 seconds
[0m11:59:31.718978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf65a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbd7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f7c50>]}
[0m11:59:31.719109 [debug] [MainThread]: Flushing usage events
[0m11:59:31.954627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:04.554892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c96c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7b79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7b7750>]}


============================== 12:00:04.556547 | 381d5f09-880a-4e39-8ac3-37cc61348493 ==============================
[0m12:00:04.556547 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:00:04.556801 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'no_print': 'None', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Reviews.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'profiles_dir': '/Users/scohen/.dbt', 'target_path': 'None', 'printer_width': '80', 'empty': 'None', 'version_check': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'fail_fast': 'False', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False'}
[0m12:00:05.379732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '381d5f09-880a-4e39-8ac3-37cc61348493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb10c30>]}
[0m12:00:05.399154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '381d5f09-880a-4e39-8ac3-37cc61348493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236c2360>]}
[0m12:00:05.399362 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:00:05.473763 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:00:05.509031 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:00:05.509220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '381d5f09-880a-4e39-8ac3-37cc61348493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ae3350>]}
[0m12:00:05.981633 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named Airport. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for Airport in this file:
   - models/int/schema.yml
  
[0m12:00:05.983469 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.4519993, "process_in_blocks": "0", "process_kernel_time": 0.229293, "process_mem_max_rss": "380370944", "process_out_blocks": "0", "process_user_time": 1.730083}
[0m12:00:05.983678 [debug] [MainThread]: Command `dbt test` failed at 12:00:05.983644 after 1.45 seconds
[0m12:00:05.983828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c52990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c534d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238f5a90>]}
[0m12:00:05.983947 [debug] [MainThread]: Flushing usage events
[0m12:00:06.178760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:47.831230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11f750>]}


============================== 12:00:47.832832 | e8a12e44-da75-46cb-a2c0-ce72e0a42ef9 ==============================
[0m12:00:47.832832 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:00:47.833078 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'use_experimental_parser': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'empty': 'None', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'write_json': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Reviews.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml'}
[0m12:00:48.642632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8a12e44-da75-46cb-a2c0-ce72e0a42ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c478c30>]}
[0m12:00:48.661959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8a12e44-da75-46cb-a2c0-ce72e0a42ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230c2360>]}
[0m12:00:48.662163 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:00:48.738919 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:00:48.774401 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:00:48.774583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e8a12e44-da75-46cb-a2c0-ce72e0a42ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234df350>]}
[0m12:00:49.355466 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m12:00:49.359086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8a12e44-da75-46cb-a2c0-ce72e0a42ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235b1c70>]}
[0m12:00:49.392427 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:00:49.393275 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:00:49.403948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8a12e44-da75-46cb-a2c0-ce72e0a42ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123aeaeb0>]}
[0m12:00:49.404131 [info ] [MainThread]: Found 38 models, 16 data tests, 9 sources, 630 macros
[0m12:00:49.404254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a12e44-da75-46cb-a2c0-ce72e0a42ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b4b380>]}
[0m12:00:49.412052 [info ] [MainThread]: 
[0m12:00:49.412204 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:00:49.412304 [info ] [MainThread]: 
[0m12:00:49.412489 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:00:49.414686 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:00:49.414847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:49.713215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:00:49.715461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:49.990831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:00:49.993370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:50.274768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a12e44-da75-46cb-a2c0-ce72e0a42ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ae7a10>]}
[0m12:00:50.275540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:50.279872 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:00:50.280341 [info ] [Thread-1 (]: 1 of 7 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m12:00:50.280738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m12:00:50.281038 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:00:50.292741 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m12:00:50.293402 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:00:50.306843 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m12:00:50.307298 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airport_icao, terminal, business, location
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    group by airport_icao, terminal, business, location
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:00:50.307533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:50.999979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:899f3247-e2cd-4e5d-99e2-eb443ecae95e&page=queryresults
[0m12:00:51.480004 [info ] [Thread-1 (]: 1 of 7 PASS dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[32mPASS[0m in 1.20s]
[0m12:00:51.480810 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:00:51.481186 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m12:00:51.481577 [info ] [Thread-1 (]: 2 of 7 START test not_null_Airline_id .......................................... [RUN]
[0m12:00:51.482024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m12:00:51.482302 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m12:00:51.487545 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m12:00:51.488215 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m12:00:51.490393 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m12:00:51.490967 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m12:00:51.491236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:52.328583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b9663c6e-4228-418c-8a32-5512ae9cf5b2&page=queryresults
[0m12:00:52.788841 [info ] [Thread-1 (]: 2 of 7 PASS not_null_Airline_id ................................................ [[32mPASS[0m in 1.31s]
[0m12:00:52.789698 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m12:00:52.790116 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m12:00:52.790571 [info ] [Thread-1 (]: 3 of 7 START test not_null_Airport_icao ........................................ [RUN]
[0m12:00:52.791080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m12:00:52.791445 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m12:00:52.796025 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m12:00:52.797189 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m12:00:52.799638 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m12:00:52.800346 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m12:00:52.801107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:53.315333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5b4b5db1-f086-48b9-9181-629a7025f637&page=queryresults
[0m12:00:53.730705 [info ] [Thread-1 (]: 3 of 7 PASS not_null_Airport_icao .............................................. [[32mPASS[0m in 0.94s]
[0m12:00:53.731946 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m12:00:53.732494 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m12:00:53.732960 [info ] [Thread-1 (]: 4 of 7 START test not_null_Country_iso_code .................................... [RUN]
[0m12:00:53.733846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m12:00:53.734279 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m12:00:53.738336 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m12:00:53.739166 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m12:00:53.741412 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m12:00:53.741930 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m12:00:53.742401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:54.206564 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9d6eeb10-239e-4a55-9efb-731f3fc6d90a&page=queryresults
[0m12:00:54.689495 [info ] [Thread-1 (]: 4 of 7 PASS not_null_Country_iso_code .......................................... [[32mPASS[0m in 0.96s]
[0m12:00:54.690627 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m12:00:54.691178 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m12:00:54.691988 [info ] [Thread-1 (]: 5 of 7 START test unique_Airline_id ............................................ [RUN]
[0m12:00:54.692531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Airline_id.cb196c2622)
[0m12:00:54.692884 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m12:00:54.699059 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m12:00:54.699834 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m12:00:54.702063 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m12:00:54.702563 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:00:54.702837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:55.196902 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6013d619-87b2-4aa2-87c7-11dcba3ce83f&page=queryresults
[0m12:00:55.657723 [info ] [Thread-1 (]: 5 of 7 PASS unique_Airline_id .................................................. [[32mPASS[0m in 0.96s]
[0m12:00:55.659062 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m12:00:55.659711 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m12:00:55.660585 [info ] [Thread-1 (]: 6 of 7 START test unique_Airport_icao .......................................... [RUN]
[0m12:00:55.661273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m12:00:55.661636 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m12:00:55.665599 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m12:00:55.666392 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m12:00:55.668572 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m12:00:55.669140 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:00:55.669505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:56.221406 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f2b6ee62-a480-4bd2-bc08-572b5b119838&page=queryresults
[0m12:00:56.633888 [info ] [Thread-1 (]: 6 of 7 PASS unique_Airport_icao ................................................ [[32mPASS[0m in 0.97s]
[0m12:00:56.635035 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m12:00:56.635440 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m12:00:56.635882 [info ] [Thread-1 (]: 7 of 7 START test unique_Country_iso_code ...................................... [RUN]
[0m12:00:56.636436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m12:00:56.636797 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m12:00:56.640629 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m12:00:56.641425 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m12:00:56.643669 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m12:00:56.644228 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:00:56.644516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:57.146641 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6f7055ef-7f00-4ca7-8ac7-a8038e66dc0e&page=queryresults
[0m12:00:57.555923 [info ] [Thread-1 (]: 7 of 7 PASS unique_Country_iso_code ............................................ [[32mPASS[0m in 0.92s]
[0m12:00:57.557180 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m12:00:57.559208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:57.561238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:57.561543 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m12:00:57.561831 [info ] [MainThread]: 
[0m12:00:57.562115 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 8.15 seconds (8.15s).
[0m12:00:57.563283 [debug] [MainThread]: Command end result
[0m12:00:57.590881 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:00:57.592039 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:00:57.595534 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:00:57.595690 [info ] [MainThread]: 
[0m12:00:57.595866 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:57.595998 [info ] [MainThread]: 
[0m12:00:57.596145 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m12:00:57.598485 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.790519, "process_in_blocks": "0", "process_kernel_time": 0.287314, "process_mem_max_rss": "397983744", "process_out_blocks": "0", "process_user_time": 2.608273}
[0m12:00:57.598707 [debug] [MainThread]: Command `dbt test` succeeded at 12:00:57.598666 after 9.79 seconds
[0m12:00:57.598872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bac1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f97cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f97f70>]}
[0m12:00:57.599027 [debug] [MainThread]: Flushing usage events
[0m12:00:57.808287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:46.703079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090146e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5f750>]}


============================== 13:57:46.704826 | 822f57b3-faed-4c9c-bffd-09f4462ac109 ==============================
[0m13:57:46.704826 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:57:46.705065 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Reviews.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m13:57:47.550253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '822f57b3-faed-4c9c-bffd-09f4462ac109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b8c30>]}
[0m13:57:47.569827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '822f57b3-faed-4c9c-bffd-09f4462ac109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fdc2360>]}
[0m13:57:47.570034 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:57:47.644687 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:57:47.691490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:57:47.691790 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m13:57:47.715609 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'Airport_Review' in the 'models' section of file 'models/int/schema.yml'
[0m13:57:47.758249 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.air_travel.unique_Airport_Review_id.690fe37ba9' (models/int/schema.yml) depends on a node named 'Airport_Review' in package '' which was not found
[0m13:57:47.758478 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.air_travel.not_null_Airport_Review_id.715ca7a304' (models/int/schema.yml) depends on a node named 'Airport_Review' in package '' which was not found
[0m13:57:47.782827 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m13:57:47.787973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '822f57b3-faed-4c9c-bffd-09f4462ac109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd6b950>]}
[0m13:57:47.823887 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:57:47.824773 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:57:47.834999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '822f57b3-faed-4c9c-bffd-09f4462ac109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120643890>]}
[0m13:57:47.835183 [info ] [MainThread]: Found 38 models, 24 data tests, 9 sources, 630 macros
[0m13:57:47.835313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822f57b3-faed-4c9c-bffd-09f4462ac109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12065bd90>]}
[0m13:57:47.844527 [info ] [MainThread]: 
[0m13:57:47.844725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:47.844835 [info ] [MainThread]: 
[0m13:57:47.845046 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:57:47.847158 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m13:57:47.847320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:48.218261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:57:48.219240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:48.515487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:57:48.517654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:48.840023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822f57b3-faed-4c9c-bffd-09f4462ac109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206b3ba0>]}
[0m13:57:48.840851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:48.847503 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:57:48.848007 [info ] [Thread-1 (]: 1 of 15 START test dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name  [RUN]
[0m13:57:48.848405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd)
[0m13:57:48.848706 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:57:48.859107 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m13:57:48.859784 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:57:48.951984 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m13:57:48.952489 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        icao, iata, name
    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
    group by icao, iata, name
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:57:48.952658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:49.569421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:118e186e-a034-4475-b220-5c151df4c3f0&page=queryresults
[0m13:57:50.069899 [info ] [Thread-1 (]: 1 of 15 PASS dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name . [[32mPASS[0m in 1.22s]
[0m13:57:50.070560 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:57:50.070897 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:57:50.071306 [info ] [Thread-1 (]: 2 of 15 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m13:57:50.071756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m13:57:50.072077 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:57:50.076391 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m13:57:50.077055 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:57:50.079153 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m13:57:50.079708 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airport_icao, terminal, business, location
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    group by airport_icao, terminal, business, location
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:57:50.080020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:50.513717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5a1e2526-3ac8-42c0-a2da-9771cfb7f139&page=queryresults
[0m13:57:50.951692 [info ] [Thread-1 (]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[32mPASS[0m in 0.88s]
[0m13:57:50.952944 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:57:50.953596 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:57:50.954121 [info ] [Thread-1 (]: 3 of 15 START test dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [RUN]
[0m13:57:50.954709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m13:57:50.955100 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:57:50.959239 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m13:57:50.960084 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:57:50.962405 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m13:57:50.962998 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_month, airline_id, airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    group by event_month, airline_id, airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:57:50.963466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:51.514261 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f94a8095-13ab-4f97-9ed4-454b608cd503&page=queryresults
[0m13:57:51.886560 [info ] [Thread-1 (]: 3 of 15 PASS dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [[32mPASS[0m in 0.93s]
[0m13:57:51.887573 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:57:51.888047 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:57:51.888516 [info ] [Thread-1 (]: 4 of 15 START test dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [RUN]
[0m13:57:51.889043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m13:57:51.889411 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:57:51.894582 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m13:57:51.895589 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:57:51.898140 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m13:57:51.898984 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    group by airline_id, source_airport_icao, dest_airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:57:51.899351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:52.538491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1aeea306-76b6-400c-9d86-c6756dac5257&page=queryresults
[0m13:57:53.156437 [info ] [Thread-1 (]: 4 of 15 PASS dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [[32mPASS[0m in 1.27s]
[0m13:57:53.157532 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:57:53.158027 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items.0ff4c7d889
[0m13:57:53.158512 [info ] [Thread-1 (]: 5 of 15 START test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items  [RUN]
[0m13:57:53.159053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items.0ff4c7d889)
[0m13:57:53.159428 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items.0ff4c7d889
[0m13:57:53.164648 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items.0ff4c7d889"
[0m13:57:53.165708 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items.0ff4c7d889
[0m13:57:53.168328 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items.0ff4c7d889"
[0m13:57:53.169088 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items.0ff4c7d889: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items.0ff4c7d889"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        business, menu_items
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    group by business, menu_items
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:57:53.169438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:53.664546 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0cd09a38-fcc8-4741-b963-9543d23cf556&page=queryresults
[0m13:57:53.665972 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0cd09a38-fcc8-4741-b963-9543d23cf556&page=queryresults
[0m13:57:53.679012 [debug] [Thread-1 (]: Database Error in test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items (models/int/schema.yml)
  Unrecognized name: menu_items; Did you mean menu_item? at [19:19]
  compiled code at target/run/air_travel/models/int/schema.yml/dbt_utils_unique_combination_o_a27ddb842481c32a13c4e2c19b44fa38.sql
[0m13:57:53.679658 [error] [Thread-1 (]: 5 of 15 ERROR dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items  [[31mERROR[0m in 0.52s]
[0m13:57:53.680140 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items.0ff4c7d889
[0m13:57:53.680465 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:57:53.680849 [debug] [Thread-4 (]: Marking all children of 'test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items.0ff4c7d889' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items (models/int/schema.yml)
  Unrecognized name: menu_items; Did you mean menu_item? at [19:19]
  compiled code at target/run/air_travel/models/int/schema.yml/dbt_utils_unique_combination_o_a27ddb842481c32a13c4e2c19b44fa38.sql.
[0m13:57:53.681157 [info ] [Thread-1 (]: 6 of 15 START test dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [RUN]
[0m13:57:53.682078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items.0ff4c7d889, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m13:57:53.682340 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:57:53.685976 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m13:57:53.686702 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:57:53.688613 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m13:57:53.689066 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:57:53.689320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:54.279283 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:fd3a6287-744b-4743-b44b-3f45076099bf&page=queryresults
[0m13:57:54.653662 [info ] [Thread-1 (]: 6 of 15 PASS dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [[32mPASS[0m in 0.97s]
[0m13:57:54.654678 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:57:54.655164 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:57:54.655628 [info ] [Thread-1 (]: 7 of 15 START test dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [RUN]
[0m13:57:54.656140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m13:57:54.656498 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:57:54.661654 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m13:57:54.662764 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:57:54.665347 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m13:57:54.666242 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_date, event_hour, airport_icao, security_checkpoint
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    group by event_date, event_hour, airport_icao, security_checkpoint
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:57:54.666644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:55.303592 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6a191bf1-6d85-4675-a043-73d3dc2aa085&page=queryresults
[0m13:57:55.681206 [info ] [Thread-1 (]: 7 of 15 PASS dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [[32mPASS[0m in 1.02s]
[0m13:57:55.682236 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:57:55.682868 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:57:55.683470 [info ] [Thread-1 (]: 8 of 15 START test not_null_Airline_id ......................................... [RUN]
[0m13:57:55.684026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m13:57:55.684388 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:57:55.690796 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m13:57:55.692654 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:57:55.694892 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m13:57:55.695458 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m13:57:55.695748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:56.145464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d4319db2-8912-4ea6-822b-1d1e5c6ae537&page=queryresults
[0m13:57:56.668755 [info ] [Thread-1 (]: 8 of 15 PASS not_null_Airline_id ............................................... [[32mPASS[0m in 0.98s]
[0m13:57:56.669414 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:57:56.669734 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:57:56.670109 [info ] [Thread-1 (]: 9 of 15 START test not_null_Airport_Establishment_business ..................... [RUN]
[0m13:57:56.670549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_Establishment_business.fa42968b3c)
[0m13:57:56.670855 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:57:56.674476 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m13:57:56.675287 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:57:56.677230 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m13:57:56.677706 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Establishment_business.fa42968b3c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select business
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
where business is null



  
  
      
    ) dbt_internal_test
[0m13:57:56.677987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:57.349962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b9a106b9-1eb4-40ca-bb79-547e2e22b713&page=queryresults
[0m13:57:57.781817 [info ] [Thread-1 (]: 9 of 15 PASS not_null_Airport_Establishment_business ........................... [[32mPASS[0m in 1.11s]
[0m13:57:57.782835 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:57:57.783385 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:57:57.784270 [info ] [Thread-1 (]: 10 of 15 START test not_null_Airport_icao ...................................... [RUN]
[0m13:57:57.784854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Establishment_business.fa42968b3c, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m13:57:57.785243 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:57:57.789847 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m13:57:57.790841 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:57:57.793388 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m13:57:57.794110 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m13:57:57.794432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:58.273653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2dec72cb-57b2-480d-a138-4bc59d0e0374&page=queryresults
[0m13:57:58.655974 [info ] [Thread-1 (]: 10 of 15 PASS not_null_Airport_icao ............................................ [[32mPASS[0m in 0.87s]
[0m13:57:58.656979 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:57:58.657437 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:57:58.657885 [info ] [Thread-1 (]: 11 of 15 START test not_null_Country_iso_code .................................. [RUN]
[0m13:57:58.658651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m13:57:58.659098 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:57:58.663190 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m13:57:58.663991 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:57:58.669867 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m13:57:58.670554 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m13:57:58.670843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:59.194691 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3438541f-29ac-44f5-a87e-cb2374c4e659&page=queryresults
[0m13:57:59.554614 [info ] [Thread-1 (]: 11 of 15 PASS not_null_Country_iso_code ........................................ [[32mPASS[0m in 0.90s]
[0m13:57:59.555525 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:57:59.555945 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m13:57:59.556361 [info ] [Thread-1 (]: 12 of 15 START test unique_Airline_id .......................................... [RUN]
[0m13:57:59.556976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Airline_id.cb196c2622)
[0m13:57:59.557687 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m13:57:59.563694 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m13:57:59.564494 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m13:57:59.566890 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m13:57:59.567338 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:57:59.567597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:00.116046 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7b1b3e5c-7f69-41a2-b78c-ac5e39fdee0f&page=queryresults
[0m13:58:00.479106 [info ] [Thread-1 (]: 12 of 15 PASS unique_Airline_id ................................................ [[32mPASS[0m in 0.92s]
[0m13:58:00.479886 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m13:58:00.480265 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:58:00.480645 [info ] [Thread-1 (]: 13 of 15 START test unique_Airport_Establishment_business ...................... [RUN]
[0m13:58:00.481093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_Establishment_business.c0ba13e1af)
[0m13:58:00.481405 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:58:00.485083 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m13:58:00.485934 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:58:00.488321 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m13:58:00.489006 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Establishment_business.c0ba13e1af: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select business as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
  where business is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:00.489326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:01.037801 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:717d7005-a6f6-4ba7-90d1-cca564797b8c&page=queryresults
[0m13:58:01.424725 [error] [Thread-1 (]: 13 of 15 FAIL 1 unique_Airport_Establishment_business .......................... [[31mFAIL 1[0m in 0.94s]
[0m13:58:01.425708 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:58:01.426166 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:58:01.426672 [info ] [Thread-1 (]: 14 of 15 START test unique_Airport_icao ........................................ [RUN]
[0m13:58:01.427182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Establishment_business.c0ba13e1af, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m13:58:01.427521 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:58:01.432347 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m13:58:01.433376 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:58:01.435885 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m13:58:01.436636 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:01.436992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:01.856370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d288cd4f-1d95-468c-8beb-1e23c774fc5f&page=queryresults
[0m13:58:02.212231 [info ] [Thread-1 (]: 14 of 15 PASS unique_Airport_icao .............................................. [[32mPASS[0m in 0.78s]
[0m13:58:02.213292 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:58:02.213776 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:58:02.214470 [info ] [Thread-1 (]: 15 of 15 START test unique_Country_iso_code .................................... [RUN]
[0m13:58:02.215241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m13:58:02.215630 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:58:02.219605 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m13:58:02.220390 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:58:02.222718 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m13:58:02.223279 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:02.223606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:02.677135 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:df031358-0af7-431e-9943-7b16695581cf&page=queryresults
[0m13:58:03.221911 [info ] [Thread-1 (]: 15 of 15 PASS unique_Country_iso_code .......................................... [[32mPASS[0m in 1.01s]
[0m13:58:03.222962 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:58:03.224615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:03.226911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:03.227365 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m13:58:03.227713 [info ] [MainThread]: 
[0m13:58:03.228039 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 15.38 seconds (15.38s).
[0m13:58:03.230358 [debug] [MainThread]: Command end result
[0m13:58:03.257320 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:58:03.258462 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:58:03.262225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:58:03.262381 [info ] [MainThread]: 
[0m13:58:03.262547 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:58:03.262679 [info ] [MainThread]: 
[0m13:58:03.262850 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items (models/int/schema.yml)[0m
[0m13:58:03.263011 [error] [MainThread]:   Database Error in test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_items (models/int/schema.yml)
  Unrecognized name: menu_items; Did you mean menu_item? at [19:19]
  compiled code at target/run/air_travel/models/int/schema.yml/dbt_utils_unique_combination_o_a27ddb842481c32a13c4e2c19b44fa38.sql
[0m13:58:03.263128 [info ] [MainThread]: 
[0m13:58:03.263267 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/schema.yml/dbt_utils_unique_combination_o_a27ddb842481c32a13c4e2c19b44fa38.sql
[0m13:58:03.263387 [info ] [MainThread]: 
[0m13:58:03.263530 [error] [MainThread]: [31mFailure in test unique_Airport_Establishment_business (models/int/schema.yml)[0m
[0m13:58:03.263668 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:58:03.263776 [info ] [MainThread]: 
[0m13:58:03.263909 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/schema.yml/unique_Airport_Establishment_business.sql
[0m13:58:03.264025 [info ] [MainThread]: 
[0m13:58:03.264164 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=15
[0m13:58:03.266458 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 16.594063, "process_in_blocks": "0", "process_kernel_time": 0.316715, "process_mem_max_rss": "394264576", "process_out_blocks": "0", "process_user_time": 2.757471}
[0m13:58:03.266660 [debug] [MainThread]: Command `dbt test` failed at 13:58:03.266620 after 16.59 seconds
[0m13:58:03.266835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d68a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120722f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207238b0>]}
[0m13:58:03.267000 [debug] [MainThread]: Flushing usage events
[0m13:58:03.473590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:37.603690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10860c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109457750>]}


============================== 14:00:37.605289 | c75d9c94-f3d1-43ba-8f4c-40b2396414d6 ==============================
[0m14:00:37.605289 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m14:00:37.605523 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'use_colors': 'True', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Reviews.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'printer_width': '80', 'use_experimental_parser': 'False'}
[0m14:00:38.425416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c75d9c94-f3d1-43ba-8f4c-40b2396414d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b0c30>]}
[0m14:00:38.445144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c75d9c94-f3d1-43ba-8f4c-40b2396414d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3c2360>]}
[0m14:00:38.445358 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:00:38.520811 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m14:00:38.567412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:00:38.567766 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m14:00:38.695445 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m14:00:38.700221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c75d9c94-f3d1-43ba-8f4c-40b2396414d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc94c50>]}
[0m14:00:38.734964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:00:38.735844 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:00:38.825799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c75d9c94-f3d1-43ba-8f4c-40b2396414d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb02300>]}
[0m14:00:38.826071 [info ] [MainThread]: Found 38 models, 26 data tests, 9 sources, 630 macros
[0m14:00:38.826202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c75d9c94-f3d1-43ba-8f4c-40b2396414d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc0b930>]}
[0m14:00:38.835348 [info ] [MainThread]: 
[0m14:00:38.835538 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:00:38.835648 [info ] [MainThread]: 
[0m14:00:38.835849 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:00:38.837992 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_int'
[0m14:00:38.838154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:39.115279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m14:00:39.116603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:39.394291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m14:00:39.396931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:39.685219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c75d9c94-f3d1-43ba-8f4c-40b2396414d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe8a820>]}
[0m14:00:39.685896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:39.689332 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m14:00:39.689603 [info ] [Thread-1 (]: 1 of 17 START test dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name  [RUN]
[0m14:00:39.689886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd)
[0m14:00:39.690115 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m14:00:39.699823 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m14:00:39.700344 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m14:00:39.712089 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m14:00:39.712531 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        icao, iata, name
    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
    group by icao, iata, name
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:00:39.712742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:40.435084 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b1f4b33d-d881-48a3-a16f-45844847db9c&page=queryresults
[0m14:00:40.935646 [info ] [Thread-1 (]: 1 of 17 PASS dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name . [[32mPASS[0m in 1.25s]
[0m14:00:40.936244 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m14:00:40.936484 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m14:00:40.936761 [info ] [Thread-1 (]: 2 of 17 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m14:00:40.937067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m14:00:40.937281 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m14:00:40.940886 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m14:00:40.941378 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m14:00:40.942739 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m14:00:40.943076 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airport_icao, terminal, business, location
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    group by airport_icao, terminal, business, location
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:00:40.943283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:41.465016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:527e994a-6b83-41c4-96ac-bb05c56a7618&page=queryresults
[0m14:00:41.872363 [info ] [Thread-1 (]: 2 of 17 PASS dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[32mPASS[0m in 0.93s]
[0m14:00:41.873410 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m14:00:41.873886 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m14:00:41.874362 [info ] [Thread-1 (]: 3 of 17 START test dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [RUN]
[0m14:00:41.874860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m14:00:41.875220 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m14:00:41.881604 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m14:00:41.882648 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m14:00:41.885138 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m14:00:41.885721 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_month, airline_id, airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    group by event_month, airline_id, airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:00:41.886067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:42.461100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:154e3c33-f7ba-4b39-aa3e-77aa09e720f5&page=queryresults
[0m14:00:42.825507 [info ] [Thread-1 (]: 3 of 17 PASS dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [[32mPASS[0m in 0.95s]
[0m14:00:42.827041 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m14:00:42.827593 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m14:00:42.828084 [info ] [Thread-1 (]: 4 of 17 START test dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [RUN]
[0m14:00:42.828659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m14:00:42.829041 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m14:00:42.834048 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m14:00:42.834851 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m14:00:42.837149 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m14:00:42.837666 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    group by airline_id, source_airport_icao, dest_airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:00:42.837961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:43.389009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6b3adf8e-a49b-46ef-8dfe-65d56e4dcad3&page=queryresults
[0m14:00:43.778917 [info ] [Thread-1 (]: 4 of 17 PASS dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [[32mPASS[0m in 0.95s]
[0m14:00:43.780043 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m14:00:43.780613 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m14:00:43.781141 [info ] [Thread-1 (]: 5 of 17 START test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [RUN]
[0m14:00:43.781704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965)
[0m14:00:43.782347 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m14:00:43.786903 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m14:00:43.787808 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m14:00:43.790407 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m14:00:43.791081 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        business, menu_item
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    group by business, menu_item
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:00:43.791423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:44.329619 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ee4a5f6f-7e34-4c76-976e-c8c34d493a68&page=queryresults
[0m14:00:44.695734 [info ] [Thread-1 (]: 5 of 17 PASS dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [[32mPASS[0m in 0.91s]
[0m14:00:44.697011 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m14:00:44.697436 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:00:44.697828 [info ] [Thread-1 (]: 6 of 17 START test dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [RUN]
[0m14:00:44.698630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m14:00:44.699182 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:00:44.704053 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m14:00:44.704903 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:00:44.707292 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m14:00:44.708099 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:00:44.708459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:45.247402 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ae546cf7-2905-4544-a7db-0099ff902a6c&page=queryresults
[0m14:00:45.606756 [info ] [Thread-1 (]: 6 of 17 PASS dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [[32mPASS[0m in 0.91s]
[0m14:00:45.607557 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:00:45.607925 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m14:00:45.608317 [info ] [Thread-1 (]: 7 of 17 START test dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [RUN]
[0m14:00:45.608812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m14:00:45.609095 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m14:00:45.613679 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m14:00:45.614386 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m14:00:45.616462 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m14:00:45.617072 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_date, event_hour, airport_icao, security_checkpoint
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    group by event_date, event_hour, airport_icao, security_checkpoint
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:00:45.617338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:46.271460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d1e80d2d-3af8-445a-8bae-6982a7a955a4&page=queryresults
[0m14:00:46.659696 [info ] [Thread-1 (]: 7 of 17 PASS dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [[32mPASS[0m in 1.05s]
[0m14:00:46.660745 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m14:00:46.661220 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m14:00:46.661680 [info ] [Thread-1 (]: 8 of 17 START test not_null_Airline_id ......................................... [RUN]
[0m14:00:46.662576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m14:00:46.663050 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m14:00:46.669816 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m14:00:46.670589 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m14:00:46.672684 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m14:00:46.673139 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m14:00:46.673403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:47.194372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5ab74135-12a0-4df3-b1fe-9ffa3176333a&page=queryresults
[0m14:00:47.603157 [info ] [Thread-1 (]: 8 of 17 PASS not_null_Airline_id ............................................... [[32mPASS[0m in 0.94s]
[0m14:00:47.604087 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m14:00:47.604493 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m14:00:47.604894 [info ] [Thread-1 (]: 9 of 17 START test not_null_Airport_Establishment_business ..................... [RUN]
[0m14:00:47.605353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_Establishment_business.fa42968b3c)
[0m14:00:47.605690 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m14:00:47.610728 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m14:00:47.611836 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m14:00:47.617720 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m14:00:47.618358 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Establishment_business.fa42968b3c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select business
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
where business is null



  
  
      
    ) dbt_internal_test
[0m14:00:47.618644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:48.116597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:59234104-82a2-4f1c-9972-399373fad8d7&page=queryresults
[0m14:00:48.455097 [info ] [Thread-1 (]: 9 of 17 PASS not_null_Airport_Establishment_business ........................... [[32mPASS[0m in 0.85s]
[0m14:00:48.455942 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m14:00:48.456592 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e
[0m14:00:48.457149 [info ] [Thread-1 (]: 10 of 17 START test not_null_Airport_Reviews_id ................................ [RUN]
[0m14:00:48.457583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Establishment_business.fa42968b3c, now test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e)
[0m14:00:48.457866 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e
[0m14:00:48.461590 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e"
[0m14:00:48.462381 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e
[0m14:00:48.464474 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e"
[0m14:00:48.465015 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Reviews`
where id is null



  
  
      
    ) dbt_internal_test
[0m14:00:48.465304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:49.024916 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:04677615-668c-41a8-b9c2-84e792b29761&page=queryresults
[0m14:00:49.404463 [info ] [Thread-1 (]: 10 of 17 PASS not_null_Airport_Reviews_id ...................................... [[32mPASS[0m in 0.95s]
[0m14:00:49.405465 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e
[0m14:00:49.405945 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m14:00:49.406409 [info ] [Thread-1 (]: 11 of 17 START test not_null_Airport_icao ...................................... [RUN]
[0m14:00:49.406905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m14:00:49.407274 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m14:00:49.412565 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m14:00:49.413572 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m14:00:49.416371 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m14:00:49.417113 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m14:00:49.417466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:49.807327 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:44afb81e-e382-41ac-868d-a208d4c29b50&page=queryresults
[0m14:00:50.155025 [info ] [Thread-1 (]: 11 of 17 PASS not_null_Airport_icao ............................................ [[32mPASS[0m in 0.75s]
[0m14:00:50.155976 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m14:00:50.156404 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m14:00:50.156814 [info ] [Thread-1 (]: 12 of 17 START test not_null_Country_iso_code .................................. [RUN]
[0m14:00:50.157307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m14:00:50.157664 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m14:00:50.162299 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m14:00:50.163196 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m14:00:50.165794 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m14:00:50.166472 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m14:00:50.166814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:50.674728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e9dad3fc-76d2-470e-a1a1-a0b4ab4d4d18&page=queryresults
[0m14:00:51.219659 [info ] [Thread-1 (]: 12 of 17 PASS not_null_Country_iso_code ........................................ [[32mPASS[0m in 1.06s]
[0m14:00:51.220530 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m14:00:51.221202 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m14:00:51.221752 [info ] [Thread-1 (]: 13 of 17 START test unique_Airline_id .......................................... [RUN]
[0m14:00:51.222248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Airline_id.cb196c2622)
[0m14:00:51.222565 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m14:00:51.227941 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m14:00:51.228647 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m14:00:51.230792 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m14:00:51.231269 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:00:51.231532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:51.699346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:89f4868f-a6de-4312-9dbe-e62356f88fba&page=queryresults
[0m14:00:52.108093 [info ] [Thread-1 (]: 13 of 17 PASS unique_Airline_id ................................................ [[32mPASS[0m in 0.89s]
[0m14:00:52.109023 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m14:00:52.109440 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m14:00:52.109859 [info ] [Thread-1 (]: 14 of 17 START test unique_Airport_Establishment_business ...................... [RUN]
[0m14:00:52.110327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_Establishment_business.c0ba13e1af)
[0m14:00:52.110669 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m14:00:52.115214 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m14:00:52.116191 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m14:00:52.118626 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m14:00:52.119226 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Establishment_business.c0ba13e1af: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select business as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
  where business is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:00:52.119558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:52.572469 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2891207c-7973-4e68-8bf4-d7baa3ab78d4&page=queryresults
[0m14:00:52.927208 [error] [Thread-1 (]: 14 of 17 FAIL 1 unique_Airport_Establishment_business .......................... [[31mFAIL 1[0m in 0.82s]
[0m14:00:52.928173 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m14:00:52.928598 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Reviews_id.71cb9a3cce
[0m14:00:52.929011 [info ] [Thread-1 (]: 15 of 17 START test unique_Airport_Reviews_id .................................. [RUN]
[0m14:00:52.929485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Establishment_business.c0ba13e1af, now test.air_travel.unique_Airport_Reviews_id.71cb9a3cce)
[0m14:00:52.929835 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Reviews_id.71cb9a3cce
[0m14:00:52.934342 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Reviews_id.71cb9a3cce"
[0m14:00:52.935309 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Reviews_id.71cb9a3cce
[0m14:00:52.937614 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Reviews_id.71cb9a3cce"
[0m14:00:52.938202 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Reviews_id.71cb9a3cce: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Reviews_id.71cb9a3cce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Reviews`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:00:52.938538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:53.470140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:654a5034-0e63-45b2-a3f2-9b512e6ad1b0&page=queryresults
[0m14:00:53.867576 [info ] [Thread-1 (]: 15 of 17 PASS unique_Airport_Reviews_id ........................................ [[32mPASS[0m in 0.94s]
[0m14:00:53.868453 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Reviews_id.71cb9a3cce
[0m14:00:53.869017 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m14:00:53.869509 [info ] [Thread-1 (]: 16 of 17 START test unique_Airport_icao ........................................ [RUN]
[0m14:00:53.869871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Reviews_id.71cb9a3cce, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m14:00:53.870111 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m14:00:53.873105 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m14:00:53.873727 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m14:00:53.875455 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m14:00:53.875825 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:00:53.876037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:54.362453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4c35a493-a02b-4dd9-a938-00f029466bcf&page=queryresults
[0m14:00:54.762501 [info ] [Thread-1 (]: 16 of 17 PASS unique_Airport_icao .............................................. [[32mPASS[0m in 0.89s]
[0m14:00:54.763396 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m14:00:54.763778 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m14:00:54.764163 [info ] [Thread-1 (]: 17 of 17 START test unique_Country_iso_code .................................... [RUN]
[0m14:00:54.765025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m14:00:54.765382 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m14:00:54.768759 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m14:00:54.769452 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m14:00:54.771569 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m14:00:54.772105 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:00:54.772381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:55.282856 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:58466418-7a16-49ec-b96b-28ca9cac1149&page=queryresults
[0m14:00:55.849057 [info ] [Thread-1 (]: 17 of 17 PASS unique_Country_iso_code .......................................... [[32mPASS[0m in 1.08s]
[0m14:00:55.850035 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m14:00:55.851708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:55.854006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:55.854556 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m14:00:55.854911 [info ] [MainThread]: 
[0m14:00:55.855244 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 17.02 seconds (17.02s).
[0m14:00:55.857698 [debug] [MainThread]: Command end result
[0m14:00:55.886305 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:00:55.887285 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:00:55.890827 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m14:00:55.890975 [info ] [MainThread]: 
[0m14:00:55.891145 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:00:55.891280 [info ] [MainThread]: 
[0m14:00:55.891452 [error] [MainThread]: [31mFailure in test unique_Airport_Establishment_business (models/int/schema.yml)[0m
[0m14:00:55.891602 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:00:55.891715 [info ] [MainThread]: 
[0m14:00:55.891854 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/schema.yml/unique_Airport_Establishment_business.sql
[0m14:00:55.891977 [info ] [MainThread]: 
[0m14:00:55.892115 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=17
[0m14:00:55.894416 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 18.31426, "process_in_blocks": "0", "process_kernel_time": 0.303877, "process_mem_max_rss": "395460608", "process_out_blocks": "0", "process_user_time": 2.898502}
[0m14:00:55.894583 [debug] [MainThread]: Command `dbt test` failed at 14:00:55.894548 after 18.31 seconds
[0m14:00:55.894726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc2f960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc2c1b0>]}
[0m14:00:55.894850 [debug] [MainThread]: Flushing usage events
[0m14:00:56.116294 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:52.625474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5e86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d433750>]}


============================== 17:50:52.627121 | 46da3314-3d1a-4052-bd33-3642ad815fba ==============================
[0m17:50:52.627121 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m17:50:52.627364 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select tmp_airport_establishment_dedup', 'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'empty': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False'}
[0m17:50:53.452898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46da3314-3d1a-4052-bd33-3642ad815fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c78cc30>]}
[0m17:50:53.472323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46da3314-3d1a-4052-bd33-3642ad815fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233be360>]}
[0m17:50:53.472547 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m17:50:53.548707 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m17:50:53.595148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:50:53.595378 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_establishment_dedup.py
[0m17:50:53.675896 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m17:50:53.680559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46da3314-3d1a-4052-bd33-3642ad815fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237da850>]}
[0m17:50:53.717237 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m17:50:53.718129 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m17:50:53.724944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46da3314-3d1a-4052-bd33-3642ad815fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238bb6b0>]}
[0m17:50:53.725141 [info ] [MainThread]: Found 39 models, 26 data tests, 9 sources, 630 macros
[0m17:50:53.725269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46da3314-3d1a-4052-bd33-3642ad815fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234873f0>]}
[0m17:50:53.726069 [info ] [MainThread]: 
[0m17:50:53.726198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:53.726292 [info ] [MainThread]: 
[0m17:50:53.726473 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:50:53.726836 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m17:50:53.727000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:54.066777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m17:50:54.067318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:54.356446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m17:50:54.359223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:54.666077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m17:50:54.668758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:54.960750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46da3314-3d1a-4052-bd33-3642ad815fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cbfe10>]}
[0m17:50:54.961405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:54.964775 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_dedup
[0m17:50:54.965217 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [RUN]
[0m17:50:54.965561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_establishment_dedup)
[0m17:50:54.965842 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_dedup
[0m17:50:54.984714 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_dedup"
[0m17:50:54.985296 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_dedup
[0m17:50:55.002337 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_dedup"
[0m17:50:55.002746 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    
    source_df = dbt.ref("tmp_airport_establishment_unique")
    counts_series = source_df.groupby['business'].size()
    counts_df = counts_series.reset_index(name='count')
    print("counts_df:", counts_df)

    return dbt


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"tmp_airport_establishment_unique": "cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_unique"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup", if_exists="replace")
df._session.close()

  
[0m17:50:55.003603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:55.004310 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/air_travel/models/tmp/tmp_airport_establishment_dedup.py[0m
Need to supply compute_region in profile to submit python job
[0m17:50:55.007843 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/base.py", line 363, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/base.py", line 310, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/base.py", line 410, in run
    return self.execute(compiled_node, manifest)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/run.py", line 336, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/run.py", line 296, in _execute_model
    result = MacroGenerator(
        materialization_macro, context, stack=context["context_macro_stack"]
    )()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/context/providers.py", line 1715, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 218, in execution_with_log
    response = code_execution_function(*args)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1724, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
        parsed_model, self.connections.profile.credentials
    )
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/adapters/bigquery/python_submissions.py", line 199, in __init__
    super().__init__(parsed_model, credentials)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/adapters/bigquery/python_submissions.py", line 55, in __init__
    raise ValueError(
        f"Need to supply {required_config} in profile to submit python job"
    )
ValueError: Need to supply compute_region in profile to submit python job

[0m17:50:55.008991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46da3314-3d1a-4052-bd33-3642ad815fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c8d3d0>]}
[0m17:50:55.009349 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [[31mERROR[0m in 0.04s]
[0m17:50:55.009686 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_dedup
[0m17:50:55.009975 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_dedup' to be skipped because of status 'error'.  Reason: Need to supply compute_region in profile to submit python job.
[0m17:50:55.010816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:55.011535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:55.011651 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_dedup' was properly closed.
[0m17:50:55.011762 [info ] [MainThread]: 
[0m17:50:55.011874 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m17:50:55.012111 [debug] [MainThread]: Command end result
[0m17:50:55.110050 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m17:50:55.110840 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m17:50:55.112863 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m17:50:55.112968 [info ] [MainThread]: 
[0m17:50:55.113106 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:50:55.113210 [info ] [MainThread]: 
[0m17:50:55.113344 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)[0m
[0m17:50:55.113465 [error] [MainThread]:   Need to supply compute_region in profile to submit python job
[0m17:50:55.113557 [info ] [MainThread]: 
[0m17:50:55.113671 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_dedup.py
[0m17:50:55.113764 [info ] [MainThread]: 
[0m17:50:55.113874 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:50:55.115596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.514366, "process_in_blocks": "0", "process_kernel_time": 0.243557, "process_mem_max_rss": "387497984", "process_out_blocks": "0", "process_user_time": 1.743715}
[0m17:50:55.115739 [debug] [MainThread]: Command `dbt run` failed at 17:50:55.115712 after 2.51 seconds
[0m17:50:55.115858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123360cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b46490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b46850>]}
[0m17:50:55.115965 [debug] [MainThread]: Flushing usage events
[0m17:50:55.321668 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:56:53.157923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5646e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3af9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3af750>]}


============================== 17:56:53.159568 | 877eabf4-cdbe-4e8f-b6fd-41b2728618e1 ==============================
[0m17:56:53.159568 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m17:56:53.159807 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'version_check': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'log_format': 'default', 'use_colors': 'True', 'empty': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select tmp_airport_establishment_dedup', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'fail_fast': 'False', 'target_path': 'None'}
[0m17:56:53.981819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '877eabf4-cdbe-4e8f-b6fd-41b2728618e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a708c30>]}
[0m17:56:54.001132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '877eabf4-cdbe-4e8f-b6fd-41b2728618e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212c6360>]}
[0m17:56:54.001334 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m17:56:54.076070 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m17:56:54.111693 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:56:54.111891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '877eabf4-cdbe-4e8f-b6fd-41b2728618e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216db450>]}
[0m17:56:54.715124 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m17:56:54.718750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '877eabf4-cdbe-4e8f-b6fd-41b2728618e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217b86e0>]}
[0m17:56:54.752666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m17:56:54.753495 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m17:56:54.760182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '877eabf4-cdbe-4e8f-b6fd-41b2728618e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214f2430>]}
[0m17:56:54.760349 [info ] [MainThread]: Found 39 models, 26 data tests, 9 sources, 630 macros
[0m17:56:54.760476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877eabf4-cdbe-4e8f-b6fd-41b2728618e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121858e20>]}
[0m17:56:54.761200 [info ] [MainThread]: 
[0m17:56:54.761326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:56:54.761422 [info ] [MainThread]: 
[0m17:56:54.761609 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:56:54.761938 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m17:56:54.762098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:55.099242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m17:56:55.099787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:55.380344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m17:56:55.382172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:55.656977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m17:56:55.658411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:55.947436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877eabf4-cdbe-4e8f-b6fd-41b2728618e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c45cd0>]}
[0m17:56:55.948225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:56:55.951945 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_dedup
[0m17:56:55.952431 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [RUN]
[0m17:56:55.952786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_establishment_dedup)
[0m17:56:55.953067 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_dedup
[0m17:56:55.974208 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_dedup"
[0m17:56:55.974826 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_dedup
[0m17:56:55.992100 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_dedup"
[0m17:56:55.992612 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    
    source_df = dbt.ref("tmp_airport_establishment_unique")
    counts_series = source_df.groupby['business'].size()
    counts_df = counts_series.reset_index(name='count')
    print("counts_df:", counts_df)

    return dbt


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"tmp_airport_establishment_unique": "cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_unique"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup", if_exists="replace")
df._session.close()

  
[0m17:56:55.993484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:55.994217 [error] [Thread-1 (]: [31mUnhandled error while executing target/run/air_travel/models/tmp/tmp_airport_establishment_dedup.py[0m
Need to supply gcs_bucket in profile to submit python job
[0m17:56:55.996560 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/base.py", line 363, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/base.py", line 310, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/base.py", line 410, in run
    return self.execute(compiled_node, manifest)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/run.py", line 336, in execute
    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/run.py", line 296, in _execute_model
    result = MacroGenerator(
        materialization_macro, context, stack=context["context_macro_stack"]
    )()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/context/providers.py", line 1715, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 218, in execution_with_log
    response = code_execution_function(*args)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1724, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
        parsed_model, self.connections.profile.credentials
    )
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/adapters/bigquery/python_submissions.py", line 199, in __init__
    super().__init__(parsed_model, credentials)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/adapters/bigquery/python_submissions.py", line 55, in __init__
    raise ValueError(
        f"Need to supply {required_config} in profile to submit python job"
    )
ValueError: Need to supply gcs_bucket in profile to submit python job

[0m17:56:55.997444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '877eabf4-cdbe-4e8f-b6fd-41b2728618e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c49860>]}
[0m17:56:55.997740 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [[31mERROR[0m in 0.04s]
[0m17:56:55.997996 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_dedup
[0m17:56:55.998238 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_dedup' to be skipped because of status 'error'.  Reason: Need to supply gcs_bucket in profile to submit python job.
[0m17:56:55.999074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:56:55.999809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:55.999942 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_dedup' was properly closed.
[0m17:56:56.000066 [info ] [MainThread]: 
[0m17:56:56.000195 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m17:56:56.000456 [debug] [MainThread]: Command end result
[0m17:56:56.017892 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m17:56:56.019070 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m17:56:56.021388 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m17:56:56.021512 [info ] [MainThread]: 
[0m17:56:56.021662 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:56:56.021789 [info ] [MainThread]: 
[0m17:56:56.021930 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)[0m
[0m17:56:56.022062 [error] [MainThread]:   Need to supply gcs_bucket in profile to submit python job
[0m17:56:56.022160 [info ] [MainThread]: 
[0m17:56:56.022271 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_dedup.py
[0m17:56:56.022361 [info ] [MainThread]: 
[0m17:56:56.022470 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:56:56.024326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8898935, "process_in_blocks": "0", "process_kernel_time": 0.246802, "process_mem_max_rss": "391856128", "process_out_blocks": "0", "process_user_time": 2.162323}
[0m17:56:56.024493 [debug] [MainThread]: Command `dbt run` failed at 17:56:56.024460 after 2.89 seconds
[0m17:56:56.024631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d62b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c3b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121753450>]}
[0m17:56:56.024757 [debug] [MainThread]: Flushing usage events
[0m17:56:56.253735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:26.958086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085146e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935f750>]}


============================== 18:01:26.959699 | f427e89f-6edb-4004-8196-fdf0c462cc51 ==============================
[0m18:01:26.959699 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m18:01:26.959941 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'empty': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'invocation_command': 'dbt run --select tmp_airport_establishment_dedup', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m18:01:27.780972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f427e89f-6edb-4004-8196-fdf0c462cc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b8c30>]}
[0m18:01:27.800233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f427e89f-6edb-4004-8196-fdf0c462cc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3c2360>]}
[0m18:01:27.800438 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m18:01:27.874847 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m18:01:27.910368 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:01:27.910564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f427e89f-6edb-4004-8196-fdf0c462cc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7db450>]}
[0m18:01:28.506510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m18:01:28.510104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f427e89f-6edb-4004-8196-fdf0c462cc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8b86e0>]}
[0m18:01:28.544990 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m18:01:28.545845 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m18:01:28.552617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f427e89f-6edb-4004-8196-fdf0c462cc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5f2430>]}
[0m18:01:28.552807 [info ] [MainThread]: Found 39 models, 26 data tests, 9 sources, 630 macros
[0m18:01:28.552933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f427e89f-6edb-4004-8196-fdf0c462cc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f980d50>]}
[0m18:01:28.553714 [info ] [MainThread]: 
[0m18:01:28.553844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:28.553939 [info ] [MainThread]: 
[0m18:01:28.554130 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:01:28.554471 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m18:01:28.554633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:28.872064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m18:01:28.872627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:29.162080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m18:01:29.164522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:29.471110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m18:01:29.473751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:29.764166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f427e89f-6edb-4004-8196-fdf0c462cc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd49910>]}
[0m18:01:29.764812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:29.768389 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_dedup
[0m18:01:29.768907 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [RUN]
[0m18:01:29.769292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_establishment_dedup)
[0m18:01:29.769577 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_dedup
[0m18:01:29.788718 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_dedup"
[0m18:01:29.789260 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_dedup
[0m18:01:29.806345 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_dedup"
[0m18:01:29.806720 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    
    source_df = dbt.ref("tmp_airport_establishment_unique")
    counts_series = source_df.groupby['business'].size()
    counts_df = counts_series.reset_index(name='count')
    print("counts_df:", counts_df)

    return dbt


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"tmp_airport_establishment_unique": "cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_unique"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup", if_exists="replace")
df._session.close()

  
[0m18:01:30.813524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:30.828376 [debug] [Thread-1 (]: Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  An unexpected error occured while executing the notebook: 400 You do not have permission to act as service_account: dbt-user@cs378-fa2025.iam.gserviceaccount.com. (or it may not exist).
[0m18:01:30.830066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f427e89f-6edb-4004-8196-fdf0c462cc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fedcd60>]}
[0m18:01:30.830603 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [[31mERROR[0m in 1.06s]
[0m18:01:30.831015 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_dedup
[0m18:01:30.831415 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_dedup' to be skipped because of status 'error'.  Reason: Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  An unexpected error occured while executing the notebook: 400 You do not have permission to act as service_account: dbt-user@cs378-fa2025.iam.gserviceaccount.com. (or it may not exist)..
[0m18:01:30.832900 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:30.834139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:30.834358 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_dedup' was properly closed.
[0m18:01:30.834563 [info ] [MainThread]: 
[0m18:01:30.834773 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m18:01:30.835203 [debug] [MainThread]: Command end result
[0m18:01:30.859083 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m18:01:30.860078 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m18:01:30.862834 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m18:01:30.862966 [info ] [MainThread]: 
[0m18:01:30.863130 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:01:30.863261 [info ] [MainThread]: 
[0m18:01:30.863425 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)[0m
[0m18:01:30.863587 [error] [MainThread]:   Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  An unexpected error occured while executing the notebook: 400 You do not have permission to act as service_account: dbt-user@cs378-fa2025.iam.gserviceaccount.com. (or it may not exist).
[0m18:01:30.863705 [info ] [MainThread]: 
[0m18:01:30.863845 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_dedup.py
[0m18:01:30.863965 [info ] [MainThread]: 
[0m18:01:30.864103 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:01:30.866331 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.9318328, "process_in_blocks": "0", "process_kernel_time": 0.261369, "process_mem_max_rss": "410435584", "process_out_blocks": "0", "process_user_time": 2.292639}
[0m18:01:30.866529 [debug] [MainThread]: Command `dbt run` failed at 18:01:30.866490 after 3.93 seconds
[0m18:01:30.866691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe05770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe81640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f891cd0>]}
[0m18:01:30.866835 [debug] [MainThread]: Flushing usage events
[0m18:01:31.076434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:29.239658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5146e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d35f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d35f750>]}


============================== 19:04:29.241422 | 0b03b843-9b81-4bd3-a18d-3beefad21365 ==============================
[0m19:04:29.241422 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:04:29.241659 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'introspect': 'True', 'static_parser': 'True', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'invocation_command': 'dbt run --select tmp_airport_establishment_dedup', 'log_format': 'default', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m19:04:30.099529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b03b843-9b81-4bd3-a18d-3beefad21365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6b8c30>]}
[0m19:04:30.119415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b03b843-9b81-4bd3-a18d-3beefad21365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233c2360>]}
[0m19:04:30.119647 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:04:30.197867 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:04:30.244186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:30.244364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:30.246902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m19:04:30.263846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b03b843-9b81-4bd3-a18d-3beefad21365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237deb50>]}
[0m19:04:30.299061 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:04:30.299976 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:04:30.306952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b03b843-9b81-4bd3-a18d-3beefad21365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233ce8a0>]}
[0m19:04:30.307155 [info ] [MainThread]: Found 39 models, 26 data tests, 9 sources, 630 macros
[0m19:04:30.307280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b03b843-9b81-4bd3-a18d-3beefad21365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a10bb0>]}
[0m19:04:30.308044 [info ] [MainThread]: 
[0m19:04:30.308171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:04:30.308262 [info ] [MainThread]: 
[0m19:04:30.308454 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:04:30.308800 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m19:04:30.308958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:30.650499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m19:04:30.651061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:30.910920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m19:04:30.913290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:31.182094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m19:04:31.183995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:31.472636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b03b843-9b81-4bd3-a18d-3beefad21365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b2b860>]}
[0m19:04:31.473424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:31.476915 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_dedup
[0m19:04:31.477413 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [RUN]
[0m19:04:31.477782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_establishment_dedup)
[0m19:04:31.478056 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_dedup
[0m19:04:31.498753 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_dedup"
[0m19:04:31.499402 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_dedup
[0m19:04:31.516141 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_dedup"
[0m19:04:31.516604 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    
    source_df = dbt.ref("tmp_airport_establishment_unique")
    counts_series = source_df.groupby['business'].size()
    counts_df = counts_series.reset_index(name='count')
    print("counts_df:", counts_df)

    return dbt


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"tmp_airport_establishment_unique": "cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_unique"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup", if_exists="replace")
df._session.close()

  
[0m19:04:32.381997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:32.393708 [debug] [Thread-1 (]: Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  An unexpected error occured while executing the notebook: 400 You do not have permission to act as service_account: dbt-user@cs378-fa2025.iam.gserviceaccount.com. (or it may not exist).
[0m19:04:32.395476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b03b843-9b81-4bd3-a18d-3beefad21365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bf2510>]}
[0m19:04:32.396098 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [[31mERROR[0m in 0.92s]
[0m19:04:32.396597 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_dedup
[0m19:04:32.397004 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_dedup' to be skipped because of status 'error'.  Reason: Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  An unexpected error occured while executing the notebook: 400 You do not have permission to act as service_account: dbt-user@cs378-fa2025.iam.gserviceaccount.com. (or it may not exist)..
[0m19:04:32.398798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:04:32.400108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:32.400328 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_dedup' was properly closed.
[0m19:04:32.400546 [info ] [MainThread]: 
[0m19:04:32.400769 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m19:04:32.401295 [debug] [MainThread]: Command end result
[0m19:04:32.425857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:04:32.426944 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:04:32.429799 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m19:04:32.429943 [info ] [MainThread]: 
[0m19:04:32.430113 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:04:32.430257 [info ] [MainThread]: 
[0m19:04:32.430432 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)[0m
[0m19:04:32.430592 [error] [MainThread]:   Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  An unexpected error occured while executing the notebook: 400 You do not have permission to act as service_account: dbt-user@cs378-fa2025.iam.gserviceaccount.com. (or it may not exist).
[0m19:04:32.430708 [info ] [MainThread]: 
[0m19:04:32.430846 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_dedup.py
[0m19:04:32.430960 [info ] [MainThread]: 
[0m19:04:32.431101 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:04:32.433427 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2188911, "process_in_blocks": "0", "process_kernel_time": 0.273154, "process_mem_max_rss": "403767296", "process_out_blocks": "0", "process_user_time": 1.766198}
[0m19:04:32.433627 [debug] [MainThread]: Command `dbt run` failed at 19:04:32.433589 after 3.22 seconds
[0m19:04:32.433786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bb07e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123be5770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123be5630>]}
[0m19:04:32.433933 [debug] [MainThread]: Flushing usage events
[0m19:04:32.652629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:04.444348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b986e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099df9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099df750>]}


============================== 19:16:04.446109 | a3e05d7b-d915-49c7-9aee-4ba682580943 ==============================
[0m19:16:04.446109 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:16:04.446360 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'empty': 'False', 'partial_parse': 'True', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'invocation_command': 'dbt run --select tmp_airport_establishment_broad_categories_frequency', 'log_format': 'default'}
[0m19:16:05.344632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3e05d7b-d915-49c7-9aee-4ba682580943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d38c30>]}
[0m19:16:05.365663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3e05d7b-d915-49c7-9aee-4ba682580943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9c6360>]}
[0m19:16:05.365961 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:16:05.446735 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:16:05.493025 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m19:16:05.493360 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_establishment_broad_categories_frequency.sql
[0m19:16:05.493474 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_establishment_broad_categories_dedup.py
[0m19:16:05.493562 [debug] [MainThread]: Partial parsing: deleted file: air_travel://models/tmp/tmp_airport_establishment_dedup.py
[0m19:16:05.575709 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m19:16:05.580425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3e05d7b-d915-49c7-9aee-4ba682580943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fdda850>]}
[0m19:16:05.616850 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:16:05.617742 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:16:05.624621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3e05d7b-d915-49c7-9aee-4ba682580943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11febb3e0>]}
[0m19:16:05.624789 [info ] [MainThread]: Found 40 models, 26 data tests, 9 sources, 630 macros
[0m19:16:05.624921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3e05d7b-d915-49c7-9aee-4ba682580943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa87930>]}
[0m19:16:05.625663 [info ] [MainThread]: 
[0m19:16:05.625792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:05.625883 [info ] [MainThread]: 
[0m19:16:05.626085 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:16:05.626391 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m19:16:05.626539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:05.962949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m19:16:05.963261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:06.255028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m19:16:06.256321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:06.542676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m19:16:06.544715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:06.807356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3e05d7b-d915-49c7-9aee-4ba682580943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120247110>]}
[0m19:16:06.808297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:06.812222 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m19:16:06.812764 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_frequency  [RUN]
[0m19:16:06.813162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_establishment_broad_categories_frequency)
[0m19:16:06.813463 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m19:16:06.820375 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_frequency"
[0m19:16:06.821047 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m19:16:06.844789 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_establishment_broad_categories_frequency"
[0m19:16:06.845334 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_broad_categories_frequency: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_establishment_broad_categories_frequency"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_frequency`
      
    
    

    
    OPTIONS()
    as (
      with broad_categories_frequency as (
    select broad_category, count(*) as count
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_mapped`
    group by broad_category
    order by count desc
)

select *
from broad_categories_frequency
    );
  
[0m19:16:06.845559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:07.451950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e6bf01e2-e56c-450b-83a5-524f01277022&page=queryresults
[0m19:16:09.487100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3e05d7b-d915-49c7-9aee-4ba682580943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202e5610>]}
[0m19:16:09.487560 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_frequency  [[32mCREATE TABLE (11.0 rows, 19.9 KiB processed)[0m in 2.67s]
[0m19:16:09.487928 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m19:16:09.488649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:16:09.489591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:09.489742 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_broad_categories_frequency' was properly closed.
[0m19:16:09.489894 [info ] [MainThread]: 
[0m19:16:09.490058 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m19:16:09.490414 [debug] [MainThread]: Command end result
[0m19:16:09.596913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:16:09.597735 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:16:09.599782 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m19:16:09.599890 [info ] [MainThread]: 
[0m19:16:09.600035 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:09.600140 [info ] [MainThread]: 
[0m19:16:09.600255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:16:09.602049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1818876, "process_in_blocks": "0", "process_kernel_time": 0.284401, "process_mem_max_rss": "393183232", "process_out_blocks": "0", "process_user_time": 1.866678}
[0m19:16:09.602196 [debug] [MainThread]: Command `dbt run` succeeded at 19:16:09.602168 after 5.18 seconds
[0m19:16:09.602311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9603c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120139310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120138e10>]}
[0m19:16:09.602427 [debug] [MainThread]: Flushing usage events
[0m19:16:09.810026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:36.901528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af4c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd979d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd97750>]}


============================== 19:33:36.903143 | da6412f9-140b-4157-8faa-a1423544b007 ==============================
[0m19:33:36.903143 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:33:36.903375 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'empty': 'False', 'write_json': 'True', 'introspect': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select tmp_airport_establishment_broad_categories_dedup', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'partial_parse': 'True', 'use_colors': 'True', 'target_path': 'None'}
[0m19:33:37.726490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da6412f9-140b-4157-8faa-a1423544b007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0f0c30>]}
[0m19:33:37.746292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da6412f9-140b-4157-8faa-a1423544b007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121cc6360>]}
[0m19:33:37.746508 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:33:37.822291 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:33:37.867999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:37.868144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:37.870612 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m19:33:37.887453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da6412f9-140b-4157-8faa-a1423544b007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220d6b50>]}
[0m19:33:37.922595 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:33:37.923408 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:33:37.930195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da6412f9-140b-4157-8faa-a1423544b007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121cce8a0>]}
[0m19:33:37.930366 [info ] [MainThread]: Found 40 models, 26 data tests, 9 sources, 630 macros
[0m19:33:37.930494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da6412f9-140b-4157-8faa-a1423544b007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12230cf30>]}
[0m19:33:37.931229 [info ] [MainThread]: 
[0m19:33:37.931358 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:37.931453 [info ] [MainThread]: 
[0m19:33:37.931639 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:33:37.931958 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m19:33:37.932135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:38.275313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m19:33:38.275859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:38.545306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m19:33:38.547022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:38.854093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m19:33:38.857159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:39.123032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da6412f9-140b-4157-8faa-a1423544b007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122427a00>]}
[0m19:33:39.123707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:39.127255 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m19:33:39.127782 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup  [RUN]
[0m19:33:39.128177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_establishment_broad_categories_dedup)
[0m19:33:39.128472 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m19:33:39.148939 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m19:33:39.149545 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m19:33:39.166131 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m19:33:39.166523 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_broad_categories_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    
    source_df = dbt.ref("tmp_airport_establishment_broad_categories_mapped")
    counts_series = source_df.groupby['business'].size()
    counts_df = counts_series.reset_index(name='count')
    print("counts_df:", counts_df)

    return dbt


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"tmp_airport_establishment_broad_categories_mapped": "cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_mapped"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_broad_categories_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup", if_exists="replace")
df._session.close()

  
[0m19:36:07.563247 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m19:36:07.564680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:36:07.566362 [error] [MainThread]: CANCEL query model.air_travel.tmp_airport_establishment_broad_categories_dedup . [[31mCANCEL[0m]
[0m19:36:07.566680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:36:36.037605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:36.038518 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_broad_categories_dedup' was properly closed.
[0m19:36:36.038990 [info ] [MainThread]: 
[0m19:36:36.039462 [info ] [MainThread]: Finished running  in 0 hours 2 minutes and 58.11 seconds (178.11s).
[0m19:36:36.040468 [error] [MainThread]: Encountered an error:

[0m19:36:36.047649 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 421, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 348, in run_queue
    self.job_queue.join()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 105, in join
    self.all_tasks_done.wait()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 587, in run
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 604, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 541, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 454, in execute_nodes
    self._cancel_connections(pool)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 412, in _cancel_connections
    pool.join()
    ~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/pool.py", line 669, in join
    p.join()
    ~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 1094, in join
    self._handle.join(timeout)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyboardInterrupt

[0m19:36:36.052569 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 179.17659, "process_in_blocks": "0", "process_kernel_time": 0.289902, "process_mem_max_rss": "403570688", "process_out_blocks": "0", "process_user_time": 1.7753}
[0m19:36:36.052952 [debug] [MainThread]: Command `dbt run` failed at 19:36:36.052869 after 179.18 seconds
[0m19:36:36.053209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc9ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224aaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224aadb0>]}
[0m19:36:36.053473 [debug] [MainThread]: Flushing usage events
[0m19:36:36.283764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:50.723375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081206e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6b750>]}


============================== 19:36:50.725029 | 4f98dfa1-3382-4369-8209-ed4523314e94 ==============================
[0m19:36:50.725029 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:36:50.725266 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'False', 'write_json': 'True', 'printer_width': '80', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --select tmp_airport_establishment_broad_categories_dedup', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m19:36:51.545699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f98dfa1-3382-4369-8209-ed4523314e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c4c30>]}
[0m19:36:51.565550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f98dfa1-3382-4369-8209-ed4523314e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eec2360>]}
[0m19:36:51.565767 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:36:51.643497 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:36:51.689178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:36:51.689526 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_broad_categories_dedup.py
[0m19:36:51.770406 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m19:36:51.775045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f98dfa1-3382-4369-8209-ed4523314e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2da850>]}
[0m19:36:51.811751 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:36:51.812632 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:36:51.819506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f98dfa1-3382-4369-8209-ed4523314e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3bb3e0>]}
[0m19:36:51.819685 [info ] [MainThread]: Found 40 models, 26 data tests, 9 sources, 630 macros
[0m19:36:51.819814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f98dfa1-3382-4369-8209-ed4523314e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ef875b0>]}
[0m19:36:51.820557 [info ] [MainThread]: 
[0m19:36:51.820685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:51.820777 [info ] [MainThread]: 
[0m19:36:51.820958 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:36:51.821298 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m19:36:51.821458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:52.177960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m19:36:52.178489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:52.481566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m19:36:52.485009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:52.796712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m19:36:52.798612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:53.350870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f98dfa1-3382-4369-8209-ed4523314e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f746ea0>]}
[0m19:36:53.351690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:53.356075 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m19:36:53.356788 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup  [RUN]
[0m19:36:53.357198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_establishment_broad_categories_dedup)
[0m19:36:53.357500 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m19:36:53.377059 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m19:36:53.377653 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m19:36:53.394750 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m19:36:53.395200 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_broad_categories_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    
    source_df = dbt.ref("tmp_airport_establishment_broad_categories_mapped")
    counts_series = source_df.groupby('business').size()
    counts_df = counts_series.reset_index(name='count')
    print("counts_df:", counts_df)

    return dbt


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"tmp_airport_establishment_broad_categories_mapped": "cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_mapped"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_broad_categories_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup", if_exists="replace")
df._session.close()

  
[0m19:41:14.630156 [info ] [Thread-1 (]: BigQuery adapter: Colab notebook runtime outputs from GCS: 
name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 1 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 2 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 3 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stdout
output_type:
    stream
text:
    ['counts_df: ']

data:
    text/html: ['✅ Completed. \n', '    Query processed 14.9 kB in 14 seconds of slot time. [<a target="_blank" href="https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c0612f01-2cd4-4c6e-8a70-7bcdfd988689&page=queryresults">Job cs378-fa2025:us-central1.c0612f01-2cd4-4c6e-8a70-7bcdfd988689 details</a>]\n', '    ']
    text/plain: ['<IPython.core.display.HTML object>']
metadata:
output_type:
    display_data

data:
    text/html: ['✅ Completed. \n', '    Query processed 27.8 kB in a moment of slot time.\n', '    ']
    text/plain: ['<IPython.core.display.HTML object>']
metadata:
output_type:
    display_data

data:
    text/html: ['✅ Completed. ']
    text/plain: ['<IPython.core.display.HTML object>']
metadata:
output_type:
    display_data

name:
    stdout
output_type:
    stream
text:
    ['                  business  count\n', '  12th Fairway Bar & Grill      1\n', ' 13th Street Pub and Grill      1\n', '                  24 Diner      1\n', '     24-Hour Flowers Kiosk      1\n', '3 Daughters Brewing at PIE      1\n', '      360 Gourmet Burritos      1\n', '            49 Mile Market      1\n', '                  4th Vine      1\n', '            562 Experience      1\n', '              5th & Sunset      1\n', '...\n', '\n', '[829 rows x 2 columns]\n']

ename:
    AttributeError
evalue:
    'dbtObj' object has no attribute 'to_gbq'
output_type:
    error

[0m19:41:14.632330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:14.640278 [debug] [Thread-1 (]: Runtime Error in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/1971431495427948544' failed.
[0m19:41:14.642457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f98dfa1-3382-4369-8209-ed4523314e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7ea690>]}
[0m19:41:14.644766 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup  [[31mERROR[0m in 261.28s]
[0m19:41:14.645343 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m19:41:14.645714 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_broad_categories_dedup' to be skipped because of status 'error'.  Reason: Runtime Error in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/1971431495427948544' failed..
[0m19:41:14.647217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:14.648583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:14.649067 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_broad_categories_dedup' was properly closed.
[0m19:41:14.649718 [info ] [MainThread]: 
[0m19:41:14.650051 [info ] [MainThread]: Finished running 1 table model in 0 hours 4 minutes and 22.83 seconds (262.83s).
[0m19:41:14.650988 [debug] [MainThread]: Command end result
[0m19:41:14.765872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:41:14.766725 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:41:14.768795 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m19:41:14.768900 [info ] [MainThread]: 
[0m19:41:14.769039 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:41:14.769147 [info ] [MainThread]: 
[0m19:41:14.769287 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)[0m
[0m19:41:14.769418 [error] [MainThread]:   Runtime Error in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/1971431495427948544' failed.
[0m19:41:14.769512 [info ] [MainThread]: 
[0m19:41:14.769624 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_broad_categories_dedup.py
[0m19:41:14.769715 [info ] [MainThread]: 
[0m19:41:14.769829 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:41:14.771615 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 264.07504, "process_in_blocks": "0", "process_kernel_time": 0.339453, "process_mem_max_rss": "407879680", "process_out_blocks": "0", "process_user_time": 2.039203}
[0m19:41:14.771762 [debug] [MainThread]: Command `dbt run` failed at 19:41:14.771734 after 264.08 seconds
[0m19:41:14.771889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee60aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6411d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f641270>]}
[0m19:41:14.772004 [debug] [MainThread]: Flushing usage events
[0m19:41:14.979730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:06.344596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7006e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b54b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b54b750>]}


============================== 19:44:06.346227 | 809ab61b-4837-4665-8089-b148938a8311 ==============================
[0m19:44:06.346227 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:44:06.346467 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'empty': 'False', 'warn_error': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'invocation_command': 'dbt run --select tmp_airport_establishment_broad_categories_dedup', 'fail_fast': 'False', 'use_colors': 'True', 'debug': 'False'}
[0m19:44:07.170104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '809ab61b-4837-4665-8089-b148938a8311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a4c30>]}
[0m19:44:07.189527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '809ab61b-4837-4665-8089-b148938a8311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213c2360>]}
[0m19:44:07.189734 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m19:44:07.267275 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:44:07.313166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:44:07.313523 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_broad_categories_dedup.py
[0m19:44:07.394198 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m19:44:07.398861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '809ab61b-4837-4665-8089-b148938a8311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217da850>]}
[0m19:44:07.435516 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:44:07.436439 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:44:07.443405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '809ab61b-4837-4665-8089-b148938a8311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218bb3e0>]}
[0m19:44:07.443579 [info ] [MainThread]: Found 40 models, 26 data tests, 9 sources, 630 macros
[0m19:44:07.443703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '809ab61b-4837-4665-8089-b148938a8311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214875b0>]}
[0m19:44:07.444482 [info ] [MainThread]: 
[0m19:44:07.444611 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:44:07.444702 [info ] [MainThread]: 
[0m19:44:07.444887 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:44:07.445241 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m19:44:07.445407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:07.783812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m19:44:07.784342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:08.123151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m19:44:08.126369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:08.388347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m19:44:08.390476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:08.657377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '809ab61b-4837-4665-8089-b148938a8311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c46ea0>]}
[0m19:44:08.658198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:08.661866 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m19:44:08.662400 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup  [RUN]
[0m19:44:08.662786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_establishment_broad_categories_dedup)
[0m19:44:08.663078 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m19:44:08.682144 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m19:44:08.682717 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m19:44:08.699483 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m19:44:08.699844 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_broad_categories_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    
    source_df = dbt.ref("tmp_airport_establishment_broad_categories_mapped")
    counts_series = source_df.groupby('business').size()
    counts_df = counts_series.reset_index(name='count')
    print("counts_df:", counts_df)

    return counts_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"tmp_airport_establishment_broad_categories_mapped": "cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_mapped"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_broad_categories_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup", if_exists="replace")
df._session.close()

  
[0m19:48:55.981664 [info ] [Thread-1 (]: BigQuery adapter: Colab notebook runtime outputs from GCS: 
name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 1 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 2 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 3 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stdout
output_type:
    stream
text:
    ['counts_df: ']

data:
    text/html: ['✅ Completed. \n', '    Query processed 14.9 kB in 5 seconds of slot time. [<a target="_blank" href="https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c4fafa99-b6b6-4295-b98c-5512de2c05c2&page=queryresults">Job cs378-fa2025:us-central1.c4fafa99-b6b6-4295-b98c-5512de2c05c2 details</a>]\n', '    ']
    text/plain: ['<IPython.core.display.HTML object>']
metadata:
output_type:
    display_data

data:
    text/html: ['✅ Completed. \n', '    Query processed 27.8 kB in a moment of slot time.\n', '    ']
    text/plain: ['<IPython.core.display.HTML object>']
metadata:
output_type:
    display_data

data:
    text/html: ['✅ Completed. ']
    text/plain: ['<IPython.core.display.HTML object>']
metadata:
output_type:
    display_data

name:
    stdout
output_type:
    stream
text:
    ['                  business  count\n', '  12th Fairway Bar & Grill      1\n', ' 13th Street Pub and Grill      1\n', '                  24 Diner      1\n', '     24-Hour Flowers Kiosk      1\n', '3 Daughters Brewing at PIE      1\n', '      360 Gourmet Burritos      1\n', '            49 Mile Market      1\n', '                  4th Vine      1\n', '            562 Experience      1\n', '              5th & Sunset      1\n', '...\n', '\n', '[829 rows x 2 columns]\n']

data:
    text/html: ['Session session25c8be closed.']
    text/plain: ['<IPython.core.display.HTML object>']
metadata:
output_type:
    display_data


[0m19:48:56.058687 [debug] [Thread-1 (]: Execution status: OK in 287.3599853515625 seconds
[0m19:48:56.097895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:56.099471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '809ab61b-4837-4665-8089-b148938a8311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ceaf90>]}
[0m19:48:56.099831 [info ] [Thread-1 (]: 1 of 1 OK created python table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup  [[32mOK[0m in 287.44s]
[0m19:48:56.100138 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m19:48:56.100839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:56.101683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:56.101832 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_broad_categories_dedup' was properly closed.
[0m19:48:56.101974 [info ] [MainThread]: 
[0m19:48:56.102129 [info ] [MainThread]: Finished running 1 table model in 0 hours 4 minutes and 48.66 seconds (288.66s).
[0m19:48:56.102438 [debug] [MainThread]: Command end result
[0m19:48:56.210721 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m19:48:56.211628 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m19:48:56.213880 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m19:48:56.214010 [info ] [MainThread]: 
[0m19:48:56.214164 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:48:56.214274 [info ] [MainThread]: 
[0m19:48:56.214397 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:48:56.216195 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 289.87915, "process_in_blocks": "0", "process_kernel_time": 0.349013, "process_mem_max_rss": "408059904", "process_out_blocks": "0", "process_user_time": 2.043275}
[0m19:48:56.216375 [debug] [MainThread]: Command `dbt run` succeeded at 19:48:56.216339 after 289.88 seconds
[0m19:48:56.216515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121360aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b41270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b413b0>]}
[0m19:48:56.216644 [debug] [MainThread]: Flushing usage events
[0m19:48:56.440412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:00.455928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a19c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afe79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afe7750>]}


============================== 20:08:00.457527 | bb85610f-c1a6-46e4-8406-0f16b911d2d3 ==============================
[0m20:08:00.457527 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m20:08:00.457771 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'target_path': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'empty': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select tmp_airport_establishment_broad_categories_dedup', 'introspect': 'True', 'partial_parse': 'True', 'version_check': 'True', 'debug': 'False'}
[0m20:08:01.282240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb85610f-c1a6-46e4-8406-0f16b911d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a340c30>]}
[0m20:08:01.301786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb85610f-c1a6-46e4-8406-0f16b911d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ec2360>]}
[0m20:08:01.301999 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m20:08:01.378498 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m20:08:01.424288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:08:01.424630 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_broad_categories_dedup.py
[0m20:08:01.505400 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m20:08:01.510147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb85610f-c1a6-46e4-8406-0f16b911d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212da850>]}
[0m20:08:01.546307 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m20:08:01.547240 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m20:08:01.553982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb85610f-c1a6-46e4-8406-0f16b911d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213bb3e0>]}
[0m20:08:01.554153 [info ] [MainThread]: Found 40 models, 26 data tests, 9 sources, 630 macros
[0m20:08:01.554283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb85610f-c1a6-46e4-8406-0f16b911d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f875b0>]}
[0m20:08:01.555042 [info ] [MainThread]: 
[0m20:08:01.555168 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:08:01.555276 [info ] [MainThread]: 
[0m20:08:01.555465 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:08:01.555792 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m20:08:01.555948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:01.890321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m20:08:01.890862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:02.163393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m20:08:02.165623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:02.424547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m20:08:02.428000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:02.697469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb85610f-c1a6-46e4-8406-0f16b911d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12173f040>]}
[0m20:08:02.698255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:08:02.702213 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m20:08:02.702784 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup  [RUN]
[0m20:08:02.703177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_establishment_broad_categories_dedup)
[0m20:08:02.703469 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m20:08:02.722962 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m20:08:02.723577 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m20:08:02.731473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:03.007166 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m20:08:03.007832 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_broad_categories_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    #freq_df = dbt.ref("tmp_airport_establishment_broad_categories_frequency")

    source_df = dbt.ref("Airport_Establishment")
    duplicate_df = source_df[source_df.duplicated('business', keep=False)]
    
    for row in duplicate_df.itertuples():
        print("row:", row)

    return duplicate_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"Airport_Establishment": "cs378-fa2025.dbt_air_travel_int.Airport_Establishment"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_broad_categories_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup", if_exists="replace")
df._session.close()

  
[0m20:11:08.055473 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m20:11:08.058947 [error] [MainThread]: CANCEL query model.air_travel.tmp_airport_establishment_broad_categories_dedup . [[31mCANCEL[0m]
[0m20:11:08.059386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:12:14.984927 [info ] [Thread-1 (]: BigQuery adapter: Colab notebook runtime outputs from GCS: 
name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 1 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 2 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 3 of 3. Reason: [Errno 115] Operation now in progress\n']

ename:
    KeyError
evalue:
    'b'
output_type:
    error

[0m20:12:14.989646 [debug] [Thread-1 (]: Runtime Error in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/6402973528760516608' failed.
[0m20:12:14.991410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb85610f-c1a6-46e4-8406-0f16b911d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217e4e90>]}
[0m20:12:14.991959 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup  [[31mERROR[0m in 252.29s]
[0m20:12:14.992355 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m20:12:14.992640 [info ] [MainThread]: 
[0m20:12:14.992973 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m20:12:14.993179 [info ] [MainThread]: 
[0m20:12:14.993401 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m20:12:14.993587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:14.993766 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_broad_categories_dedup' was properly closed.
[0m20:12:14.993931 [info ] [MainThread]: 
[0m20:12:14.994104 [info ] [MainThread]: Finished running  in 0 hours 4 minutes and 13.44 seconds (253.44s).
[0m20:12:14.994395 [error] [MainThread]: Encountered an error:

[0m20:12:14.996241 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 587, in run
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 604, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 541, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 421, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 348, in run_queue
    self.job_queue.join()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 105, in join
    self.all_tasks_done.wait()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

[0m20:12:14.999960 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 254.56914, "process_in_blocks": "0", "process_kernel_time": 0.327935, "process_mem_max_rss": "408027136", "process_out_blocks": "0", "process_user_time": 1.967582}
[0m20:12:15.000359 [debug] [MainThread]: Command `dbt run` failed at 20:12:15.000290 after 254.57 seconds
[0m20:12:15.000614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121771390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12181b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12181b610>]}
[0m20:12:15.000834 [debug] [MainThread]: Flushing usage events
[0m20:12:15.212025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:53.176982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c38c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1d79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1d7750>]}


============================== 20:12:53.178592 | 79b4f0fb-078c-4087-8c2b-6623e8b2ff8e ==============================
[0m20:12:53.178592 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m20:12:53.178835 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_format': 'default', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'introspect': 'True', 'invocation_command': 'dbt run --select tmp_airport_establishment_broad_categories_dedup', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'printer_width': '80'}
[0m20:12:54.056398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79b4f0fb-078c-4087-8c2b-6623e8b2ff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c530c30>]}
[0m20:12:54.076536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79b4f0fb-078c-4087-8c2b-6623e8b2ff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230c6360>]}
[0m20:12:54.076804 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m20:12:54.154714 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m20:12:54.204689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:12:54.205278 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_broad_categories_dedup.py
[0m20:12:54.292487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m20:12:54.297556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79b4f0fb-078c-4087-8c2b-6623e8b2ff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234da850>]}
[0m20:12:54.337123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m20:12:54.338201 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m20:12:54.345605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79b4f0fb-078c-4087-8c2b-6623e8b2ff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235bb3e0>]}
[0m20:12:54.345816 [info ] [MainThread]: Found 40 models, 26 data tests, 9 sources, 630 macros
[0m20:12:54.345949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79b4f0fb-078c-4087-8c2b-6623e8b2ff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231875b0>]}
[0m20:12:54.346905 [info ] [MainThread]: 
[0m20:12:54.347055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:12:54.347156 [info ] [MainThread]: 
[0m20:12:54.347355 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:12:54.347711 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m20:12:54.347881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:54.687880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m20:12:54.688206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:54.969213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m20:12:54.970666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:55.257114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m20:12:55.259779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:55.547761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79b4f0fb-078c-4087-8c2b-6623e8b2ff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12393f040>]}
[0m20:12:55.548459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:55.552930 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m20:12:55.553637 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup  [RUN]
[0m20:12:55.554124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_establishment_broad_categories_dedup)
[0m20:12:55.554435 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m20:12:55.575409 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m20:12:55.576018 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m20:12:55.583935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:55.865766 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m20:12:55.866610 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_broad_categories_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    #freq_df = dbt.ref("tmp_airport_establishment_broad_categories_frequency")

    source_df = dbt.ref("Airport_Establishment")
    duplicate_df = source_df[source_df.duplicated('business', keep=False)]
    
    for row in duplicate_df.itertuples():
        print("row:", row)

    output_df = session.createDataFrame(duplicate_df)
    
    return output_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"Airport_Establishment": "cs378-fa2025.dbt_air_travel_int.Airport_Establishment"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_broad_categories_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup", if_exists="replace")
df._session.close()

  
[0m20:16:55.093402 [info ] [Thread-1 (]: BigQuery adapter: Colab notebook runtime outputs from GCS: 
name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 1 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 2 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 3 of 3. Reason: [Errno 115] Operation now in progress\n']

ename:
    KeyError
evalue:
    'b'
output_type:
    error

[0m20:16:55.102475 [debug] [Thread-1 (]: Runtime Error in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3812277843115638784' failed.
[0m20:16:55.104769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b4f0fb-078c-4087-8c2b-6623e8b2ff8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239ea750>]}
[0m20:16:55.105479 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup  [[31mERROR[0m in 239.55s]
[0m20:16:55.105961 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m20:16:55.106338 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_broad_categories_dedup' to be skipped because of status 'error'.  Reason: Runtime Error in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3812277843115638784' failed..
[0m20:16:55.107692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:16:55.108910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:55.109102 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_broad_categories_dedup' was properly closed.
[0m20:16:55.109295 [info ] [MainThread]: 
[0m20:16:55.109487 [info ] [MainThread]: Finished running 1 table model in 0 hours 4 minutes and 0.76 seconds (240.76s).
[0m20:16:55.109880 [debug] [MainThread]: Command end result
[0m20:16:55.214146 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m20:16:55.214979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m20:16:55.217054 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m20:16:55.217158 [info ] [MainThread]: 
[0m20:16:55.217294 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:16:55.217403 [info ] [MainThread]: 
[0m20:16:55.217540 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)[0m
[0m20:16:55.217670 [error] [MainThread]:   Runtime Error in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3812277843115638784' failed.
[0m20:16:55.217765 [info ] [MainThread]: 
[0m20:16:55.217880 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_broad_categories_dedup.py
[0m20:16:55.217974 [info ] [MainThread]: 
[0m20:16:55.218082 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:16:55.219814 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 242.06386, "process_in_blocks": "0", "process_kernel_time": 0.325872, "process_mem_max_rss": "410730496", "process_out_blocks": "0", "process_user_time": 2.075972}
[0m20:16:55.219960 [debug] [MainThread]: Command `dbt run` failed at 20:16:55.219932 after 242.06 seconds
[0m20:16:55.220086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123060aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12383d1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12383d270>]}
[0m20:16:55.220195 [debug] [MainThread]: Flushing usage events
[0m20:16:55.441367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:07:40.317957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c17c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfc79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfc7750>]}


============================== 22:07:40.319578 | cc1dc2c3-bfb9-421f-bbb5-5777b0bc085b ==============================
[0m22:07:40.319578 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m22:07:40.319821 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'cache_selected_only': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'no_print': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select tmp_airport_establishment_broad_categories_dedup', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'write_json': 'True'}
[0m22:07:41.149847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc1dc2c3-bfb9-421f-bbb5-5777b0bc085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c320c30>]}
[0m22:07:41.169282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc1dc2c3-bfb9-421f-bbb5-5777b0bc085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ec2360>]}
[0m22:07:41.169491 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m22:07:41.245776 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m22:07:41.293157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:07:41.293354 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:07:41.295997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m22:07:41.312653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc1dc2c3-bfb9-421f-bbb5-5777b0bc085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232dab50>]}
[0m22:07:41.347516 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:07:41.348335 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:07:41.354911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc1dc2c3-bfb9-421f-bbb5-5777b0bc085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ece8a0>]}
[0m22:07:41.355076 [info ] [MainThread]: Found 40 models, 26 data tests, 9 sources, 630 macros
[0m22:07:41.355208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc1dc2c3-bfb9-421f-bbb5-5777b0bc085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12350cf30>]}
[0m22:07:41.355945 [info ] [MainThread]: 
[0m22:07:41.356074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:07:41.356170 [info ] [MainThread]: 
[0m22:07:41.356354 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:07:41.356667 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m22:07:41.356821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:41.798584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m22:07:41.798868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:42.093673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m22:07:42.095840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:42.372229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m22:07:42.374426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:42.662099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc1dc2c3-bfb9-421f-bbb5-5777b0bc085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123627ee0>]}
[0m22:07:42.662699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:42.665992 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m22:07:42.666473 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup  [RUN]
[0m22:07:42.666821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_establishment_broad_categories_dedup)
[0m22:07:42.667095 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m22:07:42.687448 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m22:07:42.688093 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m22:07:42.704541 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_broad_categories_dedup"
[0m22:07:42.704939 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_broad_categories_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    #freq_df = dbt.ref("tmp_airport_establishment_broad_categories_frequency")

    source_df = dbt.ref("Airport_Establishment")
    duplicate_df = source_df[source_df.duplicated('business', keep=False)]
    
    for row in duplicate_df.itertuples():
        print("row:", row)

    output_df = session.createDataFrame(duplicate_df)
    
    return output_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"Airport_Establishment": "cs378-fa2025.dbt_air_travel_int.Airport_Establishment"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_broad_categories_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup", if_exists="replace")
df._session.close()

  
[0m22:11:39.875582 [info ] [Thread-1 (]: BigQuery adapter: Colab notebook runtime outputs from GCS: 
name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 1 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 2 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 3 of 3. Reason: [Errno 115] Operation now in progress\n']

ename:
    KeyError
evalue:
    'b'
output_type:
    error

[0m22:11:39.876737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:39.883651 [debug] [Thread-1 (]: Runtime Error in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3593906037746302976' failed.
[0m22:11:39.885341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1dc2c3-bfb9-421f-bbb5-5777b0bc085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236ed910>]}
[0m22:11:39.885951 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model dbt_air_travel_tmp.tmp_airport_establishment_broad_categories_dedup  [[31mERROR[0m in 237.22s]
[0m22:11:39.886435 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_dedup
[0m22:11:39.886916 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_broad_categories_dedup' to be skipped because of status 'error'.  Reason: Runtime Error in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3593906037746302976' failed..
[0m22:11:39.888567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:39.889806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:39.890026 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_broad_categories_dedup' was properly closed.
[0m22:11:39.890242 [info ] [MainThread]: 
[0m22:11:39.890449 [info ] [MainThread]: Finished running 1 table model in 0 hours 3 minutes and 58.53 seconds (238.53s).
[0m22:11:39.890908 [debug] [MainThread]: Command end result
[0m22:11:39.913303 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:11:39.914222 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:11:39.916606 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m22:11:39.916730 [info ] [MainThread]: 
[0m22:11:39.916878 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:11:39.916987 [info ] [MainThread]: 
[0m22:11:39.917124 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)[0m
[0m22:11:39.917253 [error] [MainThread]:   Runtime Error in model tmp_airport_establishment_broad_categories_dedup (models/tmp/tmp_airport_establishment_broad_categories_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3593906037746302976' failed.
[0m22:11:39.917347 [info ] [MainThread]: 
[0m22:11:39.917458 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_broad_categories_dedup.py
[0m22:11:39.917546 [info ] [MainThread]: 
[0m22:11:39.917657 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:11:39.919446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 239.62784, "process_in_blocks": "0", "process_kernel_time": 0.311927, "process_mem_max_rss": "403587072", "process_out_blocks": "0", "process_user_time": 1.808446}
[0m22:11:39.919617 [debug] [MainThread]: Command `dbt run` failed at 22:11:39.919581 after 239.63 seconds
[0m22:11:39.919757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236c47e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236e1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236e18b0>]}
[0m22:11:39.919885 [debug] [MainThread]: Flushing usage events
[0m22:11:40.146070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:21:50.305253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0f39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0f3750>]}


============================== 22:21:50.306866 | 4e3e0c8e-a7da-497f-9e0a-3e174af85fe8 ==============================
[0m22:21:50.306866 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m22:21:50.307102 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --select tmp_airport_establishment_dedup', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'version_check': 'True', 'empty': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m22:21:51.126403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e3e0c8e-a7da-497f-9e0a-3e174af85fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a44cc30>]}
[0m22:21:51.145809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e3e0c8e-a7da-497f-9e0a-3e174af85fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fc2360>]}
[0m22:21:51.146007 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m22:21:51.221698 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m22:21:51.267353 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m22:21:51.267668 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_establishment_dedup.py
[0m22:21:51.267773 [debug] [MainThread]: Partial parsing: deleted file: air_travel://models/tmp/tmp_airport_establishment_broad_categories_dedup.py
[0m22:21:51.348472 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m22:21:51.353189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e3e0c8e-a7da-497f-9e0a-3e174af85fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213da850>]}
[0m22:21:51.389631 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:21:51.390507 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:21:51.397352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e3e0c8e-a7da-497f-9e0a-3e174af85fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214bb3e0>]}
[0m22:21:51.397541 [info ] [MainThread]: Found 40 models, 26 data tests, 9 sources, 630 macros
[0m22:21:51.397662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e3e0c8e-a7da-497f-9e0a-3e174af85fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1210875b0>]}
[0m22:21:51.398446 [info ] [MainThread]: 
[0m22:21:51.398575 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:21:51.398669 [info ] [MainThread]: 
[0m22:21:51.398855 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:21:51.399192 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m22:21:51.399354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:51.727144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m22:21:51.727726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:21:52.029852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m22:21:52.032017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:21:52.313714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m22:21:52.316277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:21:52.757942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e3e0c8e-a7da-497f-9e0a-3e174af85fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12183f520>]}
[0m22:21:52.758716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:52.762198 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_dedup
[0m22:21:52.762669 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [RUN]
[0m22:21:52.763024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_establishment_dedup)
[0m22:21:52.763307 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_dedup
[0m22:21:52.783396 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_dedup"
[0m22:21:52.784047 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_dedup
[0m22:21:52.801043 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_dedup"
[0m22:21:52.801557 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    
    source_df = dbt.ref("Airport_Establishment")
    counts_series = source_df.groupby('business').size()
    counts_df = counts_series.reset_index(name='count')
    print("counts_df:", counts_df)

    return counts_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"Airport_Establishment": "cs378-fa2025.dbt_air_travel_int.Airport_Establishment"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup", if_exists="replace")
df._session.close()

  
[0m22:26:10.964804 [info ] [Thread-1 (]: BigQuery adapter: Colab notebook runtime outputs from GCS: 
name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 1 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 2 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 3 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stdout
output_type:
    stream
text:
    ['counts_df: ']

data:
    text/html: ['✅ Completed. \n', '    Query processed 14.6 kB in 16 seconds of slot time. [<a target="_blank" href="https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9361b3a8-d14c-40ca-83ae-01b8ff7ebc24&page=queryresults">Job cs378-fa2025:us-central1.9361b3a8-d14c-40ca-83ae-01b8ff7ebc24 details</a>]\n', '    ']
    text/plain: ['<IPython.core.display.HTML object>']
metadata:
output_type:
    display_data

data:
    text/html: ['✅ Completed. \n', '    Query processed 27.8 kB in a moment of slot time.\n', '    ']
    text/plain: ['<IPython.core.display.HTML object>']
metadata:
output_type:
    display_data

data:
    text/html: ['✅ Completed. ']
    text/plain: ['<IPython.core.display.HTML object>']
metadata:
output_type:
    display_data

name:
    stdout
output_type:
    stream
text:
    ['                  business  count\n', '  12th Fairway Bar & Grill      1\n', ' 13th Street Pub and Grill      1\n', '                  24 Diner      1\n', '     24-Hour Flowers Kiosk      1\n', '3 Daughters Brewing at PIE      1\n', '      360 Gourmet Burritos      1\n', '            49 Mile Market      1\n', '                  4th Vine      1\n', '            562 Experience      1\n', '              5th & Sunset      1\n', '...\n', '\n', '[829 rows x 2 columns]\n']

data:
    text/html: ['Session session9895f2 closed.']
    text/plain: ['<IPython.core.display.HTML object>']
metadata:
output_type:
    display_data


[0m22:26:11.046877 [debug] [Thread-1 (]: Execution status: OK in 258.25 seconds
[0m22:26:11.082315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:11.083761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e3e0c8e-a7da-497f-9e0a-3e174af85fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218eaf90>]}
[0m22:26:11.084086 [info ] [Thread-1 (]: 1 of 1 OK created python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [[32mOK[0m in 258.32s]
[0m22:26:11.084363 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_dedup
[0m22:26:11.084964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:26:11.085661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:11.085786 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_dedup' was properly closed.
[0m22:26:11.085914 [info ] [MainThread]: 
[0m22:26:11.086053 [info ] [MainThread]: Finished running 1 table model in 0 hours 4 minutes and 19.69 seconds (259.69s).
[0m22:26:11.086344 [debug] [MainThread]: Command end result
[0m22:26:11.183358 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:26:11.184197 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:26:11.186286 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m22:26:11.186390 [info ] [MainThread]: 
[0m22:26:11.186538 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:26:11.186649 [info ] [MainThread]: 
[0m22:26:11.186779 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:26:11.188499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 260.90845, "process_in_blocks": "0", "process_kernel_time": 0.321295, "process_mem_max_rss": "407896064", "process_out_blocks": "0", "process_user_time": 1.989673}
[0m22:26:11.188652 [debug] [MainThread]: Command `dbt run` succeeded at 22:26:11.188622 after 260.91 seconds
[0m22:26:11.188770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f60aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12173d270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12173d3b0>]}
[0m22:26:11.188889 [debug] [MainThread]: Flushing usage events
[0m22:26:11.395509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:32:05.871544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084646e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092af9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092af750>]}


============================== 22:32:05.873188 | db84c47d-ec5c-48e8-b609-3a5e3eda7076 ==============================
[0m22:32:05.873188 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m22:32:05.873433 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'False', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True', 'quiet': 'False', 'introspect': 'True', 'write_json': 'True', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select tmp_airport_establishment_dedup', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'debug': 'False'}
[0m22:32:06.694505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db84c47d-ec5c-48e8-b609-3a5e3eda7076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108608c30>]}
[0m22:32:06.713846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db84c47d-ec5c-48e8-b609-3a5e3eda7076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2c6360>]}
[0m22:32:06.714046 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m22:32:06.789467 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m22:32:06.835461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:32:06.835823 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_dedup.py
[0m22:32:06.916206 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m22:32:06.921072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db84c47d-ec5c-48e8-b609-3a5e3eda7076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6da850>]}
[0m22:32:06.957416 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:32:06.958290 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:32:06.965208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db84c47d-ec5c-48e8-b609-3a5e3eda7076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7bb3e0>]}
[0m22:32:06.965376 [info ] [MainThread]: Found 40 models, 26 data tests, 9 sources, 630 macros
[0m22:32:06.965489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db84c47d-ec5c-48e8-b609-3a5e3eda7076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3875b0>]}
[0m22:32:06.966228 [info ] [MainThread]: 
[0m22:32:06.966352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:32:06.966447 [info ] [MainThread]: 
[0m22:32:06.966629 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:32:06.966942 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m22:32:06.967098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:07.318139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m22:32:07.318750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:32:07.589731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m22:32:07.591592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:32:07.868684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m22:32:07.871734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:32:08.197614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db84c47d-ec5c-48e8-b609-3a5e3eda7076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb3f040>]}
[0m22:32:08.198483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:08.202728 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_dedup
[0m22:32:08.203377 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [RUN]
[0m22:32:08.203815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_airport_establishment_dedup)
[0m22:32:08.204150 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_dedup
[0m22:32:08.223660 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_dedup"
[0m22:32:08.224257 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_dedup
[0m22:32:08.232153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:08.521139 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_dedup"
[0m22:32:08.521646 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    
    source_df = dbt.ref("Airport_Establishment")
    filtered_df = source_df.groupby('business').filter(lambda x: len(x) > 1)
    #counts_df = filtered_df.reset_index(name='count')
    #print("counts_df:", counts_df)

    return filtered_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"Airport_Establishment": "cs378-fa2025.dbt_air_travel_int.Airport_Establishment"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup", if_exists="replace")
df._session.close()

  
[0m22:35:59.554201 [info ] [Thread-1 (]: BigQuery adapter: Colab notebook runtime outputs from GCS: 
name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 1 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 2 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 3 of 3. Reason: [Errno 115] Operation now in progress\n']

ename:
    AttributeError
evalue:
    'DataFrameGroupBy' object has no attribute 'filter'
output_type:
    error

[0m22:35:59.562891 [debug] [Thread-1 (]: Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3183462745144033280' failed.
[0m22:35:59.565486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db84c47d-ec5c-48e8-b609-3a5e3eda7076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbe6750>]}
[0m22:35:59.566346 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [[31mERROR[0m in 231.36s]
[0m22:35:59.566786 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_dedup
[0m22:35:59.567115 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_dedup' to be skipped because of status 'error'.  Reason: Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3183462745144033280' failed..
[0m22:35:59.568393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:35:59.569624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:59.569815 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_dedup' was properly closed.
[0m22:35:59.570006 [info ] [MainThread]: 
[0m22:35:59.570200 [info ] [MainThread]: Finished running 1 table model in 0 hours 3 minutes and 52.60 seconds (232.60s).
[0m22:35:59.570624 [debug] [MainThread]: Command end result
[0m22:35:59.678503 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:35:59.679304 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:35:59.681466 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m22:35:59.681592 [info ] [MainThread]: 
[0m22:35:59.681735 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:35:59.681850 [info ] [MainThread]: 
[0m22:35:59.681998 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)[0m
[0m22:35:59.682134 [error] [MainThread]:   Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3183462745144033280' failed.
[0m22:35:59.682229 [info ] [MainThread]: 
[0m22:35:59.682340 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_dedup.py
[0m22:35:59.682430 [info ] [MainThread]: 
[0m22:35:59.682537 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:35:59.684340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 233.83783, "process_in_blocks": "0", "process_kernel_time": 0.305658, "process_mem_max_rss": "407994368", "process_out_blocks": "0", "process_user_time": 2.019745}
[0m22:35:59.684488 [debug] [MainThread]: Command `dbt run` failed at 22:35:59.684459 after 233.84 seconds
[0m22:35:59.684611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f260310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa40e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa411d0>]}
[0m22:35:59.684724 [debug] [MainThread]: Flushing usage events
[0m22:35:59.920702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:37:48.917355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5206e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b36b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b36b750>]}


============================== 22:37:48.918939 | f4bd0157-da8b-4d21-bc80-fec3369679f3 ==============================
[0m22:37:48.918939 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m22:37:48.919177 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'quiet': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error': 'None', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'empty': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'partial_parse': 'True', 'invocation_command': 'dbt run --select tmp_airport_establishment_dedup', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None'}
[0m22:37:49.739603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4bd0157-da8b-4d21-bc80-fec3369679f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6c4c30>]}
[0m22:37:49.759127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4bd0157-da8b-4d21-bc80-fec3369679f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212c2360>]}
[0m22:37:49.759329 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m22:37:49.834221 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m22:37:49.880374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:37:49.880712 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_dedup.py
[0m22:37:49.961430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m22:37:49.966138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4bd0157-da8b-4d21-bc80-fec3369679f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216da850>]}
[0m22:37:50.002251 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:37:50.003105 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:37:50.009906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4bd0157-da8b-4d21-bc80-fec3369679f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217bb3e0>]}
[0m22:37:50.010100 [info ] [MainThread]: Found 40 models, 26 data tests, 9 sources, 630 macros
[0m22:37:50.010230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4bd0157-da8b-4d21-bc80-fec3369679f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213875b0>]}
[0m22:37:50.011056 [info ] [MainThread]: 
[0m22:37:50.011188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:37:50.011280 [info ] [MainThread]: 
[0m22:37:50.011464 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:37:50.011808 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m22:37:50.011956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:50.416045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m22:37:50.416421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:37:50.682887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m22:37:50.686074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:37:50.976167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m22:37:50.978439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:37:51.288918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4bd0157-da8b-4d21-bc80-fec3369679f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b3f450>]}
[0m22:37:51.289540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:51.292718 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_dedup
[0m22:37:51.293215 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [RUN]
[0m22:37:51.293566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_establishment_dedup)
[0m22:37:51.293845 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_dedup
[0m22:37:51.312470 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_dedup"
[0m22:37:51.313041 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_dedup
[0m22:37:51.320671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:51.601925 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_dedup"
[0m22:37:51.602573 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    
    source_df = dbt.ref("Airport_Establishment")
    result_df = source_df.drop_duplicates(subset=['business'], keep='first', inplace=False)

    return result_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"Airport_Establishment": "cs378-fa2025.dbt_air_travel_int.Airport_Establishment"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup", if_exists="replace")
df._session.close()

  
[0m22:41:38.231176 [info ] [Thread-1 (]: BigQuery adapter: Colab notebook runtime outputs from GCS: 
name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 1 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 2 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 3 of 3. Reason: [Errno 115] Operation now in progress\n']

ename:
    TypeError
evalue:
    DataFrame.drop_duplicates() got an unexpected keyword argument 'inplace'
output_type:
    error

[0m22:41:38.241069 [debug] [Thread-1 (]: Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3028651507953172480' failed.
[0m22:41:38.243183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4bd0157-da8b-4d21-bc80-fec3369679f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121be6750>]}
[0m22:41:38.243854 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [[31mERROR[0m in 226.95s]
[0m22:41:38.244334 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_dedup
[0m22:41:38.244792 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_dedup' to be skipped because of status 'error'.  Reason: Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3028651507953172480' failed..
[0m22:41:38.246376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:41:38.247710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:38.247915 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_dedup' was properly closed.
[0m22:41:38.248111 [info ] [MainThread]: 
[0m22:41:38.248315 [info ] [MainThread]: Finished running 1 table model in 0 hours 3 minutes and 48.24 seconds (228.24s).
[0m22:41:38.248776 [debug] [MainThread]: Command end result
[0m22:41:38.355804 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:41:38.356567 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:41:38.358623 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m22:41:38.358723 [info ] [MainThread]: 
[0m22:41:38.358852 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:41:38.358955 [info ] [MainThread]: 
[0m22:41:38.359085 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)[0m
[0m22:41:38.359208 [error] [MainThread]:   Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/3028651507953172480' failed.
[0m22:41:38.359300 [info ] [MainThread]: 
[0m22:41:38.359409 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_dedup.py
[0m22:41:38.359498 [info ] [MainThread]: 
[0m22:41:38.359602 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:41:38.361370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 229.46858, "process_in_blocks": "0", "process_kernel_time": 0.310807, "process_mem_max_rss": "409436160", "process_out_blocks": "0", "process_user_time": 2.006314}
[0m22:41:38.361513 [debug] [MainThread]: Command `dbt run` failed at 22:41:38.361486 after 229.47 seconds
[0m22:41:38.361632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121260310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a40e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a411d0>]}
[0m22:41:38.361743 [debug] [MainThread]: Flushing usage events
[0m22:41:38.583615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:38.632673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccc86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db139d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db13750>]}


============================== 22:43:38.634300 | 7a38a70c-300a-4ddb-8768-0de8447f99cd ==============================
[0m22:43:38.634300 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m22:43:38.634544 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'False', 'fail_fast': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_experimental_parser': 'False', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select tmp_airport_establishment_dedup', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'cache_selected_only': 'False'}
[0m22:43:39.459988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a38a70c-300a-4ddb-8768-0de8447f99cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce6cc30>]}
[0m22:43:39.479318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a38a70c-300a-4ddb-8768-0de8447f99cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ac2360>]}
[0m22:43:39.479523 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m22:43:39.555524 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m22:43:39.601368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:43:39.601718 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_establishment_dedup.py
[0m22:43:39.682468 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m22:43:39.687112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a38a70c-300a-4ddb-8768-0de8447f99cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123eda850>]}
[0m22:43:39.723442 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:43:39.724387 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:43:39.731168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a38a70c-300a-4ddb-8768-0de8447f99cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123fbb3e0>]}
[0m22:43:39.731350 [info ] [MainThread]: Found 40 models, 26 data tests, 9 sources, 630 macros
[0m22:43:39.731480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a38a70c-300a-4ddb-8768-0de8447f99cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b875b0>]}
[0m22:43:39.732249 [info ] [MainThread]: 
[0m22:43:39.732383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:39.732477 [info ] [MainThread]: 
[0m22:43:39.732671 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:43:39.732995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m22:43:39.733152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:40.062855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m22:43:40.063401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:40.348780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m22:43:40.352170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:40.636614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m22:43:40.638806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:40.920390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a38a70c-300a-4ddb-8768-0de8447f99cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124346f70>]}
[0m22:43:40.920787 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:40.922967 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_dedup
[0m22:43:40.923299 [info ] [Thread-1 (]: 1 of 1 START python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [RUN]
[0m22:43:40.923572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_establishment_dedup)
[0m22:43:40.923790 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_dedup
[0m22:43:40.939640 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_dedup"
[0m22:43:40.940220 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_dedup
[0m22:43:40.947277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:41.226131 [debug] [Thread-1 (]: Writing runtime python for node "model.air_travel.tmp_airport_establishment_dedup"
[0m22:43:41.226863 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_establishment_dedup: 
  
    
import bigframes.pandas as bpd
bpd.options.compute.extra_query_labels["bigframes-dbt-api"] = "python-model-table"
bpd.options.bigquery.application_name = f"dbt-bigquery-1.11.0b4"
bpd.options.bigquery.ordering_mode = "partial"
bpd.options.bigquery.project = "cs378-fa2025"

bpd.options.bigquery.location = "us-central1"

session = bpd.get_global_session()
def model(dbt, session):
    
    dbt.config(submission_method="bigframes", materialized="table")
    
    source_df = dbt.ref("Airport_Establishment")
    result_df = source_df.drop_duplicates(subset=['business'], keep='first')

    return result_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"Airport_Establishment": "cs378-fa2025.dbt_air_travel_int.Airport_Establishment"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "cs378-fa2025"
    schema = "dbt_air_travel_tmp"
    identifier = "tmp_airport_establishment_dedup"
    
    def __repr__(self):
        return 'cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(bpd.read_gbq)
df = model(dbt, session)
df.to_gbq("cs378-fa2025.dbt_air_travel_tmp.tmp_airport_establishment_dedup", if_exists="replace")
df._session.close()

  
[0m22:47:37.274165 [info ] [Thread-1 (]: BigQuery adapter: Colab notebook runtime outputs from GCS: 
name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 1 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 2 of 3. Reason: [Errno 115] Operation now in progress\n']

name:
    stderr
output_type:
    stream
text:
    ['WARNING:google.auth.compute_engine._metadata:Compute Engine Metadata server unavailable on attempt 3 of 3. Reason: [Errno 115] Operation now in progress\n']

ename:
    OrderRequiredError
evalue:
    Op drop_duplicates(keep != False) requires an ordering. Use .sort_values or .sort_index to provide an ordering. Share your use case with the BigQuery DataFrames team at the https://bit.ly/bigframes-feedback survey. You are currently running BigFrames version 2.27.0.
output_type:
    error

[0m22:47:37.283513 [debug] [Thread-1 (]: Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/5354760715490033664' failed.
[0m22:47:37.285496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a38a70c-300a-4ddb-8768-0de8447f99cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243ea750>]}
[0m22:47:37.286137 [error] [Thread-1 (]: 1 of 1 ERROR creating python table model dbt_air_travel_tmp.tmp_airport_establishment_dedup  [[31mERROR[0m in 236.36s]
[0m22:47:37.286613 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_dedup
[0m22:47:37.287066 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_establishment_dedup' to be skipped because of status 'error'.  Reason: Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/5354760715490033664' failed..
[0m22:47:37.289051 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:37.290531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:37.290917 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_establishment_dedup' was properly closed.
[0m22:47:37.291189 [info ] [MainThread]: 
[0m22:47:37.291409 [info ] [MainThread]: Finished running 1 table model in 0 hours 3 minutes and 57.56 seconds (237.56s).
[0m22:47:37.291892 [debug] [MainThread]: Command end result
[0m22:47:37.401866 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m22:47:37.402679 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m22:47:37.404763 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m22:47:37.404874 [info ] [MainThread]: 
[0m22:47:37.405013 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:47:37.405137 [info ] [MainThread]: 
[0m22:47:37.405276 [error] [MainThread]: [31mFailure in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)[0m
[0m22:47:37.405408 [error] [MainThread]:   Runtime Error in model tmp_airport_establishment_dedup (models/tmp/tmp_airport_establishment_dedup.py)
  The colab notebook execution job 'projects/988876466742/locations/us-central1/notebookExecutionJobs/5354760715490033664' failed.
[0m22:47:37.405497 [info ] [MainThread]: 
[0m22:47:37.405616 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_establishment_dedup.py
[0m22:47:37.405707 [info ] [MainThread]: 
[0m22:47:37.405822 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:47:37.407596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 238.8181, "process_in_blocks": "0", "process_kernel_time": 0.321979, "process_mem_max_rss": "409796608", "process_out_blocks": "0", "process_user_time": 2.032079}
[0m22:47:37.407741 [debug] [MainThread]: Command `dbt run` failed at 22:47:37.407714 after 238.82 seconds
[0m22:47:37.407867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a60310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12423ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12423d1d0>]}
[0m22:47:37.407978 [debug] [MainThread]: Flushing usage events
[0m22:47:37.613421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:20.909386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aed86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd239d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd23750>]}


============================== 09:08:20.911070 | 4ddc9201-6d86-4283-a5c3-9c3c813b5793 ==============================
[0m09:08:20.911070 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:08:20.911328 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'version_check': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select Airport_Establishment', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'introspect': 'True', 'write_json': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m09:08:21.732884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ddc9201-6d86-4283-a5c3-9c3c813b5793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b07cc30>]}
[0m09:08:21.752343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ddc9201-6d86-4283-a5c3-9c3c813b5793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bc2360>]}
[0m09:08:21.752543 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:08:21.829014 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:08:21.874865 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m09:08:21.875167 [debug] [MainThread]: Partial parsing: deleted file: air_travel://models/tmp/tmp_airport_establishment_dedup.py
[0m09:08:21.875332 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport_Establishment.sql
[0m09:08:22.000412 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:08:22.005136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ddc9201-6d86-4283-a5c3-9c3c813b5793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fdfe50>]}
[0m09:08:22.041018 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:08:22.041904 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:08:22.048758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ddc9201-6d86-4283-a5c3-9c3c813b5793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220bb2f0>]}
[0m09:08:22.048930 [info ] [MainThread]: Found 39 models, 26 data tests, 9 sources, 630 macros
[0m09:08:22.049060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ddc9201-6d86-4283-a5c3-9c3c813b5793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12220fbd0>]}
[0m09:08:22.049806 [info ] [MainThread]: 
[0m09:08:22.049939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:08:22.050036 [info ] [MainThread]: 
[0m09:08:22.050227 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:08:22.050536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:08:22.050692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:22.431030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:08:22.431361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:22.738908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:08:22.740914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:23.053390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:08:23.056006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:23.339988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ddc9201-6d86-4283-a5c3-9c3c813b5793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223e81f0>]}
[0m09:08:23.340664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:08:23.343915 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Establishment
[0m09:08:23.344364 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport_Establishment .......... [RUN]
[0m09:08:23.344712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.Airport_Establishment)
[0m09:08:23.344987 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Establishment
[0m09:08:23.353146 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Establishment"
[0m09:08:23.353730 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Establishment
[0m09:08:23.446072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:23.754804 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Establishment"
[0m09:08:23.755873 [debug] [Thread-1 (]: On model.air_travel.Airport_Establishment: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Establishment"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
      
    
    

    
    OPTIONS()
    as (
      with airport_establishment_joined as (
  select distinct e.business, m.broad_category, m.sub_category,
    case when m.broad_category in ('Fast Casual', 'Full-Service Dining') then True else False end as dining,
    'airport.guide,llm' as _data_source, e._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique` e 
  join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_sub_categories_mapped` m
  on e.business = m.business
),
Airport_Establishment as (
  select *, rank() over (
      partition by business
      order by 
        (select count 
        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_frequency` 
        where broad_category = ae.broad_category)
  ) as business_rank
  from airport_establishment_joined ae
),

select * except(business_rank)
from Airport_Establishment
where business_rank = 1
    );
  
[0m09:08:24.069517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:30440ba0-c0ef-48ba-88e8-455baffd8d8c&page=queryresults
[0m09:08:24.071001 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:30440ba0-c0ef-48ba-88e8-455baffd8d8c&page=queryresults
[0m09:08:24.083080 [debug] [Thread-1 (]: Database Error in model Airport_Establishment (models/int/Airport_Establishment.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [33:1]
  compiled code at target/run/air_travel/models/int/Airport_Establishment.sql
[0m09:08:24.084974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ddc9201-6d86-4283-a5c3-9c3c813b5793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222fa450>]}
[0m09:08:24.085563 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Airport_Establishment . [[31mERROR[0m in 0.74s]
[0m09:08:24.086038 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Establishment
[0m09:08:24.086488 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Airport_Establishment' to be skipped because of status 'error'.  Reason: Database Error in model Airport_Establishment (models/int/Airport_Establishment.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [33:1]
  compiled code at target/run/air_travel/models/int/Airport_Establishment.sql.
[0m09:08:24.088101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:08:24.089349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:24.089549 [debug] [MainThread]: Connection 'model.air_travel.Airport_Establishment' was properly closed.
[0m09:08:24.089743 [info ] [MainThread]: 
[0m09:08:24.089955 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m09:08:24.090393 [debug] [MainThread]: Command end result
[0m09:08:24.114799 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:08:24.115942 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:08:24.118914 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:08:24.119117 [info ] [MainThread]: 
[0m09:08:24.119362 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:08:24.119569 [info ] [MainThread]: 
[0m09:08:24.119762 [error] [MainThread]: [31mFailure in model Airport_Establishment (models/int/Airport_Establishment.sql)[0m
[0m09:08:24.119928 [error] [MainThread]:   Database Error in model Airport_Establishment (models/int/Airport_Establishment.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [33:1]
  compiled code at target/run/air_travel/models/int/Airport_Establishment.sql
[0m09:08:24.120050 [info ] [MainThread]: 
[0m09:08:24.120196 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Airport_Establishment.sql
[0m09:08:24.120316 [info ] [MainThread]: 
[0m09:08:24.120479 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:08:24.123005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2376165, "process_in_blocks": "0", "process_kernel_time": 0.241442, "process_mem_max_rss": "389873664", "process_out_blocks": "0", "process_user_time": 1.841651}
[0m09:08:24.123285 [debug] [MainThread]: Command `dbt run` failed at 09:08:24.123236 after 3.24 seconds
[0m09:08:24.123469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223fe620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109641810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c05c70>]}
[0m09:08:24.123634 [debug] [MainThread]: Flushing usage events
[0m09:08:24.345761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:41.028241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d60f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d60f750>]}


============================== 09:08:41.029818 | 8fb7ec14-b0ae-45ae-9fa7-2c741bbef44e ==============================
[0m09:08:41.029818 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:08:41.030058 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'quiet': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'invocation_command': 'dbt run --select Airport_Establishment', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'partial_parse': 'True'}
[0m09:08:41.873254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fb7ec14-b0ae-45ae-9fa7-2c741bbef44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c968c30>]}
[0m09:08:41.893103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fb7ec14-b0ae-45ae-9fa7-2c741bbef44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235c2360>]}
[0m09:08:41.893337 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:08:41.973692 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:08:42.021381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:08:42.021803 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport_Establishment.sql
[0m09:08:42.149689 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:08:42.154541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fb7ec14-b0ae-45ae-9fa7-2c741bbef44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239dfe50>]}
[0m09:08:42.191606 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:08:42.192630 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:08:42.199849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fb7ec14-b0ae-45ae-9fa7-2c741bbef44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123abb2f0>]}
[0m09:08:42.200042 [info ] [MainThread]: Found 39 models, 26 data tests, 9 sources, 630 macros
[0m09:08:42.200174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb7ec14-b0ae-45ae-9fa7-2c741bbef44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c4b5b0>]}
[0m09:08:42.200958 [info ] [MainThread]: 
[0m09:08:42.201091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:08:42.201184 [info ] [MainThread]: 
[0m09:08:42.201383 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:08:42.201718 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:08:42.201896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:42.606659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:08:42.607040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:42.902017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:08:42.904009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:43.185945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:08:43.188008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:43.528910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb7ec14-b0ae-45ae-9fa7-2c741bbef44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e10870>]}
[0m09:08:43.529696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:08:43.534106 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Establishment
[0m09:08:43.534789 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport_Establishment .......... [RUN]
[0m09:08:43.535183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Airport_Establishment)
[0m09:08:43.535458 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Establishment
[0m09:08:43.544609 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Establishment"
[0m09:08:43.545261 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Establishment
[0m09:08:43.635169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:43.910936 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Establishment"
[0m09:08:43.911593 [debug] [Thread-1 (]: On model.air_travel.Airport_Establishment: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Establishment"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
      
    
    

    
    OPTIONS()
    as (
      with airport_establishment_joined as (
  select distinct e.business, m.broad_category, m.sub_category,
    case when m.broad_category in ('Fast Casual', 'Full-Service Dining') then True else False end as dining,
    'airport.guide,llm' as _data_source, e._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_unique` e 
  join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_sub_categories_mapped` m
  on e.business = m.business
),
Airport_Establishment as (
  select *, rank() over (
      partition by business
      order by 
        (select count 
        from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_establishment_broad_categories_frequency` 
        where broad_category = ae.broad_category)
  ) as business_rank
  from airport_establishment_joined ae
)

select * except(business_rank)
from Airport_Establishment
where business_rank = 1
    );
  
[0m09:08:44.341630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:002415a3-40b2-40ce-84ca-6abc18148ba6&page=queryresults
[0m09:08:46.532920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb7ec14-b0ae-45ae-9fa7-2c741bbef44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ff5cd0>]}
[0m09:08:46.533411 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Airport_Establishment ..... [[32mCREATE TABLE (829.0 rows, 81.8 KiB processed)[0m in 3.00s]
[0m09:08:46.533780 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Establishment
[0m09:08:46.534586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:08:46.535608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:46.535783 [debug] [MainThread]: Connection 'model.air_travel.Airport_Establishment' was properly closed.
[0m09:08:46.535947 [info ] [MainThread]: 
[0m09:08:46.536130 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m09:08:46.536493 [debug] [MainThread]: Command end result
[0m09:08:46.558220 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:08:46.559411 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:08:46.561967 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:08:46.562103 [info ] [MainThread]: 
[0m09:08:46.562300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:08:46.562457 [info ] [MainThread]: 
[0m09:08:46.562603 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:08:46.564765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5601306, "process_in_blocks": "0", "process_kernel_time": 0.262433, "process_mem_max_rss": "393216000", "process_out_blocks": "0", "process_user_time": 1.875887}
[0m09:08:46.564959 [debug] [MainThread]: Command `dbt run` succeeded at 09:08:46.564921 after 5.56 seconds
[0m09:08:46.565112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123dfaaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cd80f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123813bb0>]}
[0m09:08:46.565258 [debug] [MainThread]: Flushing usage events
[0m09:08:46.752603 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:23.473065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c7750>]}


============================== 09:10:23.474713 | 6455454b-2206-46a9-849d-08a25431b38b ==============================
[0m09:10:23.474713 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:10:23.474947 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'no_print': 'None', 'empty': 'None', 'debug': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test'}
[0m09:10:24.295376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6455454b-2206-46a9-849d-08a25431b38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c20c30>]}
[0m09:10:24.314728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6455454b-2206-46a9-849d-08a25431b38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8be360>]}
[0m09:10:24.314930 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:10:24.389937 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:10:24.425651 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:10:24.425838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6455454b-2206-46a9-849d-08a25431b38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcdb450>]}
[0m09:10:25.019131 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:10:25.022736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6455454b-2206-46a9-849d-08a25431b38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ffd4aa0>]}
[0m09:10:25.056911 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:10:25.057781 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:10:25.068400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6455454b-2206-46a9-849d-08a25431b38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202c6cf0>]}
[0m09:10:25.068582 [info ] [MainThread]: Found 39 models, 26 data tests, 9 sources, 630 macros
[0m09:10:25.068706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6455454b-2206-46a9-849d-08a25431b38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120353860>]}
[0m09:10:25.069917 [info ] [MainThread]: 
[0m09:10:25.070047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:10:25.070143 [info ] [MainThread]: 
[0m09:10:25.070321 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:10:25.072476 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_int'
[0m09:10:25.072622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:25.339002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:10:25.341609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:25.686127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:10:25.688067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:26.005378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6455454b-2206-46a9-849d-08a25431b38b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff074d0>]}
[0m09:10:26.006182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:10:26.011336 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m09:10:26.011857 [info ] [Thread-1 (]: 1 of 26 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m09:10:26.012322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m09:10:26.012639 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m09:10:26.020775 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m09:10:26.021826 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m09:10:26.036388 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m09:10:26.037021 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`aircrafts` )

  
  
      
    ) dbt_internal_test
[0m09:10:26.037274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:27.021054 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:be9acf96-6e8a-4a03-9747-cd1c223c3cf1&page=queryresults
[0m09:10:27.540951 [info ] [Thread-1 (]: 1 of 26 PASS check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ . [[32mPASS[0m in 1.53s]
[0m09:10:27.541506 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m09:10:27.541740 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m09:10:27.542004 [info ] [Thread-1 (]: 2 of 26 START test check_row_count_equals_airlines_source_air_travel_raw_airlines_  [RUN]
[0m09:10:27.542295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc, now test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d)
[0m09:10:27.542495 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m09:10:27.545383 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m09:10:27.546996 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m09:10:27.548403 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m09:10:27.548743 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airlines` )

  
  
      
    ) dbt_internal_test
[0m09:10:27.548939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:28.690730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3ab23cea-16d5-45d2-ae88-375c5c7c0afd&page=queryresults
[0m09:10:29.345582 [info ] [Thread-1 (]: 2 of 26 PASS check_row_count_equals_airlines_source_air_travel_raw_airlines_ ... [[32mPASS[0m in 1.80s]
[0m09:10:29.346207 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m09:10:29.346549 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m09:10:29.346997 [info ] [Thread-1 (]: 3 of 26 START test check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_  [RUN]
[0m09:10:29.347458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d, now test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510)
[0m09:10:29.347797 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m09:10:29.351562 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m09:10:29.352934 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m09:10:29.354830 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m09:10:29.355288 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_maps` )

  
  
      
    ) dbt_internal_test
[0m09:10:29.355533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:30.330258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ad6e6f61-c744-4859-b0a5-92b7770d2046&page=queryresults
[0m09:10:30.744262 [info ] [Thread-1 (]: 3 of 26 PASS check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_  [[32mPASS[0m in 1.40s]
[0m09:10:30.745367 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m09:10:30.745890 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m09:10:30.746357 [info ] [Thread-1 (]: 4 of 26 START test check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_  [RUN]
[0m09:10:30.747252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510, now test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587)
[0m09:10:30.747758 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m09:10:30.752987 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m09:10:30.753841 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m09:10:30.756191 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m09:10:30.756981 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_reviews` )

  
  
      
    ) dbt_internal_test
[0m09:10:30.757364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:32.480241 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6bb46cfc-0ae0-4eba-82c2-2750edc73169&page=queryresults
[0m09:10:32.949797 [info ] [Thread-1 (]: 4 of 26 PASS check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_  [[32mPASS[0m in 2.20s]
[0m09:10:32.951032 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m09:10:32.951519 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m09:10:32.952011 [info ] [Thread-1 (]: 5 of 26 START test check_row_count_equals_airports_source_air_travel_raw_airports_  [RUN]
[0m09:10:32.952578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587, now test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0)
[0m09:10:32.952975 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m09:10:32.957553 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m09:10:32.959347 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m09:10:32.961445 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m09:10:32.961990 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airports` )

  
  
      
    ) dbt_internal_test
[0m09:10:32.962273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:33.750998 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7f7db57e-5d46-4109-be97-7b47e19a5dbe&page=queryresults
[0m09:10:34.122740 [info ] [Thread-1 (]: 5 of 26 PASS check_row_count_equals_airports_source_air_travel_raw_airports_ ... [[32mPASS[0m in 1.17s]
[0m09:10:34.123370 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m09:10:34.123695 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m09:10:34.124091 [info ] [Thread-1 (]: 6 of 26 START test check_row_count_equals_countries_source_air_travel_raw_countries_  [RUN]
[0m09:10:34.124537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0, now test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414)
[0m09:10:34.124853 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m09:10:34.129070 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m09:10:34.129788 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m09:10:34.134507 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m09:10:34.135082 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`countries` )

  
  
      
    ) dbt_internal_test
[0m09:10:34.135349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:35.040208 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:354a36e5-c3b7-4437-a750-53be0080ba7b&page=queryresults
[0m09:10:35.466606 [info ] [Thread-1 (]: 6 of 26 PASS check_row_count_equals_countries_source_air_travel_raw_countries_ . [[32mPASS[0m in 1.34s]
[0m09:10:35.467498 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m09:10:35.467893 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m09:10:35.468345 [info ] [Thread-1 (]: 7 of 26 START test check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_  [RUN]
[0m09:10:35.468880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414, now test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823)
[0m09:10:35.469250 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m09:10:35.473857 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m09:10:35.474669 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m09:10:35.476808 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m09:10:35.477316 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_delays` )

  
  
      
    ) dbt_internal_test
[0m09:10:35.477612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:36.439123 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a8faac7d-79b1-4ac1-95d0-8d08f81c5a17&page=queryresults
[0m09:10:36.870491 [info ] [Thread-1 (]: 7 of 26 PASS check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_  [[32mPASS[0m in 1.40s]
[0m09:10:36.871693 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m09:10:36.872131 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m09:10:36.872600 [info ] [Thread-1 (]: 8 of 26 START test check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_  [RUN]
[0m09:10:36.873152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823, now test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81)
[0m09:10:36.873532 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m09:10:36.878288 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m09:10:36.879115 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m09:10:36.881325 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m09:10:36.881864 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_routes` )

  
  
      
    ) dbt_internal_test
[0m09:10:36.882164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:37.819802 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d78d3cd3-0771-4ab3-b1cf-64dbc01cae21&page=queryresults
[0m09:10:38.275007 [info ] [Thread-1 (]: 8 of 26 PASS check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_  [[32mPASS[0m in 1.40s]
[0m09:10:38.275990 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m09:10:38.276439 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m09:10:38.277143 [info ] [Thread-1 (]: 9 of 26 START test check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_  [RUN]
[0m09:10:38.277836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81, now test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee)
[0m09:10:38.278219 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m09:10:38.283175 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m09:10:38.283959 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m09:10:38.286417 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m09:10:38.287187 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic` )

  
  
      
    ) dbt_internal_test
[0m09:10:38.287503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:39.343604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a81b3945-8646-4fc0-8fcd-e3d6e82b8b53&page=queryresults
[0m09:10:39.855840 [info ] [Thread-1 (]: 9 of 26 PASS check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_  [[32mPASS[0m in 1.58s]
[0m09:10:39.857018 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m09:10:39.857448 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m09:10:39.857919 [info ] [Thread-1 (]: 10 of 26 START test dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name  [RUN]
[0m09:10:39.858474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee, now test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd)
[0m09:10:39.858867 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m09:10:39.867103 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m09:10:39.868600 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m09:10:39.870622 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m09:10:39.871075 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        icao, iata, name
    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
    group by icao, iata, name
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m09:10:39.871344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:40.365987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:af1e24a8-db6e-404d-b356-7d6a2cd2ef3d&page=queryresults
[0m09:10:41.089741 [info ] [Thread-1 (]: 10 of 26 PASS dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name  [[32mPASS[0m in 1.23s]
[0m09:10:41.090794 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m09:10:41.091274 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m09:10:41.091745 [info ] [Thread-1 (]: 11 of 26 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m09:10:41.092509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m09:10:41.093238 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m09:10:41.097439 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m09:10:41.099339 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m09:10:41.101598 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m09:10:41.102152 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airport_icao, terminal, business, location
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    group by airport_icao, terminal, business, location
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m09:10:41.102488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:41.653662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f43d8c34-6d95-4379-85a5-f735ac57266b&page=queryresults
[0m09:10:42.140571 [info ] [Thread-1 (]: 11 of 26 PASS dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[32mPASS[0m in 1.05s]
[0m09:10:42.141725 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m09:10:42.142539 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m09:10:42.143255 [info ] [Thread-1 (]: 12 of 26 START test dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [RUN]
[0m09:10:42.143848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m09:10:42.144242 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m09:10:42.148500 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m09:10:42.149276 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m09:10:42.151528 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m09:10:42.152102 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_month, airline_id, airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    group by event_month, airline_id, airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m09:10:42.152443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:42.618655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:27fe9403-fd4e-4d4b-8e77-3ea6ddf7e876&page=queryresults
[0m09:10:42.953615 [info ] [Thread-1 (]: 12 of 26 PASS dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [[32mPASS[0m in 0.81s]
[0m09:10:42.954796 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m09:10:42.955362 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m09:10:42.955842 [info ] [Thread-1 (]: 13 of 26 START test dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [RUN]
[0m09:10:42.956362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m09:10:42.957186 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m09:10:42.961810 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m09:10:42.962601 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m09:10:42.964861 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m09:10:42.965827 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    group by airline_id, source_airport_icao, dest_airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m09:10:42.966285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:43.437930 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:12821839-7b78-4c0c-8c91-076d7d9878be&page=queryresults
[0m09:10:43.829621 [info ] [Thread-1 (]: 13 of 26 PASS dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [[32mPASS[0m in 0.87s]
[0m09:10:43.830873 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m09:10:43.831370 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m09:10:43.831814 [info ] [Thread-1 (]: 14 of 26 START test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [RUN]
[0m09:10:43.832700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965)
[0m09:10:43.833181 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m09:10:43.837758 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m09:10:43.839619 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m09:10:43.841932 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m09:10:43.842429 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        business, menu_item
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    group by business, menu_item
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m09:10:43.842745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:44.255504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c05c8fff-5a2a-42dd-b34b-edc896b16ba2&page=queryresults
[0m09:10:44.617305 [info ] [Thread-1 (]: 14 of 26 PASS dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [[32mPASS[0m in 0.78s]
[0m09:10:44.618403 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m09:10:44.618926 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m09:10:44.619493 [info ] [Thread-1 (]: 15 of 26 START test dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [RUN]
[0m09:10:44.620258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m09:10:44.620661 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m09:10:44.624907 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m09:10:44.625702 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m09:10:44.628016 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m09:10:44.628983 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m09:10:44.629434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:45.075430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9f12fd69-139a-42aa-8350-e87f2bae94d2&page=queryresults
[0m09:10:45.444389 [info ] [Thread-1 (]: 15 of 26 PASS dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [[32mPASS[0m in 0.82s]
[0m09:10:45.445643 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m09:10:45.446225 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m09:10:45.446780 [info ] [Thread-1 (]: 16 of 26 START test dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [RUN]
[0m09:10:45.447720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m09:10:45.448214 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m09:10:45.452595 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m09:10:45.453394 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m09:10:45.455589 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m09:10:45.456140 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_date, event_hour, airport_icao, security_checkpoint
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    group by event_date, event_hour, airport_icao, security_checkpoint
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m09:10:45.456490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:45.918420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:19c15335-90bb-4457-8fa2-4b0bad849b22&page=queryresults
[0m09:10:46.320460 [info ] [Thread-1 (]: 16 of 26 PASS dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [[32mPASS[0m in 0.87s]
[0m09:10:46.321538 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m09:10:46.321955 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:10:46.322405 [info ] [Thread-1 (]: 17 of 26 START test not_null_Airline_id ........................................ [RUN]
[0m09:10:46.322951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m09:10:46.323312 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:10:46.329380 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m09:10:46.331072 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:10:46.332999 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m09:10:46.333467 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m09:10:46.333754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:46.749027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8e82aaea-67af-4de3-8e60-d3d71fde4246&page=queryresults
[0m09:10:47.116388 [info ] [Thread-1 (]: 17 of 26 PASS not_null_Airline_id .............................................. [[32mPASS[0m in 0.79s]
[0m09:10:47.117393 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:10:47.117882 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m09:10:47.118302 [info ] [Thread-1 (]: 18 of 26 START test not_null_Airport_Establishment_business .................... [RUN]
[0m09:10:47.118776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_Establishment_business.fa42968b3c)
[0m09:10:47.119116 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m09:10:47.122941 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m09:10:47.123704 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m09:10:47.128263 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m09:10:47.128965 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Establishment_business.fa42968b3c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select business
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
where business is null



  
  
      
    ) dbt_internal_test
[0m09:10:47.129326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:47.735758 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:09a44462-b27b-4793-8655-5d181b20531a&page=queryresults
[0m09:10:48.108471 [info ] [Thread-1 (]: 18 of 26 PASS not_null_Airport_Establishment_business .......................... [[32mPASS[0m in 0.99s]
[0m09:10:48.109677 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m09:10:48.110170 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e
[0m09:10:48.110631 [info ] [Thread-1 (]: 19 of 26 START test not_null_Airport_Reviews_id ................................ [RUN]
[0m09:10:48.111306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Establishment_business.fa42968b3c, now test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e)
[0m09:10:48.111979 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e
[0m09:10:48.116338 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e"
[0m09:10:48.117164 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e
[0m09:10:48.119464 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e"
[0m09:10:48.120025 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Reviews`
where id is null



  
  
      
    ) dbt_internal_test
[0m09:10:48.120354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:48.657962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b8a7cec4-e64f-4678-8c8c-65b12192bf9c&page=queryresults
[0m09:10:49.075459 [info ] [Thread-1 (]: 19 of 26 PASS not_null_Airport_Reviews_id ...................................... [[32mPASS[0m in 0.96s]
[0m09:10:49.075915 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e
[0m09:10:49.076144 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:10:49.076413 [info ] [Thread-1 (]: 20 of 26 START test not_null_Airport_icao ...................................... [RUN]
[0m09:10:49.076720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m09:10:49.076933 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:10:49.079428 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m09:10:49.079864 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:10:49.081389 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m09:10:49.081758 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m09:10:49.081972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:49.582171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3df7a822-4a9f-4c29-8fdc-e184a9434008&page=queryresults
[0m09:10:49.963876 [info ] [Thread-1 (]: 20 of 26 PASS not_null_Airport_icao ............................................ [[32mPASS[0m in 0.89s]
[0m09:10:49.964937 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:10:49.965629 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m09:10:49.966239 [info ] [Thread-1 (]: 21 of 26 START test not_null_Country_iso_code .................................. [RUN]
[0m09:10:49.966794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m09:10:49.967253 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m09:10:49.971306 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m09:10:49.972143 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m09:10:49.974369 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m09:10:49.974914 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m09:10:49.975247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:50.506781 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b37ecf3c-d923-4fe4-821e-8530fbcaff6a&page=queryresults
[0m09:10:50.985362 [info ] [Thread-1 (]: 21 of 26 PASS not_null_Country_iso_code ........................................ [[32mPASS[0m in 1.02s]
[0m09:10:50.986386 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m09:10:50.986887 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m09:10:50.987388 [info ] [Thread-1 (]: 22 of 26 START test unique_Airline_id .......................................... [RUN]
[0m09:10:50.987941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Airline_id.cb196c2622)
[0m09:10:50.988648 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m09:10:50.995328 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m09:10:50.996192 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m09:10:50.998377 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m09:10:50.998846 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:10:50.999127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:51.424092 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:934150a4-e2be-4d5e-85e8-12fe05d227a6&page=queryresults
[0m09:10:51.994146 [info ] [Thread-1 (]: 22 of 26 PASS unique_Airline_id ................................................ [[32mPASS[0m in 1.01s]
[0m09:10:51.995271 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m09:10:51.996021 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m09:10:51.996574 [info ] [Thread-1 (]: 23 of 26 START test unique_Airport_Establishment_business ...................... [RUN]
[0m09:10:51.997169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_Establishment_business.c0ba13e1af)
[0m09:10:51.997537 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m09:10:52.001430 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m09:10:52.002244 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m09:10:52.004503 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m09:10:52.005042 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Establishment_business.c0ba13e1af: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select business as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
  where business is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:10:52.005386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:52.550364 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1cb56b7e-e197-4749-ba92-0cf8c8a22b08&page=queryresults
[0m09:10:53.168848 [info ] [Thread-1 (]: 23 of 26 PASS unique_Airport_Establishment_business ............................ [[32mPASS[0m in 1.17s]
[0m09:10:53.169982 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m09:10:53.170494 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Reviews_id.71cb9a3cce
[0m09:10:53.170997 [info ] [Thread-1 (]: 24 of 26 START test unique_Airport_Reviews_id .................................. [RUN]
[0m09:10:53.171771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Establishment_business.c0ba13e1af, now test.air_travel.unique_Airport_Reviews_id.71cb9a3cce)
[0m09:10:53.172428 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Reviews_id.71cb9a3cce
[0m09:10:53.176861 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Reviews_id.71cb9a3cce"
[0m09:10:53.177700 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Reviews_id.71cb9a3cce
[0m09:10:53.180009 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Reviews_id.71cb9a3cce"
[0m09:10:53.180568 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Reviews_id.71cb9a3cce: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Reviews_id.71cb9a3cce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Reviews`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:10:53.180900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:53.678024 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1965e338-ae49-4e59-af72-5618bcf16b25&page=queryresults
[0m09:10:54.108239 [info ] [Thread-1 (]: 24 of 26 PASS unique_Airport_Reviews_id ........................................ [[32mPASS[0m in 0.94s]
[0m09:10:54.108867 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Reviews_id.71cb9a3cce
[0m09:10:54.109179 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:10:54.109512 [info ] [Thread-1 (]: 25 of 26 START test unique_Airport_icao ........................................ [RUN]
[0m09:10:54.109899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Reviews_id.71cb9a3cce, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m09:10:54.110165 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:10:54.113140 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m09:10:54.114738 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:10:54.116480 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m09:10:54.116890 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:10:54.117139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:54.601686 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:950af984-afae-4904-a0e9-549e209fc5e2&page=queryresults
[0m09:10:55.031747 [info ] [Thread-1 (]: 25 of 26 PASS unique_Airport_icao .............................................. [[32mPASS[0m in 0.92s]
[0m09:10:55.032766 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:10:55.033240 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m09:10:55.033975 [info ] [Thread-1 (]: 26 of 26 START test unique_Country_iso_code .................................... [RUN]
[0m09:10:55.034698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m09:10:55.035073 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m09:10:55.038819 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m09:10:55.039560 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m09:10:55.041751 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m09:10:55.042287 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:10:55.042625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:55.438211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:403f08f4-1894-433b-9437-9b320f1fcc17&page=queryresults
[0m09:10:55.802767 [info ] [Thread-1 (]: 26 of 26 PASS unique_Country_iso_code .......................................... [[32mPASS[0m in 0.77s]
[0m09:10:55.804045 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m09:10:55.805770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:10:55.807718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:55.807993 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m09:10:55.808253 [info ] [MainThread]: 
[0m09:10:55.808508 [info ] [MainThread]: Finished running 26 data tests in 0 hours 0 minutes and 30.74 seconds (30.74s).
[0m09:10:55.811691 [debug] [MainThread]: Command end result
[0m09:10:55.839732 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:10:55.840871 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:10:55.844669 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:10:55.844824 [info ] [MainThread]: 
[0m09:10:55.844992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:10:55.845127 [info ] [MainThread]: 
[0m09:10:55.845272 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=26
[0m09:10:55.847601 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 32.3986, "process_in_blocks": "0", "process_kernel_time": 0.361731, "process_mem_max_rss": "397787136", "process_out_blocks": "0", "process_user_time": 3.960815}
[0m09:10:55.847802 [debug] [MainThread]: Command `dbt test` succeeded at 09:10:55.847762 after 32.40 seconds
[0m09:10:55.847964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202238b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120867a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120866df0>]}
[0m09:10:55.848117 [debug] [MainThread]: Flushing usage events
[0m09:10:56.058733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:46.645899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6386e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4839d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b483750>]}


============================== 09:27:46.647478 | e47b994a-0ff8-4028-ae27-840d041337a3 ==============================
[0m09:27:46.647478 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:27:46.647715 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'introspect': 'True', 'quiet': 'False', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select Airline', 'partial_parse': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m09:27:47.468587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e47b994a-0ff8-4028-ae27-840d041337a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7dcc30>]}
[0m09:27:47.487903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e47b994a-0ff8-4028-ae27-840d041337a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214c2360>]}
[0m09:27:47.488112 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:27:47.564459 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:27:47.610828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:27:47.611165 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m09:27:47.739602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:27:47.744354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e47b994a-0ff8-4028-ae27-840d041337a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d98b50>]}
[0m09:27:47.779658 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:27:47.780564 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:27:47.869536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e47b994a-0ff8-4028-ae27-840d041337a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c02300>]}
[0m09:27:47.869802 [info ] [MainThread]: Found 39 models, 27 data tests, 9 sources, 630 macros
[0m09:27:47.869945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e47b994a-0ff8-4028-ae27-840d041337a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d0bbd0>]}
[0m09:27:47.870809 [info ] [MainThread]: 
[0m09:27:47.870987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:27:47.871119 [info ] [MainThread]: 
[0m09:27:47.871327 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:27:47.873455 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m09:27:47.873618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:48.161952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:27:48.162714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:48.455421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:27:48.457112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:48.730799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e47b994a-0ff8-4028-ae27-840d041337a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d01160>]}
[0m09:27:48.731211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:27:48.733898 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:27:48.734231 [info ] [Thread-1 (]: 1 of 3 START test not_null_Airline_id .......................................... [RUN]
[0m09:27:48.734543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m09:27:48.734764 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:27:48.743932 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m09:27:48.744506 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:27:48.756943 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m09:27:48.757468 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m09:27:48.757705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:49.329258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:77c816f3-7899-42ca-af0b-257ea33965f1&page=queryresults
[0m09:27:49.818656 [info ] [Thread-1 (]: 1 of 3 PASS not_null_Airline_id ................................................ [[32mPASS[0m in 1.08s]
[0m09:27:49.819407 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:27:49.819725 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m09:27:49.820103 [info ] [Thread-1 (]: 2 of 3 START test relationships_Airline_country_code__iso_code__ref_Country_ ... [RUN]
[0m09:27:49.820526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26)
[0m09:27:49.820831 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m09:27:49.824902 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m09:27:49.825507 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m09:27:49.827386 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m09:27:49.827870 [debug] [Thread-1 (]: On test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:27:49.828134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:50.453366 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:fc389d1c-b479-40eb-b4de-3d6b4002606b&page=queryresults
[0m09:27:50.872877 [info ] [Thread-1 (]: 2 of 3 PASS relationships_Airline_country_code__iso_code__ref_Country_ ......... [[32mPASS[0m in 1.05s]
[0m09:27:50.873717 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m09:27:50.874108 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m09:27:50.874721 [info ] [Thread-1 (]: 3 of 3 START test unique_Airline_id ............................................ [RUN]
[0m09:27:50.875370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26, now test.air_travel.unique_Airline_id.cb196c2622)
[0m09:27:50.875769 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m09:27:50.881996 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m09:27:50.882857 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m09:27:50.885094 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m09:27:50.885613 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:27:50.885908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:51.375299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0d446799-647f-462c-bc9b-24b0f0278aeb&page=queryresults
[0m09:27:51.809720 [info ] [Thread-1 (]: 3 of 3 PASS unique_Airline_id .................................................. [[32mPASS[0m in 0.93s]
[0m09:27:51.810937 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m09:27:51.812459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:27:51.814326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:51.814622 [debug] [MainThread]: Connection 'test.air_travel.unique_Airline_id.cb196c2622' was properly closed.
[0m09:27:51.814884 [info ] [MainThread]: 
[0m09:27:51.815146 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m09:27:51.816059 [debug] [MainThread]: Command end result
[0m09:27:51.844909 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:27:51.846136 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:27:51.849398 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:27:51.849550 [info ] [MainThread]: 
[0m09:27:51.849716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:27:51.849846 [info ] [MainThread]: 
[0m09:27:51.849995 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m09:27:51.852309 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.229959, "process_in_blocks": "0", "process_kernel_time": 0.263102, "process_mem_max_rss": "394772480", "process_out_blocks": "0", "process_user_time": 1.896291}
[0m09:27:51.852519 [debug] [MainThread]: Command `dbt test` succeeded at 09:27:51.852478 after 5.23 seconds
[0m09:27:51.852694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b388ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e7eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f4a6d0>]}
[0m09:27:51.852855 [debug] [MainThread]: Flushing usage events
[0m09:27:52.059181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:28:49.744496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b957750>]}


============================== 09:28:49.746110 | 8b5ac4af-990e-41b0-935e-7d42beb49729 ==============================
[0m09:28:49.746110 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:28:49.746353 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select Airline', 'debug': 'False', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'empty': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m09:28:50.554179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b5ac4af-990e-41b0-935e-7d42beb49729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb0c30>]}
[0m09:28:50.573655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b5ac4af-990e-41b0-935e-7d42beb49729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217be360>]}
[0m09:28:50.573856 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:28:50.649681 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:28:50.694945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:28:50.695221 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airline.sql
[0m09:28:50.823742 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:28:50.828583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b5ac4af-990e-41b0-935e-7d42beb49729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12209c250>]}
[0m09:28:50.863938 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:28:50.864827 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:28:50.872094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b5ac4af-990e-41b0-935e-7d42beb49729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217ce8a0>]}
[0m09:28:50.872272 [info ] [MainThread]: Found 39 models, 27 data tests, 9 sources, 630 macros
[0m09:28:50.872395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b5ac4af-990e-41b0-935e-7d42beb49729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12181b230>]}
[0m09:28:50.873182 [info ] [MainThread]: 
[0m09:28:50.873308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:28:50.873400 [info ] [MainThread]: 
[0m09:28:50.873583 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:28:50.873934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m09:28:50.874094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:51.282737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:28:51.283027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:51.543394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:28:51.545880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:51.812191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:28:51.813869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:52.092286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b5ac4af-990e-41b0-935e-7d42beb49729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122192680>]}
[0m09:28:52.092969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:28:52.096290 [debug] [Thread-1 (]: Began running node model.air_travel.Airline
[0m09:28:52.096735 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airline ........................ [RUN]
[0m09:28:52.097086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Airline)
[0m09:28:52.097361 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airline
[0m09:28:52.194650 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airline"
[0m09:28:52.195891 [debug] [Thread-1 (]: Began executing node model.air_travel.Airline
[0m09:28:52.201023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:28:52.472124 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airline"
[0m09:28:52.473002 [debug] [Thread-1 (]: On model.air_travel.Airline: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airline"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
      
    
    

    
    OPTIONS()
    as (
      with airline_country_joined as (
  select a.id, a.name, a.alias, a.icao, a.iata, a.callsign, 
    a.country as country_name, c.iso_code as country_code, a.active, 
    a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines` a left join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null 
),
Airline as (
    select acj.id, acj.name, acj.alias, acj.icao, acj.iata, acj.callsign, 
        amc.mapped_iso_code as country_code, 
        acj.active, acj._data_source, acj._load_time 
    from airline_country_joined acj join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped` amc
    on acj.country_name = amc.original_country
    where acj.country_code is null
    and acj.country_name is not null
)

select *
from Airline
    );
  
[0m09:28:52.795066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f6f2d52b-f8b0-46ca-afd7-c9689a0e1869&page=queryresults
[0m09:28:54.969889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b5ac4af-990e-41b0-935e-7d42beb49729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222b9d90>]}
[0m09:28:54.970350 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Airline ................... [[32mCREATE TABLE (0.0 rows, 473.4 KiB processed)[0m in 2.87s]
[0m09:28:54.970703 [debug] [Thread-1 (]: Finished running node model.air_travel.Airline
[0m09:28:54.971417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:28:54.972361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:54.972515 [debug] [MainThread]: Connection 'model.air_travel.Airline' was properly closed.
[0m09:28:54.972670 [info ] [MainThread]: 
[0m09:28:54.972840 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m09:28:54.973197 [debug] [MainThread]: Command end result
[0m09:28:54.993756 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:28:54.994717 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:28:54.997182 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:28:54.997301 [info ] [MainThread]: 
[0m09:28:54.997452 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:28:54.997566 [info ] [MainThread]: 
[0m09:28:54.997698 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:28:54.999767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.2790794, "process_in_blocks": "0", "process_kernel_time": 0.236353, "process_mem_max_rss": "394821632", "process_out_blocks": "0", "process_user_time": 1.864885}
[0m09:28:54.999953 [debug] [MainThread]: Command `dbt run` succeeded at 09:28:54.999915 after 5.28 seconds
[0m09:28:55.000100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122196360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a316d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a30af0>]}
[0m09:28:55.000241 [debug] [MainThread]: Flushing usage events
[0m09:28:55.189601 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:29:01.135647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0d06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf1b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf1b750>]}


============================== 09:29:01.137268 | 4d90d5ea-bda4-4722-a6f7-b7d02b09205f ==============================
[0m09:29:01.137268 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:29:01.137509 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt test --select Airline', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'version_check': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True'}
[0m09:29:01.950078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d90d5ea-bda4-4722-a6f7-b7d02b09205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c274c30>]}
[0m09:29:01.969814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d90d5ea-bda4-4722-a6f7-b7d02b09205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f3e360>]}
[0m09:29:01.970019 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:29:02.045839 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:29:02.091479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:29:02.091622 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:29:02.095286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:29:02.110094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d90d5ea-bda4-4722-a6f7-b7d02b09205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12335b950>]}
[0m09:29:02.146289 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:29:02.147210 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:29:02.158057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d90d5ea-bda4-4722-a6f7-b7d02b09205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236f5310>]}
[0m09:29:02.158237 [info ] [MainThread]: Found 39 models, 27 data tests, 9 sources, 630 macros
[0m09:29:02.158364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d90d5ea-bda4-4722-a6f7-b7d02b09205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236e6430>]}
[0m09:29:02.159158 [info ] [MainThread]: 
[0m09:29:02.159287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:29:02.159382 [info ] [MainThread]: 
[0m09:29:02.159571 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:29:02.161604 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m09:29:02.161746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:02.422177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:29:02.424107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:02.757142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:29:02.759516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:03.095666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d90d5ea-bda4-4722-a6f7-b7d02b09205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12378cef0>]}
[0m09:29:03.096413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:29:03.100512 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:29:03.101013 [info ] [Thread-1 (]: 1 of 3 START test not_null_Airline_id .......................................... [RUN]
[0m09:29:03.101412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m09:29:03.101691 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:29:03.116344 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m09:29:03.116939 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:29:03.129204 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m09:29:03.129679 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m09:29:03.129896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:03.673076 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3fa21f15-33f2-4c7a-984b-bd16d7bb2425&page=queryresults
[0m09:29:04.096055 [info ] [Thread-1 (]: 1 of 3 PASS not_null_Airline_id ................................................ [[32mPASS[0m in 0.99s]
[0m09:29:04.096688 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m09:29:04.096942 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m09:29:04.097268 [info ] [Thread-1 (]: 2 of 3 START test relationships_Airline_country_code__iso_code__ref_Country_ ... [RUN]
[0m09:29:04.097601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26)
[0m09:29:04.097819 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m09:29:04.102889 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m09:29:04.104066 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m09:29:04.105525 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m09:29:04.105877 [debug] [Thread-1 (]: On test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:29:04.106092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:04.696708 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c2d3c0b0-aa64-4af1-baef-faad3203c5b8&page=queryresults
[0m09:29:05.214909 [info ] [Thread-1 (]: 2 of 3 PASS relationships_Airline_country_code__iso_code__ref_Country_ ......... [[32mPASS[0m in 1.12s]
[0m09:29:05.215908 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m09:29:05.216343 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m09:29:05.216795 [info ] [Thread-1 (]: 3 of 3 START test unique_Airline_id ............................................ [RUN]
[0m09:29:05.217275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26, now test.air_travel.unique_Airline_id.cb196c2622)
[0m09:29:05.217611 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m09:29:05.224199 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m09:29:05.225046 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m09:29:05.227340 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m09:29:05.227840 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:29:05.228119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:05.822984 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:25df7290-ad89-45de-832d-f62c0e3a6a7b&page=queryresults
[0m09:29:06.194696 [info ] [Thread-1 (]: 3 of 3 PASS unique_Airline_id .................................................. [[32mPASS[0m in 0.98s]
[0m09:29:06.195694 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m09:29:06.197260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:29:06.199582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:06.199900 [debug] [MainThread]: Connection 'test.air_travel.unique_Airline_id.cb196c2622' was properly closed.
[0m09:29:06.200175 [info ] [MainThread]: 
[0m09:29:06.200474 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m09:29:06.201248 [debug] [MainThread]: Command end result
[0m09:29:06.228708 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:29:06.229772 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:29:06.232655 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:29:06.232817 [info ] [MainThread]: 
[0m09:29:06.232959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:29:06.233074 [info ] [MainThread]: 
[0m09:29:06.233195 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m09:29:06.234889 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.122553, "process_in_blocks": "0", "process_kernel_time": 0.229999, "process_mem_max_rss": "389709824", "process_out_blocks": "0", "process_user_time": 1.750414}
[0m09:29:06.235049 [debug] [MainThread]: Command `dbt test` succeeded at 09:29:06.235019 after 5.12 seconds
[0m09:29:06.235203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce20a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123692af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123692620>]}
[0m09:29:06.235364 [debug] [MainThread]: Flushing usage events
[0m09:29:06.525469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:22.471965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b01c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be679d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be67750>]}


============================== 09:34:22.473685 | 662509f4-afb3-4e1b-8fd2-221da41fce6d ==============================
[0m09:34:22.473685 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:34:22.473925 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error': 'None', 'static_parser': 'True', 'version_check': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'quiet': 'False', 'no_print': 'None', 'fail_fast': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'invocation_command': 'dbt test --select Airport', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True'}
[0m09:34:23.297545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '662509f4-afb3-4e1b-8fd2-221da41fce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1c0c30>]}
[0m09:34:23.317065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '662509f4-afb3-4e1b-8fd2-221da41fce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121dbe360>]}
[0m09:34:23.317283 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:34:23.393451 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:34:23.440196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:34:23.440509 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m09:34:23.461866 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'country_code' in the 'models' section of file 'models/int/schema.yml'
[0m09:34:23.497465 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.air_travel.relationships_country_code_iso_code__ref_Country_.52d3193aae' (models/int/schema.yml) depends on a node named 'country_code' in package '' which was not found
[0m09:34:23.519636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:34:23.524539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '662509f4-afb3-4e1b-8fd2-221da41fce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221da750>]}
[0m09:34:23.561521 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:34:23.562424 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:34:23.572665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '662509f4-afb3-4e1b-8fd2-221da41fce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12264ba70>]}
[0m09:34:23.572844 [info ] [MainThread]: Found 39 models, 27 data tests, 9 sources, 630 macros
[0m09:34:23.572967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '662509f4-afb3-4e1b-8fd2-221da41fce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f409f0>]}
[0m09:34:23.573783 [info ] [MainThread]: 
[0m09:34:23.573912 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:34:23.574007 [info ] [MainThread]: 
[0m09:34:23.574192 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:34:23.576278 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_tmp'
[0m09:34:23.576423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:23.865636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m09:34:23.869124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:24.276047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:34:24.278183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:24.600130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '662509f4-afb3-4e1b-8fd2-221da41fce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122773ee0>]}
[0m09:34:24.601063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:34:24.605488 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:34:24.606030 [info ] [Thread-1 (]: 1 of 2 START test not_null_Airport_icao ........................................ [RUN]
[0m09:34:24.606472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m09:34:24.606804 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:34:24.617842 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m09:34:24.618433 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:34:24.631052 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m09:34:24.631504 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m09:34:24.631732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:25.216464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3eeffd72-1885-4a28-8db2-b32873526efd&page=queryresults
[0m09:34:25.725926 [info ] [Thread-1 (]: 1 of 2 PASS not_null_Airport_icao .............................................. [[32mPASS[0m in 1.12s]
[0m09:34:25.726659 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:34:25.726988 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:34:25.727387 [info ] [Thread-1 (]: 2 of 2 START test unique_Airport_icao .......................................... [RUN]
[0m09:34:25.727836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m09:34:25.728135 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:34:25.732998 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m09:34:25.733608 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:34:25.735940 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m09:34:25.736509 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:34:25.736772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:26.206412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b1e582b3-9a22-4ad4-ab6d-2d79877d26f8&page=queryresults
[0m09:34:26.636716 [info ] [Thread-1 (]: 2 of 2 PASS unique_Airport_icao ................................................ [[32mPASS[0m in 0.91s]
[0m09:34:26.637697 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:34:26.639716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:34:26.641628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:26.641943 [debug] [MainThread]: Connection 'test.air_travel.unique_Airport_icao.8928a8a965' was properly closed.
[0m09:34:26.642235 [info ] [MainThread]: 
[0m09:34:26.642538 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m09:34:26.643524 [debug] [MainThread]: Command end result
[0m09:34:26.670005 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:34:26.671267 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:34:26.674856 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:34:26.675044 [info ] [MainThread]: 
[0m09:34:26.675231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:34:26.675371 [info ] [MainThread]: 
[0m09:34:26.675526 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m09:34:26.678127 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.2294164, "process_in_blocks": "0", "process_kernel_time": 0.261734, "process_mem_max_rss": "392331264", "process_out_blocks": "0", "process_user_time": 1.831531}
[0m09:34:26.678403 [debug] [MainThread]: Command `dbt test` succeeded at 09:34:26.678352 after 4.23 seconds
[0m09:34:26.678591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd6ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122719020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122719860>]}
[0m09:34:26.678765 [debug] [MainThread]: Flushing usage events
[0m09:34:26.890492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:35:06.698983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a3750>]}


============================== 09:35:06.700639 | 49de3490-1157-4b8c-b353-3828291b2cfb ==============================
[0m09:35:06.700639 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m09:35:06.700872 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': '/Users/scohen/.dbt', 'no_print': 'None', 'static_parser': 'True', 'warn_error': 'None', 'printer_width': '80', 'empty': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select Airport', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m09:35:07.511451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49de3490-1157-4b8c-b353-3828291b2cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083fcc30>]}
[0m09:35:07.530884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49de3490-1157-4b8c-b353-3828291b2cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0c2360>]}
[0m09:35:07.531097 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m09:35:07.607306 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m09:35:07.652603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:35:07.652955 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m09:35:07.781947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.air_travel.mrt
[0m09:35:07.786681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49de3490-1157-4b8c-b353-3828291b2cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9a4d50>]}
[0m09:35:07.821972 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:35:07.822882 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:35:07.911839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49de3490-1157-4b8c-b353-3828291b2cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbc5d60>]}
[0m09:35:07.912058 [info ] [MainThread]: Found 39 models, 28 data tests, 9 sources, 630 macros
[0m09:35:07.912190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49de3490-1157-4b8c-b353-3828291b2cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8aa350>]}
[0m09:35:07.912977 [info ] [MainThread]: 
[0m09:35:07.913102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:35:07.913199 [info ] [MainThread]: 
[0m09:35:07.913385 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:35:07.915490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_int'
[0m09:35:07.915659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:08.210758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m09:35:08.211849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:08.488774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m09:35:08.490680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:08.776034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49de3490-1157-4b8c-b353-3828291b2cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb9f110>]}
[0m09:35:08.776690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:35:08.780039 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:35:08.780373 [info ] [Thread-1 (]: 1 of 3 START test not_null_Airport_icao ........................................ [RUN]
[0m09:35:08.780707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m09:35:08.780976 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:35:08.791527 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m09:35:08.792198 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:35:08.804292 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m09:35:08.804703 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m09:35:08.804914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:09.351113 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7e76bcf9-805d-4e85-ab6c-1e4c91f4f125&page=queryresults
[0m09:35:09.912044 [info ] [Thread-1 (]: 1 of 3 PASS not_null_Airport_icao .............................................. [[32mPASS[0m in 1.13s]
[0m09:35:09.912812 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m09:35:09.913163 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m09:35:09.913568 [info ] [Thread-1 (]: 2 of 3 START test relationships_Airport_country_code__iso_code__ref_Country_ ... [RUN]
[0m09:35:09.914028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0)
[0m09:35:09.914352 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m09:35:09.918423 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m09:35:09.919153 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m09:35:09.921275 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m09:35:09.921915 [debug] [Thread-1 (]: On test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m09:35:09.922234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:10.581263 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9cc61518-e662-401a-9549-3ebd3ff770c6&page=queryresults
[0m09:35:11.058919 [error] [Thread-1 (]: 2 of 3 FAIL 5 relationships_Airport_country_code__iso_code__ref_Country_ ....... [[31mFAIL 5[0m in 1.14s]
[0m09:35:11.060035 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m09:35:11.060520 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:35:11.061004 [info ] [Thread-1 (]: 3 of 3 START test unique_Airport_icao .......................................... [RUN]
[0m09:35:11.061559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m09:35:11.062263 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:35:11.068687 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m09:35:11.069568 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:35:11.071886 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m09:35:11.072362 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:35:11.072641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:11.511849 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:24ad7aac-7762-46bf-898f-6a5800332f16&page=queryresults
[0m09:35:11.882359 [info ] [Thread-1 (]: 3 of 3 PASS unique_Airport_icao ................................................ [[32mPASS[0m in 0.82s]
[0m09:35:11.883395 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m09:35:11.885014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:35:11.887383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:11.887889 [debug] [MainThread]: Connection 'test.air_travel.unique_Airport_icao.8928a8a965' was properly closed.
[0m09:35:11.888221 [info ] [MainThread]: 
[0m09:35:11.888665 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m09:35:11.889673 [debug] [MainThread]: Command end result
[0m09:35:11.919287 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m09:35:11.920405 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m09:35:11.923686 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m09:35:11.923840 [info ] [MainThread]: 
[0m09:35:11.923980 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:35:11.924088 [info ] [MainThread]: 
[0m09:35:11.924220 [error] [MainThread]: [31mFailure in test relationships_Airport_country_code__iso_code__ref_Country_ (models/int/schema.yml)[0m
[0m09:35:11.924346 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m09:35:11.924435 [info ] [MainThread]: 
[0m09:35:11.924547 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/schema.yml/relationships_Airport_country_code__iso_code__ref_Country_.sql
[0m09:35:11.924642 [info ] [MainThread]: 
[0m09:35:11.924755 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m09:35:11.926603 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.250902, "process_in_blocks": "0", "process_kernel_time": 0.238657, "process_mem_max_rss": "394854400", "process_out_blocks": "0", "process_user_time": 1.940235}
[0m09:35:11.926770 [debug] [MainThread]: Command `dbt test` failed at 09:35:11.926741 after 5.25 seconds
[0m09:35:11.926911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa8bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa8b490>]}
[0m09:35:11.927029 [debug] [MainThread]: Flushing usage events
[0m09:35:12.116646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:00.708785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f046e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d4f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d4f750>]}


============================== 10:17:00.710360 | eee9e528-a8c2-4ca2-8b68-4314c2310f2d ==============================
[0m10:17:00.710360 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:17:00.710595 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select models/mrt/foot_traffic_starbucks_airports_monthly.sql models/mrt/foot_traffic_starbucks_terminals_monthly.sql', 'static_parser': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'version_check': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'use_experimental_parser': 'False', 'fail_fast': 'False'}
[0m10:17:01.532100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eee9e528-a8c2-4ca2-8b68-4314c2310f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a8c30>]}
[0m10:17:01.551499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eee9e528-a8c2-4ca2-8b68-4314c2310f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbbe360>]}
[0m10:17:01.551711 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:17:01.627848 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:17:01.674403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:17:01.674639 [debug] [MainThread]: Partial parsing: added file: air_travel://models/mrt/foot_traffic_starbucks_terminals_monthly.sql
[0m10:17:01.674753 [debug] [MainThread]: Partial parsing: added file: air_travel://models/mrt/foot_traffic_starbucks_airports_monthly.sql
[0m10:17:01.760736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eee9e528-a8c2-4ca2-8b68-4314c2310f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ffde850>]}
[0m10:17:01.795656 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:17:01.796463 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:17:01.803213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eee9e528-a8c2-4ca2-8b68-4314c2310f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbce8a0>]}
[0m10:17:01.803383 [info ] [MainThread]: Found 41 models, 28 data tests, 9 sources, 630 macros
[0m10:17:01.803504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eee9e528-a8c2-4ca2-8b68-4314c2310f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc87150>]}
[0m10:17:01.805581 [info ] [MainThread]: 
[0m10:17:01.805711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:17:01.805806 [info ] [MainThread]: 
[0m10:17:01.805979 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:17:01.807277 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:17:01.807432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:02.165325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now create_cs378-fa2025_dbt_air_travel_mrt)
[0m10:17:02.166214 [debug] [ThreadPool]: Creating schema "database: "cs378-fa2025"
schema: "dbt_air_travel_mrt"
"
[0m10:17:02.174613 [debug] [ThreadPool]: On create_cs378-fa2025_dbt_air_travel_mrt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "create_cs378-fa2025_dbt_air_travel_mrt"} */
create schema if not exists `cs378-fa2025`.`dbt_air_travel_mrt`
  
[0m10:17:02.175101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:02.539094 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ec6730e1-2c1f-46be-91e4-210aea0f02df&page=queryresults
[0m10:17:03.219237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m10:17:03.219528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:03.509383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m10:17:03.510226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:03.812311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:17:03.814598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:04.146435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m10:17:04.148203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:04.442670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eee9e528-a8c2-4ca2-8b68-4314c2310f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120704c80>]}
[0m10:17:04.443189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:04.445977 [debug] [Thread-1 (]: Began running node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m10:17:04.446379 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_air_travel_mrt.foot_traffic_starbucks_airports_monthly  [RUN]
[0m10:17:04.446696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.foot_traffic_starbucks_airports_monthly)
[0m10:17:04.446935 [debug] [Thread-1 (]: Began compiling node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m10:17:04.453034 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.foot_traffic_starbucks_airports_monthly"
[0m10:17:04.453673 [debug] [Thread-1 (]: Began executing node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m10:17:04.473331 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.foot_traffic_starbucks_airports_monthly"
[0m10:17:04.473997 [debug] [Thread-1 (]: On model.air_travel.foot_traffic_starbucks_airports_monthly: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.foot_traffic_starbucks_airports_monthly"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_mrt`.`foot_traffic_starbucks_airports_monthly`
      
    
    

    
    OPTIONS()
    as (
      with foot_traffic_starbucks_airports_monthly as (
    select case month_of_year
        when 1 then 'January'
        when 2 then 'February'
        when 3 then 'March'
        when 4 then 'April'
        when 5 then 'May'
        when 6 then 'June'
        when 7 then 'July'
        when 8 then 'August'
        when 9 then 'September'
        when 10 then 'October'
        when 11 then 'November'
        when 12 then 'December' end as month_long, * except (month_of_year)
    from
        (select extract(month from t.event_date) as month_of_year, 
            t.airport_icao, a.name as airport_name,
            ac.location, round(avg(total_traffic), 2) avg_foot_traffic
        from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic` t
        join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a on t.airport_icao = a.icao
        join `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions` ac on a.icao = ac.airport_icao
        where ac.business = 'Starbucks'
        group by extract(month from t.event_date), t.airport_icao, a.name, ac.location
        order by airport_icao, month_of_year)
    )

select * 
from foot_traffic_starbucks_airports_monthly
    );
  
[0m10:17:04.474240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:05.030850 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c7868c83-c0e7-4ad9-8fbc-b92d98970eb1&page=queryresults
[0m10:17:07.238404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eee9e528-a8c2-4ca2-8b68-4314c2310f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204a7050>]}
[0m10:17:07.239089 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_air_travel_mrt.foot_traffic_starbucks_airports_monthly  [[32mCREATE TABLE (0.0 rows, 120.2 KiB processed)[0m in 2.79s]
[0m10:17:07.239544 [debug] [Thread-1 (]: Finished running node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m10:17:07.239806 [debug] [Thread-1 (]: Began running node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m10:17:07.240188 [info ] [Thread-1 (]: 2 of 2 START sql table model dbt_air_travel_mrt.foot_traffic_starbucks_terminals_monthly  [RUN]
[0m10:17:07.240547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.foot_traffic_starbucks_airports_monthly, now model.air_travel.foot_traffic_starbucks_terminals_monthly)
[0m10:17:07.240790 [debug] [Thread-1 (]: Began compiling node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m10:17:07.242142 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.foot_traffic_starbucks_terminals_monthly"
[0m10:17:07.242711 [debug] [Thread-1 (]: Began executing node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m10:17:07.246588 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.foot_traffic_starbucks_terminals_monthly"
[0m10:17:07.247189 [debug] [Thread-1 (]: On model.air_travel.foot_traffic_starbucks_terminals_monthly: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.foot_traffic_starbucks_terminals_monthly"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_mrt`.`foot_traffic_starbucks_terminals_monthly`
      
    
    

    
    OPTIONS()
    as (
      with foot_traffic_starbucks_terminals_monthly as (
  select case month_of_year
    when 1 then 'January'
    when 2 then 'February'
    when 3 then 'March'
    when 4 then 'April'
    when 5 then 'May'
    when 6 then 'June'
    when 7 then 'July'
    when 8 then 'August'
    when 9 then 'September'
    when 10 then 'October'
    when 11 then 'November'
    when 12 then 'December' end as month_long, * except (month_of_year)
  from
    (select extract(month from t.event_date) as month_of_year, ct.mapped_terminal as terminal, t.airport_icao, a.name as airport,
      ac.location, round(avg(total_traffic), 2) avg_foot_traffic
    from air_travel_int.TSA_Traffic t
    join air_travel_tmp.tsa_checkpoint_terminal ct
      on t.airport_icao = ct.airport_icao and t.security_checkpoint = ct.security_checkpoint
    join air_travel_int.Airport a on t.airport_icao = a.icao
    join air_travel_int.Airport_Concessions ac on a.icao = ac.airport_icao
    join air_travel_int.Airport_Concessions ac2
      on ac2.airport_icao = ct.airport_icao and ac2.terminal = ct.mapped_terminal
    where ac.business = 'Starbucks'
    group by extract(month from t.event_date), ct.mapped_terminal, t.airport_icao, a.name, ac.location
    order by airport_icao, month_of_year)
)

select *
from foot_traffic_starbucks_terminals_monthly
    );
  
[0m10:17:07.247477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:07.910749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c6392af9-84ad-4a2e-8cc5-039c533dad3e&page=queryresults
[0m10:17:09.991351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eee9e528-a8c2-4ca2-8b68-4314c2310f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202fafc0>]}
[0m10:17:09.992317 [info ] [Thread-1 (]: 2 of 2 OK created sql table model dbt_air_travel_mrt.foot_traffic_starbucks_terminals_monthly  [[32mCREATE TABLE (12.0 rows, 244.6 KiB processed)[0m in 2.75s]
[0m10:17:09.992947 [debug] [Thread-1 (]: Finished running node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m10:17:09.994332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:09.995908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:09.996126 [debug] [MainThread]: Connection 'model.air_travel.foot_traffic_starbucks_terminals_monthly' was properly closed.
[0m10:17:09.996400 [info ] [MainThread]: 
[0m10:17:09.996654 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.19 seconds (8.19s).
[0m10:17:09.997312 [debug] [MainThread]: Command end result
[0m10:17:10.111581 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:17:10.112360 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:17:10.114431 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:17:10.114536 [info ] [MainThread]: 
[0m10:17:10.114668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:10.114785 [info ] [MainThread]: 
[0m10:17:10.114906 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:17:10.116620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.431363, "process_in_blocks": "0", "process_kernel_time": 0.269088, "process_mem_max_rss": "392151040", "process_out_blocks": "0", "process_user_time": 2.001605}
[0m10:17:10.116770 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:10.116741 after 9.43 seconds
[0m10:17:10.116889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120352350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120303ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203e3ed0>]}
[0m10:17:10.117003 [debug] [MainThread]: Flushing usage events
[0m10:17:10.323400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:42.201497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9c06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80b750>]}


============================== 10:19:42.203110 | db3149b8-80fb-4b6a-814e-aace19cf148e ==============================
[0m10:19:42.203110 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:19:42.203352 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'invocation_command': 'dbt run --select models/mrt/foot_traffic_starbucks_terminals_monthly', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'debug': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None'}
[0m10:19:43.030424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db3149b8-80fb-4b6a-814e-aace19cf148e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb64c30>]}
[0m10:19:43.050366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db3149b8-80fb-4b6a-814e-aace19cf148e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236be360>]}
[0m10:19:43.050585 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:19:43.126886 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:19:43.173725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:19:43.173975 [debug] [MainThread]: Partial parsing: added file: air_travel://models/mrt/passenger_sentiment_airports_top_kpis.sql
[0m10:19:43.174107 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/mrt/foot_traffic_starbucks_terminals_monthly.sql
[0m10:19:43.233501 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.foot_traffic_starbucks_terminals_monthly' (models/mrt/foot_traffic_starbucks_terminals_monthly.sql) depends on a node named 'tsa_checkpoint_terminal' which was not found
[0m10:19:43.235404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0571, "process_in_blocks": "0", "process_kernel_time": 0.222506, "process_mem_max_rss": "380010496", "process_out_blocks": "0", "process_user_time": 1.330756}
[0m10:19:43.235626 [debug] [MainThread]: Command `dbt run` failed at 10:19:43.235583 after 1.06 seconds
[0m10:19:43.235774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12366eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123adae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e16d50>]}
[0m10:19:43.235911 [debug] [MainThread]: Flushing usage events
[0m10:19:43.445170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:32.667335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083986e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e3750>]}


============================== 10:26:32.668956 | a9615fff-789c-4a44-87f8-f6b681d0d915 ==============================
[0m10:26:32.668956 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:26:32.669207 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'empty': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select tsa_checkpoint_terminal', 'log_cache_events': 'False', 'debug': 'False', 'static_parser': 'True', 'no_print': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'write_json': 'True'}
[0m10:26:33.522911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9615fff-789c-4a44-87f8-f6b681d0d915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853cc30>]}
[0m10:26:33.542348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9615fff-789c-4a44-87f8-f6b681d0d915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0be360>]}
[0m10:26:33.542544 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:26:33.618719 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:26:33.665612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m10:26:33.665856 [debug] [MainThread]: Partial parsing: added file: air_travel://models/mrt/passenger_sentiment_airports_top_kpis.sql
[0m10:26:33.665968 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tsa_checkpoint_terminal.sql
[0m10:26:33.666083 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/mrt/foot_traffic_starbucks_terminals_monthly.sql
[0m10:26:33.753249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9615fff-789c-4a44-87f8-f6b681d0d915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4da850>]}
[0m10:26:33.788740 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:26:33.789572 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:26:33.796345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9615fff-789c-4a44-87f8-f6b681d0d915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5c72f0>]}
[0m10:26:33.796519 [info ] [MainThread]: Found 43 models, 28 data tests, 9 sources, 630 macros
[0m10:26:33.796639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9615fff-789c-4a44-87f8-f6b681d0d915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f187bd0>]}
[0m10:26:33.797401 [info ] [MainThread]: 
[0m10:26:33.797531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:33.797631 [info ] [MainThread]: 
[0m10:26:33.797814 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:26:33.798126 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:26:33.798288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:34.199757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m10:26:34.200053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:34.477287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:26:34.478475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:34.772266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m10:26:34.774703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:35.048126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m10:26:35.050665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:35.513379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9615fff-789c-4a44-87f8-f6b681d0d915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9c7d40>]}
[0m10:26:35.514246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:35.518471 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_checkpoint_terminal
[0m10:26:35.518951 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tsa_checkpoint_terminal ........ [RUN]
[0m10:26:35.519311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tsa_checkpoint_terminal)
[0m10:26:35.519600 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_checkpoint_terminal
[0m10:26:35.525910 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_checkpoint_terminal"
[0m10:26:35.526575 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_checkpoint_terminal
[0m10:26:35.550401 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tsa_checkpoint_terminal"
[0m10:26:35.550929 [debug] [Thread-1 (]: On model.air_travel.tsa_checkpoint_terminal: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tsa_checkpoint_terminal"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tsa_checkpoint_terminal`
      
    
    

    
    OPTIONS()
    as (
      

with tsa_checkpoints as (
  select distinct security_checkpoint, airport_icao
  from air_travel_int.TSA_Traffic
),
tsa_checkpoint_terminal as (
    select airport_icao, security_checkpoint,
    AI.GENERATE(
      ('What is the terminal for TSA security checkpoint ', security_checkpoint, ' and airport ', airport_icao, '? If you cannot find it, return None.'),
      connection_id => 'us-central1.vertex-ai-connection',
      endpoint => 'gemini-2.5-flash-lite',
      model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
      output_schema => 'terminal STRING') as llm_response
  from tsa_checkpoints
)

select airport_icao, security_checkpoint, llm_response.terminal as mapped_terminal
from tsa_checkpoint_terminal
    );
  
[0m10:26:35.551145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:36.634269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:583a0240-f9ed-46cc-a33b-acb3631180d8&page=queryresults
[0m10:26:40.527032 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:26:40.974103 [error] [MainThread]: CANCEL query model.air_travel.tsa_checkpoint_terminal .......................... [[31mCANCEL[0m]
[0m10:26:40.974935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:26:42.579366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:42.580304 [debug] [MainThread]: Connection 'model.air_travel.tsa_checkpoint_terminal' was properly closed.
[0m10:26:42.580820 [info ] [MainThread]: 
[0m10:26:42.581297 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 8.78 seconds (8.78s).
[0m10:26:42.581901 [error] [MainThread]: Encountered an error:

[0m10:26:42.586439 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 421, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 348, in run_queue
    self.job_queue.join()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 105, in join
    self.all_tasks_done.wait()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 587, in run
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 604, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 541, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 454, in execute_nodes
    self._cancel_connections(pool)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/runnable.py", line 412, in _cancel_connections
    pool.join()
    ~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/pool.py", line 669, in join
    p.join()
    ~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 1094, in join
    self._handle.join(timeout)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyboardInterrupt

[0m10:26:42.591637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.947699, "process_in_blocks": "0", "process_kernel_time": 0.253035, "process_mem_max_rss": "390316032", "process_out_blocks": "0", "process_user_time": 1.780236}
[0m10:26:42.592118 [debug] [MainThread]: Command `dbt run` failed at 10:26:42.592028 after 9.95 seconds
[0m10:26:42.592431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7f8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7f8f70>]}
[0m10:26:42.592726 [debug] [MainThread]: Flushing usage events
[0m10:26:42.821207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:01.953695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa646e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8af9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8af750>]}


============================== 10:27:01.955271 | 8510a033-8099-44e7-b4e5-78d2c269c99a ==============================
[0m10:27:01.955271 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:27:01.955513 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_format': 'default', 'fail_fast': 'False', 'empty': 'False', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select tsa_checkpoint_terminal', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m10:27:02.794250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8510a033-8099-44e7-b4e5-78d2c269c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac08c30>]}
[0m10:27:02.814368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8510a033-8099-44e7-b4e5-78d2c269c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218c2360>]}
[0m10:27:02.814673 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:27:02.892047 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:27:02.937919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:27:02.938190 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tsa_checkpoint_terminal.sql
[0m10:27:03.024682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8510a033-8099-44e7-b4e5-78d2c269c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121cda850>]}
[0m10:27:03.061712 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:27:03.062659 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:27:03.069633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8510a033-8099-44e7-b4e5-78d2c269c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218ce8a0>]}
[0m10:27:03.069807 [info ] [MainThread]: Found 43 models, 28 data tests, 9 sources, 630 macros
[0m10:27:03.069939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8510a033-8099-44e7-b4e5-78d2c269c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121987150>]}
[0m10:27:03.070722 [info ] [MainThread]: 
[0m10:27:03.070849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:03.070945 [info ] [MainThread]: 
[0m10:27:03.071135 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:27:03.071444 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:27:03.071592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:03.419695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m10:27:03.420245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:03.734672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:27:03.735521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:04.061021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m10:27:04.062871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:04.294591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m10:27:04.296946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:04.587525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8510a033-8099-44e7-b4e5-78d2c269c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221b46d0>]}
[0m10:27:04.588079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:04.591905 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_checkpoint_terminal
[0m10:27:04.592381 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tsa_checkpoint_terminal ........ [RUN]
[0m10:27:04.592747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tsa_checkpoint_terminal)
[0m10:27:04.593029 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_checkpoint_terminal
[0m10:27:04.600063 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_checkpoint_terminal"
[0m10:27:04.600807 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_checkpoint_terminal
[0m10:27:04.626493 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tsa_checkpoint_terminal"
[0m10:27:04.627104 [debug] [Thread-1 (]: On model.air_travel.tsa_checkpoint_terminal: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tsa_checkpoint_terminal"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tsa_checkpoint_terminal`
      
    
    

    
    OPTIONS()
    as (
      

with tsa_checkpoints as (
  select distinct security_checkpoint, airport_icao
  from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
),
tsa_checkpoint_terminal as (
    select airport_icao, security_checkpoint,
    AI.GENERATE(
      ('What is the terminal for TSA security checkpoint ', security_checkpoint, ' and airport ', airport_icao, '? If you cannot find it, return None.'),
      connection_id => 'us-central1.vertex-ai-connection',
      endpoint => 'gemini-2.5-flash-lite',
      model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
      output_schema => 'terminal STRING') as llm_response
  from tsa_checkpoints
)

select airport_icao, security_checkpoint, llm_response.terminal as mapped_terminal
from tsa_checkpoint_terminal
    );
  
[0m10:27:04.627339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:05.306636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0f156f5a-64a5-405b-8d28-8880032b8e5c&page=queryresults
[0m10:28:46.402684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8510a033-8099-44e7-b4e5-78d2c269c99a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222a9d90>]}
[0m10:28:46.403496 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tsa_checkpoint_terminal ... [[32mCREATE TABLE (213.0 rows, 6.4 KiB processed)[0m in 101.81s]
[0m10:28:46.404011 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_checkpoint_terminal
[0m10:28:46.405046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:46.406346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:46.406536 [debug] [MainThread]: Connection 'model.air_travel.tsa_checkpoint_terminal' was properly closed.
[0m10:28:46.406713 [info ] [MainThread]: 
[0m10:28:46.406905 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 43.34 seconds (103.34s).
[0m10:28:46.407319 [debug] [MainThread]: Command end result
[0m10:28:46.517006 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:28:46.517860 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:28:46.520004 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:28:46.520110 [info ] [MainThread]: 
[0m10:28:46.520250 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:28:46.520353 [info ] [MainThread]: 
[0m10:28:46.520470 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:28:46.522164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 104.5924, "process_in_blocks": "0", "process_kernel_time": 0.258224, "process_mem_max_rss": "392773632", "process_out_blocks": "0", "process_user_time": 1.952939}
[0m10:28:46.522315 [debug] [MainThread]: Command `dbt run` succeeded at 10:28:46.522286 after 104.59 seconds
[0m10:28:46.522435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121860aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12205ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12205a7b0>]}
[0m10:28:46.522546 [debug] [MainThread]: Flushing usage events
[0m10:28:46.732406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:27.980046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090486e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e939d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e93750>]}


============================== 10:47:27.981643 | 3259f545-95d2-44d5-93d1-6fe878e02891 ==============================
[0m10:47:27.981643 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:47:27.981868 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'version_check': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select tmp_tsa_checkpoint_terminal', 'printer_width': '80', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'no_print': 'None'}
[0m10:47:28.881491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3259f545-95d2-44d5-93d1-6fe878e02891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ecc30>]}
[0m10:47:28.902959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3259f545-95d2-44d5-93d1-6fe878e02891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11febe360>]}
[0m10:47:28.903268 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:47:28.985408 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:47:29.037991 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m10:47:29.038342 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_tsa_checkpoint_terminal.sql
[0m10:47:29.038477 [debug] [MainThread]: Partial parsing: deleted file: air_travel://models/tmp/tsa_checkpoint_terminal.sql
[0m10:47:29.038579 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/mrt/foot_traffic_starbucks_terminals_monthly.sql
[0m10:47:29.102912 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.foot_traffic_starbucks_terminals_monthly' (models/mrt/foot_traffic_starbucks_terminals_monthly.sql) depends on a node named 'tsa_checkpoint_terminal' which was not found
[0m10:47:29.104866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1481782, "process_in_blocks": "0", "process_kernel_time": 0.244838, "process_mem_max_rss": "380420096", "process_out_blocks": "0", "process_user_time": 1.397141}
[0m10:47:29.105112 [debug] [MainThread]: Command `dbt run` failed at 10:47:29.105073 after 1.15 seconds
[0m10:47:29.105268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe6eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202dee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12061ad50>]}
[0m10:47:29.105405 [debug] [MainThread]: Flushing usage events
[0m10:47:29.304194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:44.891671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109473750>]}


============================== 10:47:44.893273 | bb80cf1a-1677-4cf1-9399-488532316e43 ==============================
[0m10:47:44.893273 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:47:44.893518 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select tmp_tsa_checkpoint_terminal', 'fail_fast': 'False', 'printer_width': '80'}
[0m10:47:45.800682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb80cf1a-1677-4cf1-9399-488532316e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ccc30>]}
[0m10:47:45.821524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb80cf1a-1677-4cf1-9399-488532316e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4be360>]}
[0m10:47:45.821879 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:47:45.902838 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:47:45.953407 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m10:47:45.953752 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_tsa_checkpoint_terminal.sql
[0m10:47:45.953889 [debug] [MainThread]: Partial parsing: deleted file: air_travel://models/tmp/tsa_checkpoint_terminal.sql
[0m10:47:45.953991 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/mrt/foot_traffic_starbucks_terminals_monthly.sql
[0m10:47:46.043399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb80cf1a-1677-4cf1-9399-488532316e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8da850>]}
[0m10:47:46.079113 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:47:46.079905 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:47:46.086763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb80cf1a-1677-4cf1-9399-488532316e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4ce8a0>]}
[0m10:47:46.086926 [info ] [MainThread]: Found 43 models, 28 data tests, 9 sources, 630 macros
[0m10:47:46.087055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb80cf1a-1677-4cf1-9399-488532316e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f586970>]}
[0m10:47:46.087855 [info ] [MainThread]: 
[0m10:47:46.087981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:47:46.088075 [info ] [MainThread]: 
[0m10:47:46.088247 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:47:46.088580 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:47:46.088729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:46.480640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:47:46.481036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:46.749653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m10:47:46.751731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:47.028826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m10:47:47.031886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:47.310249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m10:47:47.311161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:47.616584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb80cf1a-1677-4cf1-9399-488532316e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fddb860>]}
[0m10:47:47.617268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:47:47.621091 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_tsa_checkpoint_terminal
[0m10:47:47.621560 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_tsa_checkpoint_terminal .... [RUN]
[0m10:47:47.621923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.tmp_tsa_checkpoint_terminal)
[0m10:47:47.622199 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_tsa_checkpoint_terminal
[0m10:47:47.628375 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_tsa_checkpoint_terminal"
[0m10:47:47.628968 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_tsa_checkpoint_terminal
[0m10:47:47.652453 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_tsa_checkpoint_terminal"
[0m10:47:47.653023 [debug] [Thread-1 (]: On model.air_travel.tmp_tsa_checkpoint_terminal: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_tsa_checkpoint_terminal"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_tsa_checkpoint_terminal`
      
    
    

    
    OPTIONS()
    as (
      

with tsa_checkpoints as (
  select distinct security_checkpoint, airport_icao
  from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
),
tmp_tsa_checkpoint_terminal as (
    select airport_icao, security_checkpoint,
    AI.GENERATE(
      ('What is the terminal for TSA security checkpoint ', security_checkpoint, ' and airport ', airport_icao, '? If you cannot find it, return None.'),
      connection_id => 'us-central1.vertex-ai-connection',
      endpoint => 'gemini-2.5-flash-lite',
      model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
      output_schema => 'terminal STRING') as llm_response
  from tsa_checkpoints
)

select airport_icao, security_checkpoint, llm_response.terminal as mapped_terminal
from tmp_tsa_checkpoint_terminal
    );
  
[0m10:47:47.653251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:48.203547 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f306c734-194e-43f7-9048-4d09a546dd1e&page=queryresults
[0m10:48:01.369209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb80cf1a-1677-4cf1-9399-488532316e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fea1e50>]}
[0m10:48:01.369523 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_tsa_checkpoint_terminal  [[32mCREATE TABLE (213.0 rows, 6.4 KiB processed)[0m in 13.75s]
[0m10:48:01.369758 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_tsa_checkpoint_terminal
[0m10:48:01.370317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:01.371023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:01.371145 [debug] [MainThread]: Connection 'model.air_travel.tmp_tsa_checkpoint_terminal' was properly closed.
[0m10:48:01.371262 [info ] [MainThread]: 
[0m10:48:01.371390 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.28 seconds (15.28s).
[0m10:48:01.371650 [debug] [MainThread]: Command end result
[0m10:48:01.486982 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:48:01.488013 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:48:01.490297 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:48:01.490419 [info ] [MainThread]: 
[0m10:48:01.490573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:01.490687 [info ] [MainThread]: 
[0m10:48:01.490815 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:48:01.492511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.624647, "process_in_blocks": "0", "process_kernel_time": 0.293505, "process_mem_max_rss": "392740864", "process_out_blocks": "0", "process_user_time": 1.93413}
[0m10:48:01.492658 [debug] [MainThread]: Command `dbt run` succeeded at 10:48:01.492628 after 16.62 seconds
[0m10:48:01.492773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f460aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc56d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc567b0>]}
[0m10:48:01.492884 [debug] [MainThread]: Flushing usage events
[0m10:48:01.683510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:03.848514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adf46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc3f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc3f750>]}


============================== 10:49:03.850095 | d6b505c9-3522-4299-85ef-86a9c1d4fada ==============================
[0m10:49:03.850095 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:49:03.850340 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select foot_traffic_starbucks_terminals_monthly', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'quiet': 'False', 'partial_parse': 'True', 'empty': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'use_experimental_parser': 'False'}
[0m10:49:04.674420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6b505c9-3522-4299-85ef-86a9c1d4fada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af98c30>]}
[0m10:49:04.694301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6b505c9-3522-4299-85ef-86a9c1d4fada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ac2360>]}
[0m10:49:04.694513 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:49:04.770425 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:49:04.817247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:49:04.817388 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:49:04.834955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6b505c9-3522-4299-85ef-86a9c1d4fada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121edab50>]}
[0m10:49:04.869795 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:49:04.870600 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:49:04.877427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6b505c9-3522-4299-85ef-86a9c1d4fada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ace8a0>]}
[0m10:49:04.877601 [info ] [MainThread]: Found 43 models, 28 data tests, 9 sources, 630 macros
[0m10:49:04.877736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b505c9-3522-4299-85ef-86a9c1d4fada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12215a350>]}
[0m10:49:04.878549 [info ] [MainThread]: 
[0m10:49:04.878674 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:49:04.878768 [info ] [MainThread]: 
[0m10:49:04.878942 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:49:04.879284 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:49:04.879442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:05.265666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m10:49:05.266214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:05.558616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m10:49:05.559917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:05.821417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m10:49:05.823577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:06.180924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:49:06.184107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:06.455360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b505c9-3522-4299-85ef-86a9c1d4fada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122345230>]}
[0m10:49:06.456125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:49:06.460717 [debug] [Thread-1 (]: Began running node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m10:49:06.461292 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_mrt.foot_traffic_starbucks_terminals_monthly  [RUN]
[0m10:49:06.461683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.foot_traffic_starbucks_terminals_monthly)
[0m10:49:06.461988 [debug] [Thread-1 (]: Began compiling node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m10:49:06.470761 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.foot_traffic_starbucks_terminals_monthly"
[0m10:49:06.471323 [debug] [Thread-1 (]: Began executing node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m10:49:06.482308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:06.768527 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.foot_traffic_starbucks_terminals_monthly"
[0m10:49:06.769140 [debug] [Thread-1 (]: On model.air_travel.foot_traffic_starbucks_terminals_monthly: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.foot_traffic_starbucks_terminals_monthly"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_mrt`.`foot_traffic_starbucks_terminals_monthly`
      
    
    

    
    OPTIONS()
    as (
      with foot_traffic_starbucks_terminals_monthly as (
  select case month_of_year
    when 1 then 'January'
    when 2 then 'February'
    when 3 then 'March'
    when 4 then 'April'
    when 5 then 'May'
    when 6 then 'June'
    when 7 then 'July'
    when 8 then 'August'
    when 9 then 'September'
    when 10 then 'October'
    when 11 then 'November'
    when 12 then 'December' end as month_long, * except (month_of_year)
  from
    (select extract(month from t.event_date) as month_of_year, 
      ct.mapped_terminal as terminal, t.airport_icao, a.name as airport,
      ac.location, round(avg(total_traffic), 2) avg_foot_traffic
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic` t
    join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_tsa_checkpoint_terminal` ct
      on t.airport_icao = ct.airport_icao and t.security_checkpoint = ct.security_checkpoint
    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a on t.airport_icao = a.icao
    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions` ac on a.icao = ac.airport_icao
    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions` ac2
      on ac2.airport_icao = ct.airport_icao and ac2.terminal = ct.mapped_terminal
    where ac.business = 'Starbucks'
    group by extract(month from t.event_date), ct.mapped_terminal, t.airport_icao, a.name, ac.location
    order by airport_icao, month_of_year)
)

select *
from foot_traffic_starbucks_terminals_monthly
    );
  
[0m10:49:07.304991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:46ca2451-3c4d-4289-94f8-f96bf4989c69&page=queryresults
[0m10:49:09.179058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b505c9-3522-4299-85ef-86a9c1d4fada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222b8710>]}
[0m10:49:09.179610 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_mrt.foot_traffic_starbucks_terminals_monthly  [[32mCREATE TABLE (0.0 rows, 133.3 KiB processed)[0m in 2.72s]
[0m10:49:09.180054 [debug] [Thread-1 (]: Finished running node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m10:49:09.180922 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:49:09.182043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:09.182211 [debug] [MainThread]: Connection 'model.air_travel.foot_traffic_starbucks_terminals_monthly' was properly closed.
[0m10:49:09.182377 [info ] [MainThread]: 
[0m10:49:09.182561 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m10:49:09.182950 [debug] [MainThread]: Command end result
[0m10:49:09.206552 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:49:09.207624 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:49:09.210528 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:49:09.210679 [info ] [MainThread]: 
[0m10:49:09.210859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:09.210991 [info ] [MainThread]: 
[0m10:49:09.211136 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:49:09.213330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.388017, "process_in_blocks": "0", "process_kernel_time": 0.259223, "process_mem_max_rss": "388825088", "process_out_blocks": "0", "process_user_time": 1.748974}
[0m10:49:09.213535 [debug] [MainThread]: Command `dbt run` succeeded at 10:49:09.213496 after 5.39 seconds
[0m10:49:09.213694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222ee200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122341f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108118550>]}
[0m10:49:09.213842 [debug] [MainThread]: Flushing usage events
[0m10:49:09.420658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:19.955774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c98c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7d79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7d7750>]}


============================== 10:50:19.957407 | 542e7a24-3731-42f9-a3d6-be60e99aea8a ==============================
[0m10:50:19.957407 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:50:19.957657 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'static_parser': 'True', 'invocation_command': 'dbt run --select passenger_sentiment_airports_top_kpis', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'write_json': 'True'}
[0m10:50:20.770605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '542e7a24-3731-42f9-a3d6-be60e99aea8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb30c30>]}
[0m10:50:20.790082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '542e7a24-3731-42f9-a3d6-be60e99aea8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236be360>]}
[0m10:50:20.790296 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:50:20.866511 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:50:20.912194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:50:20.912459 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/mrt/passenger_sentiment_airports_top_kpis.sql
[0m10:50:20.971526 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.passenger_sentiment_airports_top_kpis' (models/mrt/passenger_sentiment_airports_top_kpis.sql) depends on a node named 'Airport_Review' which was not found
[0m10:50:20.973294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0415488, "process_in_blocks": "0", "process_kernel_time": 0.19997, "process_mem_max_rss": "380420096", "process_out_blocks": "0", "process_user_time": 1.337007}
[0m10:50:20.973513 [debug] [MainThread]: Command `dbt run` failed at 10:50:20.973472 after 1.04 seconds
[0m10:50:20.973657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12366eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12366fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e1a4e0>]}
[0m10:50:20.973787 [debug] [MainThread]: Flushing usage events
[0m10:50:21.163118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:40.530382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c36c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1b79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1b7750>]}


============================== 10:50:40.532266 | 73842f22-d5a8-4128-868d-edf9fa711bea ==============================
[0m10:50:40.532266 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:50:40.532514 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'target_path': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'warn_error': 'None', 'log_format': 'default', 'quiet': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select passenger_sentiment_airports_top_kpis', 'debug': 'False'}
[0m10:50:41.368741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73842f22-d5a8-4128-868d-edf9fa711bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c510c30>]}
[0m10:50:41.388489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73842f22-d5a8-4128-868d-edf9fa711bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231be360>]}
[0m10:50:41.388712 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:50:41.470145 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:50:41.519666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:50:41.519986 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/mrt/passenger_sentiment_airports_top_kpis.sql
[0m10:50:41.608574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73842f22-d5a8-4128-868d-edf9fa711bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235da850>]}
[0m10:50:41.645924 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:50:41.646946 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:50:41.654045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73842f22-d5a8-4128-868d-edf9fa711bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231ce8a0>]}
[0m10:50:41.654236 [info ] [MainThread]: Found 43 models, 28 data tests, 9 sources, 630 macros
[0m10:50:41.654365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73842f22-d5a8-4128-868d-edf9fa711bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123287070>]}
[0m10:50:41.655215 [info ] [MainThread]: 
[0m10:50:41.655343 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:50:41.655436 [info ] [MainThread]: 
[0m10:50:41.655623 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:50:41.655966 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:50:41.656123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:42.018553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m10:50:42.019139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:42.298979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m10:50:42.301486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:42.573237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:50:42.575115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:42.859581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m10:50:42.861979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:43.142293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73842f22-d5a8-4128-868d-edf9fa711bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ab3110>]}
[0m10:50:43.142700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:43.145233 [debug] [Thread-1 (]: Began running node model.air_travel.passenger_sentiment_airports_top_kpis
[0m10:50:43.145555 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_mrt.passenger_sentiment_airports_top_kpis  [RUN]
[0m10:50:43.145815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now model.air_travel.passenger_sentiment_airports_top_kpis)
[0m10:50:43.146018 [debug] [Thread-1 (]: Began compiling node model.air_travel.passenger_sentiment_airports_top_kpis
[0m10:50:43.150957 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.passenger_sentiment_airports_top_kpis"
[0m10:50:43.151492 [debug] [Thread-1 (]: Began executing node model.air_travel.passenger_sentiment_airports_top_kpis
[0m10:50:43.172451 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.passenger_sentiment_airports_top_kpis"
[0m10:50:43.173004 [debug] [Thread-1 (]: On model.air_travel.passenger_sentiment_airports_top_kpis: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.passenger_sentiment_airports_top_kpis"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_mrt`.`passenger_sentiment_airports_top_kpis`
      
    
    

    
    OPTIONS()
    as (
      with passenger_sentiment_airports_top_kpis as (
  select r.sub_category, a.icao, a.name as airport, a.city, 
    a.state_prov, c.name as country, r.sentiment, count(*) as count
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Reviews` r
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a on r.airport_icao = a.icao
  join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c on a.country_code = c.iso_code
  where r.sub_category in ('Wayfinding & Information', 'Airport Staff',
    'Amenities & Facilities', 'Boarding Process', 'Security Screening',
    'Food, Beverage & Retail')
  group by r.sub_category, a.icao, a.name, a.city, a.state_prov, c.name, r.sentiment
  order by r.sub_category, count(*) desc, a.name
)

select *
from passenger_sentiment_airports_top_kpis
    );
  
[0m10:50:43.173232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:43.667042 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0530dffe-2b03-40d5-b8dd-40a777c4a69a&page=queryresults
[0m10:50:46.138367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73842f22-d5a8-4128-868d-edf9fa711bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ba9f10>]}
[0m10:50:46.139036 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_mrt.passenger_sentiment_airports_top_kpis  [[32mCREATE TABLE (570.0 rows, 343.9 KiB processed)[0m in 2.99s]
[0m10:50:46.139522 [debug] [Thread-1 (]: Finished running node model.air_travel.passenger_sentiment_airports_top_kpis
[0m10:50:46.140510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:50:46.141662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:46.141831 [debug] [MainThread]: Connection 'model.air_travel.passenger_sentiment_airports_top_kpis' was properly closed.
[0m10:50:46.142002 [info ] [MainThread]: 
[0m10:50:46.142187 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m10:50:46.142596 [debug] [MainThread]: Command end result
[0m10:50:46.249724 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:50:46.250539 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:50:46.252815 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:50:46.252934 [info ] [MainThread]: 
[0m10:50:46.253070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:50:46.253169 [info ] [MainThread]: 
[0m10:50:46.253281 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:50:46.254980 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7516804, "process_in_blocks": "0", "process_kernel_time": 0.257146, "process_mem_max_rss": "393248768", "process_out_blocks": "0", "process_user_time": 1.898724}
[0m10:50:46.255127 [debug] [MainThread]: Command `dbt run` succeeded at 10:50:46.255098 after 5.75 seconds
[0m10:50:46.255246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123160aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12395ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12395a7b0>]}
[0m10:50:46.255354 [debug] [MainThread]: Flushing usage events
[0m10:50:46.447756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:18.881481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b33f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b33f750>]}


============================== 10:51:18.883116 | eadd6cf2-8d8a-4a2e-8e98-a9714381dcee ==============================
[0m10:51:18.883116 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:51:18.883357 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'empty': 'False', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --select Airport_Review'}
[0m10:51:19.709352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eadd6cf2-8d8a-4a2e-8e98-a9714381dcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a698c30>]}
[0m10:51:19.728846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eadd6cf2-8d8a-4a2e-8e98-a9714381dcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211c2360>]}
[0m10:51:19.729050 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:51:19.805076 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:51:19.852068 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m10:51:19.852311 [debug] [MainThread]: Partial parsing: added file: air_travel://models/int/Airport_Review.sql
[0m10:51:19.852457 [debug] [MainThread]: Partial parsing: deleted file: air_travel://models/int/Airport_Reviews.sql
[0m10:51:19.852564 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/mrt/passenger_sentiment_airports_top_kpis.sql
[0m10:51:19.931811 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'Airport_Reviews' in the 'models' section of file 'models/int/schema.yml'
[0m10:51:19.959298 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.air_travel.unique_Airport_Reviews_id.71cb9a3cce' (models/int/schema.yml) depends on a node named 'Airport_Reviews' in package '' which was not found
[0m10:51:19.959539 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.air_travel.not_null_Airport_Reviews_id.f4c6ceba4e' (models/int/schema.yml) depends on a node named 'Airport_Reviews' in package '' which was not found
[0m10:51:19.987704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eadd6cf2-8d8a-4a2e-8e98-a9714381dcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121aa8850>]}
[0m10:51:20.023207 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:51:20.024078 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:51:20.031542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eadd6cf2-8d8a-4a2e-8e98-a9714381dcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211ce8a0>]}
[0m10:51:20.031719 [info ] [MainThread]: Found 43 models, 26 data tests, 9 sources, 630 macros
[0m10:51:20.031850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eadd6cf2-8d8a-4a2e-8e98-a9714381dcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12121b230>]}
[0m10:51:20.032654 [info ] [MainThread]: 
[0m10:51:20.032781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:20.032877 [info ] [MainThread]: 
[0m10:51:20.033059 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:51:20.033374 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:51:20.033530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:20.430501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m10:51:20.430812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:20.719408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m10:51:20.720848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:20.985593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m10:51:20.987848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:21.255202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:51:21.258853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:21.522781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eadd6cf2-8d8a-4a2e-8e98-a9714381dcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c45980>]}
[0m10:51:21.523571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:21.640019 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Review
[0m10:51:21.640320 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport_Review ................. [RUN]
[0m10:51:21.640531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.Airport_Review)
[0m10:51:21.640659 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Review
[0m10:51:21.643423 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Review"
[0m10:51:21.643792 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Review
[0m10:51:21.657752 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport_Review"
[0m10:51:21.658407 [debug] [Thread-1 (]: On model.air_travel.Airport_Review: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport_Review"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
      
    
    

    
    OPTIONS()
    as (
      with Airport_Review as (
    select distinct r.id, r.review_thread, r.review_date, r.review_author,
      r.review_subject, r.review_details, a.icao as airport_icao, r.broad_category, r.sub_category, r.sentiment,
      r.language, r._data_source, r._load_time
    from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews` r join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a
    on a.icao = r.airport_code
)

select * 
from Airport_Review
    );
  
[0m10:51:21.658587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:22.165512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:046790ac-6af5-4c46-a608-6da0df4d57a9&page=queryresults
[0m10:51:24.409298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eadd6cf2-8d8a-4a2e-8e98-a9714381dcee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121cdd610>]}
[0m10:51:24.409908 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Airport_Review ............ [[32mCREATE TABLE (3.9k rows, 5.1 MiB processed)[0m in 2.77s]
[0m10:51:24.410337 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Review
[0m10:51:24.411330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:24.412490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:24.412661 [debug] [MainThread]: Connection 'model.air_travel.Airport_Review' was properly closed.
[0m10:51:24.412835 [info ] [MainThread]: 
[0m10:51:24.413033 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m10:51:24.413444 [debug] [MainThread]: Command end result
[0m10:51:24.436374 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:51:24.437421 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:51:24.440054 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:51:24.440192 [info ] [MainThread]: 
[0m10:51:24.440366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:51:24.440492 [info ] [MainThread]: 
[0m10:51:24.440635 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:51:24.442839 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.584968, "process_in_blocks": "0", "process_kernel_time": 0.270912, "process_mem_max_rss": "398262272", "process_out_blocks": "0", "process_user_time": 1.922865}
[0m10:51:24.443028 [debug] [MainThread]: Command `dbt run` succeeded at 10:51:24.442991 after 5.59 seconds
[0m10:51:24.443182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c16570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b77430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214316d0>]}
[0m10:51:24.443333 [debug] [MainThread]: Flushing usage events
[0m10:51:24.657820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:43.623406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8fc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7479d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b747750>]}


============================== 10:51:43.625048 | a88a619a-f3e1-443e-bff7-e477ad0d1fca ==============================
[0m10:51:43.625048 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:51:43.625288 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'invocation_command': 'dbt run --select passenger_sentiment_airports_top_kpis', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'no_print': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True'}
[0m10:51:44.537581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a88a619a-f3e1-443e-bff7-e477ad0d1fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa0c30>]}
[0m10:51:44.559022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a88a619a-f3e1-443e-bff7-e477ad0d1fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215be360>]}
[0m10:51:44.559392 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:51:44.642294 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:51:44.692602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:44.692820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:44.711715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a88a619a-f3e1-443e-bff7-e477ad0d1fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219deb50>]}
[0m10:51:44.748817 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:51:44.749786 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:51:44.757005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a88a619a-f3e1-443e-bff7-e477ad0d1fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215ce8a0>]}
[0m10:51:44.757192 [info ] [MainThread]: Found 43 models, 26 data tests, 9 sources, 630 macros
[0m10:51:44.757325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88a619a-f3e1-443e-bff7-e477ad0d1fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c4d710>]}
[0m10:51:44.758191 [info ] [MainThread]: 
[0m10:51:44.758328 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:44.758425 [info ] [MainThread]: 
[0m10:51:44.758623 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:51:44.758983 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m10:51:44.759147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:45.089466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m10:51:45.090027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:45.369875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m10:51:45.372846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:45.633508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m10:51:45.635024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:45.931945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m10:51:45.935748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:46.197927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88a619a-f3e1-443e-bff7-e477ad0d1fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e493d0>]}
[0m10:51:46.198710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:46.203685 [debug] [Thread-1 (]: Began running node model.air_travel.passenger_sentiment_airports_top_kpis
[0m10:51:46.204339 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_mrt.passenger_sentiment_airports_top_kpis  [RUN]
[0m10:51:46.204732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.passenger_sentiment_airports_top_kpis)
[0m10:51:46.205017 [debug] [Thread-1 (]: Began compiling node model.air_travel.passenger_sentiment_airports_top_kpis
[0m10:51:46.213585 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.passenger_sentiment_airports_top_kpis"
[0m10:51:46.214270 [debug] [Thread-1 (]: Began executing node model.air_travel.passenger_sentiment_airports_top_kpis
[0m10:51:46.225187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:46.544281 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.passenger_sentiment_airports_top_kpis"
[0m10:51:46.545035 [debug] [Thread-1 (]: On model.air_travel.passenger_sentiment_airports_top_kpis: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.passenger_sentiment_airports_top_kpis"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_mrt`.`passenger_sentiment_airports_top_kpis`
      
    
    

    
    OPTIONS()
    as (
      with passenger_sentiment_airports_top_kpis as (
  select r.sub_category, a.icao, a.name as airport, a.city, 
    a.state_prov, c.name as country, r.sentiment, count(*) as count
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review` r
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a on r.airport_icao = a.icao
  join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c on a.country_code = c.iso_code
  where r.sub_category in ('Wayfinding & Information', 'Airport Staff',
    'Amenities & Facilities', 'Boarding Process', 'Security Screening',
    'Food, Beverage & Retail')
  group by r.sub_category, a.icao, a.name, a.city, a.state_prov, c.name, r.sentiment
  order by r.sub_category, count(*) desc, a.name
)

select *
from passenger_sentiment_airports_top_kpis
    );
  
[0m10:51:47.153423 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7c17eba7-65be-4d98-ab7d-20222a16119c&page=queryresults
[0m10:51:49.169360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a88a619a-f3e1-443e-bff7-e477ad0d1fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121db9190>]}
[0m10:51:49.169878 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_mrt.passenger_sentiment_airports_top_kpis  [[32mCREATE TABLE (570.0 rows, 343.9 KiB processed)[0m in 2.96s]
[0m10:51:49.170260 [debug] [Thread-1 (]: Finished running node model.air_travel.passenger_sentiment_airports_top_kpis
[0m10:51:49.171067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:49.172176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:49.172386 [debug] [MainThread]: Connection 'model.air_travel.passenger_sentiment_airports_top_kpis' was properly closed.
[0m10:51:49.172563 [info ] [MainThread]: 
[0m10:51:49.172748 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m10:51:49.173117 [debug] [MainThread]: Command end result
[0m10:51:49.195258 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:51:49.196350 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:51:49.199099 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:51:49.199241 [info ] [MainThread]: 
[0m10:51:49.199404 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:51:49.199522 [info ] [MainThread]: 
[0m10:51:49.199678 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:51:49.201807 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.601709, "process_in_blocks": "0", "process_kernel_time": 0.257713, "process_mem_max_rss": "389038080", "process_out_blocks": "0", "process_user_time": 1.837759}
[0m10:51:49.202028 [debug] [MainThread]: Command `dbt run` succeeded at 10:51:49.201990 after 5.60 seconds
[0m10:51:49.202197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121dee0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121662490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa3d810>]}
[0m10:51:49.202353 [debug] [MainThread]: Flushing usage events
[0m10:51:49.386657 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:25.214056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff3750>]}


============================== 10:52:25.215676 | 4b7de827-05cb-4975-8930-2848669e4365 ==============================
[0m10:52:25.215676 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:52:25.215918 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Review.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'debug': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'write_json': 'True', 'partial_parse': 'True', 'empty': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'introspect': 'True'}
[0m10:52:26.039785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b7de827-05cb-4975-8930-2848669e4365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34cc30>]}
[0m10:52:26.059162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b7de827-05cb-4975-8930-2848669e4365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ec2360>]}
[0m10:52:26.059379 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:52:26.134432 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:52:26.179869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:52:26.180195 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m10:52:26.259560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b7de827-05cb-4975-8930-2848669e4365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212dfd50>]}
[0m10:52:26.294449 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:52:26.295243 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:52:26.305411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b7de827-05cb-4975-8930-2848669e4365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12162f6b0>]}
[0m10:52:26.305599 [info ] [MainThread]: Found 43 models, 28 data tests, 9 sources, 630 macros
[0m10:52:26.305720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b7de827-05cb-4975-8930-2848669e4365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121041a90>]}
[0m10:52:26.315664 [info ] [MainThread]: 
[0m10:52:26.315819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:52:26.315922 [info ] [MainThread]: 
[0m10:52:26.316118 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:52:26.318347 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m10:52:26.318526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:26.586205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m10:52:26.588027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:26.832566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m10:52:26.833419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:27.100288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m10:52:27.103860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:27.393393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b7de827-05cb-4975-8930-2848669e4365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121863ee0>]}
[0m10:52:27.394213 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:52:27.398752 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m10:52:27.399323 [info ] [Thread-1 (]: 1 of 19 START test dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name  [RUN]
[0m10:52:27.399782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd)
[0m10:52:27.400097 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m10:52:27.414827 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m10:52:27.415466 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m10:52:27.427989 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m10:52:27.428435 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        icao, iata, name
    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
    group by icao, iata, name
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:52:27.428677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:28.012519 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3ea473f4-180d-4ee2-a2d8-9c93d8cba7b6&page=queryresults
[0m10:52:28.542377 [info ] [Thread-1 (]: 1 of 19 PASS dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name . [[32mPASS[0m in 1.14s]
[0m10:52:28.543054 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m10:52:28.543335 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m10:52:28.543648 [info ] [Thread-1 (]: 2 of 19 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m10:52:28.544009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m10:52:28.544262 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m10:52:28.548560 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m10:52:28.549080 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m10:52:28.550874 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m10:52:28.551410 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airport_icao, terminal, business, location
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    group by airport_icao, terminal, business, location
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:52:28.551685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:28.932435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a26ef947-15a7-4ae6-a28f-8296ad654cbf&page=queryresults
[0m10:52:29.338124 [info ] [Thread-1 (]: 2 of 19 PASS dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[32mPASS[0m in 0.79s]
[0m10:52:29.339317 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m10:52:29.339745 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m10:52:29.340223 [info ] [Thread-1 (]: 3 of 19 START test dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [RUN]
[0m10:52:29.340785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m10:52:29.341174 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m10:52:29.346065 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m10:52:29.346880 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m10:52:29.349058 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m10:52:29.349578 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_month, airline_id, airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    group by event_month, airline_id, airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:52:29.349881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:30.162370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:45865f01-0985-42a4-adf7-13901fd74227&page=queryresults
[0m10:52:30.552177 [info ] [Thread-1 (]: 3 of 19 PASS dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [[32mPASS[0m in 1.21s]
[0m10:52:30.553217 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m10:52:30.553726 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m10:52:30.554370 [info ] [Thread-1 (]: 4 of 19 START test dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [RUN]
[0m10:52:30.555056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m10:52:30.555454 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m10:52:30.560835 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m10:52:30.561748 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m10:52:30.564125 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m10:52:30.564633 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    group by airline_id, source_airport_icao, dest_airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:52:30.564931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:31.083881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1af842a2-d2ec-4520-93d3-f3a707a35c63&page=queryresults
[0m10:52:31.480879 [info ] [Thread-1 (]: 4 of 19 PASS dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [[32mPASS[0m in 0.93s]
[0m10:52:31.482082 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m10:52:31.482717 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m10:52:31.483193 [info ] [Thread-1 (]: 5 of 19 START test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [RUN]
[0m10:52:31.483756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965)
[0m10:52:31.484135 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m10:52:31.488898 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m10:52:31.489793 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m10:52:31.492091 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m10:52:31.492642 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        business, menu_item
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    group by business, menu_item
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:52:31.492966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:32.005874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:800c3d61-423b-4f6b-8042-5d57985a9129&page=queryresults
[0m10:52:32.410566 [info ] [Thread-1 (]: 5 of 19 PASS dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [[32mPASS[0m in 0.93s]
[0m10:52:32.411606 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m10:52:32.412105 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m10:52:32.412593 [info ] [Thread-1 (]: 6 of 19 START test dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [RUN]
[0m10:52:32.413110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m10:52:32.413468 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m10:52:32.418823 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m10:52:32.419812 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m10:52:32.422224 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m10:52:32.422881 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:52:32.423231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:32.926845 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7ec338ee-3f0d-4b12-b720-f609b87e653a&page=queryresults
[0m10:52:33.304003 [info ] [Thread-1 (]: 6 of 19 PASS dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [[32mPASS[0m in 0.89s]
[0m10:52:33.304991 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m10:52:33.305492 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m10:52:33.306375 [info ] [Thread-1 (]: 7 of 19 START test dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [RUN]
[0m10:52:33.306966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m10:52:33.307359 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m10:52:33.313143 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m10:52:33.314018 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m10:52:33.316283 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m10:52:33.316768 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_date, event_hour, airport_icao, security_checkpoint
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    group by event_date, event_hour, airport_icao, security_checkpoint
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m10:52:33.317059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:33.677897 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5a26a057-c98e-4ff7-8dcf-fedeba28df9c&page=queryresults
[0m10:52:34.130807 [info ] [Thread-1 (]: 7 of 19 PASS dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [[32mPASS[0m in 0.82s]
[0m10:52:34.131745 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m10:52:34.132198 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m10:52:34.132642 [info ] [Thread-1 (]: 8 of 19 START test not_null_Airline_id ......................................... [RUN]
[0m10:52:34.133116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m10:52:34.133449 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m10:52:34.140226 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m10:52:34.141202 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m10:52:34.143475 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m10:52:34.144296 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m10:52:34.144586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:34.873972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c1b0b2a0-4524-4af6-982c-569273783653&page=queryresults
[0m10:52:35.308665 [info ] [Thread-1 (]: 8 of 19 PASS not_null_Airline_id ............................................... [[32mPASS[0m in 1.18s]
[0m10:52:35.309685 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m10:52:35.310146 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m10:52:35.310590 [info ] [Thread-1 (]: 9 of 19 START test not_null_Airport_Establishment_business ..................... [RUN]
[0m10:52:35.311095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_Establishment_business.fa42968b3c)
[0m10:52:35.311457 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m10:52:35.316015 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m10:52:35.317028 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m10:52:35.319403 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m10:52:35.319976 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Establishment_business.fa42968b3c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select business
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
where business is null



  
  
      
    ) dbt_internal_test
[0m10:52:35.320331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:35.721046 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c2b94c8c-e695-4af6-a0b9-50eb29ea3408&page=queryresults
[0m10:52:36.177458 [info ] [Thread-1 (]: 9 of 19 PASS not_null_Airport_Establishment_business ........................... [[32mPASS[0m in 0.87s]
[0m10:52:36.178478 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m10:52:36.178908 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m10:52:36.179321 [info ] [Thread-1 (]: 10 of 19 START test not_null_Airport_Review_id ................................. [RUN]
[0m10:52:36.179847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Establishment_business.fa42968b3c, now test.air_travel.not_null_Airport_Review_id.715ca7a304)
[0m10:52:36.180196 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m10:52:36.184679 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m10:52:36.185815 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m10:52:36.188234 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m10:52:36.188863 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Review_id.715ca7a304: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Review_id.715ca7a304"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
where id is null



  
  
      
    ) dbt_internal_test
[0m10:52:36.189191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:36.818474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e97f9862-bcd9-4e77-b86c-d562a29873bf&page=queryresults
[0m10:52:37.189000 [info ] [Thread-1 (]: 10 of 19 PASS not_null_Airport_Review_id ....................................... [[32mPASS[0m in 1.01s]
[0m10:52:37.190034 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m10:52:37.190500 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m10:52:37.190952 [info ] [Thread-1 (]: 11 of 19 START test not_null_Airport_icao ...................................... [RUN]
[0m10:52:37.191464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Review_id.715ca7a304, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m10:52:37.191805 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m10:52:37.196750 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m10:52:37.197795 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m10:52:37.200364 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m10:52:37.201146 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m10:52:37.201495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:37.637481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7afbafa8-8719-4143-aef3-41080723cedb&page=queryresults
[0m10:52:38.012384 [info ] [Thread-1 (]: 11 of 19 PASS not_null_Airport_icao ............................................ [[32mPASS[0m in 0.82s]
[0m10:52:38.013604 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m10:52:38.014049 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m10:52:38.014513 [info ] [Thread-1 (]: 12 of 19 START test not_null_Country_iso_code .................................. [RUN]
[0m10:52:38.015062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m10:52:38.015437 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m10:52:38.019260 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m10:52:38.020065 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m10:52:38.024921 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m10:52:38.025641 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m10:52:38.025965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:38.457296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:deeeaa32-ab40-4572-9104-2190aee50b4d&page=queryresults
[0m10:52:38.821366 [info ] [Thread-1 (]: 12 of 19 PASS not_null_Country_iso_code ........................................ [[32mPASS[0m in 0.81s]
[0m10:52:38.822374 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m10:52:38.822861 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m10:52:38.823481 [info ] [Thread-1 (]: 13 of 19 START test relationships_Airline_country_code__iso_code__ref_Country_ . [RUN]
[0m10:52:38.824296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26)
[0m10:52:38.824708 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m10:52:38.833107 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m10:52:38.833912 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m10:52:38.835506 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m10:52:38.836023 [debug] [Thread-1 (]: On test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m10:52:38.836320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:39.275558 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b913a5f3-d04f-42b3-b35a-ac588705709a&page=queryresults
[0m10:52:39.689074 [info ] [Thread-1 (]: 13 of 19 PASS relationships_Airline_country_code__iso_code__ref_Country_ ....... [[32mPASS[0m in 0.86s]
[0m10:52:39.690170 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m10:52:39.690648 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m10:52:39.691079 [info ] [Thread-1 (]: 14 of 19 START test relationships_Airport_country_code__iso_code__ref_Country_ . [RUN]
[0m10:52:39.691574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26, now test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0)
[0m10:52:39.691950 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m10:52:39.698000 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m10:52:39.699066 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m10:52:39.700928 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m10:52:39.701545 [debug] [Thread-1 (]: On test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m10:52:39.701907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:40.122564 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9978a693-becb-4980-b5a8-6a82a2050266&page=queryresults
[0m10:52:40.496215 [error] [Thread-1 (]: 14 of 19 FAIL 5 relationships_Airport_country_code__iso_code__ref_Country_ ..... [[31mFAIL 5[0m in 0.80s]
[0m10:52:40.497409 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m10:52:40.497841 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m10:52:40.498294 [info ] [Thread-1 (]: 15 of 19 START test unique_Airline_id .......................................... [RUN]
[0m10:52:40.498862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0, now test.air_travel.unique_Airline_id.cb196c2622)
[0m10:52:40.499240 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m10:52:40.505544 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m10:52:40.506363 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m10:52:40.507882 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m10:52:40.508405 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:52:40.508700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:41.017147 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a39f6fad-3a99-4bd3-bd52-afb78a0eb7e8&page=queryresults
[0m10:52:41.633584 [info ] [Thread-1 (]: 15 of 19 PASS unique_Airline_id ................................................ [[32mPASS[0m in 1.13s]
[0m10:52:41.634625 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m10:52:41.635098 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m10:52:41.635542 [info ] [Thread-1 (]: 16 of 19 START test unique_Airport_Establishment_business ...................... [RUN]
[0m10:52:41.636045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_Establishment_business.c0ba13e1af)
[0m10:52:41.636397 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m10:52:41.641794 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m10:52:41.642804 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m10:52:41.644672 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m10:52:41.645257 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Establishment_business.c0ba13e1af: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select business as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
  where business is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:52:41.645589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:42.142900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3c31fdec-22eb-4499-8a40-6f4c5f38b0be&page=queryresults
[0m10:52:42.502628 [info ] [Thread-1 (]: 16 of 19 PASS unique_Airport_Establishment_business ............................ [[32mPASS[0m in 0.87s]
[0m10:52:42.503610 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m10:52:42.504055 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m10:52:42.504487 [info ] [Thread-1 (]: 17 of 19 START test unique_Airport_Review_id ................................... [RUN]
[0m10:52:42.504989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Establishment_business.c0ba13e1af, now test.air_travel.unique_Airport_Review_id.690fe37ba9)
[0m10:52:42.505561 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m10:52:42.510729 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m10:52:42.511684 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m10:52:42.513574 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m10:52:42.514221 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Review_id.690fe37ba9: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Review_id.690fe37ba9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:52:42.514570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:43.167688 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:17784b4c-436c-49ea-9400-fc1615ad926f&page=queryresults
[0m10:52:43.558743 [info ] [Thread-1 (]: 17 of 19 PASS unique_Airport_Review_id ......................................... [[32mPASS[0m in 1.05s]
[0m10:52:43.559786 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m10:52:43.560266 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m10:52:43.560731 [info ] [Thread-1 (]: 18 of 19 START test unique_Airport_icao ........................................ [RUN]
[0m10:52:43.561251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Review_id.690fe37ba9, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m10:52:43.561613 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m10:52:43.566871 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m10:52:43.567878 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m10:52:43.569667 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m10:52:43.570553 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:52:43.570890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:44.132576 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:bff2af32-84b8-40f6-9223-8e3f44730586&page=queryresults
[0m10:52:44.499557 [info ] [Thread-1 (]: 18 of 19 PASS unique_Airport_icao .............................................. [[32mPASS[0m in 0.94s]
[0m10:52:44.499982 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m10:52:44.500186 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m10:52:44.500415 [info ] [Thread-1 (]: 19 of 19 START test unique_Country_iso_code .................................... [RUN]
[0m10:52:44.500700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m10:52:44.500902 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m10:52:44.503010 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m10:52:44.503453 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m10:52:44.504818 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m10:52:44.505130 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:52:44.505315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:44.909020 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6d245d2e-6326-4c4d-ac23-4d0e6dbc22e1&page=queryresults
[0m10:52:45.287442 [info ] [Thread-1 (]: 19 of 19 PASS unique_Country_iso_code .......................................... [[32mPASS[0m in 0.79s]
[0m10:52:45.288452 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m10:52:45.290060 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:52:45.292417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:45.292954 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m10:52:45.293297 [info ] [MainThread]: 
[0m10:52:45.293608 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 18.98 seconds (18.98s).
[0m10:52:45.296512 [debug] [MainThread]: Command end result
[0m10:52:45.325925 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m10:52:45.327083 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m10:52:45.330645 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m10:52:45.330788 [info ] [MainThread]: 
[0m10:52:45.330949 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:52:45.331081 [info ] [MainThread]: 
[0m10:52:45.331251 [error] [MainThread]: [31mFailure in test relationships_Airport_country_code__iso_code__ref_Country_ (models/int/schema.yml)[0m
[0m10:52:45.331405 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m10:52:45.331522 [info ] [MainThread]: 
[0m10:52:45.331660 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/schema.yml/relationships_Airport_country_code__iso_code__ref_Country_.sql
[0m10:52:45.331779 [info ] [MainThread]: 
[0m10:52:45.331921 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=19
[0m10:52:45.334218 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 20.144423, "process_in_blocks": "0", "process_kernel_time": 0.308971, "process_mem_max_rss": "394330112", "process_out_blocks": "0", "process_user_time": 3.114804}
[0m10:52:45.334422 [debug] [MainThread]: Command `dbt test` failed at 10:52:45.334381 after 20.14 seconds
[0m10:52:45.334602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aef8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12188f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218a3330>]}
[0m10:52:45.334762 [debug] [MainThread]: Flushing usage events
[0m10:52:45.528655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:58:50.146379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab386e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9839d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b983750>]}


============================== 10:58:50.147991 | d3f15c2f-fa15-4a0d-a6c4-08e52e6f13a6 ==============================
[0m10:58:50.147991 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:58:50.148232 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'empty': 'None', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'no_print': 'None', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt test --select tmp_airport_terminal_mentioned_food_keywords', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error': 'None', 'debug': 'False', 'target_path': 'None'}
[0m10:58:50.970433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3f15c2f-fa15-4a0d-a6c4-08e52e6f13a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acdcc30>]}
[0m10:58:50.989810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3f15c2f-fa15-4a0d-a6c4-08e52e6f13a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219be360>]}
[0m10:58:50.990013 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:58:51.066271 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:58:51.113377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:58:51.113622 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_terminal_food_keywords_category.sql
[0m10:58:51.113732 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_terminal_mentioned_food_keywords.sql
[0m10:58:51.172952 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.tmp_airport_terminal_food_keywords_category' (models/tmp/tmp_airport_terminal_food_keywords_category.sql) depends on a node named 'airport_terminal_mentioned_food_keywords' which was not found
[0m10:58:51.174714 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.0516171, "process_in_blocks": "0", "process_kernel_time": 0.220374, "process_mem_max_rss": "380469248", "process_out_blocks": "0", "process_user_time": 1.329544}
[0m10:58:51.174931 [debug] [MainThread]: Command `dbt test` failed at 10:58:51.174890 after 1.05 seconds
[0m10:58:51.175074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12196a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ddee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12211a4e0>]}
[0m10:58:51.175201 [debug] [MainThread]: Flushing usage events
[0m10:58:51.403264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:59:52.313180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b206e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996b750>]}


============================== 10:59:52.314850 | 53cf3be0-1d0b-4e4d-a2bf-e4ee39c18eb3 ==============================
[0m10:59:52.314850 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m10:59:52.315089 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'quiet': 'False', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt test --select tmp_airport_terminal_mentioned_food_keywords', 'partial_parse': 'True'}
[0m10:59:53.132276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53cf3be0-1d0b-4e4d-a2bf-e4ee39c18eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc4c30>]}
[0m10:59:53.151967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53cf3be0-1d0b-4e4d-a2bf-e4ee39c18eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8c2360>]}
[0m10:59:53.152178 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m10:59:53.229251 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m10:59:53.274884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:59:53.275130 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_terminal_food_keywords_category.sql
[0m10:59:53.275242 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_terminal_mentioned_food_keywords.sql
[0m10:59:53.334783 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.air_travel.tmp_airport_terminal_food_keywords_category' (models/tmp/tmp_airport_terminal_food_keywords_category.sql) depends on a node named 'airport_terminal_mentioned_food_keywords' which was not found
[0m10:59:53.336588 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.0466535, "process_in_blocks": "0", "process_kernel_time": 0.199198, "process_mem_max_rss": "384499712", "process_out_blocks": "0", "process_user_time": 1.336892}
[0m10:59:53.336808 [debug] [MainThread]: Command `dbt test` failed at 10:59:53.336769 after 1.05 seconds
[0m10:59:53.336949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f86e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcdee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12001e4e0>]}
[0m10:59:53.337081 [debug] [MainThread]: Flushing usage events
[0m10:59:53.541770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:42.015873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1406e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af8b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af8b750>]}


============================== 11:01:42.017484 | c0c3d8bd-4f1f-45f3-9a2e-aad0ef7bc230 ==============================
[0m11:01:42.017484 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:01:42.017719 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'empty': 'None', 'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'partial_parse': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tmp_airport_terminal_mentioned_food_keywords', 'log_cache_events': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False'}
[0m11:01:42.843522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0c3d8bd-4f1f-45f3-9a2e-aad0ef7bc230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e4c30>]}
[0m11:01:42.862921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0c3d8bd-4f1f-45f3-9a2e-aad0ef7bc230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fbe360>]}
[0m11:01:42.863128 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:01:42.938879 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:01:42.985651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m11:01:42.985887 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_terminal_food_keywords_category.sql
[0m11:01:42.986004 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_terminal_mentioned_food_keywords.sql
[0m11:01:43.072027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0c3d8bd-4f1f-45f3-9a2e-aad0ef7bc230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213da750>]}
[0m11:01:43.107372 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:01:43.108217 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:01:43.118375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0c3d8bd-4f1f-45f3-9a2e-aad0ef7bc230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12189b890>]}
[0m11:01:43.118551 [info ] [MainThread]: Found 45 models, 28 data tests, 9 sources, 630 macros
[0m11:01:43.118678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0c3d8bd-4f1f-45f3-9a2e-aad0ef7bc230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12194cd70>]}
[0m11:01:43.119451 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:01:43.119654 [debug] [MainThread]: Command end result
[0m11:01:43.216377 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:01:43.217183 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:01:43.218391 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:01:43.220089 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.227371, "process_in_blocks": "0", "process_kernel_time": 0.227652, "process_mem_max_rss": "384565248", "process_out_blocks": "0", "process_user_time": 1.494214}
[0m11:01:43.220283 [debug] [MainThread]: Command `dbt test` succeeded at 11:01:43.220250 after 1.23 seconds
[0m11:01:43.220405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae6dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae94a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12189f950>]}
[0m11:01:43.220521 [debug] [MainThread]: Flushing usage events
[0m11:01:43.420217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:57.715592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1046e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df4f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df4f750>]}


============================== 11:01:57.717183 | cb82459e-6f16-4034-a957-79f4328dd5e1 ==============================
[0m11:01:57.717183 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:01:57.717423 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'version_check': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --select tmp_airport_terminal_mentioned_food_keywords', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'log_format': 'default', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'introspect': 'True'}
[0m11:01:58.552291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb82459e-6f16-4034-a957-79f4328dd5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2a8c30>]}
[0m11:01:58.571630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb82459e-6f16-4034-a957-79f4328dd5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ebe360>]}
[0m11:01:58.571828 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:01:58.647821 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:01:58.693548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:01:58.693689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:01:58.711310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb82459e-6f16-4034-a957-79f4328dd5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1242dab50>]}
[0m11:01:58.746147 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:01:58.746986 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:01:58.753637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb82459e-6f16-4034-a957-79f4328dd5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ece8a0>]}
[0m11:01:58.753806 [info ] [MainThread]: Found 45 models, 28 data tests, 9 sources, 630 macros
[0m11:01:58.753940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb82459e-6f16-4034-a957-79f4328dd5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124562270>]}
[0m11:01:58.754749 [info ] [MainThread]: 
[0m11:01:58.754873 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:58.754972 [info ] [MainThread]: 
[0m11:01:58.755156 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:01:58.755462 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:01:58.755619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:59.125623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:01:59.126269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:59.517318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:01:59.520280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:59.846267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:01:59.848592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:00.235103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m11:02:00.237194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:00.645822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb82459e-6f16-4034-a957-79f4328dd5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124751570>]}
[0m11:02:00.646849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:00.653466 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m11:02:00.654041 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_terminal_mentioned_food_keywords  [RUN]
[0m11:02:00.654452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now model.air_travel.tmp_airport_terminal_mentioned_food_keywords)
[0m11:02:00.654757 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m11:02:00.662369 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_terminal_mentioned_food_keywords"
[0m11:02:00.663180 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m11:02:00.687313 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_terminal_mentioned_food_keywords"
[0m11:02:00.687877 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_terminal_mentioned_food_keywords: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_terminal_mentioned_food_keywords"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_terminal_mentioned_food_keywords`
      
    
    

    
    OPTIONS()
    as (
      with tmp_airport_terminal_mentioned_food_keywords as (
  select id as review_id, concat(review_subject, ':', review_details) as review_content,
  AI.GENERATE(
    ('If this review mentions food, what food keywords does it mention?',
      concat(review_subject, ':', review_details), '. Return your answer as a comma-separated list of keywords. If the review does not mention food, return None.'),
    connection_id => 'us-central1.vertex-ai-connection',
    endpoint => 'gemini-2.5-flash-lite',
    model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
    output_schema => 'keywords STRING') as llm_response
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
  where sentiment != 'Negative'
)

select review_id, review_content, llm_response.keywords as keywords
from tmp_airport_terminal_mentioned_food_keywords
    );
  
[0m11:02:00.688104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:01.456310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:db043fd2-0ef5-439f-914e-b3b7c41e1a1f&page=queryresults
[0m11:11:52.109358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb82459e-6f16-4034-a957-79f4328dd5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246c9490>]}
[0m11:11:52.110058 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_terminal_mentioned_food_keywords  [[32mCREATE TABLE (3.1k rows, 993.8 KiB processed)[0m in 591.45s]
[0m11:11:52.110528 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m11:11:52.111553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:52.112889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:52.113094 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_terminal_mentioned_food_keywords' was properly closed.
[0m11:11:52.113282 [info ] [MainThread]: 
[0m11:11:52.113480 [info ] [MainThread]: Finished running 1 table model in 0 hours 9 minutes and 53.36 seconds (593.36s).
[0m11:11:52.113902 [debug] [MainThread]: Command end result
[0m11:11:52.138610 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:11:52.139703 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:11:52.142842 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:11:52.143029 [info ] [MainThread]: 
[0m11:11:52.143214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:52.143341 [info ] [MainThread]: 
[0m11:11:52.143482 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:11:52.145818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 594.45795, "process_in_blocks": "0", "process_kernel_time": 0.290634, "process_mem_max_rss": "389103616", "process_out_blocks": "0", "process_user_time": 2.144481}
[0m11:11:52.146069 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:52.146024 after 594.46 seconds
[0m11:11:52.146247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246fa4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d241810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d243f70>]}
[0m11:11:52.146418 [debug] [MainThread]: Flushing usage events
[0m11:11:52.356035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:13:53.473945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb686e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9b39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9b3750>]}


============================== 11:13:53.475556 | a10ae68c-2bb1-41be-926d-5e303df6ab8c ==============================
[0m11:13:53.475556 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:13:53.475782 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'empty': 'False', 'static_parser': 'True', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt run --select aircraft_flight_delays', 'printer_width': '80', 'version_check': 'True', 'log_format': 'default'}
[0m11:13:54.328498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a10ae68c-2bb1-41be-926d-5e303df6ab8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd0cc30>]}
[0m11:13:54.348838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a10ae68c-2bb1-41be-926d-5e303df6ab8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239c2360>]}
[0m11:13:54.349091 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:13:54.427697 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:13:54.478718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m11:13:54.479016 [debug] [MainThread]: Partial parsing: added file: air_travel://models/mrt/food_category_comparison.sql
[0m11:13:54.479134 [debug] [MainThread]: Partial parsing: added file: air_travel://models/mrt/aircraft_flight_delays.sql
[0m11:13:54.479232 [debug] [MainThread]: Partial parsing: added file: air_travel://models/mrt/carrier_flight_delays.sql
[0m11:13:54.479357 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_terminal_food_keywords_category.sql
[0m11:13:54.572323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a10ae68c-2bb1-41be-926d-5e303df6ab8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123dda850>]}
[0m11:13:54.609468 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:13:54.610325 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:13:54.617609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a10ae68c-2bb1-41be-926d-5e303df6ab8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ec72f0>]}
[0m11:13:54.617786 [info ] [MainThread]: Found 48 models, 28 data tests, 9 sources, 630 macros
[0m11:13:54.617917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a10ae68c-2bb1-41be-926d-5e303df6ab8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a87310>]}
[0m11:13:54.618743 [info ] [MainThread]: 
[0m11:13:54.618874 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:54.618968 [info ] [MainThread]: 
[0m11:13:54.619153 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:13:54.619508 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:13:54.619693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:54.992403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:13:54.992738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:55.301158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:13:55.304710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:55.567559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:13:55.569930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:55.832225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m11:13:55.832974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:56.134505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a10ae68c-2bb1-41be-926d-5e303df6ab8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1242d3860>]}
[0m11:13:56.135306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:13:56.140210 [debug] [Thread-1 (]: Began running node model.air_travel.aircraft_flight_delays
[0m11:13:56.140847 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_mrt.aircraft_flight_delays ......... [RUN]
[0m11:13:56.141246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now model.air_travel.aircraft_flight_delays)
[0m11:13:56.141550 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircraft_flight_delays
[0m11:13:56.147169 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircraft_flight_delays"
[0m11:13:56.147776 [debug] [Thread-1 (]: Began executing node model.air_travel.aircraft_flight_delays
[0m11:13:56.172265 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.aircraft_flight_delays"
[0m11:13:56.172939 [debug] [Thread-1 (]: On model.air_travel.aircraft_flight_delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.aircraft_flight_delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_mrt`.`aircraft_flight_delays`
      
    
    

    
    OPTIONS()
    as (
      with delayed_flights as (
    select ac.name as aircraft, ac.icao as aircraft_code, 
        count(*) aircraft_delay_flights
    from air_travel_int.Flight_Delays fd
    join air_travel_int.Airline al
        on fd.airline_id = al.id
    join air_travel_int.Airport ap
        on fd.airport_icao = ap.icao
    join air_travel_int.Route_Equipment re
        on al.id = re.airline_id and ap.icao = re.dest_airport_icao
    join air_travel_int.Aircraft ac
        on re.icao_equipment = ac.icao
    where carrier_delay_min > 0
    and weather_delay_min = 0
    group by ac.name, ac.icao
    order by ac.name
),
total_flights as (
    select ac.name as aircraft, ac.icao as aircraft_code, count(*) aircraft_total_flights
    from air_travel_int.Flight_Delays fd
    join air_travel_int.Airline al
    on fd.airline_id = al.id
    join air_travel_int.Airport ap
    on fd.airport_icao = ap.icao
    join air_travel_int.Route_Equipment re
    on al.id = re.airline_id and ap.icao = re.dest_airport_icao
    join air_travel_int.Aircraft ac
    on re.icao_equipment = ac.icao
    group by ac.name, ac.icao
    order by ac.name
)

select aircraft, aircraft_code, aircraft_delay_flights, aircraft_total_flights, round(aircraft_delay_flights / aircraft_total_flights * 100) as aircraft_delay_rate
from delayed_flights
join total_flights
using (aircraft, aircraft_code)
order by aircraft_delay_rate desc
    );
  
[0m11:13:56.173201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:56.747211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:102752ee-40a3-4779-baa5-36cfb7de1298&page=queryresults
[0m11:13:59.270197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10ae68c-2bb1-41be-926d-5e303df6ab8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243b1b50>]}
[0m11:13:59.270882 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_mrt.aircraft_flight_delays .... [[32mCREATE TABLE (17.0 rows, 3.4 MiB processed)[0m in 3.13s]
[0m11:13:59.271358 [debug] [Thread-1 (]: Finished running node model.air_travel.aircraft_flight_delays
[0m11:13:59.272408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:13:59.273698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:59.273891 [debug] [MainThread]: Connection 'model.air_travel.aircraft_flight_delays' was properly closed.
[0m11:13:59.274088 [info ] [MainThread]: 
[0m11:13:59.274298 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m11:13:59.274714 [debug] [MainThread]: Command end result
[0m11:13:59.375202 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:13:59.376033 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:13:59.378105 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:13:59.378214 [info ] [MainThread]: 
[0m11:13:59.378411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:59.378533 [info ] [MainThread]: 
[0m11:13:59.378665 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:13:59.380359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.930058, "process_in_blocks": "0", "process_kernel_time": 0.271007, "process_mem_max_rss": "392806400", "process_out_blocks": "0", "process_user_time": 1.903321}
[0m11:13:59.380513 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:59.380484 after 5.93 seconds
[0m11:13:59.380633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123960310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124162d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124162a30>]}
[0m11:13:59.380747 [debug] [MainThread]: Flushing usage events
[0m11:13:59.576530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:14:10.762373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9f06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d83b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d83b750>]}


============================== 11:14:10.763965 | 251bea05-5be4-4863-bed8-5107939aecb3 ==============================
[0m11:14:10.763965 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:14:10.764207 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'profiles_dir': '/Users/scohen/.dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'fail_fast': 'False', 'introspect': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --select carrier_flight_delays', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'target_path': 'None'}
[0m11:14:11.610839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '251bea05-5be4-4863-bed8-5107939aecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb94c30>]}
[0m11:14:11.630922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '251bea05-5be4-4863-bed8-5107939aecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237c2360>]}
[0m11:14:11.631159 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:14:11.711731 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:14:11.761640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:11.761837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:11.778700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '251bea05-5be4-4863-bed8-5107939aecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bdeb50>]}
[0m11:14:11.814210 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:14:11.815026 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:14:11.822514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '251bea05-5be4-4863-bed8-5107939aecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237ce8a0>]}
[0m11:14:11.822705 [info ] [MainThread]: Found 48 models, 28 data tests, 9 sources, 630 macros
[0m11:14:11.822839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '251bea05-5be4-4863-bed8-5107939aecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e66350>]}
[0m11:14:11.823709 [info ] [MainThread]: 
[0m11:14:11.823844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:11.823939 [info ] [MainThread]: 
[0m11:14:11.824135 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:14:11.824463 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:14:11.824624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:12.204261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:14:12.204826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:12.485674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:14:12.488072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:12.752203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:14:12.753228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:12.994016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m11:14:12.995508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:13.249460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '251bea05-5be4-4863-bed8-5107939aecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124065570>]}
[0m11:14:13.250210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:13.254238 [debug] [Thread-1 (]: Began running node model.air_travel.carrier_flight_delays
[0m11:14:13.254690 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_mrt.carrier_flight_delays .......... [RUN]
[0m11:14:13.255039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now model.air_travel.carrier_flight_delays)
[0m11:14:13.255319 [debug] [Thread-1 (]: Began compiling node model.air_travel.carrier_flight_delays
[0m11:14:13.264189 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.carrier_flight_delays"
[0m11:14:13.264865 [debug] [Thread-1 (]: Began executing node model.air_travel.carrier_flight_delays
[0m11:14:13.287752 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.carrier_flight_delays"
[0m11:14:13.288322 [debug] [Thread-1 (]: On model.air_travel.carrier_flight_delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.carrier_flight_delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_mrt`.`carrier_flight_delays`
      
    
    

    
    OPTIONS()
    as (
      with delayed_flights as (
    select ap.state_prov, ap.icao, ap.name as airport, al.name as airline,
        count(fd.carrier_delay_min) carrier_delay_count
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays` fd
    join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al
        on fd.airline_id = al.id
    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap
        on fd.airport_icao = ap.icao
    where carrier_delay_min > 0
    and weather_delay_min = 0
    group by ap.state_prov, ap.icao, ap.name, al.name
    order by ap.state_prov, al.name
),
all_flights as (
    select ap.state_prov, ap.icao, ap.name as airport, al.name as airline,
        count(*) as total_flights
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays` fd
    join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al
        on fd.airline_id = al.id
    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap
        on fd.airport_icao = ap.icao
    group by ap.state_prov, ap.icao, ap.name, al.name
    order by ap.state_prov, al.name
)

select state_prov, icao, airport, airline, carrier_delay_count, total_flights,
  round(carrier_delay_count / total_flights * 100) as delay_rate_percent
from delayed_flights join all_flights
using (state_prov, icao, airport, airline)
order by delay_rate_percent desc
    );
  
[0m11:14:13.288564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:13.815874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:33b95a8a-b853-4b58-849a-7bbaeb22ab79&page=queryresults
[0m11:14:15.731088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '251bea05-5be4-4863-bed8-5107939aecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123fa9850>]}
[0m11:14:15.731807 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_mrt.carrier_flight_delays ..... [[32mCREATE TABLE (0.0 rows, 145.4 KiB processed)[0m in 2.48s]
[0m11:14:15.732286 [debug] [Thread-1 (]: Finished running node model.air_travel.carrier_flight_delays
[0m11:14:15.733467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:14:15.734711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:15.734886 [debug] [MainThread]: Connection 'model.air_travel.carrier_flight_delays' was properly closed.
[0m11:14:15.735062 [info ] [MainThread]: 
[0m11:14:15.735265 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m11:14:15.735694 [debug] [MainThread]: Command end result
[0m11:14:15.760213 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:14:15.761367 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:14:15.764392 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:14:15.764528 [info ] [MainThread]: 
[0m11:14:15.764696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:15.764819 [info ] [MainThread]: 
[0m11:14:15.764961 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:14:15.767203 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0284243, "process_in_blocks": "0", "process_kernel_time": 0.24564, "process_mem_max_rss": "389726208", "process_out_blocks": "0", "process_user_time": 1.747563}
[0m11:14:15.767411 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:15.767372 after 5.03 seconds
[0m11:14:15.767581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f1e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ffd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb2d810>]}
[0m11:14:15.767736 [debug] [MainThread]: Flushing usage events
[0m11:14:16.002981 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:14:27.894169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c38c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1d79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1d7750>]}


============================== 11:14:27.895776 | cd91cd23-173b-4945-adc6-74c01bc61812 ==============================
[0m11:14:27.895776 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:14:27.896018 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'partial_parse': 'True', 'invocation_command': 'dbt run --select tmp_airport_terminal_food_keywords_category', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True'}
[0m11:14:28.793270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd91cd23-173b-4945-adc6-74c01bc61812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c530c30>]}
[0m11:14:28.813048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd91cd23-173b-4945-adc6-74c01bc61812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231c2360>]}
[0m11:14:28.813286 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:14:28.889477 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:14:28.938731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:28.938910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:28.955574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd91cd23-173b-4945-adc6-74c01bc61812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235deb50>]}
[0m11:14:28.991172 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:14:28.992041 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:14:28.999840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd91cd23-173b-4945-adc6-74c01bc61812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231ce8a0>]}
[0m11:14:29.000017 [info ] [MainThread]: Found 48 models, 28 data tests, 9 sources, 630 macros
[0m11:14:29.000144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd91cd23-173b-4945-adc6-74c01bc61812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123862350>]}
[0m11:14:29.001004 [info ] [MainThread]: 
[0m11:14:29.001127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:29.001217 [info ] [MainThread]: 
[0m11:14:29.001404 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:14:29.001775 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:14:29.001935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:29.401380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:14:29.401731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:29.689831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:14:29.693948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:29.984272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:14:29.986182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:30.249925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m11:14:30.251694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:30.551155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd91cd23-173b-4945-adc6-74c01bc61812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a65bf0>]}
[0m11:14:30.551867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:30.555755 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m11:14:30.556258 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_terminal_food_keywords_category  [RUN]
[0m11:14:30.556625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now model.air_travel.tmp_airport_terminal_food_keywords_category)
[0m11:14:30.557025 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m11:14:30.564578 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_terminal_food_keywords_category"
[0m11:14:30.565218 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m11:14:30.587512 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_terminal_food_keywords_category"
[0m11:14:30.588112 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_terminal_food_keywords_category: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_terminal_food_keywords_category"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_terminal_food_keywords_category`
      
    
    

    
    OPTIONS()
    as (
      with canonical_food_categories as (
    select array_to_string(array_agg(distinct sub_category), ', ') as categories
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
    where dining = True
),
tmp_airport_terminal_food_keywords_category as (
    select review_id, review_content, keywords,
      AI.GENERATE(
        ('Map the food keywords , ', keywords, ' to its best fit category: ', categories,
          'If the keywords are too generic, return None.'),
        connection_id => 'us-central1.vertex-ai-connection',
        endpoint => 'gemini-2.5-flash-lite',
        model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
        output_schema => 'category STRING') as llm_response
     from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_terminal_mentioned_food_keywords`
     cross join canonical_food_categories
     where keywords != 'None'
  )

select review_id, review_content, keywords, llm_response.category as category
from tmp_airport_terminal_food_keywords_category
    );
  
[0m11:14:30.588350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:31.239634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:92cf517d-c902-4109-aac5-262c6ba4d2e2&page=queryresults
[0m11:14:43.291507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd91cd23-173b-4945-adc6-74c01bc61812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239bd6d0>]}
[0m11:14:43.292096 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_terminal_food_keywords_category  [[32mCREATE TABLE (155.0 rows, 716.3 KiB processed)[0m in 12.73s]
[0m11:14:43.292518 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m11:14:43.293495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:14:43.294710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:43.294909 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_terminal_food_keywords_category' was properly closed.
[0m11:14:43.295094 [info ] [MainThread]: 
[0m11:14:43.295292 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.29 seconds (14.29s).
[0m11:14:43.295702 [debug] [MainThread]: Command end result
[0m11:14:43.319608 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:14:43.320662 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:14:43.323457 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:14:43.323587 [info ] [MainThread]: 
[0m11:14:43.323754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:43.323869 [info ] [MainThread]: 
[0m11:14:43.324003 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:14:43.326187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.45557, "process_in_blocks": "0", "process_kernel_time": 0.27884, "process_mem_max_rss": "388890624", "process_out_blocks": "0", "process_user_time": 1.768563}
[0m11:14:43.326387 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:43.326350 after 15.46 seconds
[0m11:14:43.326546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12391e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4c9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4cbf70>]}
[0m11:14:43.326693 [debug] [MainThread]: Flushing usage events
[0m11:14:43.512382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:16:00.091803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3bc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b207750>]}


============================== 11:16:00.093447 | 950b3e42-ec34-4211-940f-5c58e9f9cb1a ==============================
[0m11:16:00.093447 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:16:00.093690 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False', 'introspect': 'True', 'printer_width': '80', 'empty': 'False', 'no_print': 'None', 'partial_parse': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'target_path': 'None', 'invocation_command': 'dbt run --select food_category_comparison', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None'}
[0m11:16:00.922861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '950b3e42-ec34-4211-940f-5c58e9f9cb1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a560c30>]}
[0m11:16:00.942584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '950b3e42-ec34-4211-940f-5c58e9f9cb1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1210c2360>]}
[0m11:16:00.942804 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:16:01.019565 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:16:01.068253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:16:01.068546 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_terminal_food_keywords_category.sql
[0m11:16:01.068686 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_terminal_mentioned_food_keywords.sql
[0m11:16:01.155111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '950b3e42-ec34-4211-940f-5c58e9f9cb1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214dfc50>]}
[0m11:16:01.189796 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:16:01.190631 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:16:01.197556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '950b3e42-ec34-4211-940f-5c58e9f9cb1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215cf2f0>]}
[0m11:16:01.197726 [info ] [MainThread]: Found 48 models, 28 data tests, 9 sources, 630 macros
[0m11:16:01.197854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '950b3e42-ec34-4211-940f-5c58e9f9cb1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121925c50>]}
[0m11:16:01.198724 [info ] [MainThread]: 
[0m11:16:01.198853 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:16:01.198946 [info ] [MainThread]: 
[0m11:16:01.199117 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:16:01.199461 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m11:16:01.199631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:01.534060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:16:01.534599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:01.823537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m11:16:01.826074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:02.098466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:16:02.100053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:02.390461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:16:02.392417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:02.652167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '950b3e42-ec34-4211-940f-5c58e9f9cb1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219bbe10>]}
[0m11:16:02.652466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:16:02.654467 [debug] [Thread-1 (]: Began running node model.air_travel.food_category_comparison
[0m11:16:02.654723 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_mrt.food_category_comparison ....... [RUN]
[0m11:16:02.654930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.food_category_comparison)
[0m11:16:02.655094 [debug] [Thread-1 (]: Began compiling node model.air_travel.food_category_comparison
[0m11:16:02.659096 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.food_category_comparison"
[0m11:16:02.659489 [debug] [Thread-1 (]: Began executing node model.air_travel.food_category_comparison
[0m11:16:02.677155 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.food_category_comparison"
[0m11:16:02.677687 [debug] [Thread-1 (]: On model.air_travel.food_category_comparison: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.food_category_comparison"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_mrt`.`food_category_comparison`
      
    
    

    
    OPTIONS()
    as (
      with lax_categories as (
  select sub_category, count(*) as lax_availability_count
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment` e
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions` c
  on e.business = c.business
  where e.dining = True
  and c.airport_icao = 'KLAX'
  group by sub_category
  order by sub_category
),
reviews_categories as (
  select category, count(*) as num_mentions
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_terminal_food_keywords_category`
  where category != 'None'
  group by category
  order by category
)

select r.category, r.num_mentions, l.lax_availability_count
from reviews_categories r join lax_categories l
on r.category = l.sub_category
order by r.category
    );
  
[0m11:16:02.677883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:03.204360 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:91570abe-f213-4e5c-8334-8a2cbe629ee1&page=queryresults
[0m11:16:05.451985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '950b3e42-ec34-4211-940f-5c58e9f9cb1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121aa5d90>]}
[0m11:16:05.452412 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_mrt.food_category_comparison .. [[32mCREATE TABLE (0.0 rows, 43.0 KiB processed)[0m in 2.80s]
[0m11:16:05.452748 [debug] [Thread-1 (]: Finished running node model.air_travel.food_category_comparison
[0m11:16:05.453487 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:16:05.454423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:05.454582 [debug] [MainThread]: Connection 'model.air_travel.food_category_comparison' was properly closed.
[0m11:16:05.454728 [info ] [MainThread]: 
[0m11:16:05.454891 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m11:16:05.455219 [debug] [MainThread]: Command end result
[0m11:16:05.561504 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:16:05.562341 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:16:05.564442 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:16:05.564545 [info ] [MainThread]: 
[0m11:16:05.564683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:05.564783 [info ] [MainThread]: 
[0m11:16:05.564900 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:16:05.566660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.499593, "process_in_blocks": "0", "process_kernel_time": 0.267473, "process_mem_max_rss": "394018816", "process_out_blocks": "0", "process_user_time": 1.867269}
[0m11:16:05.566815 [debug] [MainThread]: Command `dbt run` succeeded at 11:16:05.566785 after 5.50 seconds
[0m11:16:05.566936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121061020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a6d770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a6c690>]}
[0m11:16:05.567047 [debug] [MainThread]: Flushing usage events
[0m11:16:05.786628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:16:58.414007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2bc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d107750>]}


============================== 11:16:58.415653 | 435384e6-e55b-4383-a80a-5bffed78ff41 ==============================
[0m11:16:58.415653 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:16:58.415899 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'empty': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'fail_fast': 'False', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Review.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'cache_selected_only': 'False', 'introspect': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m11:16:59.237734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '435384e6-e55b-4383-a80a-5bffed78ff41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c460c30>]}
[0m11:16:59.257070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '435384e6-e55b-4383-a80a-5bffed78ff41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230c6360>]}
[0m11:16:59.257272 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:16:59.333445 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:16:59.381695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:16:59.381845 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:16:59.398295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '435384e6-e55b-4383-a80a-5bffed78ff41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234e7950>]}
[0m11:16:59.433709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:16:59.434528 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:16:59.445187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '435384e6-e55b-4383-a80a-5bffed78ff41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123949310>]}
[0m11:16:59.445364 [info ] [MainThread]: Found 48 models, 28 data tests, 9 sources, 630 macros
[0m11:16:59.445501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435384e6-e55b-4383-a80a-5bffed78ff41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12393e270>]}
[0m11:16:59.456106 [info ] [MainThread]: 
[0m11:16:59.456264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:16:59.456369 [info ] [MainThread]: 
[0m11:16:59.456566 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:16:59.458865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_int'
[0m11:16:59.459031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:59.730034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:16:59.732264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:00.011357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:17:00.013248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:00.285743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m11:17:00.288338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:00.560270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435384e6-e55b-4383-a80a-5bffed78ff41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123929d90>]}
[0m11:17:00.561019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:17:00.565636 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:17:00.566185 [info ] [Thread-1 (]: 1 of 19 START test dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name  [RUN]
[0m11:17:00.566650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd)
[0m11:17:00.566983 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:17:00.583419 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m11:17:00.584071 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:17:00.596502 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m11:17:00.596933 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        icao, iata, name
    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
    group by icao, iata, name
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:17:00.597164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:01.155404 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4c9d19c7-aa22-49b6-93ca-844acdac20cb&page=queryresults
[0m11:17:01.779699 [info ] [Thread-1 (]: 1 of 19 PASS dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name . [[32mPASS[0m in 1.21s]
[0m11:17:01.780384 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:17:01.780667 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:17:01.781008 [info ] [Thread-1 (]: 2 of 19 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m11:17:01.781374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m11:17:01.781627 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:17:01.785960 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m11:17:01.786488 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:17:01.788035 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m11:17:01.788438 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airport_icao, terminal, business, location
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    group by airport_icao, terminal, business, location
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:17:01.788770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:02.280790 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f61eed11-f630-488f-95ef-16cc43daaab2&page=queryresults
[0m11:17:02.736701 [info ] [Thread-1 (]: 2 of 19 PASS dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[32mPASS[0m in 0.95s]
[0m11:17:02.737619 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:17:02.738055 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:17:02.738527 [info ] [Thread-1 (]: 3 of 19 START test dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [RUN]
[0m11:17:02.739100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m11:17:02.739489 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:17:02.744476 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m11:17:02.745313 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:17:02.747540 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m11:17:02.748086 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_month, airline_id, airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    group by event_month, airline_id, airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:17:02.748373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:03.305620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0201209c-e98a-438c-9fdc-6e2900a91af3&page=queryresults
[0m11:17:03.679848 [info ] [Thread-1 (]: 3 of 19 PASS dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [[32mPASS[0m in 0.94s]
[0m11:17:03.680800 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:17:03.681259 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:17:03.681711 [info ] [Thread-1 (]: 4 of 19 START test dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [RUN]
[0m11:17:03.682403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m11:17:03.683095 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:17:03.688156 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m11:17:03.688976 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:17:03.691605 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m11:17:03.692306 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    group by airline_id, source_airport_icao, dest_airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:17:03.692628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:04.230331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a65c0f01-a44a-4739-b2da-08644019d2fd&page=queryresults
[0m11:17:04.657452 [info ] [Thread-1 (]: 4 of 19 PASS dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [[32mPASS[0m in 0.97s]
[0m11:17:04.658309 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:17:04.658736 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:17:04.659204 [info ] [Thread-1 (]: 5 of 19 START test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [RUN]
[0m11:17:04.659778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965)
[0m11:17:04.660155 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:17:04.664667 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m11:17:04.665462 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:17:04.667695 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m11:17:04.668207 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        business, menu_item
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    group by business, menu_item
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:17:04.668501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:05.353290 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:86ad309d-8df3-44ca-8a51-cebe3997ecbd&page=queryresults
[0m11:17:05.762791 [info ] [Thread-1 (]: 5 of 19 PASS dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [[32mPASS[0m in 1.10s]
[0m11:17:05.763284 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:17:05.763545 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:17:05.763833 [info ] [Thread-1 (]: 6 of 19 START test dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [RUN]
[0m11:17:05.764159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m11:17:05.764377 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:17:05.767241 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m11:17:05.767739 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:17:05.769259 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m11:17:05.769652 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:17:05.769862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:06.222428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3b4f34df-d88b-4a22-9244-b92c8dd8d6d0&page=queryresults
[0m11:17:06.575269 [info ] [Thread-1 (]: 6 of 19 PASS dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [[32mPASS[0m in 0.81s]
[0m11:17:06.576103 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:17:06.576552 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:17:06.576974 [info ] [Thread-1 (]: 7 of 19 START test dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [RUN]
[0m11:17:06.577492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m11:17:06.577847 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:17:06.584041 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m11:17:06.585027 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:17:06.590234 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m11:17:06.590888 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_date, event_hour, airport_icao, security_checkpoint
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    group by event_date, event_hour, airport_icao, security_checkpoint
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:17:06.591198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:07.094084 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:288aadb6-5c56-47f8-bf82-01cb2ca9f330&page=queryresults
[0m11:17:07.495365 [info ] [Thread-1 (]: 7 of 19 PASS dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [[32mPASS[0m in 0.92s]
[0m11:17:07.496299 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:17:07.496746 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:17:07.497182 [info ] [Thread-1 (]: 8 of 19 START test not_null_Airline_id ......................................... [RUN]
[0m11:17:07.497684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m11:17:07.498025 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:17:07.505565 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:17:07.506566 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:17:07.614326 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:17:07.614820 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m11:17:07.614981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:08.015099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6d4a887b-342c-4571-a95f-f4c61c93f3a1&page=queryresults
[0m11:17:08.376530 [info ] [Thread-1 (]: 8 of 19 PASS not_null_Airline_id ............................................... [[32mPASS[0m in 0.88s]
[0m11:17:08.377484 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:17:08.377933 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:17:08.378368 [info ] [Thread-1 (]: 9 of 19 START test not_null_Airport_Establishment_business ..................... [RUN]
[0m11:17:08.378854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_Establishment_business.fa42968b3c)
[0m11:17:08.379193 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:17:08.383795 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m11:17:08.384772 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:17:08.387145 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m11:17:08.387769 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Establishment_business.fa42968b3c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select business
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
where business is null



  
  
      
    ) dbt_internal_test
[0m11:17:08.388123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:08.833045 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:98b8c655-7307-42f5-b074-8c701bd42dce&page=queryresults
[0m11:17:09.185723 [info ] [Thread-1 (]: 9 of 19 PASS not_null_Airport_Establishment_business ........................... [[32mPASS[0m in 0.81s]
[0m11:17:09.186662 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:17:09.187524 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:17:09.188046 [info ] [Thread-1 (]: 10 of 19 START test not_null_Airport_Review_id ................................. [RUN]
[0m11:17:09.188622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Establishment_business.fa42968b3c, now test.air_travel.not_null_Airport_Review_id.715ca7a304)
[0m11:17:09.188986 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:17:09.192897 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m11:17:09.193726 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:17:09.196042 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m11:17:09.196776 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Review_id.715ca7a304: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Review_id.715ca7a304"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
where id is null



  
  
      
    ) dbt_internal_test
[0m11:17:09.197092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:09.653898 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:71d7d1b5-85fe-45cb-98d9-f834bfd0de37&page=queryresults
[0m11:17:09.999725 [info ] [Thread-1 (]: 10 of 19 PASS not_null_Airport_Review_id ....................................... [[32mPASS[0m in 0.81s]
[0m11:17:10.000762 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:17:10.001127 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:17:10.001528 [info ] [Thread-1 (]: 11 of 19 START test not_null_Airport_icao ...................................... [RUN]
[0m11:17:10.002007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Review_id.715ca7a304, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m11:17:10.002308 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:17:10.005969 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:17:10.006728 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:17:10.008720 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:17:10.009309 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m11:17:10.009602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:10.472340 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8c6e8da3-4b79-4b8e-b0cf-cc422a9d77c1&page=queryresults
[0m11:17:10.819977 [info ] [Thread-1 (]: 11 of 19 PASS not_null_Airport_icao ............................................ [[32mPASS[0m in 0.82s]
[0m11:17:10.820583 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:17:10.820890 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:17:10.821254 [info ] [Thread-1 (]: 12 of 19 START test not_null_Country_iso_code .................................. [RUN]
[0m11:17:10.821689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m11:17:10.821984 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:17:10.825381 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:17:10.825995 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:17:10.827935 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:17:10.828410 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m11:17:10.828687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:11.394580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e59f282a-4ffb-47e5-9596-a7c6a6f9880b&page=queryresults
[0m11:17:11.795981 [info ] [Thread-1 (]: 12 of 19 PASS not_null_Country_iso_code ........................................ [[32mPASS[0m in 0.97s]
[0m11:17:11.796935 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:17:11.797357 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:17:11.797777 [info ] [Thread-1 (]: 13 of 19 START test relationships_Airline_country_code__iso_code__ref_Country_ . [RUN]
[0m11:17:11.798259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26)
[0m11:17:11.798594 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:17:11.807191 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m11:17:11.807948 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:17:11.809524 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m11:17:11.809996 [debug] [Thread-1 (]: On test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:17:11.810299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:12.411272 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:25caf982-ef9a-418d-a887-faaf00887280&page=queryresults
[0m11:17:12.780871 [info ] [Thread-1 (]: 13 of 19 PASS relationships_Airline_country_code__iso_code__ref_Country_ ....... [[32mPASS[0m in 0.98s]
[0m11:17:12.782049 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:17:12.782464 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:17:12.782890 [info ] [Thread-1 (]: 14 of 19 START test relationships_Airport_country_code__iso_code__ref_Country_ . [RUN]
[0m11:17:12.783781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26, now test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0)
[0m11:17:12.784265 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:17:12.789347 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m11:17:12.790167 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:17:12.791847 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m11:17:12.792363 [debug] [Thread-1 (]: On test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:17:12.792666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:13.340623 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:47fb5c82-9067-4fd7-a8ac-b03e956bfff8&page=queryresults
[0m11:17:13.702401 [error] [Thread-1 (]: 14 of 19 FAIL 5 relationships_Airport_country_code__iso_code__ref_Country_ ..... [[31mFAIL 5[0m in 0.92s]
[0m11:17:13.703428 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:17:13.703890 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:17:13.704345 [info ] [Thread-1 (]: 15 of 19 START test unique_Airline_id .......................................... [RUN]
[0m11:17:13.704863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0, now test.air_travel.unique_Airline_id.cb196c2622)
[0m11:17:13.705238 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m11:17:13.712892 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:17:13.713837 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m11:17:13.715623 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:17:13.716153 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:17:13.716469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:14.146080 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:cbe066f4-9270-4777-bc3f-3e2ae702235d&page=queryresults
[0m11:17:14.523585 [info ] [Thread-1 (]: 15 of 19 PASS unique_Airline_id ................................................ [[32mPASS[0m in 0.82s]
[0m11:17:14.524464 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:17:14.524876 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:17:14.525282 [info ] [Thread-1 (]: 16 of 19 START test unique_Airport_Establishment_business ...................... [RUN]
[0m11:17:14.525748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_Establishment_business.c0ba13e1af)
[0m11:17:14.526483 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:17:14.531111 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m11:17:14.531947 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:17:14.535727 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m11:17:14.536647 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Establishment_business.c0ba13e1af: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select business as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
  where business is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:17:14.537050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:14.978352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:737629d7-a7b5-4a11-8287-ded0e35d9c28&page=queryresults
[0m11:17:15.358923 [info ] [Thread-1 (]: 16 of 19 PASS unique_Airport_Establishment_business ............................ [[32mPASS[0m in 0.83s]
[0m11:17:15.359857 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:17:15.360295 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:17:15.360703 [info ] [Thread-1 (]: 17 of 19 START test unique_Airport_Review_id ................................... [RUN]
[0m11:17:15.361160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Establishment_business.c0ba13e1af, now test.air_travel.unique_Airport_Review_id.690fe37ba9)
[0m11:17:15.361484 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:17:15.366693 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m11:17:15.367684 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:17:15.369485 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m11:17:15.370083 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Review_id.690fe37ba9: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Review_id.690fe37ba9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:17:15.370409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:16.004601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ffe00f9f-5c97-402e-bda1-33a80ebb253e&page=queryresults
[0m11:17:16.406735 [info ] [Thread-1 (]: 17 of 19 PASS unique_Airport_Review_id ......................................... [[32mPASS[0m in 1.05s]
[0m11:17:16.407734 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:17:16.408189 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:17:16.408627 [info ] [Thread-1 (]: 18 of 19 START test unique_Airport_icao ........................................ [RUN]
[0m11:17:16.409122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Review_id.690fe37ba9, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m11:17:16.409462 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:17:16.414657 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:17:16.415717 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:17:16.417644 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:17:16.418386 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:17:16.418768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:16.924393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:62e5da42-feb6-4f05-b9f2-6d360d308585&page=queryresults
[0m11:17:17.279149 [info ] [Thread-1 (]: 18 of 19 PASS unique_Airport_icao .............................................. [[32mPASS[0m in 0.87s]
[0m11:17:17.280082 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:17:17.280522 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:17:17.280950 [info ] [Thread-1 (]: 19 of 19 START test unique_Country_iso_code .................................... [RUN]
[0m11:17:17.281430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m11:17:17.281766 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:17:17.287138 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:17:17.288179 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:17:17.289975 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:17:17.290583 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:17:17.290920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:17.743660 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:07f7b5c7-2f2f-4a95-aa06-8ffc096b7aff&page=queryresults
[0m11:17:18.164827 [info ] [Thread-1 (]: 19 of 19 PASS unique_Country_iso_code .......................................... [[32mPASS[0m in 0.88s]
[0m11:17:18.165776 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:17:18.167831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:17:18.169823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:18.170088 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m11:17:18.170353 [info ] [MainThread]: 
[0m11:17:18.170626 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 18.71 seconds (18.71s).
[0m11:17:18.172979 [debug] [MainThread]: Command end result
[0m11:17:18.203395 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:17:18.204489 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:17:18.207442 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:17:18.207558 [info ] [MainThread]: 
[0m11:17:18.207698 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:17:18.207851 [info ] [MainThread]: 
[0m11:17:18.208033 [error] [MainThread]: [31mFailure in test relationships_Airport_country_code__iso_code__ref_Country_ (models/int/schema.yml)[0m
[0m11:17:18.208205 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m11:17:18.208330 [info ] [MainThread]: 
[0m11:17:18.208481 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/schema.yml/relationships_Airport_country_code__iso_code__ref_Country_.sql
[0m11:17:18.208618 [info ] [MainThread]: 
[0m11:17:18.208765 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=19
[0m11:17:18.211133 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 19.820675, "process_in_blocks": "0", "process_kernel_time": 0.323423, "process_mem_max_rss": "390758400", "process_out_blocks": "0", "process_user_time": 3.01777}
[0m11:17:18.211350 [debug] [MainThread]: Command `dbt test` failed at 11:17:18.211305 after 19.82 seconds
[0m11:17:18.211534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d00ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12386f120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12386f6a0>]}
[0m11:17:18.211685 [debug] [MainThread]: Flushing usage events
[0m11:17:18.399541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:01:40.319687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b80b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b80b750>]}


============================== 12:01:40.321270 | 589c131d-e855-42e5-aa25-04c0f94e1a4b ==============================
[0m12:01:40.321270 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:01:40.321516 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'quiet': 'False', 'static_parser': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select tmp_airport_country_closest_match', 'write_json': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_format': 'default', 'fail_fast': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_cache_events': 'False'}
[0m12:01:41.153554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '589c131d-e855-42e5-aa25-04c0f94e1a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab64c30>]}
[0m12:01:41.173034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '589c131d-e855-42e5-aa25-04c0f94e1a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216be360>]}
[0m12:01:41.173232 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:01:41.249460 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:01:41.298005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:01:41.298260 [debug] [MainThread]: Partial parsing: added file: air_travel://models/tmp/tmp_airport_country_closest_match.sql
[0m12:01:41.384332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '589c131d-e855-42e5-aa25-04c0f94e1a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121adbc50>]}
[0m12:01:41.420003 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:01:41.420873 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:01:41.428105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '589c131d-e855-42e5-aa25-04c0f94e1a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bcb2f0>]}
[0m12:01:41.428297 [info ] [MainThread]: Found 49 models, 28 data tests, 9 sources, 630 macros
[0m12:01:41.428427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '589c131d-e855-42e5-aa25-04c0f94e1a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f50910>]}
[0m12:01:41.429260 [info ] [MainThread]: 
[0m12:01:41.429385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:01:41.429477 [info ] [MainThread]: 
[0m12:01:41.429657 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:01:41.430006 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:01:41.430151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:41.872308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:01:41.872624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:42.151856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:01:42.153646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:42.435684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m12:01:42.437838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:42.718267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:01:42.720318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:42.993941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '589c131d-e855-42e5-aa25-04c0f94e1a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fcf860>]}
[0m12:01:42.994867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:42.999379 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_closest_match
[0m12:01:42.999894 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_country_closest_match  [RUN]
[0m12:01:43.000256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.tmp_airport_country_closest_match)
[0m12:01:43.000548 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_closest_match
[0m12:01:43.007078 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_closest_match"
[0m12:01:43.007738 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_closest_match
[0m12:01:43.031767 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_country_closest_match"
[0m12:01:43.032370 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_country_closest_match: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_country_closest_match"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_closest_match`
      
    
    

    
    OPTIONS()
    as (
      with unmatched_country_codes as (
    select airport_country_name, mapped_iso_code 
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`
    where airport_country_name not in 
        (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country` )
),
find_closest_match as (
    select u.airport_country_name, u.mapped_iso_code as original_iso_code, 
    AI.GENERATE(
      ('What is the closest match for country ', airport_country_name, ' 
        with iso code ', mapped_iso_code, ' from the reference list below? 
        Return the most suitable matching iso that appears in parenthesis. 
        If there is no suitable match, return None', 
        array_to_string(array_agg(concat(c.name, ' (', c.iso_code, ')')), ', ') as country_list),
      connection_id => 'us-central1.vertex-ai-connection',
      endpoint => 'gemini-2.5-flash-lite',
      model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
      output_schema => 'iso_code STRING') as llm_response
    from unmatched_country_codes u cross join  c
    group by u.airport_country_name, u.mapped_iso_code
)

select airport_country_name, original_iso_code, llm_response.iso_code as mapped_iso_code
from find_closest_match
    );
  
[0m12:01:43.032618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:43.325162 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e0820714-6635-4a44-a30d-8f565324c5e3&page=queryresults
[0m12:01:43.326626 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e0820714-6635-4a44-a30d-8f565324c5e3&page=queryresults
[0m12:01:43.334857 [debug] [Thread-1 (]: Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Syntax error: Unclosed string literal at [23:72]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:01:43.336243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '589c131d-e855-42e5-aa25-04c0f94e1a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fc5910>]}
[0m12:01:43.336787 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_country_closest_match  [[31mERROR[0m in 0.34s]
[0m12:01:43.337192 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_closest_match
[0m12:01:43.337497 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_country_closest_match' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Syntax error: Unclosed string literal at [23:72]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql.
[0m12:01:43.338711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:01:43.339849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:43.340041 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_country_closest_match' was properly closed.
[0m12:01:43.340219 [info ] [MainThread]: 
[0m12:01:43.340409 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m12:01:43.340800 [debug] [MainThread]: Command end result
[0m12:01:43.443792 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:01:43.444600 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:01:43.446668 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:01:43.446773 [info ] [MainThread]: 
[0m12:01:43.446916 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:01:43.447021 [info ] [MainThread]: 
[0m12:01:43.447158 [error] [MainThread]: [31mFailure in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)[0m
[0m12:01:43.447284 [error] [MainThread]:   Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Syntax error: Unclosed string literal at [23:72]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:01:43.447376 [info ] [MainThread]: 
[0m12:01:43.447485 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:01:43.447573 [info ] [MainThread]: 
[0m12:01:43.447679 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:01:43.449385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1532338, "process_in_blocks": "0", "process_kernel_time": 0.24506, "process_mem_max_rss": "388268032", "process_out_blocks": "0", "process_user_time": 1.837166}
[0m12:01:43.449532 [debug] [MainThread]: Command `dbt run` failed at 12:01:43.449504 after 3.15 seconds
[0m12:01:43.449651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e6f1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e6ed50>]}
[0m12:01:43.449762 [debug] [MainThread]: Flushing usage events
[0m12:01:43.655183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:30.595744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4fc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b343750>]}


============================== 12:05:30.597474 | 1f91553e-642f-40d5-87ef-6f2dd256205d ==============================
[0m12:05:30.597474 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:05:30.597717 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'empty': 'False', 'debug': 'False', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --select tmp_airport_country_closest_match', 'partial_parse': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m12:05:31.424633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f91553e-642f-40d5-87ef-6f2dd256205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a69cc30>]}
[0m12:05:31.444007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f91553e-642f-40d5-87ef-6f2dd256205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211c2360>]}
[0m12:05:31.444216 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:05:31.520308 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:05:31.568899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:05:31.569173 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_country_closest_match.sql
[0m12:05:31.654681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f91553e-642f-40d5-87ef-6f2dd256205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215dfc50>]}
[0m12:05:31.689434 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:05:31.690258 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:05:31.697333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f91553e-642f-40d5-87ef-6f2dd256205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216cf2f0>]}
[0m12:05:31.697505 [info ] [MainThread]: Found 49 models, 28 data tests, 9 sources, 630 macros
[0m12:05:31.697631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f91553e-642f-40d5-87ef-6f2dd256205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a50910>]}
[0m12:05:31.698452 [info ] [MainThread]: 
[0m12:05:31.698579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:05:31.698671 [info ] [MainThread]: 
[0m12:05:31.698855 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:05:31.699196 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:05:31.699348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:32.059507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:05:32.060055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:32.364118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m12:05:32.366643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:32.674028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:05:32.675651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:32.957473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:05:32.958367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:33.221419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f91553e-642f-40d5-87ef-6f2dd256205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ac7d40>]}
[0m12:05:33.222160 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:33.227100 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_closest_match
[0m12:05:33.227841 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_country_closest_match  [RUN]
[0m12:05:33.228319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_country_closest_match)
[0m12:05:33.228623 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_closest_match
[0m12:05:33.235454 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_closest_match"
[0m12:05:33.236096 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_closest_match
[0m12:05:33.260214 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_country_closest_match"
[0m12:05:33.260809 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_country_closest_match: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_country_closest_match"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_closest_match`
      
    
    

    
    OPTIONS()
    as (
      with unmatched_country_codes as (
    select airport_country_name, mapped_iso_code 
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`
    where airport_country_name not in 
        (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country` )
),
find_closest_match as (
    select u.airport_country_name, u.mapped_iso_code as original_iso_code, 
    AI.GENERATE(
      ('What is the closest match for country ', airport_country_name, ' 
        with iso code ', mapped_iso_code, ' from the reference list below? 
        Return the most suitable matching iso that appears in parenthesis. 
        If there is no suitable match, return None',
        array_to_string(array_agg(concat(c.name, ' (', c.iso_code, ')')), ', ') as country_list 
      ),
      connection_id => 'us-central1.vertex-ai-connection',
      endpoint => 'gemini-2.5-flash-lite',
      model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
      output_schema => 'iso_code STRING') as llm_response
    from unmatched_country_codes u cross join  c
    group by u.airport_country_name, u.mapped_iso_code
)

select airport_country_name, original_iso_code, 
  llm_response.iso_code as mapped_iso_code
from find_closest_match
    );
  
[0m12:05:33.261054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:33.524314 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:56b096cd-3631-4dc7-934b-67a6590e5597&page=queryresults
[0m12:05:33.525720 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:56b096cd-3631-4dc7-934b-67a6590e5597&page=queryresults
[0m12:05:33.534180 [debug] [Thread-1 (]: Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Syntax error: Unclosed string literal at [23:72]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:05:33.535633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f91553e-642f-40d5-87ef-6f2dd256205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ab5fd0>]}
[0m12:05:33.536205 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_country_closest_match  [[31mERROR[0m in 0.31s]
[0m12:05:33.536620 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_closest_match
[0m12:05:33.536920 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_country_closest_match' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Syntax error: Unclosed string literal at [23:72]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql.
[0m12:05:33.538078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:05:33.539173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:33.539357 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_country_closest_match' was properly closed.
[0m12:05:33.539541 [info ] [MainThread]: 
[0m12:05:33.539737 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m12:05:33.540135 [debug] [MainThread]: Command end result
[0m12:05:33.643464 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:05:33.644287 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:05:33.646431 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:05:33.646550 [info ] [MainThread]: 
[0m12:05:33.646690 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:05:33.646796 [info ] [MainThread]: 
[0m12:05:33.646925 [error] [MainThread]: [31mFailure in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)[0m
[0m12:05:33.647050 [error] [MainThread]:   Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Syntax error: Unclosed string literal at [23:72]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:05:33.647139 [info ] [MainThread]: 
[0m12:05:33.647246 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:05:33.647335 [info ] [MainThread]: 
[0m12:05:33.647444 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:05:33.649175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.076769, "process_in_blocks": "0", "process_kernel_time": 0.247104, "process_mem_max_rss": "388595712", "process_out_blocks": "0", "process_user_time": 1.848222}
[0m12:05:33.649321 [debug] [MainThread]: Command `dbt run` failed at 12:05:33.649292 after 3.08 seconds
[0m12:05:33.649446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12196b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12196b4d0>]}
[0m12:05:33.649557 [debug] [MainThread]: Flushing usage events
[0m12:05:33.874013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:33.688250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6b06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4fb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4fb750>]}


============================== 12:08:33.689885 | 4b9e3220-e59c-47be-a4fd-f80d43bcf84c ==============================
[0m12:08:33.689885 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:08:33.690128 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'invocation_command': 'dbt run --select tmp_airport_country_closest_match', 'static_parser': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None'}
[0m12:08:34.515082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b9e3220-e59c-47be-a4fd-f80d43bcf84c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c854c30>]}
[0m12:08:34.534498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b9e3220-e59c-47be-a4fd-f80d43bcf84c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233c2360>]}
[0m12:08:34.534697 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:08:34.611124 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:08:34.659914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:08:34.660200 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_country_closest_match.sql
[0m12:08:34.746217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b9e3220-e59c-47be-a4fd-f80d43bcf84c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237dbc50>]}
[0m12:08:34.780856 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:08:34.781650 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:08:34.788659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b9e3220-e59c-47be-a4fd-f80d43bcf84c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238cb2f0>]}
[0m12:08:34.788826 [info ] [MainThread]: Found 49 models, 28 data tests, 9 sources, 630 macros
[0m12:08:34.788945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b9e3220-e59c-47be-a4fd-f80d43bcf84c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c50910>]}
[0m12:08:34.789723 [info ] [MainThread]: 
[0m12:08:34.789851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:34.789950 [info ] [MainThread]: 
[0m12:08:34.790133 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:08:34.790451 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:08:34.790599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:35.110323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:08:35.110846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:35.402148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m12:08:35.405427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:35.709079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:08:35.710602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:36.024244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:08:36.025155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:36.329575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b9e3220-e59c-47be-a4fd-f80d43bcf84c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cc3860>]}
[0m12:08:36.330392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:36.335339 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_closest_match
[0m12:08:36.336060 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_country_closest_match  [RUN]
[0m12:08:36.336527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_country_closest_match)
[0m12:08:36.336832 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_closest_match
[0m12:08:36.343638 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_closest_match"
[0m12:08:36.344295 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_closest_match
[0m12:08:36.368481 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_country_closest_match"
[0m12:08:36.369115 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_country_closest_match: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_country_closest_match"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_closest_match`
      
    
    

    
    OPTIONS()
    as (
      with unmatched_country_codes as (
    select airport_country_name, mapped_iso_code 
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`
    where airport_country_name not in 
        (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country` )
),
find_closest_match as (
    select u.airport_country_name, u.mapped_iso_code as original_iso_code, 
    AI.GENERATE(
      ('What is the closest match for country ', airport_country_name, 'with iso code ', mapped_iso_code, ' from the reference list below? Return the most suitable matching iso that appears in parenthesis. If there is no suitable match, return None', array_to_string(array_agg(concat(c.name, ' (', c.iso_code, ')')), ', ')),
      ),
      connection_id => 'us-central1.vertex-ai-connection',
      endpoint => 'gemini-2.5-flash-lite',
      model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
      output_schema => 'iso_code STRING') as llm_response
    from unmatched_country_codes u cross join  c
    group by u.airport_country_name, u.mapped_iso_code
)

select airport_country_name, original_iso_code, 
  llm_response.iso_code as mapped_iso_code
from find_closest_match
    );
  
[0m12:08:36.369357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:36.804426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:80f6861c-73f4-4b3d-ba26-662d167792dd&page=queryresults
[0m12:08:36.805937 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:80f6861c-73f4-4b3d-ba26-662d167792dd&page=queryresults
[0m12:08:36.817637 [debug] [Thread-1 (]: Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Syntax error: Unexpected ")" at [24:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:08:36.819681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b9e3220-e59c-47be-a4fd-f80d43bcf84c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cb19d0>]}
[0m12:08:36.820339 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_country_closest_match  [[31mERROR[0m in 0.48s]
[0m12:08:36.820842 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_closest_match
[0m12:08:36.821351 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_country_closest_match' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Syntax error: Unexpected ")" at [24:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql.
[0m12:08:36.823339 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:08:36.824876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:36.825096 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_country_closest_match' was properly closed.
[0m12:08:36.825310 [info ] [MainThread]: 
[0m12:08:36.825524 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m12:08:36.826020 [debug] [MainThread]: Command end result
[0m12:08:36.932789 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:08:36.933605 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:08:36.935667 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:08:36.935776 [info ] [MainThread]: 
[0m12:08:36.935913 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:08:36.936036 [info ] [MainThread]: 
[0m12:08:36.936173 [error] [MainThread]: [31mFailure in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)[0m
[0m12:08:36.936303 [error] [MainThread]:   Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Syntax error: Unexpected ")" at [24:7]
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:08:36.936392 [info ] [MainThread]: 
[0m12:08:36.936514 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:08:36.936600 [info ] [MainThread]: 
[0m12:08:36.936720 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:08:36.938531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2739484, "process_in_blocks": "0", "process_kernel_time": 0.246896, "process_mem_max_rss": "388284416", "process_out_blocks": "0", "process_user_time": 1.858808}
[0m12:08:36.938685 [debug] [MainThread]: Command `dbt run` failed at 12:08:36.938655 after 3.27 seconds
[0m12:08:36.938807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b6b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b6b4d0>]}
[0m12:08:36.938917 [debug] [MainThread]: Flushing usage events
[0m12:08:37.194820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:44.351486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1f06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d03b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d03b750>]}


============================== 12:10:44.353172 | 1619a3e6-d6af-468e-9920-c509c1a5d8c5 ==============================
[0m12:10:44.353172 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:10:44.353418 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'introspect': 'True', 'quiet': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'use_experimental_parser': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'debug': 'False', 'empty': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select tmp_airport_country_closest_match', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_format': 'default', 'log_cache_events': 'False'}
[0m12:10:45.196687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1619a3e6-d6af-468e-9920-c509c1a5d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c394c30>]}
[0m12:10:45.218265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1619a3e6-d6af-468e-9920-c509c1a5d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fbe360>]}
[0m12:10:45.218540 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:10:45.299038 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:10:45.348799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:45.349105 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_country_closest_match.sql
[0m12:10:45.435441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1619a3e6-d6af-468e-9920-c509c1a5d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233dbc50>]}
[0m12:10:45.471786 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:10:45.472648 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:10:45.479958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1619a3e6-d6af-468e-9920-c509c1a5d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234cb2f0>]}
[0m12:10:45.480139 [info ] [MainThread]: Found 49 models, 28 data tests, 9 sources, 630 macros
[0m12:10:45.480277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1619a3e6-d6af-468e-9920-c509c1a5d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12383c910>]}
[0m12:10:45.481087 [info ] [MainThread]: 
[0m12:10:45.481218 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:45.481318 [info ] [MainThread]: 
[0m12:10:45.481506 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:10:45.481822 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:10:45.481974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:45.805053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:10:45.805593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:46.074956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:10:46.077218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:46.382756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:10:46.386425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:46.697294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m12:10:46.699178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:46.998168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1619a3e6-d6af-468e-9920-c509c1a5d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238bfd40>]}
[0m12:10:46.998996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:47.004117 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_closest_match
[0m12:10:47.004743 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_country_closest_match  [RUN]
[0m12:10:47.005124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now model.air_travel.tmp_airport_country_closest_match)
[0m12:10:47.005417 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_closest_match
[0m12:10:47.012277 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_closest_match"
[0m12:10:47.012907 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_closest_match
[0m12:10:47.037049 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_country_closest_match"
[0m12:10:47.037640 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_country_closest_match: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_country_closest_match"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_closest_match`
      
    
    

    
    OPTIONS()
    as (
      with unmatched_country_codes as (
    select airport_country_name, mapped_iso_code 
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`
    where airport_country_name not in 
        (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country` )
),
find_closest_match as (
    select u.airport_country_name, u.mapped_iso_code as original_iso_code, 
      AI.GENERATE(
      ('What is the closest match for country ', airport_country_name, 'with iso code ', mapped_iso_code, ' from the reference list below? Return the most suitable matching iso that appears in parenthesis. If there is no suitable match, return None', array_to_string(array_agg(concat(c.name, ' (', c.iso_code, ')')), ', ')),
      connection_id => 'us-central1.vertex-ai-connection',
      endpoint => 'gemini-2.5-flash-lite',
      model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
      output_schema => 'iso_code STRING') as llm_response
    from unmatched_country_codes u cross join  c
    group by u.airport_country_name, u.mapped_iso_code
)

select airport_country_name, original_iso_code, 
  llm_response.iso_code as mapped_iso_code
from find_closest_match
    );
  
[0m12:10:47.037880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:47.469808 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4e20dce4-6c7b-47f1-a1cc-69041a5e6a88&page=queryresults
[0m12:10:47.471332 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4e20dce4-6c7b-47f1-a1cc-69041a5e6a88&page=queryresults
[0m12:10:47.481316 [debug] [Thread-1 (]: Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Table "c" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:10:47.483036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1619a3e6-d6af-468e-9920-c509c1a5d8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239a9b50>]}
[0m12:10:47.483613 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_tmp.tmp_airport_country_closest_match  [[31mERROR[0m in 0.48s]
[0m12:10:47.484078 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_closest_match
[0m12:10:47.484560 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.tmp_airport_country_closest_match' to be skipped because of status 'error'.  Reason: Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Table "c" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql.
[0m12:10:47.486133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:47.487305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:47.487493 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_country_closest_match' was properly closed.
[0m12:10:47.487682 [info ] [MainThread]: 
[0m12:10:47.487885 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m12:10:47.488324 [debug] [MainThread]: Command end result
[0m12:10:47.594801 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:10:47.595604 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:10:47.597816 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:10:47.597933 [info ] [MainThread]: 
[0m12:10:47.598073 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:10:47.598178 [info ] [MainThread]: 
[0m12:10:47.598314 [error] [MainThread]: [31mFailure in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)[0m
[0m12:10:47.598444 [error] [MainThread]:   Database Error in model tmp_airport_country_closest_match (models/tmp/tmp_airport_country_closest_match.sql)
  Table "c" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:10:47.598534 [info ] [MainThread]: 
[0m12:10:47.598645 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/tmp/tmp_airport_country_closest_match.sql
[0m12:10:47.598732 [info ] [MainThread]: 
[0m12:10:47.598840 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:10:47.600599 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.272704, "process_in_blocks": "0", "process_kernel_time": 0.259122, "process_mem_max_rss": "392675328", "process_out_blocks": "0", "process_user_time": 1.872781}
[0m12:10:47.600746 [debug] [MainThread]: Command `dbt run` failed at 12:10:47.600717 after 3.27 seconds
[0m12:10:47.600873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12376b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12376b4d0>]}
[0m12:10:47.600986 [debug] [MainThread]: Flushing usage events
[0m12:10:47.804947 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:18.298399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1046e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af4f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af4f750>]}


============================== 12:12:18.300010 | 8365764c-89e4-4ee6-a484-8d05070384f1 ==============================
[0m12:12:18.300010 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:12:18.300250 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'fail_fast': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'no_print': 'None', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'invocation_command': 'dbt run --select tmp_airport_country_closest_match', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_cache_events': 'False'}
[0m12:12:19.126064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8365764c-89e4-4ee6-a484-8d05070384f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a8c30>]}
[0m12:12:19.145844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8365764c-89e4-4ee6-a484-8d05070384f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120dc2360>]}
[0m12:12:19.146061 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:12:19.223067 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:12:19.271569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:12:19.271970 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/tmp/tmp_airport_country_closest_match.sql
[0m12:12:19.356747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8365764c-89e4-4ee6-a484-8d05070384f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211d7c50>]}
[0m12:12:19.391142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:12:19.391955 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:12:19.398965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8365764c-89e4-4ee6-a484-8d05070384f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212cb2f0>]}
[0m12:12:19.399131 [info ] [MainThread]: Found 49 models, 28 data tests, 9 sources, 630 macros
[0m12:12:19.399262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8365764c-89e4-4ee6-a484-8d05070384f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121525710>]}
[0m12:12:19.400040 [info ] [MainThread]: 
[0m12:12:19.400167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:12:19.400264 [info ] [MainThread]: 
[0m12:12:19.400475 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:12:19.400799 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:12:19.400955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:19.732636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:12:19.733242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:20.019217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m12:12:20.022439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:20.294277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:12:20.295704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:20.570998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:12:20.573106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:20.855614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8365764c-89e4-4ee6-a484-8d05070384f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216c7860>]}
[0m12:12:20.856360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:12:20.861148 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_closest_match
[0m12:12:20.861746 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_tmp.tmp_airport_country_closest_match  [RUN]
[0m12:12:20.862159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.tmp_airport_country_closest_match)
[0m12:12:20.862456 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_closest_match
[0m12:12:20.869361 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_closest_match"
[0m12:12:20.870001 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_closest_match
[0m12:12:20.893906 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.tmp_airport_country_closest_match"
[0m12:12:20.894446 [debug] [Thread-1 (]: On model.air_travel.tmp_airport_country_closest_match: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.tmp_airport_country_closest_match"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_closest_match`
      
    
    

    
    OPTIONS()
    as (
      with unmatched_country_codes as (
    select airport_country_name, mapped_iso_code 
    from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_iso_codes`
    where airport_country_name not in 
        (select name from `cs378-fa2025`.`dbt_air_travel_int`.`Country` )
),
find_closest_match as (
    select u.airport_country_name, u.mapped_iso_code as original_iso_code, 
      AI.GENERATE(
      ('What is the closest match for country ', airport_country_name, 'with iso code ', mapped_iso_code, ' from the reference list below? Return the most suitable matching iso that appears in parenthesis. If there is no suitable match, return None', array_to_string(array_agg(concat(c.name, ' (', c.iso_code, ')')), ', ')),
      connection_id => 'us-central1.vertex-ai-connection',
      endpoint => 'gemini-2.5-flash-lite',
      model_params => JSON '{"generation_config":{"thinking_config": {"thinking_budget": 0}}, "tools": [{"googleSearch": {}}]}',
      output_schema => 'iso_code STRING') as llm_response
    from unmatched_country_codes u cross join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
    group by u.airport_country_name, u.mapped_iso_code
)

select airport_country_name, original_iso_code, 
  llm_response.iso_code as mapped_iso_code
from find_closest_match
    );
  
[0m12:12:20.894681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:21.431035 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8344afb1-efa1-438b-be7f-dbe9cb561677&page=queryresults
[0m12:12:26.400481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8365764c-89e4-4ee6-a484-8d05070384f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217a5e50>]}
[0m12:12:26.400967 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_tmp.tmp_airport_country_closest_match  [[32mCREATE TABLE (19.0 rows, 4.0 KiB processed)[0m in 5.54s]
[0m12:12:26.401333 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_closest_match
[0m12:12:26.402152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:12:26.403178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:26.403355 [debug] [MainThread]: Connection 'model.air_travel.tmp_airport_country_closest_match' was properly closed.
[0m12:12:26.403518 [info ] [MainThread]: 
[0m12:12:26.403698 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m12:12:26.404061 [debug] [MainThread]: Command end result
[0m12:12:26.504278 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:12:26.505068 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:12:26.507094 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:12:26.507195 [info ] [MainThread]: 
[0m12:12:26.507337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:26.507445 [info ] [MainThread]: 
[0m12:12:26.507578 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:12:26.509255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.23419, "process_in_blocks": "0", "process_kernel_time": 0.266691, "process_mem_max_rss": "393625600", "process_out_blocks": "0", "process_user_time": 1.877523}
[0m12:12:26.509403 [debug] [MainThread]: Command `dbt run` succeeded at 12:12:26.509374 after 8.23 seconds
[0m12:12:26.509524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d61020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121775630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217744b0>]}
[0m12:12:26.509664 [debug] [MainThread]: Flushing usage events
[0m12:12:26.715120 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:36.831998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8786e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6c39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6c3750>]}


============================== 12:15:36.833626 | de2f1f64-6409-44f4-bc83-f0e6d94a19cc ==============================
[0m12:15:36.833626 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:15:36.833857 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'empty': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select Airport', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'quiet': 'False'}
[0m12:15:37.656104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de2f1f64-6409-44f4-bc83-f0e6d94a19cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa1cc30>]}
[0m12:15:37.675569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de2f1f64-6409-44f4-bc83-f0e6d94a19cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215be360>]}
[0m12:15:37.675775 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:15:37.750779 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:15:37.799341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:37.799631 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airport.sql
[0m12:15:37.930954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de2f1f64-6409-44f4-bc83-f0e6d94a19cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121eac550>]}
[0m12:15:37.966524 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:15:37.967346 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:15:38.052616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de2f1f64-6409-44f4-bc83-f0e6d94a19cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215ce8a0>]}
[0m12:15:38.052847 [info ] [MainThread]: Found 49 models, 28 data tests, 9 sources, 630 macros
[0m12:15:38.052984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de2f1f64-6409-44f4-bc83-f0e6d94a19cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e26a50>]}
[0m12:15:38.053796 [info ] [MainThread]: 
[0m12:15:38.053927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:15:38.054028 [info ] [MainThread]: 
[0m12:15:38.054215 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:15:38.054546 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:15:38.054707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:38.385548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m12:15:38.385830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:38.663236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:15:38.665118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:38.941902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:15:38.943910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:39.417375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:15:39.420234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:39.717800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de2f1f64-6409-44f4-bc83-f0e6d94a19cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f6e750>]}
[0m12:15:39.718350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:39.721570 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m12:15:39.722087 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airport ........................ [RUN]
[0m12:15:39.722441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Airport)
[0m12:15:39.722688 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m12:15:39.728965 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m12:15:39.730563 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m12:15:39.739992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:40.072578 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airport"
[0m12:15:40.073501 [debug] [Thread-1 (]: On model.air_travel.Airport: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airport"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
      
    
    

    
    OPTIONS()
    as (
      with Airport as (
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null
  union all
  select a.icao, a.iata, a.name, a.city, a.state_prov, c.mapped_iso_code as country_code,
    a.latitude, a.longitude, a.timezone_delta, a.daylight_savings_time, a.timezone_name,
    a.type, a.source, a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_refined` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airport_country_closest_match` c
  on a.country = c.airport_country_name
  where c.mapped_iso_code is not null
)

select distinct * 
from Airport
    );
  
[0m12:15:40.642867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:05f3df78-b042-44d3-aebb-e47c29473d78&page=queryresults
[0m12:15:42.606709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2f1f64-6409-44f4-bc83-f0e6d94a19cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e96750>]}
[0m12:15:42.607390 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Airport ................... [[32mCREATE TABLE (3.5k rows, 542.9 KiB processed)[0m in 2.88s]
[0m12:15:42.607870 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m12:15:42.608930 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:42.610217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:42.610410 [debug] [MainThread]: Connection 'model.air_travel.Airport' was properly closed.
[0m12:15:42.610599 [info ] [MainThread]: 
[0m12:15:42.610801 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m12:15:42.611251 [debug] [MainThread]: Command end result
[0m12:15:42.636539 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:15:42.637609 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:15:42.640241 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:15:42.640381 [info ] [MainThread]: 
[0m12:15:42.640549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:42.640669 [info ] [MainThread]: 
[0m12:15:42.640808 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:15:42.643030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8344007, "process_in_blocks": "0", "process_kernel_time": 0.261464, "process_mem_max_rss": "393461760", "process_out_blocks": "0", "process_user_time": 1.931477}
[0m12:15:42.643223 [debug] [MainThread]: Command `dbt run` succeeded at 12:15:42.643183 after 5.83 seconds
[0m12:15:42.643375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f7b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ed8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ed8370>]}
[0m12:15:42.643529 [debug] [MainThread]: Flushing usage events
[0m12:15:42.849424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:58.972998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913f750>]}


============================== 12:15:58.974665 | 10e10ba9-ae88-4684-9d42-0f044452fd7c ==============================
[0m12:15:58.974665 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:15:58.974912 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'profiles_dir': '/Users/scohen/.dbt', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Review.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'cache_selected_only': 'False', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False'}
[0m12:15:59.784811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10e10ba9-ae88-4684-9d42-0f044452fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108498c30>]}
[0m12:15:59.804279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10e10ba9-ae88-4684-9d42-0f044452fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0c6360>]}
[0m12:15:59.804483 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:15:59.880359 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:15:59.927431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:15:59.927574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:15:59.944077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10e10ba9-ae88-4684-9d42-0f044452fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4df950>]}
[0m12:15:59.979333 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:15:59.980105 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:15:59.990730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10e10ba9-ae88-4684-9d42-0f044452fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f941310>]}
[0m12:15:59.990926 [info ] [MainThread]: Found 49 models, 28 data tests, 9 sources, 630 macros
[0m12:15:59.991054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10e10ba9-ae88-4684-9d42-0f044452fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f936270>]}
[0m12:16:00.001999 [info ] [MainThread]: 
[0m12:16:00.002185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:00.002295 [info ] [MainThread]: 
[0m12:16:00.002503 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:16:00.004885 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:16:00.005047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:00.272886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m12:16:00.274757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:00.556552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:16:00.557472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:00.862200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:16:00.864210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:01.129514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10e10ba9-ae88-4684-9d42-0f044452fd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f920ef0>]}
[0m12:16:01.130446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:01.134395 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m12:16:01.134835 [info ] [Thread-1 (]: 1 of 19 START test dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name  [RUN]
[0m12:16:01.135233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd)
[0m12:16:01.135553 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m12:16:01.152145 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m12:16:01.152734 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m12:16:01.165321 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m12:16:01.165897 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        icao, iata, name
    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
    group by icao, iata, name
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:16:01.166135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:01.636910 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:39278c34-c93b-4f6c-b1fa-0ffdd62ae865&page=queryresults
[0m12:16:02.139067 [info ] [Thread-1 (]: 1 of 19 PASS dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name . [[32mPASS[0m in 1.00s]
[0m12:16:02.139978 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m12:16:02.140396 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:16:02.140887 [info ] [Thread-1 (]: 2 of 19 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m12:16:02.141429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m12:16:02.141790 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:16:02.147463 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m12:16:02.148197 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:16:02.150216 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m12:16:02.150728 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airport_icao, terminal, business, location
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    group by airport_icao, terminal, business, location
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:16:02.151031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:02.658893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:656cd47e-949c-4a5e-9ef6-0bd7e3e6174e&page=queryresults
[0m12:16:03.137497 [info ] [Thread-1 (]: 2 of 19 PASS dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[32mPASS[0m in 1.00s]
[0m12:16:03.138495 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:16:03.138956 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:16:03.139424 [info ] [Thread-1 (]: 3 of 19 START test dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [RUN]
[0m12:16:03.140294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m12:16:03.140835 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:16:03.146133 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m12:16:03.146948 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:16:03.149388 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m12:16:03.150030 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_month, airline_id, airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    group by event_month, airline_id, airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:16:03.150356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:03.581945 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:feddddd9-1b96-413e-8e08-b718afae4f4f&page=queryresults
[0m12:16:03.993751 [info ] [Thread-1 (]: 3 of 19 PASS dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [[32mPASS[0m in 0.85s]
[0m12:16:03.994712 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:16:03.995134 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m12:16:03.995557 [info ] [Thread-1 (]: 4 of 19 START test dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [RUN]
[0m12:16:03.996211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m12:16:03.996937 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m12:16:04.002088 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m12:16:04.002927 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m12:16:04.005391 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m12:16:04.006113 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    group by airline_id, source_airport_icao, dest_airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:16:04.006436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:04.467897 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:26f454bd-1089-4f76-87b9-b5574d0c9bb0&page=queryresults
[0m12:16:04.924824 [info ] [Thread-1 (]: 4 of 19 PASS dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [[32mPASS[0m in 0.93s]
[0m12:16:04.925732 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m12:16:04.926160 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m12:16:04.926569 [info ] [Thread-1 (]: 5 of 19 START test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [RUN]
[0m12:16:04.927049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965)
[0m12:16:04.927404 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m12:16:04.932712 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m12:16:04.933744 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m12:16:04.936044 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m12:16:04.936648 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        business, menu_item
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    group by business, menu_item
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:16:04.936991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:05.423887 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:cfc95a4f-e6e0-4d64-a53f-15c0504c9fd4&page=queryresults
[0m12:16:05.875918 [info ] [Thread-1 (]: 5 of 19 PASS dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [[32mPASS[0m in 0.95s]
[0m12:16:05.876893 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m12:16:05.877364 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m12:16:05.877832 [info ] [Thread-1 (]: 6 of 19 START test dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [RUN]
[0m12:16:05.878338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m12:16:05.878704 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m12:16:05.884510 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m12:16:05.885513 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m12:16:05.887937 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m12:16:05.888551 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:16:05.888903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:06.319792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:198a29bf-5a5f-420f-ad01-67dbf1faa3dc&page=queryresults
[0m12:16:06.963149 [info ] [Thread-1 (]: 6 of 19 PASS dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [[32mPASS[0m in 1.08s]
[0m12:16:06.964137 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m12:16:06.964587 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m12:16:06.965040 [info ] [Thread-1 (]: 7 of 19 START test dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [RUN]
[0m12:16:06.965547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m12:16:06.965918 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m12:16:06.972517 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m12:16:06.973549 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m12:16:06.978905 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m12:16:06.979582 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_date, event_hour, airport_icao, security_checkpoint
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    group by event_date, event_hour, airport_icao, security_checkpoint
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:16:06.979896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:07.473347 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:73d1019f-0bc0-47a8-a1ab-a3c721236cfb&page=queryresults
[0m12:16:07.843135 [info ] [Thread-1 (]: 7 of 19 PASS dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [[32mPASS[0m in 0.88s]
[0m12:16:07.844065 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m12:16:07.844519 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m12:16:07.844922 [info ] [Thread-1 (]: 8 of 19 START test not_null_Airline_id ......................................... [RUN]
[0m12:16:07.845390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m12:16:07.845747 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m12:16:07.852646 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m12:16:07.853641 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m12:16:07.942040 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m12:16:07.942509 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m12:16:07.942677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:08.391792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f3bf9691-760b-4015-89e0-bf2482605483&page=queryresults
[0m12:16:08.779929 [info ] [Thread-1 (]: 8 of 19 PASS not_null_Airline_id ............................................... [[32mPASS[0m in 0.93s]
[0m12:16:08.780894 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m12:16:08.781343 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m12:16:08.781788 [info ] [Thread-1 (]: 9 of 19 START test not_null_Airport_Establishment_business ..................... [RUN]
[0m12:16:08.782296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_Establishment_business.fa42968b3c)
[0m12:16:08.782651 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m12:16:08.787615 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m12:16:08.788688 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m12:16:08.791104 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m12:16:08.791674 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Establishment_business.fa42968b3c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select business
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
where business is null



  
  
      
    ) dbt_internal_test
[0m12:16:08.791982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:09.213640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:66e164eb-6873-4f76-820c-8fa6a8cc4f6e&page=queryresults
[0m12:16:09.599164 [info ] [Thread-1 (]: 9 of 19 PASS not_null_Airport_Establishment_business ........................... [[32mPASS[0m in 0.82s]
[0m12:16:09.600155 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m12:16:09.600599 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m12:16:09.601035 [info ] [Thread-1 (]: 10 of 19 START test not_null_Airport_Review_id ................................. [RUN]
[0m12:16:09.601525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Establishment_business.fa42968b3c, now test.air_travel.not_null_Airport_Review_id.715ca7a304)
[0m12:16:09.601868 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m12:16:09.606570 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m12:16:09.607564 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m12:16:09.609900 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m12:16:09.610470 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Review_id.715ca7a304: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Review_id.715ca7a304"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
where id is null



  
  
      
    ) dbt_internal_test
[0m12:16:09.610796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:10.116258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a25a863e-bea9-44e0-919c-36a7d2c4a8a7&page=queryresults
[0m12:16:10.508414 [info ] [Thread-1 (]: 10 of 19 PASS not_null_Airport_Review_id ....................................... [[32mPASS[0m in 0.91s]
[0m12:16:10.509282 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m12:16:10.509683 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m12:16:10.510124 [info ] [Thread-1 (]: 11 of 19 START test not_null_Airport_icao ...................................... [RUN]
[0m12:16:10.510674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Review_id.715ca7a304, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m12:16:10.511040 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m12:16:10.514948 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m12:16:10.515779 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m12:16:10.518120 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m12:16:10.518798 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m12:16:10.519098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:11.056106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8c83e24c-f7dd-486b-a9c8-b21a6a8ef142&page=queryresults
[0m12:16:11.523044 [info ] [Thread-1 (]: 11 of 19 PASS not_null_Airport_icao ............................................ [[32mPASS[0m in 1.01s]
[0m12:16:11.524133 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m12:16:11.524550 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m12:16:11.524989 [info ] [Thread-1 (]: 12 of 19 START test not_null_Country_iso_code .................................. [RUN]
[0m12:16:11.525525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m12:16:11.525885 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m12:16:11.529602 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m12:16:11.530372 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m12:16:11.532611 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m12:16:11.533188 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m12:16:11.533470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:11.918240 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:341209f7-cca6-41fd-8c6d-2ccdaf465988&page=queryresults
[0m12:16:12.314878 [info ] [Thread-1 (]: 12 of 19 PASS not_null_Country_iso_code ........................................ [[32mPASS[0m in 0.79s]
[0m12:16:12.315932 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m12:16:12.316381 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m12:16:12.316791 [info ] [Thread-1 (]: 13 of 19 START test relationships_Airline_country_code__iso_code__ref_Country_ . [RUN]
[0m12:16:12.317266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26)
[0m12:16:12.317614 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m12:16:12.326843 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m12:16:12.327641 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m12:16:12.329396 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m12:16:12.329885 [debug] [Thread-1 (]: On test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:16:12.330174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:12.797011 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:42938519-2d68-46a2-8112-692170af0756&page=queryresults
[0m12:16:13.208208 [info ] [Thread-1 (]: 13 of 19 PASS relationships_Airline_country_code__iso_code__ref_Country_ ....... [[32mPASS[0m in 0.89s]
[0m12:16:13.209479 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m12:16:13.210083 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m12:16:13.210564 [info ] [Thread-1 (]: 14 of 19 START test relationships_Airport_country_code__iso_code__ref_Country_ . [RUN]
[0m12:16:13.211133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26, now test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0)
[0m12:16:13.211519 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m12:16:13.216738 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m12:16:13.217509 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m12:16:13.219537 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m12:16:13.220236 [debug] [Thread-1 (]: On test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:16:13.220634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:13.820789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:fd1663ea-2868-48b4-8431-d768964be639&page=queryresults
[0m12:16:14.182260 [info ] [Thread-1 (]: 14 of 19 PASS relationships_Airport_country_code__iso_code__ref_Country_ ....... [[32mPASS[0m in 0.97s]
[0m12:16:14.183212 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m12:16:14.183755 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m12:16:14.184186 [info ] [Thread-1 (]: 15 of 19 START test unique_Airline_id .......................................... [RUN]
[0m12:16:14.184679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0, now test.air_travel.unique_Airline_id.cb196c2622)
[0m12:16:14.185155 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m12:16:14.192666 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m12:16:14.193468 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m12:16:14.195203 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m12:16:14.195738 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:16:14.196044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:14.742453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a7626c4e-96f4-4a44-a0c4-1dc680abea22&page=queryresults
[0m12:16:15.157302 [info ] [Thread-1 (]: 15 of 19 PASS unique_Airline_id ................................................ [[32mPASS[0m in 0.97s]
[0m12:16:15.158289 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m12:16:15.158755 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m12:16:15.159182 [info ] [Thread-1 (]: 16 of 19 START test unique_Airport_Establishment_business ...................... [RUN]
[0m12:16:15.159685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_Establishment_business.c0ba13e1af)
[0m12:16:15.160048 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m12:16:15.165186 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m12:16:15.166209 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m12:16:15.167987 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m12:16:15.168586 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Establishment_business.c0ba13e1af: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select business as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
  where business is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:16:15.168938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:15.870793 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2a5751a0-80bf-4a20-999c-ce0379802a5b&page=queryresults
[0m12:16:16.235416 [info ] [Thread-1 (]: 16 of 19 PASS unique_Airport_Establishment_business ............................ [[32mPASS[0m in 1.08s]
[0m12:16:16.236484 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m12:16:16.236938 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m12:16:16.237356 [info ] [Thread-1 (]: 17 of 19 START test unique_Airport_Review_id ................................... [RUN]
[0m12:16:16.238034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Establishment_business.c0ba13e1af, now test.air_travel.unique_Airport_Review_id.690fe37ba9)
[0m12:16:16.238719 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m12:16:16.243484 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m12:16:16.244328 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m12:16:16.246257 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m12:16:16.246974 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Review_id.690fe37ba9: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Review_id.690fe37ba9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:16:16.247397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:16.652263 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:fca085a1-b590-41db-a977-9bc6b94ddee6&page=queryresults
[0m12:16:17.033423 [info ] [Thread-1 (]: 17 of 19 PASS unique_Airport_Review_id ......................................... [[32mPASS[0m in 0.80s]
[0m12:16:17.034255 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m12:16:17.034647 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m12:16:17.035089 [info ] [Thread-1 (]: 18 of 19 START test unique_Airport_icao ........................................ [RUN]
[0m12:16:17.035617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Review_id.690fe37ba9, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m12:16:17.035997 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m12:16:17.040507 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m12:16:17.041345 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m12:16:17.043013 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m12:16:17.043576 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:16:17.043958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:17.609844 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ec2a1ba7-841c-4d5c-96d1-ef69b266133b&page=queryresults
[0m12:16:17.962106 [info ] [Thread-1 (]: 18 of 19 PASS unique_Airport_icao .............................................. [[32mPASS[0m in 0.93s]
[0m12:16:17.963319 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m12:16:17.963971 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m12:16:17.964448 [info ] [Thread-1 (]: 19 of 19 START test unique_Country_iso_code .................................... [RUN]
[0m12:16:17.965015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m12:16:17.965388 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m12:16:17.969826 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m12:16:17.970610 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m12:16:17.972302 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m12:16:17.972829 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:16:17.973115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:18.429068 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:048fda46-2273-4023-b004-7912c44af674&page=queryresults
[0m12:16:18.779453 [info ] [Thread-1 (]: 19 of 19 PASS unique_Country_iso_code .......................................... [[32mPASS[0m in 0.81s]
[0m12:16:18.780381 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m12:16:18.781999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:18.784266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:18.784821 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m12:16:18.785173 [info ] [MainThread]: 
[0m12:16:18.785511 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 18.78 seconds (18.78s).
[0m12:16:18.788270 [debug] [MainThread]: Command end result
[0m12:16:18.819539 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:16:18.820662 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:16:18.824390 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:16:18.824542 [info ] [MainThread]: 
[0m12:16:18.824709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:18.824845 [info ] [MainThread]: 
[0m12:16:18.824993 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=19
[0m12:16:18.827318 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.87758, "process_in_blocks": "0", "process_kernel_time": 0.305916, "process_mem_max_rss": "390578176", "process_out_blocks": "0", "process_user_time": 3.053454}
[0m12:16:18.827520 [debug] [MainThread]: Command `dbt test` succeeded at 12:16:18.827480 after 19.88 seconds
[0m12:16:18.827679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109044a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f866ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f866f10>]}
[0m12:16:18.827826 [debug] [MainThread]: Flushing usage events
[0m12:16:19.020991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:59.693044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f206e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d6b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d6b750>]}


============================== 12:34:59.694636 | ae8c9d94-a715-45b7-ab98-c0de2a4c64c3 ==============================
[0m12:34:59.694636 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:34:59.694871 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'None', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/Users/scohen/.dbt', 'partial_parse': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'invocation_command': 'dbt test --select Airport_Concessions', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'write_json': 'True'}
[0m12:35:00.522701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae8c9d94-a715-45b7-ab98-c0de2a4c64c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c4c30>]}
[0m12:35:00.542096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae8c9d94-a715-45b7-ab98-c0de2a4c64c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fdc2360>]}
[0m12:35:00.542302 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:35:00.618304 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:35:00.666662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:35:00.667027 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m12:35:00.771734 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/int/schema.yml:
  	test definition dictionary must have exactly one key, got [('name', 'airport_icao'), ('data_tests', [{'relationships': {'arguments': {'to': "ref('Airport')", 'field': 'icao'}}}])] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m12:35:00.773566 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.1041781, "process_in_blocks": "0", "process_kernel_time": 0.22261, "process_mem_max_rss": "382386176", "process_out_blocks": "0", "process_user_time": 1.374009}
[0m12:35:00.773781 [debug] [MainThread]: Command `dbt test` failed at 12:35:00.773743 after 1.10 seconds
[0m12:35:00.773924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206b4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206b4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120725b80>]}
[0m12:35:00.774050 [debug] [MainThread]: Flushing usage events
[0m12:35:01.004991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:20.613897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109443750>]}


============================== 12:36:20.615503 | ff3036cb-c0de-4ea3-a1b7-f0a77a1e6577 ==============================
[0m12:36:20.615503 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:36:20.615744 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error': 'None', 'empty': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'debug': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/scohen/.dbt', 'fail_fast': 'False', 'invocation_command': 'dbt test --select Airport_Concessions', 'indirect_selection': 'eager', 'static_parser': 'True', 'introspect': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80'}
[0m12:36:21.438784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff3036cb-c0de-4ea3-a1b7-f0a77a1e6577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879cc30>]}
[0m12:36:21.458180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff3036cb-c0de-4ea3-a1b7-f0a77a1e6577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2be360>]}
[0m12:36:21.458390 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:36:21.534111 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:36:21.582392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:36:21.582761 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m12:36:21.714807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff3036cb-c0de-4ea3-a1b7-f0a77a1e6577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbb4d50>]}
[0m12:36:21.829335 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:36:21.830298 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:36:21.840585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff3036cb-c0de-4ea3-a1b7-f0a77a1e6577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcddd60>]}
[0m12:36:21.840775 [info ] [MainThread]: Found 49 models, 29 data tests, 9 sources, 630 macros
[0m12:36:21.840907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff3036cb-c0de-4ea3-a1b7-f0a77a1e6577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc0f150>]}
[0m12:36:21.841760 [info ] [MainThread]: 
[0m12:36:21.841891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:21.841986 [info ] [MainThread]: 
[0m12:36:21.842178 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:36:21.844431 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_int'
[0m12:36:21.844593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:22.149903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:36:22.151054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:22.408884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m12:36:22.412155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:22.700731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:36:22.702683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:22.985110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff3036cb-c0de-4ea3-a1b7-f0a77a1e6577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fce32b0>]}
[0m12:36:22.985916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:36:22.990733 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:36:22.991253 [info ] [Thread-1 (]: 1 of 2 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m12:36:22.991660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m12:36:22.991992 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:36:23.003328 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m12:36:23.003917 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:36:23.017609 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m12:36:23.018141 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airport_icao, terminal, business, location
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    group by airport_icao, terminal, business, location
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:36:23.018381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:23.616629 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9d508f28-fcc7-4af6-b1d1-fa5d32902b1d&page=queryresults
[0m12:36:24.127221 [info ] [Thread-1 (]: 1 of 2 PASS dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[32mPASS[0m in 1.14s]
[0m12:36:24.128243 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m12:36:24.128689 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m12:36:24.129180 [info ] [Thread-1 (]: 2 of 2 START test relationships_Airport_Concessions_airport_icao__icao__ref_Airport_  [RUN]
[0m12:36:24.129752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1)
[0m12:36:24.130133 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m12:36:24.134801 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"
[0m12:36:24.135595 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m12:36:24.137832 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"
[0m12:36:24.138387 [debug] [Thread-1 (]: On test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:36:24.138704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:24.845017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:40284ebc-7a6d-4b06-b14d-724145007648&page=queryresults
[0m12:36:25.459833 [info ] [Thread-1 (]: 2 of 2 PASS relationships_Airport_Concessions_airport_icao__icao__ref_Airport_ . [[32mPASS[0m in 1.33s]
[0m12:36:25.460863 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m12:36:25.462416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:36:25.464698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:25.465112 [debug] [MainThread]: Connection 'test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1' was properly closed.
[0m12:36:25.465454 [info ] [MainThread]: 
[0m12:36:25.465799 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m12:36:25.466586 [debug] [MainThread]: Command end result
[0m12:36:25.497877 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:36:25.498957 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:36:25.501446 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:36:25.501604 [info ] [MainThread]: 
[0m12:36:25.501787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:25.501915 [info ] [MainThread]: 
[0m12:36:25.502045 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:36:25.504301 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.913571, "process_in_blocks": "0", "process_kernel_time": 0.263961, "process_mem_max_rss": "394772480", "process_out_blocks": "0", "process_user_time": 1.927172}
[0m12:36:25.504493 [debug] [MainThread]: Command `dbt test` succeeded at 12:36:25.504456 after 4.91 seconds
[0m12:36:25.504647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109348ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb950d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb968e0>]}
[0m12:36:25.504795 [debug] [MainThread]: Flushing usage events
[0m12:36:25.710945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:18.605903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ef750>]}


============================== 12:39:18.607523 | b09015e3-0823-4735-9378-34960042238d ==============================
[0m12:39:18.607523 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:39:18.607769 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt test --select Flight_Delays', 'fail_fast': 'False', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'indirect_selection': 'eager'}
[0m12:39:19.432736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b09015e3-0823-4735-9378-34960042238d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a648c30>]}
[0m12:39:19.452253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b09015e3-0823-4735-9378-34960042238d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212c2360>]}
[0m12:39:19.452459 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:39:19.530716 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:39:19.569686 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'columns' in "<unicode string>", line 64, column 5 in file
`models/int/schema.yml`
[0m12:39:19.569880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b09015e3-0823-4735-9378-34960042238d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216df550>]}
[0m12:39:19.580404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:39:19.580877 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m12:39:19.718676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b09015e3-0823-4735-9378-34960042238d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a327b0>]}
[0m12:39:19.835476 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:39:19.836469 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:39:19.846930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b09015e3-0823-4735-9378-34960042238d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214fac10>]}
[0m12:39:19.847121 [info ] [MainThread]: Found 49 models, 30 data tests, 9 sources, 630 macros
[0m12:39:19.847260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b09015e3-0823-4735-9378-34960042238d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b475f0>]}
[0m12:39:19.848088 [info ] [MainThread]: 
[0m12:39:19.848214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:19.848309 [info ] [MainThread]: 
[0m12:39:19.848491 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:39:19.850759 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_mrt'
[0m12:39:19.850904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:20.127091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:39:20.127887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:20.402318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:39:20.404700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:20.669554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:39:20.671971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:20.997000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b09015e3-0823-4735-9378-34960042238d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12196fc50>]}
[0m12:39:20.997715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:21.001611 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:39:21.001981 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [RUN]
[0m12:39:21.002356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m12:39:21.002650 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:39:21.013166 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m12:39:21.013821 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:39:21.027367 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m12:39:21.027883 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_month, airline_id, airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    group by event_month, airline_id, airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:39:21.028119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:21.589908 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:90f73508-d5f7-42ef-a1da-97f03625cb77&page=queryresults
[0m12:39:22.464877 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [[32mPASS[0m in 1.46s]
[0m12:39:22.465780 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:39:22.466219 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m12:39:22.466700 [info ] [Thread-1 (]: 2 of 3 START test relationships_Flight_Delays_airline_id__id__ref_Airline_ ..... [RUN]
[0m12:39:22.467239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3)
[0m12:39:22.467596 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m12:39:22.471969 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m12:39:22.472834 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m12:39:22.474948 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m12:39:22.475637 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:39:22.475938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:23.126001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:21607d04-0983-47c2-b2d3-300039fea8d9&page=queryresults
[0m12:39:23.548775 [info ] [Thread-1 (]: 2 of 3 PASS relationships_Flight_Delays_airline_id__id__ref_Airline_ ........... [[32mPASS[0m in 1.08s]
[0m12:39:23.550029 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m12:39:23.550683 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m12:39:23.551199 [info ] [Thread-1 (]: 3 of 3 START test relationships_Flight_Delays_airport_icao__icao__ref_Airport_ . [RUN]
[0m12:39:23.551779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3, now test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4)
[0m12:39:23.552168 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m12:39:23.556683 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"
[0m12:39:23.557540 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m12:39:23.559879 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"
[0m12:39:23.560606 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:39:23.560910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:24.148346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e07d3e2e-f45b-430e-9b99-0bd66d2db592&page=queryresults
[0m12:39:24.578008 [info ] [Thread-1 (]: 3 of 3 PASS relationships_Flight_Delays_airport_icao__icao__ref_Airport_ ....... [[32mPASS[0m in 1.03s]
[0m12:39:24.578664 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m12:39:24.579755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:24.581240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:24.581523 [debug] [MainThread]: Connection 'test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4' was properly closed.
[0m12:39:24.581774 [info ] [MainThread]: 
[0m12:39:24.582051 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m12:39:24.582877 [debug] [MainThread]: Command end result
[0m12:39:24.614103 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:39:24.615408 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:39:24.618931 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:39:24.619084 [info ] [MainThread]: 
[0m12:39:24.619253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:24.619380 [info ] [MainThread]: 
[0m12:39:24.619532 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:39:24.619767 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:39:24.622170 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.0396934, "process_in_blocks": "0", "process_kernel_time": 0.270356, "process_mem_max_rss": "394674176", "process_out_blocks": "0", "process_user_time": 1.999886}
[0m12:39:24.622387 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:24.622344 after 6.04 seconds
[0m12:39:24.622628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b9e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b86a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b86c10>]}
[0m12:39:24.622786 [debug] [MainThread]: Flushing usage events
[0m12:39:24.828463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:44.601264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ec6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109037750>]}


============================== 12:40:44.602853 | fc49225d-d412-4ac8-ae68-b99823b01655 ==============================
[0m12:40:44.602853 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:40:44.603097 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'invocation_command': 'dbt test --select Flight_Delays', 'profiles_dir': '/Users/scohen/.dbt', 'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'partial_parse': 'True', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'printer_width': '80'}
[0m12:40:45.434362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc49225d-d412-4ac8-ae68-b99823b01655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108390c30>]}
[0m12:40:45.453760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc49225d-d412-4ac8-ae68-b99823b01655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eebe360>]}
[0m12:40:45.453967 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:40:45.530423 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:40:45.578971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:45.579403 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m12:40:45.711394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc49225d-d412-4ac8-ae68-b99823b01655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7b8f50>]}
[0m12:40:45.827034 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:40:45.827949 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:40:45.838351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc49225d-d412-4ac8-ae68-b99823b01655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f75e120>]}
[0m12:40:45.838543 [info ] [MainThread]: Found 49 models, 32 data tests, 9 sources, 630 macros
[0m12:40:45.838675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc49225d-d412-4ac8-ae68-b99823b01655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f80ef90>]}
[0m12:40:45.839545 [info ] [MainThread]: 
[0m12:40:45.839676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:45.839770 [info ] [MainThread]: 
[0m12:40:45.839954 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:40:45.842225 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_tmp'
[0m12:40:45.842379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:46.160953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m12:40:46.162938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:46.439860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:40:46.441513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:46.709689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:40:46.711880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:47.013124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc49225d-d412-4ac8-ae68-b99823b01655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f79e000>]}
[0m12:40:47.013791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:47.017824 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:40:47.018232 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [RUN]
[0m12:40:47.018623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m12:40:47.018923 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:40:47.030356 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m12:40:47.030995 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:40:47.044174 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m12:40:47.044900 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_month, airline_id, airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    group by event_month, airline_id, airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:40:47.045151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:47.487822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:69bbfcb9-5ac2-4509-8eb7-254c8d86c17d&page=queryresults
[0m12:40:47.997110 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [[32mPASS[0m in 0.98s]
[0m12:40:47.997856 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m12:40:47.998214 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m12:40:47.998606 [info ] [Thread-1 (]: 2 of 3 START test relationships_Flight_Delays_airline_id__id__ref_Airline_ ..... [RUN]
[0m12:40:47.999015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3)
[0m12:40:47.999289 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m12:40:48.003496 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m12:40:48.004231 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m12:40:48.006083 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m12:40:48.006582 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:40:48.006869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:48.532756 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:64028597-317a-4827-9739-702449809777&page=queryresults
[0m12:40:48.970456 [info ] [Thread-1 (]: 2 of 3 PASS relationships_Flight_Delays_airline_id__id__ref_Airline_ ........... [[32mPASS[0m in 0.97s]
[0m12:40:48.971460 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m12:40:48.971983 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m12:40:48.972499 [info ] [Thread-1 (]: 3 of 3 START test relationships_Flight_Delays_airport_icao__icao__ref_Airport_ . [RUN]
[0m12:40:48.972994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3, now test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4)
[0m12:40:48.973332 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m12:40:48.978641 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"
[0m12:40:48.979615 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m12:40:48.981992 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"
[0m12:40:48.982639 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:40:48.982978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:49.553740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:537cfe0b-6f37-4080-b026-13f9cd05305d&page=queryresults
[0m12:40:49.944505 [info ] [Thread-1 (]: 3 of 3 PASS relationships_Flight_Delays_airport_icao__icao__ref_Airport_ ....... [[32mPASS[0m in 0.97s]
[0m12:40:49.945487 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m12:40:49.947103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:49.949520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:49.950026 [debug] [MainThread]: Connection 'test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4' was properly closed.
[0m12:40:49.950383 [info ] [MainThread]: 
[0m12:40:49.950689 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m12:40:49.951614 [debug] [MainThread]: Command end result
[0m12:40:49.983281 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:40:49.984531 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:40:49.987820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:40:49.987967 [info ] [MainThread]: 
[0m12:40:49.988136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:49.988261 [info ] [MainThread]: 
[0m12:40:49.988404 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:40:49.990721 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.412898, "process_in_blocks": "0", "process_kernel_time": 0.276914, "process_mem_max_rss": "395919360", "process_out_blocks": "0", "process_user_time": 2.015367}
[0m12:40:49.990929 [debug] [MainThread]: Command `dbt test` succeeded at 12:40:49.990888 after 5.41 seconds
[0m12:40:49.991102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f3ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f756ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f754470>]}
[0m12:40:49.991260 [debug] [MainThread]: Flushing usage events
[0m12:40:50.200857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:35.121542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5806e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3cb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3cb750>]}


============================== 12:48:35.123131 | 4c2805fa-822a-4ab0-9058-7d6b06c10baa ==============================
[0m12:48:35.123131 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:48:35.123380 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'target_path': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'debug': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'empty': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select Flight_Routes', 'use_colors': 'True', 'log_format': 'default'}
[0m12:48:35.949920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c2805fa-822a-4ab0-9058-7d6b06c10baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c724c30>]}
[0m12:48:35.969849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c2805fa-822a-4ab0-9058-7d6b06c10baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233c6360>]}
[0m12:48:35.970089 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:48:36.045341 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:48:36.094026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:48:36.094419 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m12:48:36.230905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c2805fa-822a-4ab0-9058-7d6b06c10baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cc1150>]}
[0m12:48:36.347407 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:48:36.348332 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:48:36.358966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c2805fa-822a-4ab0-9058-7d6b06c10baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ca6030>]}
[0m12:48:36.359151 [info ] [MainThread]: Found 49 models, 35 data tests, 9 sources, 630 macros
[0m12:48:36.359287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c2805fa-822a-4ab0-9058-7d6b06c10baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b7bd90>]}
[0m12:48:36.360135 [info ] [MainThread]: 
[0m12:48:36.360276 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:36.360376 [info ] [MainThread]: 
[0m12:48:36.360563 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:48:36.362869 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m12:48:36.363025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:36.653352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m12:48:36.654304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:36.931443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:48:36.933230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:37.228334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:48:37.230490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:37.538485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c2805fa-822a-4ab0-9058-7d6b06c10baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c92000>]}
[0m12:48:37.539128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:37.543154 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m12:48:37.543518 [info ] [Thread-1 (]: 1 of 4 START test dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [RUN]
[0m12:48:37.543887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m12:48:37.544181 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m12:48:37.554712 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m12:48:37.555376 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m12:48:37.568890 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m12:48:37.569420 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    group by airline_id, source_airport_icao, dest_airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m12:48:37.569651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:38.150338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:66b085fb-5a66-47ec-8180-359b7cb40b8a&page=queryresults
[0m12:48:38.606904 [info ] [Thread-1 (]: 1 of 4 PASS dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [[32mPASS[0m in 1.06s]
[0m12:48:38.607534 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m12:48:38.607817 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m12:48:38.608137 [info ] [Thread-1 (]: 2 of 4 START test relationships_Flight_Routes_airline_id__id__ref_Airline_ ..... [RUN]
[0m12:48:38.608495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e)
[0m12:48:38.608750 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m12:48:38.612265 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m12:48:38.612834 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m12:48:38.614492 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m12:48:38.614939 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:48:38.615186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:39.172302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f3503576-4ab7-4968-86c5-f50547c385ce&page=queryresults
[0m12:48:39.592792 [error] [Thread-1 (]: 2 of 4 FAIL 13227 relationships_Flight_Routes_airline_id__id__ref_Airline_ ..... [[31mFAIL 13227[0m in 0.98s]
[0m12:48:39.593804 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m12:48:39.594323 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m12:48:39.594823 [info ] [Thread-1 (]: 3 of 4 START test relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_  [RUN]
[0m12:48:39.595515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e, now test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052)
[0m12:48:39.596200 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m12:48:39.601259 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m12:48:39.602101 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m12:48:39.604413 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m12:48:39.605028 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dest_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where dest_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:48:39.605340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:40.196589 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:cf2c6bc0-7719-4aa8-8583-114634f40250&page=queryresults
[0m12:48:40.699095 [info ] [Thread-1 (]: 3 of 4 PASS relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_ .. [[32mPASS[0m in 1.10s]
[0m12:48:40.700145 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m12:48:40.700660 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m12:48:40.701115 [info ] [Thread-1 (]: 4 of 4 START test relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_  [RUN]
[0m12:48:40.701619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052, now test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df)
[0m12:48:40.701969 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m12:48:40.707275 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m12:48:40.708342 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m12:48:40.714195 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m12:48:40.714930 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select source_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where source_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:48:40.715253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:41.323242 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4c8ce6b5-555e-4b69-8286-6912c4022a9c&page=queryresults
[0m12:48:41.732982 [info ] [Thread-1 (]: 4 of 4 PASS relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 1.03s]
[0m12:48:41.733716 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m12:48:41.735250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:41.736962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:41.737226 [debug] [MainThread]: Connection 'test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df' was properly closed.
[0m12:48:41.737481 [info ] [MainThread]: 
[0m12:48:41.737736 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m12:48:41.738874 [debug] [MainThread]: Command end result
[0m12:48:41.770904 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:48:41.772131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:48:41.775559 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:48:41.775708 [info ] [MainThread]: 
[0m12:48:41.775870 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:48:41.776006 [info ] [MainThread]: 
[0m12:48:41.776170 [error] [MainThread]: [31mFailure in test relationships_Flight_Routes_airline_id__id__ref_Airline_ (models/int/schema.yml)[0m
[0m12:48:41.776324 [error] [MainThread]:   Got 13227 results, configured to fail if != 0
[0m12:48:41.776437 [info ] [MainThread]: 
[0m12:48:41.776579 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/schema.yml/relationships_Flight_Routes_airline_id__id__ref_Airline_.sql
[0m12:48:41.776698 [info ] [MainThread]: 
[0m12:48:41.776834 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m12:48:41.779225 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.6811037, "process_in_blocks": "0", "process_kernel_time": 0.271907, "process_mem_max_rss": "394854400", "process_out_blocks": "0", "process_user_time": 2.082476}
[0m12:48:41.779426 [debug] [MainThread]: Command `dbt test` failed at 12:48:41.779386 after 6.68 seconds
[0m12:48:41.779600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2d0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c58730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c59bd0>]}
[0m12:48:41.779757 [debug] [MainThread]: Flushing usage events
[0m12:48:41.986290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:27.898505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6686e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4b39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4b3750>]}


============================== 12:51:27.900110 | 158f46ef-f9e7-453e-b544-68fca275d6b5 ==============================
[0m12:51:27.900110 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m12:51:27.900350 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --select Airline', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'False', 'partial_parse': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'debug': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True'}
[0m12:51:28.726632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '158f46ef-f9e7-453e-b544-68fca275d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c80cc30>]}
[0m12:51:28.746060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '158f46ef-f9e7-453e-b544-68fca275d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233be360>]}
[0m12:51:28.746267 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:51:28.822708 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m12:51:28.871680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:28.871836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:28.888479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '158f46ef-f9e7-453e-b544-68fca275d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237daf50>]}
[0m12:51:28.924123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:51:28.924930 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:51:28.932539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '158f46ef-f9e7-453e-b544-68fca275d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238db7a0>]}
[0m12:51:28.932715 [info ] [MainThread]: Found 49 models, 35 data tests, 9 sources, 630 macros
[0m12:51:28.932842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158f46ef-f9e7-453e-b544-68fca275d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a63310>]}
[0m12:51:28.933698 [info ] [MainThread]: 
[0m12:51:28.933825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:28.933916 [info ] [MainThread]: 
[0m12:51:28.934095 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:51:28.934438 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m12:51:28.934604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:29.374824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m12:51:29.375386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:29.649253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m12:51:29.653027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:29.968866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_stg)
[0m12:51:29.970396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:30.273269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m12:51:30.275188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:30.560826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158f46ef-f9e7-453e-b544-68fca275d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c8a340>]}
[0m12:51:30.561559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:30.565362 [debug] [Thread-1 (]: Began running node model.air_travel.Airline
[0m12:51:30.565857 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airline ........................ [RUN]
[0m12:51:30.566168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.Airline)
[0m12:51:30.566407 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airline
[0m12:51:30.573159 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airline"
[0m12:51:30.573707 [debug] [Thread-1 (]: Began executing node model.air_travel.Airline
[0m12:51:30.581987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:30.862404 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airline"
[0m12:51:30.863165 [debug] [Thread-1 (]: On model.air_travel.Airline: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airline"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
      
    
    

    
    OPTIONS()
    as (
      with airline_country_joined as (
  select a.id, a.name, a.alias, a.icao, a.iata, a.callsign, 
    a.country as country_name, c.iso_code as country_code, a.active, 
    a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines` a left join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null 
),
Airline as (
    select acj.id, acj.name, acj.alias, acj.icao, acj.iata, acj.callsign, 
        amc.mapped_iso_code as country_code, 
        acj.active, acj._data_source, acj._load_time 
    from airline_country_joined acj join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped` amc
    on acj.country_name = amc.original_country
    where acj.country_code is null
    and acj.country_name is not null
)

select *
from Airline
    );
  
[0m12:51:31.308747 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:795e6c4d-389d-4bb5-9d0d-27a831fbdb5c&page=queryresults
[0m12:51:33.112711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158f46ef-f9e7-453e-b544-68fca275d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c81a90>]}
[0m12:51:33.113159 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Airline ................... [[32mCREATE TABLE (0.0 rows, 473.4 KiB processed)[0m in 2.55s]
[0m12:51:33.113506 [debug] [Thread-1 (]: Finished running node model.air_travel.Airline
[0m12:51:33.114297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:33.115329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:33.115502 [debug] [MainThread]: Connection 'model.air_travel.Airline' was properly closed.
[0m12:51:33.115662 [info ] [MainThread]: 
[0m12:51:33.115839 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.18 seconds (4.18s).
[0m12:51:33.116205 [debug] [MainThread]: Command end result
[0m12:51:33.139131 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m12:51:33.140188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m12:51:33.142857 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m12:51:33.142990 [info ] [MainThread]: 
[0m12:51:33.143161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:33.143285 [info ] [MainThread]: 
[0m12:51:33.143421 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:51:33.145461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.27025, "process_in_blocks": "0", "process_kernel_time": 0.262146, "process_mem_max_rss": "390463488", "process_out_blocks": "0", "process_user_time": 1.755416}
[0m12:51:33.145648 [debug] [MainThread]: Command `dbt run` succeeded at 12:51:33.145612 after 5.27 seconds
[0m12:51:33.145791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b4e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10992c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235277f0>]}
[0m12:51:33.145930 [debug] [MainThread]: Flushing usage events
[0m12:51:33.373688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:12.788063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085946e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093df9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093df750>]}


============================== 13:01:12.789699 | 3d41df10-2ee0-476e-8345-fc738d6e3af6 ==============================
[0m13:01:12.789699 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:01:12.789940 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select Airline', 'log_cache_events': 'False', 'no_print': 'None', 'debug': 'False', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'False', 'version_check': 'True', 'fail_fast': 'False', 'write_json': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:01:13.687660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d41df10-2ee0-476e-8345-fc738d6e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108738c30>]}
[0m13:01:13.709403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d41df10-2ee0-476e-8345-fc738d6e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2be360>]}
[0m13:01:13.709714 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:01:13.786005 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:01:13.835097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:01:13.835451 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Flight_Delays.sql
[0m13:01:13.835590 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Flight_Routes.sql
[0m13:01:13.835682 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Airline.sql
[0m13:01:13.986668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d41df10-2ee0-476e-8345-fc738d6e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbbd750>]}
[0m13:01:14.114338 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:01:14.115354 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:01:14.123374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d41df10-2ee0-476e-8345-fc738d6e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7d77a0>]}
[0m13:01:14.123592 [info ] [MainThread]: Found 49 models, 35 data tests, 9 sources, 630 macros
[0m13:01:14.123726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d41df10-2ee0-476e-8345-fc738d6e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fad2c10>]}
[0m13:01:14.124608 [info ] [MainThread]: 
[0m13:01:14.124732 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:14.124824 [info ] [MainThread]: 
[0m13:01:14.125009 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:01:14.125350 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:01:14.125511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:14.565752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:01:14.566312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:14.846511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:01:14.847585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:15.126491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:01:15.129156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:15.385305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m13:01:15.387253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:15.666650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d41df10-2ee0-476e-8345-fc738d6e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd47110>]}
[0m13:01:15.667065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:15.669494 [debug] [Thread-1 (]: Began running node model.air_travel.Airline
[0m13:01:15.669880 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Airline ........................ [RUN]
[0m13:01:15.670182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now model.air_travel.Airline)
[0m13:01:15.670404 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airline
[0m13:01:15.675320 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airline"
[0m13:01:15.675782 [debug] [Thread-1 (]: Began executing node model.air_travel.Airline
[0m13:01:15.683972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:15.975884 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Airline"
[0m13:01:15.976605 [debug] [Thread-1 (]: On model.air_travel.Airline: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Airline"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
      
    
    

    
    OPTIONS()
    as (
      with airline_country_joined as (
  select a.id, a.name, a.alias, a.icao, a.iata, a.callsign, 
    c.iso_code as country_code, a.active, 
    a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines` a join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on a.country = c.name
  where c.iso_code is not null 
),
airline_country_fuzzy_matches as (
  select a.id, a.name, a.alias, a.icao, a.iata, a.callsign, 
    c.iso_code as country_code, a.active, 
    a._data_source, a._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines` a join `cs378-fa2025`.`dbt_air_travel_tmp`.`tmp_airline_country_mapped` amc
  on a.country = amc.original_country
  join `cs378-fa2025`.`dbt_air_travel_int`.`Country` c
  on amc.mapped_iso_code = c.iso_code
  where c.iso_code is not null
)

select *
from airline_country_joined
union distinct
select * 
from airline_country_fuzzy_matches
    );
  
[0m13:01:16.399557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0a89e9a8-c992-45dc-bf51-cb448d595d30&page=queryresults
[0m13:01:18.647158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d41df10-2ee0-476e-8345-fc738d6e3af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcae2d0>]}
[0m13:01:18.647813 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Airline ................... [[32mCREATE TABLE (6.0k rows, 473.4 KiB processed)[0m in 2.98s]
[0m13:01:18.648275 [debug] [Thread-1 (]: Finished running node model.air_travel.Airline
[0m13:01:18.649356 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:18.650541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:18.650713 [debug] [MainThread]: Connection 'model.air_travel.Airline' was properly closed.
[0m13:01:18.650892 [info ] [MainThread]: 
[0m13:01:18.651091 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m13:01:18.651522 [debug] [MainThread]: Command end result
[0m13:01:18.677960 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:01:18.678991 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:01:18.681568 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:01:18.681690 [info ] [MainThread]: 
[0m13:01:18.681849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:18.681964 [info ] [MainThread]: 
[0m13:01:18.682098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:01:18.684286 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9200425, "process_in_blocks": "0", "process_kernel_time": 0.28436, "process_mem_max_rss": "394166272", "process_out_blocks": "0", "process_user_time": 2.007771}
[0m13:01:18.684478 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:18.684441 after 5.92 seconds
[0m13:01:18.684623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcdfac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093aacb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ab610>]}
[0m13:01:18.684763 [debug] [MainThread]: Flushing usage events
[0m13:01:18.891424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:51.325817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b833750>]}


============================== 13:01:51.327432 | b17d8255-7ccc-43f1-9c8c-55494bb9f865 ==============================
[0m13:01:51.327432 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:01:51.327672 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'fail_fast': 'False', 'partial_parse': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --select Airline', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'static_parser': 'True'}
[0m13:01:52.150229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b17d8255-7ccc-43f1-9c8c-55494bb9f865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab8cc30>]}
[0m13:01:52.170059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b17d8255-7ccc-43f1-9c8c-55494bb9f865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12183e360>]}
[0m13:01:52.170292 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:01:52.247780 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:01:52.297565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:52.297732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:52.314439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b17d8255-7ccc-43f1-9c8c-55494bb9f865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c5bd50>]}
[0m13:01:52.350205 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:01:52.351002 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:01:52.361762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b17d8255-7ccc-43f1-9c8c-55494bb9f865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220ed6d0>]}
[0m13:01:52.361936 [info ] [MainThread]: Found 49 models, 35 data tests, 9 sources, 630 macros
[0m13:01:52.362066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17d8255-7ccc-43f1-9c8c-55494bb9f865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12205ec10>]}
[0m13:01:52.362945 [info ] [MainThread]: 
[0m13:01:52.363071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:52.363166 [info ] [MainThread]: 
[0m13:01:52.363347 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:01:52.365589 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_mrt'
[0m13:01:52.365747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:52.624099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:01:52.625591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:52.910927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:01:52.912333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:53.266971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:01:53.269932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:53.532895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17d8255-7ccc-43f1-9c8c-55494bb9f865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220b69c0>]}
[0m13:01:53.533723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:53.538631 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:01:53.539203 [info ] [Thread-1 (]: 1 of 5 START test not_null_Airline_id .......................................... [RUN]
[0m13:01:53.539635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m13:01:53.539935 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:01:53.554262 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m13:01:53.554884 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:01:53.567432 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m13:01:53.567904 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m13:01:53.568130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:54.138526 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:666ccafd-40f5-4189-ab99-8d5e3ac3f024&page=queryresults
[0m13:01:54.561991 [info ] [Thread-1 (]: 1 of 5 PASS not_null_Airline_id ................................................ [[32mPASS[0m in 1.02s]
[0m13:01:54.562866 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:01:54.563279 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:01:54.563766 [info ] [Thread-1 (]: 2 of 5 START test relationships_Airline_country_code__iso_code__ref_Country_ ... [RUN]
[0m13:01:54.564221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26)
[0m13:01:54.564552 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:01:54.571365 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m13:01:54.572192 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:01:54.574355 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m13:01:54.574894 [debug] [Thread-1 (]: On test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:01:54.575179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:55.106258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8a819f7c-287b-4c44-a814-c4e954f97e90&page=queryresults
[0m13:01:55.499957 [info ] [Thread-1 (]: 2 of 5 PASS relationships_Airline_country_code__iso_code__ref_Country_ ......... [[32mPASS[0m in 0.94s]
[0m13:01:55.500920 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:01:55.501336 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:01:55.501797 [info ] [Thread-1 (]: 3 of 5 START test relationships_Flight_Delays_airline_id__id__ref_Airline_ ..... [RUN]
[0m13:01:55.502348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26, now test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3)
[0m13:01:55.502717 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:01:55.507553 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m13:01:55.508418 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:01:55.510506 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m13:01:55.510975 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:01:55.511252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:56.038727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:20c4c8f9-8452-4851-b48d-a7f2b2fee9cb&page=queryresults
[0m13:01:56.463976 [info ] [Thread-1 (]: 3 of 5 PASS relationships_Flight_Delays_airline_id__id__ref_Airline_ ........... [[32mPASS[0m in 0.96s]
[0m13:01:56.465004 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:01:56.465452 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:01:56.465875 [info ] [Thread-1 (]: 4 of 5 START test relationships_Flight_Routes_airline_id__id__ref_Airline_ ..... [RUN]
[0m13:01:56.466359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3, now test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e)
[0m13:01:56.466700 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:01:56.471929 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m13:01:56.472879 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:01:56.475212 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m13:01:56.475918 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:01:56.476270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:57.026453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6425cc6e-6804-4fc0-bc4a-5ff1afcbcd57&page=queryresults
[0m13:01:57.411893 [error] [Thread-1 (]: 4 of 5 FAIL 376 relationships_Flight_Routes_airline_id__id__ref_Airline_ ....... [[31mFAIL 376[0m in 0.95s]
[0m13:01:57.412842 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:01:57.413254 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m13:01:57.413704 [info ] [Thread-1 (]: 5 of 5 START test unique_Airline_id ............................................ [RUN]
[0m13:01:57.414277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e, now test.air_travel.unique_Airline_id.cb196c2622)
[0m13:01:57.414654 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m13:01:57.420272 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m13:01:57.421110 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m13:01:57.423243 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m13:01:57.423750 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:01:57.424036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:57.920489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:25bc6d6f-3718-4d9d-ba67-ee777a34fb90&page=queryresults
[0m13:01:58.257175 [info ] [Thread-1 (]: 5 of 5 PASS unique_Airline_id .................................................. [[32mPASS[0m in 0.84s]
[0m13:01:58.258094 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m13:01:58.259624 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:58.261663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:58.261954 [debug] [MainThread]: Connection 'test.air_travel.unique_Airline_id.cb196c2622' was properly closed.
[0m13:01:58.262247 [info ] [MainThread]: 
[0m13:01:58.262649 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m13:01:58.263949 [debug] [MainThread]: Command end result
[0m13:01:58.380441 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:01:58.381228 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:01:58.383642 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:01:58.383747 [info ] [MainThread]: 
[0m13:01:58.383877 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:01:58.383981 [info ] [MainThread]: 
[0m13:01:58.384115 [error] [MainThread]: [31mFailure in test relationships_Flight_Routes_airline_id__id__ref_Airline_ (models/int/schema.yml)[0m
[0m13:01:58.384235 [error] [MainThread]:   Got 376 results, configured to fail if != 0
[0m13:01:58.384320 [info ] [MainThread]: 
[0m13:01:58.384431 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/schema.yml/relationships_Flight_Routes_airline_id__id__ref_Airline_.sql
[0m13:01:58.384525 [info ] [MainThread]: 
[0m13:01:58.384637 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m13:01:58.386358 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 7.084199, "process_in_blocks": "0", "process_kernel_time": 0.27682, "process_mem_max_rss": "391446528", "process_out_blocks": "0", "process_user_time": 2.044417}
[0m13:01:58.386507 [debug] [MainThread]: Command `dbt test` failed at 13:01:58.386478 after 7.08 seconds
[0m13:01:58.386634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b738a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ffe8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ffe6d0>]}
[0m13:01:58.386749 [debug] [MainThread]: Flushing usage events
[0m13:01:58.569707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:17.960736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d4c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b979d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b97750>]}


============================== 13:02:17.962329 | 6377c4a4-3fbd-481c-a32f-62364f9b2251 ==============================
[0m13:02:17.962329 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:02:17.962574 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select Flight_Routes', 'debug': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True', 'write_json': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'use_colors': 'True', 'empty': 'None', 'log_cache_events': 'False'}
[0m13:02:18.796333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6377c4a4-3fbd-481c-a32f-62364f9b2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef0c30>]}
[0m13:02:18.815742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6377c4a4-3fbd-481c-a32f-62364f9b2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbbe360>]}
[0m13:02:18.815944 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:02:18.892241 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:02:18.943907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:18.944113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:18.961450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6377c4a4-3fbd-481c-a32f-62364f9b2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ffdbd50>]}
[0m13:02:18.997622 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:02:18.998442 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:02:19.009297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6377c4a4-3fbd-481c-a32f-62364f9b2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204696d0>]}
[0m13:02:19.009472 [info ] [MainThread]: Found 49 models, 35 data tests, 9 sources, 630 macros
[0m13:02:19.009601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6377c4a4-3fbd-481c-a32f-62364f9b2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203dac10>]}
[0m13:02:19.010482 [info ] [MainThread]: 
[0m13:02:19.010606 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:02:19.010697 [info ] [MainThread]: 
[0m13:02:19.010880 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:02:19.013107 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_int'
[0m13:02:19.013254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:19.262240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:02:19.263373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:19.497458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m13:02:19.498252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:19.744747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:02:19.746292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:19.996876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6377c4a4-3fbd-481c-a32f-62364f9b2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204329c0>]}
[0m13:02:19.997411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:20.000994 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:02:20.001302 [info ] [Thread-1 (]: 1 of 4 START test dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [RUN]
[0m13:02:20.001615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m13:02:20.001855 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:02:20.015525 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m13:02:20.016023 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:02:20.028490 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m13:02:20.029021 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    group by airline_id, source_airport_icao, dest_airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:02:20.029243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:20.604587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:564c8611-2815-4339-882c-5b12614d101b&page=queryresults
[0m13:02:21.087786 [info ] [Thread-1 (]: 1 of 4 PASS dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [[32mPASS[0m in 1.09s]
[0m13:02:21.088458 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:02:21.088745 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:02:21.089064 [info ] [Thread-1 (]: 2 of 4 START test relationships_Flight_Routes_airline_id__id__ref_Airline_ ..... [RUN]
[0m13:02:21.089432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e)
[0m13:02:21.089680 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:02:21.095038 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m13:02:21.095509 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:02:21.097320 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m13:02:21.098033 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:02:21.098300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:21.525529 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:806fdbc5-abb0-4c62-94e9-6ad01f503fdb&page=queryresults
[0m13:02:21.855922 [error] [Thread-1 (]: 2 of 4 FAIL 376 relationships_Flight_Routes_airline_id__id__ref_Airline_ ....... [[31mFAIL 376[0m in 0.77s]
[0m13:02:21.856904 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:02:21.857361 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:02:21.857806 [info ] [Thread-1 (]: 3 of 4 START test relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_  [RUN]
[0m13:02:21.858287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e, now test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052)
[0m13:02:21.858625 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:02:21.864250 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m13:02:21.865284 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:02:21.867825 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m13:02:21.868547 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dest_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where dest_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:02:21.868905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:22.344713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9e967eaf-59a1-4dad-bab0-0f923ea79698&page=queryresults
[0m13:02:22.798090 [info ] [Thread-1 (]: 3 of 4 PASS relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_ .. [[32mPASS[0m in 0.94s]
[0m13:02:22.799136 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:02:22.799503 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:02:22.799899 [info ] [Thread-1 (]: 4 of 4 START test relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_  [RUN]
[0m13:02:22.800390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052, now test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df)
[0m13:02:22.800721 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:02:22.805194 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m13:02:22.806007 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:02:22.808196 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m13:02:22.808793 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select source_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where source_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:02:22.809074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:23.234320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:501aea66-b0fa-4f8f-8a0f-9a0fce1f645b&page=queryresults
[0m13:02:23.636064 [info ] [Thread-1 (]: 4 of 4 PASS relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 0.84s]
[0m13:02:23.637103 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:02:23.638691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:02:23.640958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:23.641476 [debug] [MainThread]: Connection 'test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df' was properly closed.
[0m13:02:23.641816 [info ] [MainThread]: 
[0m13:02:23.642147 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m13:02:23.643202 [debug] [MainThread]: Command end result
[0m13:02:23.754601 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:02:23.755423 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:02:23.757911 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:02:23.758020 [info ] [MainThread]: 
[0m13:02:23.758149 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:02:23.758255 [info ] [MainThread]: 
[0m13:02:23.758386 [error] [MainThread]: [31mFailure in test relationships_Flight_Routes_airline_id__id__ref_Airline_ (models/int/schema.yml)[0m
[0m13:02:23.758507 [error] [MainThread]:   Got 376 results, configured to fail if != 0
[0m13:02:23.758597 [info ] [MainThread]: 
[0m13:02:23.758709 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/schema.yml/relationships_Flight_Routes_airline_id__id__ref_Airline_.sql
[0m13:02:23.758803 [info ] [MainThread]: 
[0m13:02:23.758914 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m13:02:23.760609 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.8231163, "process_in_blocks": "0", "process_kernel_time": 0.25288, "process_mem_max_rss": "390103040", "process_out_blocks": "0", "process_user_time": 1.954345}
[0m13:02:23.760756 [debug] [MainThread]: Command `dbt test` failed at 13:02:23.760728 after 5.82 seconds
[0m13:02:23.760883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120386ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203876a0>]}
[0m13:02:23.760995 [debug] [MainThread]: Flushing usage events
[0m13:02:23.947201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:53.480694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b743750>]}


============================== 13:05:53.482295 | 38b39e6a-2775-4f0a-a3eb-72c39eb2c921 ==============================
[0m13:05:53.482295 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:05:53.482544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select Flight_Routes', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error': 'None', 'write_json': 'True', 'target_path': 'None', 'empty': 'False', 'introspect': 'True', 'no_print': 'None'}
[0m13:05:54.307972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38b39e6a-2775-4f0a-a3eb-72c39eb2c921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9cc30>]}
[0m13:05:54.327456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38b39e6a-2775-4f0a-a3eb-72c39eb2c921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215be360>]}
[0m13:05:54.327658 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:05:54.407807 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:05:54.456807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:05:54.457110 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Flight_Routes.sql
[0m13:05:54.592830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38b39e6a-2775-4f0a-a3eb-72c39eb2c921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ec0e50>]}
[0m13:05:54.708099 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:05:54.709019 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:05:54.716186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38b39e6a-2775-4f0a-a3eb-72c39eb2c921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ae37a0>]}
[0m13:05:54.716362 [info ] [MainThread]: Found 49 models, 35 data tests, 9 sources, 630 macros
[0m13:05:54.716487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38b39e6a-2775-4f0a-a3eb-72c39eb2c921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121dcadd0>]}
[0m13:05:54.717298 [info ] [MainThread]: 
[0m13:05:54.717419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:54.717510 [info ] [MainThread]: 
[0m13:05:54.717694 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:05:54.718026 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:05:54.718189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:55.143873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:05:55.144421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:55.477431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:05:55.480097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:55.766008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:05:55.769245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:56.076331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m13:05:56.079476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:56.366083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38b39e6a-2775-4f0a-a3eb-72c39eb2c921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122044530>]}
[0m13:05:56.366860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:56.371227 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Routes
[0m13:05:56.371879 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Flight_Routes .................. [RUN]
[0m13:05:56.372335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now model.air_travel.Flight_Routes)
[0m13:05:56.372633 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Routes
[0m13:05:56.379478 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Routes"
[0m13:05:56.380283 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Routes
[0m13:05:56.390661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:56.704880 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Flight_Routes"
[0m13:05:56.705646 [debug] [Thread-1 (]: On model.air_travel.Flight_Routes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Flight_Routes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
      
    
    

    
    OPTIONS()
    as (
      with Flight_Routes as (
  select distinct r.airline_id, a1.icao as source_airport_icao, 
    a2.icao as dest_airport_icao, r.codeshare, r.stops, r.equipment, 
    r._data_source, r._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes` r
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a
  on r.source_airport = a.iata and r.dest_airport = a.iata
)

select * 
from Flight_Routes
    );
  
[0m13:05:57.180977 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2183fa48-9d9b-431c-906e-2b74397a890b&page=queryresults
[0m13:05:57.309216 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2183fa48-9d9b-431c-906e-2b74397a890b&page=queryresults
[0m13:05:57.320141 [debug] [Thread-1 (]: Database Error in model Flight_Routes (models/int/Flight_Routes.sql)
  Unrecognized name: a1 at [15:33]
  compiled code at target/run/air_travel/models/int/Flight_Routes.sql
[0m13:05:57.321895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38b39e6a-2775-4f0a-a3eb-72c39eb2c921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fc65d0>]}
[0m13:05:57.322524 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_air_travel_int.Flight_Routes ......... [[31mERROR[0m in 0.95s]
[0m13:05:57.322966 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Routes
[0m13:05:57.323309 [debug] [Thread-4 (]: Marking all children of 'model.air_travel.Flight_Routes' to be skipped because of status 'error'.  Reason: Database Error in model Flight_Routes (models/int/Flight_Routes.sql)
  Unrecognized name: a1 at [15:33]
  compiled code at target/run/air_travel/models/int/Flight_Routes.sql.
[0m13:05:57.324612 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:57.325835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:57.326047 [debug] [MainThread]: Connection 'model.air_travel.Flight_Routes' was properly closed.
[0m13:05:57.326244 [info ] [MainThread]: 
[0m13:05:57.326452 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m13:05:57.326901 [debug] [MainThread]: Command end result
[0m13:05:57.354508 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:05:57.355597 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:05:57.358381 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:05:57.358563 [info ] [MainThread]: 
[0m13:05:57.358739 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:05:57.358891 [info ] [MainThread]: 
[0m13:05:57.359060 [error] [MainThread]: [31mFailure in model Flight_Routes (models/int/Flight_Routes.sql)[0m
[0m13:05:57.359219 [error] [MainThread]:   Database Error in model Flight_Routes (models/int/Flight_Routes.sql)
  Unrecognized name: a1 at [15:33]
  compiled code at target/run/air_travel/models/int/Flight_Routes.sql
[0m13:05:57.359330 [info ] [MainThread]: 
[0m13:05:57.359471 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/Flight_Routes.sql
[0m13:05:57.359581 [info ] [MainThread]: 
[0m13:05:57.359715 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:05:57.361894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.9047043, "process_in_blocks": "0", "process_kernel_time": 0.251896, "process_mem_max_rss": "390365184", "process_out_blocks": "0", "process_user_time": 1.934774}
[0m13:05:57.362083 [debug] [MainThread]: Command `dbt run` failed at 13:05:57.362045 after 3.90 seconds
[0m13:05:57.362243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fc2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216a1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216a0eb0>]}
[0m13:05:57.362402 [debug] [MainThread]: Flushing usage events
[0m13:05:57.569076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:08:39.816091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdb46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbff750>]}


============================== 13:08:39.817717 | c1a6f105-41d8-475a-80d4-6ea8d30bd55e ==============================
[0m13:08:39.817717 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:08:39.817957 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'invocation_command': 'dbt run --select Flight_Routes', 'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'target_path': 'None', 'use_colors': 'True', 'static_parser': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False'}
[0m13:08:40.644498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1a6f105-41d8-475a-80d4-6ea8d30bd55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf58c30>]}
[0m13:08:40.663901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1a6f105-41d8-475a-80d4-6ea8d30bd55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bbe360>]}
[0m13:08:40.664101 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:08:40.739834 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:08:40.788752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:08:40.789053 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Flight_Routes.sql
[0m13:08:40.925100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1a6f105-41d8-475a-80d4-6ea8d30bd55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244c0e50>]}
[0m13:08:41.040680 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:08:41.041613 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:08:41.048916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1a6f105-41d8-475a-80d4-6ea8d30bd55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240db7a0>]}
[0m13:08:41.049095 [info ] [MainThread]: Found 49 models, 35 data tests, 9 sources, 630 macros
[0m13:08:41.049221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1a6f105-41d8-475a-80d4-6ea8d30bd55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243c6dd0>]}
[0m13:08:41.050036 [info ] [MainThread]: 
[0m13:08:41.050157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:08:41.050248 [info ] [MainThread]: 
[0m13:08:41.050433 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:08:41.050769 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:08:41.050925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:41.440066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m13:08:41.440484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:41.703107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:08:41.704822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:42.001462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:08:42.003448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:42.263795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:08:42.265541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:42.543435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1a6f105-41d8-475a-80d4-6ea8d30bd55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124645f30>]}
[0m13:08:42.544205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:08:42.548936 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Routes
[0m13:08:42.549548 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Flight_Routes .................. [RUN]
[0m13:08:42.549936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.Flight_Routes)
[0m13:08:42.550222 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Routes
[0m13:08:42.557107 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Routes"
[0m13:08:42.557771 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Routes
[0m13:08:42.567681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:42.850822 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Flight_Routes"
[0m13:08:42.851427 [debug] [Thread-1 (]: On model.air_travel.Flight_Routes: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Flight_Routes"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
      
    
    

    
    OPTIONS()
    as (
      with Flight_Routes as (
  select distinct r.airline_id, a1.icao as source_airport_icao, 
    a2.icao as dest_airport_icao, r.codeshare, r.stops, r.equipment, 
    r._data_source, r._load_time
  from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes` r
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a1
  on r.source_airport = a1.iata
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` a2
  on r.dest_airport = a2.iata
  join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al
  on r.airline_id = al.id
)

select * 
from Flight_Routes
    );
  
[0m13:08:43.481771 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:75f964a6-471a-45ad-8f66-369f8645c2f5&page=queryresults
[0m13:08:45.445987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a6f105-41d8-475a-80d4-6ea8d30bd55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245e6f90>]}
[0m13:08:45.446607 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Flight_Routes ............. [[32mCREATE TABLE (12.9k rows, 3.6 MiB processed)[0m in 2.90s]
[0m13:08:45.447038 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Routes
[0m13:08:45.447995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:08:45.449170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:45.449342 [debug] [MainThread]: Connection 'model.air_travel.Flight_Routes' was properly closed.
[0m13:08:45.449517 [info ] [MainThread]: 
[0m13:08:45.449709 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m13:08:45.450119 [debug] [MainThread]: Command end result
[0m13:08:45.476142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:08:45.477207 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:08:45.479864 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:08:45.480003 [info ] [MainThread]: 
[0m13:08:45.480179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:08:45.480308 [info ] [MainThread]: 
[0m13:08:45.480452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:08:45.482561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6902356, "process_in_blocks": "0", "process_kernel_time": 0.267284, "process_mem_max_rss": "393674752", "process_out_blocks": "0", "process_user_time": 1.950771}
[0m13:08:45.482748 [debug] [MainThread]: Command `dbt run` succeeded at 13:08:45.482711 after 5.69 seconds
[0m13:08:45.482896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245e38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ca04b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ca36b0>]}
[0m13:08:45.483035 [debug] [MainThread]: Flushing usage events
[0m13:08:45.690065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:25.938485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c18c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfd79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfd7750>]}


============================== 13:09:25.940190 | 5c7d43dd-393e-464d-a22b-53092e0263e6 ==============================
[0m13:09:25.940190 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:09:25.940431 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select Flight_Routes', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'partial_parse': 'True', 'warn_error': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'empty': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m13:09:26.760702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c7d43dd-393e-464d-a22b-53092e0263e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c330c30>]}
[0m13:09:26.780122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c7d43dd-393e-464d-a22b-53092e0263e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fc2360>]}
[0m13:09:26.780326 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:09:26.856877 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:09:26.906576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:09:26.906739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:09:26.923355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c7d43dd-393e-464d-a22b-53092e0263e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233dbd50>]}
[0m13:09:26.959046 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:09:26.959821 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:09:26.970565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c7d43dd-393e-464d-a22b-53092e0263e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238556d0>]}
[0m13:09:26.970735 [info ] [MainThread]: Found 49 models, 35 data tests, 9 sources, 630 macros
[0m13:09:26.970866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c7d43dd-393e-464d-a22b-53092e0263e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237c2c10>]}
[0m13:09:26.971746 [info ] [MainThread]: 
[0m13:09:26.971875 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:09:26.971966 [info ] [MainThread]: 
[0m13:09:26.972145 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:09:26.974523 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_mrt'
[0m13:09:26.974680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:27.210636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:09:27.212133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:27.484009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:09:27.484978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:27.734440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:09:27.737401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:28.025701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c7d43dd-393e-464d-a22b-53092e0263e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12381cef0>]}
[0m13:09:28.026523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:28.031590 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:09:28.032125 [info ] [Thread-1 (]: 1 of 4 START test dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [RUN]
[0m13:09:28.032609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m13:09:28.032924 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:09:28.048627 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m13:09:28.049247 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:09:28.061909 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m13:09:28.062328 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    group by airline_id, source_airport_icao, dest_airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:09:28.062560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:28.641905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f88e2402-49da-46a8-846c-088c3419501f&page=queryresults
[0m13:09:29.107071 [info ] [Thread-1 (]: 1 of 4 PASS dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [[32mPASS[0m in 1.07s]
[0m13:09:29.107746 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:09:29.108029 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:09:29.108356 [info ] [Thread-1 (]: 2 of 4 START test relationships_Flight_Routes_airline_id__id__ref_Airline_ ..... [RUN]
[0m13:09:29.108715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e)
[0m13:09:29.108971 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:09:29.114400 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m13:09:29.114964 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:09:29.116591 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m13:09:29.117128 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:09:29.117395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:29.660555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0843b3c5-063c-4a07-947d-0c045c2a48d1&page=queryresults
[0m13:09:30.179913 [info ] [Thread-1 (]: 2 of 4 PASS relationships_Flight_Routes_airline_id__id__ref_Airline_ ........... [[32mPASS[0m in 1.07s]
[0m13:09:30.181034 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:09:30.181566 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:09:30.182250 [info ] [Thread-1 (]: 3 of 4 START test relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_  [RUN]
[0m13:09:30.183049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e, now test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052)
[0m13:09:30.183444 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:09:30.189132 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m13:09:30.190070 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:09:30.192397 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m13:09:30.192857 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dest_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where dest_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:09:30.193135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:30.792796 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0a7810f1-3a57-45b5-b281-ec10681d4075&page=queryresults
[0m13:09:31.305411 [info ] [Thread-1 (]: 3 of 4 PASS relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_ .. [[32mPASS[0m in 1.12s]
[0m13:09:31.306330 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:09:31.306760 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:09:31.307173 [info ] [Thread-1 (]: 4 of 4 START test relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_  [RUN]
[0m13:09:31.307655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052, now test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df)
[0m13:09:31.307999 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:09:31.313547 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m13:09:31.314565 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:09:31.316930 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m13:09:31.317503 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select source_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where source_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:09:31.317985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:31.918908 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:80bfcc22-5d26-4db5-8fce-156a5b6d03ac&page=queryresults
[0m13:09:32.453777 [info ] [Thread-1 (]: 4 of 4 PASS relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 1.15s]
[0m13:09:32.454650 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:09:32.456093 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:09:32.457725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:32.457981 [debug] [MainThread]: Connection 'test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df' was properly closed.
[0m13:09:32.458227 [info ] [MainThread]: 
[0m13:09:32.458479 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m13:09:32.459330 [debug] [MainThread]: Command end result
[0m13:09:32.566343 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:09:32.567125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:09:32.569530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:09:32.569633 [info ] [MainThread]: 
[0m13:09:32.569765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:09:32.569884 [info ] [MainThread]: 
[0m13:09:32.570011 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:09:32.571677 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.65685, "process_in_blocks": "0", "process_kernel_time": 0.263868, "process_mem_max_rss": "390381568", "process_out_blocks": "0", "process_user_time": 1.946135}
[0m13:09:32.571858 [debug] [MainThread]: Command `dbt test` succeeded at 13:09:32.571824 after 6.66 seconds
[0m13:09:32.571997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cedcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12377b120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12377a150>]}
[0m13:09:32.572121 [debug] [MainThread]: Flushing usage events
[0m13:09:32.788054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:20.663417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ace06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2b750>]}


============================== 13:12:20.665077 | 1c9fb0c1-29cb-4fdf-9d8b-06e49bd0af34 ==============================
[0m13:12:20.665077 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:12:20.665321 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/scohen/.dbt', 'fail_fast': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --select Flight_Beverage', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'write_json': 'True'}
[0m13:12:21.526668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c9fb0c1-29cb-4fdf-9d8b-06e49bd0af34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae84c30>]}
[0m13:12:21.547587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c9fb0c1-29cb-4fdf-9d8b-06e49bd0af34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121abe360>]}
[0m13:12:21.547906 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:12:21.628964 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:12:21.680294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:12:21.680735 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m13:12:21.813621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c9fb0c1-29cb-4fdf-9d8b-06e49bd0af34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223c5150>]}
[0m13:12:21.935752 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:12:21.936663 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:12:21.947693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c9fb0c1-29cb-4fdf-9d8b-06e49bd0af34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223b6120>]}
[0m13:12:21.947911 [info ] [MainThread]: Found 49 models, 36 data tests, 9 sources, 630 macros
[0m13:12:21.948045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c9fb0c1-29cb-4fdf-9d8b-06e49bd0af34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12240d010>]}
[0m13:12:21.948419 [warn ] [MainThread]: The selection criterion 'Flight_Beverage' does not match any enabled nodes
[0m13:12:21.949029 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:12:21.949227 [debug] [MainThread]: Command end result
[0m13:12:21.964979 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:12:21.965895 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:12:21.968479 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:12:21.971556 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3315791, "process_in_blocks": "0", "process_kernel_time": 0.240061, "process_mem_max_rss": "386744320", "process_out_blocks": "0", "process_user_time": 1.587175}
[0m13:12:21.971942 [debug] [MainThread]: Command `dbt test` succeeded at 13:12:21.971896 after 1.33 seconds
[0m13:12:21.972111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223a64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba30ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224b5d90>]}
[0m13:12:21.972269 [debug] [MainThread]: Flushing usage events
[0m13:12:22.171177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:47.882081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099f79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099f7750>]}


============================== 13:12:47.883855 | 05739473-0f40-4a55-820b-542355030d6d ==============================
[0m13:12:47.883855 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:12:47.884109 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'printer_width': '80', 'invocation_command': 'dbt test --select Food_Beverage', 'version_check': 'True', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False'}
[0m13:12:48.702155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05739473-0f40-4a55-820b-542355030d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d50c30>]}
[0m13:12:48.721616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05739473-0f40-4a55-820b-542355030d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8be360>]}
[0m13:12:48.721820 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:12:48.797606 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:12:48.845202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:48.845348 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:48.861811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05739473-0f40-4a55-820b-542355030d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcdbd50>]}
[0m13:12:48.898135 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:12:48.898944 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:12:48.909654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05739473-0f40-4a55-820b-542355030d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201656d0>]}
[0m13:12:48.909831 [info ] [MainThread]: Found 49 models, 36 data tests, 9 sources, 630 macros
[0m13:12:48.909962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05739473-0f40-4a55-820b-542355030d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200dacf0>]}
[0m13:12:48.910795 [info ] [MainThread]: 
[0m13:12:48.910923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:48.911017 [info ] [MainThread]: 
[0m13:12:48.911203 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:12:48.913515 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_mrt'
[0m13:12:48.913673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:49.210187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:12:49.212271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:49.508047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:12:49.509709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:49.781962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:12:49.785193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:50.154744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05739473-0f40-4a55-820b-542355030d6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120135090>]}
[0m13:12:50.155608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:50.160463 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:12:50.160968 [info ] [Thread-1 (]: 1 of 2 START test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [RUN]
[0m13:12:50.161355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965)
[0m13:12:50.161667 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:12:50.177715 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m13:12:50.178377 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:12:50.191009 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m13:12:50.191536 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        business, menu_item
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    group by business, menu_item
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:12:50.191767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:50.681268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2df9261f-ed02-4f9c-805b-220609d6c8dd&page=queryresults
[0m13:12:51.146656 [info ] [Thread-1 (]: 1 of 2 PASS dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [[32mPASS[0m in 0.98s]
[0m13:12:51.147597 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:12:51.148035 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:12:51.148530 [info ] [Thread-1 (]: 2 of 2 START test relationships_Food_Beverage_business__business__ref_Airport_Establishment_  [RUN]
[0m13:12:51.149114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965, now test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496)
[0m13:12:51.149499 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:12:51.156365 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"
[0m13:12:51.157245 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:12:51.159446 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"
[0m13:12:51.160117 [debug] [Thread-1 (]: On test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select business as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    where business is not null
),

parent as (
    select business as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:12:51.160432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:51.907995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9cb322f6-fd05-40d9-85af-28b3781a825e&page=queryresults
[0m13:12:52.266379 [info ] [Thread-1 (]: 2 of 2 PASS relationships_Food_Beverage_business__business__ref_Airport_Establishment_  [[32mPASS[0m in 1.12s]
[0m13:12:52.267732 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:12:52.269386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:52.271279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:52.271545 [debug] [MainThread]: Connection 'test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496' was properly closed.
[0m13:12:52.271806 [info ] [MainThread]: 
[0m13:12:52.272069 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m13:12:52.272725 [debug] [MainThread]: Command end result
[0m13:12:52.387777 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:12:52.388850 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:12:52.391622 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:12:52.391762 [info ] [MainThread]: 
[0m13:12:52.391899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:52.392005 [info ] [MainThread]: 
[0m13:12:52.392125 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:12:52.394544 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.5364757, "process_in_blocks": "0", "process_kernel_time": 0.24861, "process_mem_max_rss": "390316032", "process_out_blocks": "0", "process_user_time": 1.843714}
[0m13:12:52.394809 [debug] [MainThread]: Command `dbt test` succeeded at 13:12:52.394766 after 4.54 seconds
[0m13:12:52.394976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12007f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12007e200>]}
[0m13:12:52.395132 [debug] [MainThread]: Flushing usage events
[0m13:12:52.602428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:21.964764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e146e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5f750>]}


============================== 13:18:21.966389 | b75d2304-65d7-40c6-8dfc-3d3bdc9674b6 ==============================
[0m13:18:21.966389 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:18:21.966628 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'invocation_command': 'dbt test --select TSA_Traffic', 'version_check': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'introspect': 'True', 'partial_parse': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_format': 'default', 'debug': 'False', 'target_path': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'no_print': 'None'}
[0m13:18:22.834773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b75d2304-65d7-40c6-8dfc-3d3bdc9674b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb8c30>]}
[0m13:18:22.855490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b75d2304-65d7-40c6-8dfc-3d3bdc9674b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcc2360>]}
[0m13:18:22.855750 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:18:22.933513 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:18:22.982504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:22.982898 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m13:18:23.117141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b75d2304-65d7-40c6-8dfc-3d3bdc9674b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205c5150>]}
[0m13:18:23.237783 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:18:23.238731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:18:23.249398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b75d2304-65d7-40c6-8dfc-3d3bdc9674b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120596120>]}
[0m13:18:23.249575 [info ] [MainThread]: Found 49 models, 37 data tests, 9 sources, 630 macros
[0m13:18:23.249712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b75d2304-65d7-40c6-8dfc-3d3bdc9674b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12060fbd0>]}
[0m13:18:23.250593 [info ] [MainThread]: 
[0m13:18:23.250725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:18:23.250820 [info ] [MainThread]: 
[0m13:18:23.251002 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:18:23.253250 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m13:18:23.253404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:23.527156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:18:23.528143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:23.829221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:18:23.831300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:24.141784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m13:18:24.144485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:24.414196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b75d2304-65d7-40c6-8dfc-3d3bdc9674b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205abee0>]}
[0m13:18:24.415151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:24.419769 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:18:24.420148 [info ] [Thread-1 (]: 1 of 2 START test dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [RUN]
[0m13:18:24.420539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m13:18:24.420840 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:18:24.432045 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m13:18:24.432657 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:18:24.446158 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m13:18:24.446609 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_date, event_hour, airport_icao, security_checkpoint
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    group by event_date, event_hour, airport_icao, security_checkpoint
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:18:24.446835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:24.917901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:fb674991-fc10-46a6-b451-70320305c774&page=queryresults
[0m13:18:25.374547 [info ] [Thread-1 (]: 1 of 2 PASS dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [[32mPASS[0m in 0.95s]
[0m13:18:25.375888 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:18:25.376322 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:18:25.376764 [info ] [Thread-1 (]: 2 of 2 START test relationships_TSA_Traffic_airport_icao__icao__ref_Airport_ ... [RUN]
[0m13:18:25.377288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a)
[0m13:18:25.377617 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:18:25.381989 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"
[0m13:18:25.382861 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:18:25.385291 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"
[0m13:18:25.385974 [debug] [Thread-1 (]: On test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:18:25.386287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:26.077315 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:8796e82b-1ade-4f60-bb7c-97178e6c8e9e&page=queryresults
[0m13:18:26.559698 [info ] [Thread-1 (]: 2 of 2 PASS relationships_TSA_Traffic_airport_icao__icao__ref_Airport_ ......... [[32mPASS[0m in 1.18s]
[0m13:18:26.560600 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:18:26.562029 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:18:26.563739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:26.563996 [debug] [MainThread]: Connection 'test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a' was properly closed.
[0m13:18:26.564251 [info ] [MainThread]: 
[0m13:18:26.564499 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m13:18:26.565155 [debug] [MainThread]: Command end result
[0m13:18:26.596079 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:18:26.597222 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:18:26.600462 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:18:26.600608 [info ] [MainThread]: 
[0m13:18:26.600778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:18:26.600904 [info ] [MainThread]: 
[0m13:18:26.601046 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:18:26.603352 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.661992, "process_in_blocks": "0", "process_kernel_time": 0.27502, "process_mem_max_rss": "395329536", "process_out_blocks": "0", "process_user_time": 1.967871}
[0m13:18:26.603558 [debug] [MainThread]: Command `dbt test` succeeded at 13:18:26.603518 after 4.66 seconds
[0m13:18:26.603722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b64ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12054a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12054a410>]}
[0m13:18:26.603878 [debug] [MainThread]: Flushing usage events
[0m13:18:26.814471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:46.542801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8686e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b39d0>]}


============================== 13:19:46.544404 | fd49a5cd-fc6a-4483-934a-659c2078ba8b ==============================
[0m13:19:46.544404 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:19:46.544650 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'version_check': 'True', 'empty': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/scohen/.dbt', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False'}
[0m13:19:47.440617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd49a5cd-fc6a-4483-934a-659c2078ba8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0cc30>]}
[0m13:19:47.460604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd49a5cd-fc6a-4483-934a-659c2078ba8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215be360>]}
[0m13:19:47.460836 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:19:47.543782 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:19:47.595177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:19:47.595358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:19:47.612281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd49a5cd-fc6a-4483-934a-659c2078ba8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219d7d50>]}
[0m13:19:47.621284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd49a5cd-fc6a-4483-934a-659c2078ba8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d31400>]}
[0m13:19:47.621460 [info ] [MainThread]: Found 49 models, 37 data tests, 9 sources, 630 macros
[0m13:19:47.621593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd49a5cd-fc6a-4483-934a-659c2078ba8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121682b30>]}
[0m13:19:47.623096 [info ] [MainThread]: 
[0m13:19:47.623232 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:47.623330 [info ] [MainThread]: 
[0m13:19:47.623509 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:19:47.625740 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m13:19:47.625931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:47.939390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m13:19:47.941265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:48.230286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:19:48.231751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:48.542628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:19:48.547519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:48.851917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd49a5cd-fc6a-4483-934a-659c2078ba8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d37ad0>]}
[0m13:19:48.852733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:48.857041 [debug] [Thread-1 (]: Began running node model.air_travel.aircraft_flight_delays
[0m13:19:48.857515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now model.air_travel.aircraft_flight_delays)
[0m13:19:48.857837 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircraft_flight_delays
[0m13:19:48.865023 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircraft_flight_delays"
[0m13:19:48.865674 [debug] [Thread-1 (]: Began executing node model.air_travel.aircraft_flight_delays
[0m13:19:48.865954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.867298 [debug] [Thread-1 (]: Finished running node model.air_travel.aircraft_flight_delays
[0m13:19:48.867556 [debug] [Thread-1 (]: Began running node model.air_travel.aircrafts
[0m13:19:48.867860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircraft_flight_delays, now model.air_travel.aircrafts)
[0m13:19:48.868181 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircrafts
[0m13:19:48.870554 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircrafts"
[0m13:19:48.871047 [debug] [Thread-1 (]: Began executing node model.air_travel.aircrafts
[0m13:19:48.871263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.872383 [debug] [Thread-1 (]: Finished running node model.air_travel.aircrafts
[0m13:19:48.872607 [debug] [Thread-1 (]: Began running node model.air_travel.airlines
[0m13:19:48.872849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircrafts, now model.air_travel.airlines)
[0m13:19:48.873073 [debug] [Thread-1 (]: Began compiling node model.air_travel.airlines
[0m13:19:48.874649 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airlines"
[0m13:19:48.874975 [debug] [Thread-1 (]: Began executing node model.air_travel.airlines
[0m13:19:48.875148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.876045 [debug] [Thread-1 (]: Finished running node model.air_travel.airlines
[0m13:19:48.876235 [debug] [Thread-1 (]: Began running node model.air_travel.airport_maps
[0m13:19:48.876426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airlines, now model.air_travel.airport_maps)
[0m13:19:48.876618 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_maps
[0m13:19:48.878241 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_maps"
[0m13:19:48.878553 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_maps
[0m13:19:48.878723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.879610 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_maps
[0m13:19:48.879797 [debug] [Thread-1 (]: Began running node model.air_travel.airport_reviews
[0m13:19:48.879989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_maps, now model.air_travel.airport_reviews)
[0m13:19:48.880178 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_reviews
[0m13:19:48.881484 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_reviews"
[0m13:19:48.881760 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_reviews
[0m13:19:48.881925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.882801 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_reviews
[0m13:19:48.882965 [debug] [Thread-1 (]: Began running node model.air_travel.airports
[0m13:19:48.883130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_reviews, now model.air_travel.airports)
[0m13:19:48.883294 [debug] [Thread-1 (]: Began compiling node model.air_travel.airports
[0m13:19:48.884712 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airports"
[0m13:19:48.884985 [debug] [Thread-1 (]: Began executing node model.air_travel.airports
[0m13:19:48.885134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.885909 [debug] [Thread-1 (]: Finished running node model.air_travel.airports
[0m13:19:48.886070 [debug] [Thread-1 (]: Began running node model.air_travel.countries
[0m13:19:48.886236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airports, now model.air_travel.countries)
[0m13:19:48.886399 [debug] [Thread-1 (]: Began compiling node model.air_travel.countries
[0m13:19:48.887532 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.countries"
[0m13:19:48.887784 [debug] [Thread-1 (]: Began executing node model.air_travel.countries
[0m13:19:48.887930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.888699 [debug] [Thread-1 (]: Finished running node model.air_travel.countries
[0m13:19:48.888864 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m13:19:48.889036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.countries, now model.air_travel.flight_delays)
[0m13:19:48.889226 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m13:19:48.890693 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m13:19:48.891007 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m13:19:48.891159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.891950 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m13:19:48.892108 [debug] [Thread-1 (]: Began running node model.air_travel.flight_routes
[0m13:19:48.892282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_delays, now model.air_travel.flight_routes)
[0m13:19:48.892459 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_routes
[0m13:19:48.893602 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_routes"
[0m13:19:48.893857 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_routes
[0m13:19:48.894002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.894734 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_routes
[0m13:19:48.894894 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:19:48.895062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_routes, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m13:19:48.895225 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:19:48.896259 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:19:48.896823 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:19:48.896966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.897662 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:19:48.897805 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_traffic
[0m13:19:48.897952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_canonical_categories, now model.air_travel.tsa_traffic)
[0m13:19:48.898082 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_traffic
[0m13:19:48.899098 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_traffic"
[0m13:19:48.899331 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_traffic
[0m13:19:48.899464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.900136 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_traffic
[0m13:19:48.900281 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_aircraft_icao
[0m13:19:48.900425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tsa_traffic, now model.air_travel.tmp_aircraft_icao)
[0m13:19:48.900584 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_aircraft_icao
[0m13:19:48.903292 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_aircraft_icao"
[0m13:19:48.903759 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_aircraft_icao
[0m13:19:48.903897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.904629 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_aircraft_icao
[0m13:19:48.904774 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m13:19:48.904927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_aircraft_icao, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m13:19:48.905071 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m13:19:48.908711 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m13:19:48.908990 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m13:19:48.909131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.909841 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m13:19:48.909988 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m13:19:48.910136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc, now test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d)
[0m13:19:48.910264 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m13:19:48.912097 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m13:19:48.912327 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m13:19:48.912456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.913108 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m13:19:48.913243 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m13:19:48.913375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d, now model.air_travel.tmp_airport_establishment_unique)
[0m13:19:48.913497 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m13:19:48.914392 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:19:48.914598 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m13:19:48.914721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.915350 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m13:19:48.915482 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m13:19:48.915609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_unique, now test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510)
[0m13:19:48.915752 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m13:19:48.917839 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m13:19:48.918274 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m13:19:48.918417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.919116 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m13:19:48.919254 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m13:19:48.919396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510, now test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587)
[0m13:19:48.919519 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m13:19:48.921198 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m13:19:48.921432 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m13:19:48.921556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.922196 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m13:19:48.922328 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_llm
[0m13:19:48.922453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587, now model.air_travel.tmp_airport_llm)
[0m13:19:48.922568 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_llm
[0m13:19:48.923749 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_llm"
[0m13:19:48.924127 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_llm
[0m13:19:48.924244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.924857 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_llm
[0m13:19:48.924982 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m13:19:48.925125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_llm, now test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0)
[0m13:19:48.925278 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m13:19:48.926819 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m13:19:48.927045 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m13:19:48.927164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.927757 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m13:19:48.927880 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_country_iso_codes
[0m13:19:48.928005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0, now model.air_travel.tmp_country_iso_codes)
[0m13:19:48.928116 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_country_iso_codes
[0m13:19:48.929242 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_country_iso_codes"
[0m13:19:48.929620 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_country_iso_codes
[0m13:19:48.929742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.930319 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_country_iso_codes
[0m13:19:48.930442 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m13:19:48.930585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_country_iso_codes, now test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414)
[0m13:19:48.930708 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m13:19:48.932260 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m13:19:48.932472 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m13:19:48.932588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.933164 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m13:19:48.933288 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m13:19:48.933408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414, now test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823)
[0m13:19:48.933520 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m13:19:48.935203 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m13:19:48.935388 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m13:19:48.935504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.936082 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m13:19:48.936203 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m13:19:48.936324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823, now test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81)
[0m13:19:48.936436 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m13:19:48.937915 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m13:19:48.938122 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m13:19:48.938236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.938806 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m13:19:48.938927 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m13:19:48.939048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81, now test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee)
[0m13:19:48.939163 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m13:19:48.940812 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m13:19:48.940998 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m13:19:48.941113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.941672 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m13:19:48.941791 [debug] [Thread-1 (]: Began running node model.air_travel.Aircraft
[0m13:19:48.941909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee, now model.air_travel.Aircraft)
[0m13:19:48.942017 [debug] [Thread-1 (]: Began compiling node model.air_travel.Aircraft
[0m13:19:48.942973 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Aircraft"
[0m13:19:48.943330 [debug] [Thread-1 (]: Began executing node model.air_travel.Aircraft
[0m13:19:48.943450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.944034 [debug] [Thread-1 (]: Finished running node model.air_travel.Aircraft
[0m13:19:48.944155 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:19:48.944291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Aircraft, now model.air_travel.tmp_airport_establishment_raw_categories)
[0m13:19:48.944424 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:19:48.945459 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m13:19:48.945688 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:19:48.945808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.946373 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:19:48.946491 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m13:19:48.946642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_raw_categories, now model.air_travel.tmp_airport_all)
[0m13:19:48.946765 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_all
[0m13:19:48.947659 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_all"
[0m13:19:48.948012 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_all
[0m13:19:48.948120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.948673 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m13:19:48.948791 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m13:19:48.948918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_all, now model.air_travel.Country)
[0m13:19:48.949051 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m13:19:48.950165 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m13:19:48.950350 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m13:19:48.950450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.951031 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m13:19:48.951157 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:19:48.951312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Country, now test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd)
[0m13:19:48.951493 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:19:48.955050 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m13:19:48.955446 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:19:48.955562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.956069 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:19:48.956195 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:19:48.956306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd, now model.air_travel.tmp_airport_establishment_broad_categories_mapped)
[0m13:19:48.956407 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:19:48.957493 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_mapped"
[0m13:19:48.957861 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:19:48.957976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.958535 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:19:48.958642 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates
[0m13:19:48.958782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_broad_categories_mapped, now model.air_travel.tmp_airport_duplicates)
[0m13:19:48.958900 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates
[0m13:19:48.959716 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates"
[0m13:19:48.960056 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates
[0m13:19:48.960167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.960731 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates
[0m13:19:48.960851 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airline_country_mapped
[0m13:19:48.961015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates, now model.air_travel.tmp_airline_country_mapped)
[0m13:19:48.961156 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airline_country_mapped
[0m13:19:48.962347 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airline_country_mapped"
[0m13:19:48.962691 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airline_country_mapped
[0m13:19:48.962813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.963440 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airline_country_mapped
[0m13:19:48.963554 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:19:48.963691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airline_country_mapped, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m13:19:48.963804 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:19:48.966375 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m13:19:48.966586 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:19:48.966687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.967351 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:19:48.967460 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:19:48.967573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m13:19:48.967672 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:19:48.969454 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m13:19:48.969627 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:19:48.969722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.970223 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:19:48.970337 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m13:19:48.970444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Country_iso_code.5e9388f08c, now model.air_travel.tmp_airport_establishment_broad_categories_frequency)
[0m13:19:48.970544 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m13:19:48.971285 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_frequency"
[0m13:19:48.971694 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m13:19:48.971806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.973487 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m13:19:48.973600 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m13:19:48.973715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_broad_categories_frequency, now model.air_travel.tmp_airport_establishment_sub_categories_mapped)
[0m13:19:48.973819 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m13:19:48.974736 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_sub_categories_mapped"
[0m13:19:48.975056 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m13:19:48.975170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:48.975729 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m13:19:48.975841 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:19:48.975949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_sub_categories_mapped, now model.air_travel.tmp_airport_duplicates_embeddings)
[0m13:19:48.976074 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:19:48.976975 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m13:19:48.977397 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:19:48.977509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.054333 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:19:49.054524 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results
[0m13:19:49.054662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates_embeddings, now model.air_travel.tmp_airport_inference_results)
[0m13:19:49.054779 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results
[0m13:19:49.055798 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results"
[0m13:19:49.056113 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results
[0m13:19:49.056220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.056831 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results
[0m13:19:49.056946 [debug] [Thread-1 (]: Began running node model.air_travel.Airline
[0m13:19:49.057107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results, now model.air_travel.Airline)
[0m13:19:49.057219 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airline
[0m13:19:49.058406 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airline"
[0m13:19:49.058608 [debug] [Thread-1 (]: Began executing node model.air_travel.Airline
[0m13:19:49.058709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.059231 [debug] [Thread-1 (]: Finished running node model.air_travel.Airline
[0m13:19:49.059345 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Establishment
[0m13:19:49.059489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airline, now model.air_travel.Airport_Establishment)
[0m13:19:49.059598 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Establishment
[0m13:19:49.060485 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Establishment"
[0m13:19:49.060947 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Establishment
[0m13:19:49.061094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.061699 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Establishment
[0m13:19:49.061825 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:19:49.061959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Establishment, now model.air_travel.tmp_airport_inference_results_embeddings)
[0m13:19:49.062094 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:19:49.063102 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results_embeddings"
[0m13:19:49.063598 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:19:49.063719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.064271 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:19:49.064386 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:19:49.064505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results_embeddings, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m13:19:49.064630 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:19:49.065760 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m13:19:49.065943 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:19:49.066042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.066575 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:19:49.066690 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:19:49.066802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26)
[0m13:19:49.066906 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:19:49.069555 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m13:19:49.069755 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:19:49.069863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.070400 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:19:49.070509 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m13:19:49.070619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26, now test.air_travel.unique_Airline_id.cb196c2622)
[0m13:19:49.070719 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m13:19:49.071771 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m13:19:49.071945 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m13:19:49.072047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.072569 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m13:19:49.072683 [debug] [Thread-1 (]: Began running node model.air_travel.Food_Beverage
[0m13:19:49.072791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now model.air_travel.Food_Beverage)
[0m13:19:49.072890 [debug] [Thread-1 (]: Began compiling node model.air_travel.Food_Beverage
[0m13:19:49.073865 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Food_Beverage"
[0m13:19:49.074043 [debug] [Thread-1 (]: Began executing node model.air_travel.Food_Beverage
[0m13:19:49.074145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.074670 [debug] [Thread-1 (]: Finished running node model.air_travel.Food_Beverage
[0m13:19:49.074785 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:19:49.074925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Food_Beverage, now test.air_travel.not_null_Airport_Establishment_business.fa42968b3c)
[0m13:19:49.075040 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:19:49.076096 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m13:19:49.076276 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:19:49.076378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.076897 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:19:49.077007 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:19:49.077115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Establishment_business.fa42968b3c, now test.air_travel.unique_Airport_Establishment_business.c0ba13e1af)
[0m13:19:49.077223 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:19:49.078436 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m13:19:49.078614 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:19:49.078716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.079233 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:19:49.079344 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_vector_search_results
[0m13:19:49.079451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Establishment_business.c0ba13e1af, now model.air_travel.tmp_airport_vector_search_results)
[0m13:19:49.079551 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_vector_search_results
[0m13:19:49.080416 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_vector_search_results"
[0m13:19:49.080736 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_vector_search_results
[0m13:19:49.080848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.081371 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_vector_search_results
[0m13:19:49.081484 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:19:49.081605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_vector_search_results, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965)
[0m13:19:49.081732 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:19:49.083414 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m13:19:49.083781 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:19:49.083897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.084430 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:19:49.084543 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:19:49.084659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965, now test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496)
[0m13:19:49.084764 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:19:49.086121 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"
[0m13:19:49.086316 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:19:49.086419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.086939 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:19:49.087052 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m13:19:49.087161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496, now model.air_travel.tmp_airport_refined)
[0m13:19:49.087264 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_refined
[0m13:19:49.088358 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_refined"
[0m13:19:49.088538 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_refined
[0m13:19:49.088639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.089158 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m13:19:49.089362 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_iso_codes
[0m13:19:49.089508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_refined, now model.air_travel.tmp_airport_country_iso_codes)
[0m13:19:49.089629 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_iso_codes
[0m13:19:49.090495 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_iso_codes"
[0m13:19:49.090674 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_iso_codes
[0m13:19:49.090778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.091288 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_iso_codes
[0m13:19:49.091491 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_closest_match
[0m13:19:49.091611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_country_iso_codes, now model.air_travel.tmp_airport_country_closest_match)
[0m13:19:49.091721 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_closest_match
[0m13:19:49.092729 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_closest_match"
[0m13:19:49.092915 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_closest_match
[0m13:19:49.093016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.093564 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_closest_match
[0m13:19:49.093744 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m13:19:49.093863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_country_closest_match, now model.air_travel.Airport)
[0m13:19:49.093970 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m13:19:49.094878 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m13:19:49.095199 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m13:19:49.095303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.095872 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m13:19:49.096089 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Concessions
[0m13:19:49.096211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport, now model.air_travel.Airport_Concessions)
[0m13:19:49.096318 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Concessions
[0m13:19:49.097316 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Concessions"
[0m13:19:49.097494 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Concessions
[0m13:19:49.097594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.098118 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Concessions
[0m13:19:49.098227 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Review
[0m13:19:49.098341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Concessions, now model.air_travel.Airport_Review)
[0m13:19:49.098464 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Review
[0m13:19:49.099266 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Review"
[0m13:19:49.099437 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Review
[0m13:19:49.099536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.100044 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Review
[0m13:19:49.100163 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Delays
[0m13:19:49.100292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Review, now model.air_travel.Flight_Delays)
[0m13:19:49.100424 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Delays
[0m13:19:49.101448 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Delays"
[0m13:19:49.101896 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Delays
[0m13:19:49.102007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.102561 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Delays
[0m13:19:49.102670 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Routes
[0m13:19:49.102794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Flight_Delays, now model.air_travel.Flight_Routes)
[0m13:19:49.102923 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Routes
[0m13:19:49.103858 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Routes"
[0m13:19:49.104026 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Routes
[0m13:19:49.104122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.104620 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Routes
[0m13:19:49.104726 [debug] [Thread-1 (]: Began running node model.air_travel.TSA_Traffic
[0m13:19:49.104851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Flight_Routes, now model.air_travel.TSA_Traffic)
[0m13:19:49.104993 [debug] [Thread-1 (]: Began compiling node model.air_travel.TSA_Traffic
[0m13:19:49.105939 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.TSA_Traffic"
[0m13:19:49.106290 [debug] [Thread-1 (]: Began executing node model.air_travel.TSA_Traffic
[0m13:19:49.106403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.106955 [debug] [Thread-1 (]: Finished running node model.air_travel.TSA_Traffic
[0m13:19:49.107079 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:19:49.107201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.TSA_Traffic, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m13:19:49.107332 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:19:49.108422 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m13:19:49.108617 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:19:49.108732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.109288 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:19:49.109402 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m13:19:49.109510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0)
[0m13:19:49.109611 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m13:19:49.112219 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m13:19:49.112405 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m13:19:49.112509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.113022 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m13:19:49.113130 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:19:49.113238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m13:19:49.113336 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:19:49.114351 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m13:19:49.114539 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:19:49.114651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.115330 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:19:49.115447 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:19:49.115571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m13:19:49.115692 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:19:49.117490 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m13:19:49.117706 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:19:49.117829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.118444 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:19:49.118570 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m13:19:49.118701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1)
[0m13:19:49.118824 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m13:19:49.120593 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"
[0m13:19:49.120826 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m13:19:49.120934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.121474 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m13:19:49.121595 [debug] [Thread-1 (]: Began running node model.air_travel.passenger_sentiment_airports_top_kpis
[0m13:19:49.121707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1, now model.air_travel.passenger_sentiment_airports_top_kpis)
[0m13:19:49.121813 [debug] [Thread-1 (]: Began compiling node model.air_travel.passenger_sentiment_airports_top_kpis
[0m13:19:49.122726 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.passenger_sentiment_airports_top_kpis"
[0m13:19:49.122930 [debug] [Thread-1 (]: Began executing node model.air_travel.passenger_sentiment_airports_top_kpis
[0m13:19:49.123048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.123592 [debug] [Thread-1 (]: Finished running node model.air_travel.passenger_sentiment_airports_top_kpis
[0m13:19:49.123708 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m13:19:49.123835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.passenger_sentiment_airports_top_kpis, now model.air_travel.tmp_airport_terminal_mentioned_food_keywords)
[0m13:19:49.123949 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m13:19:49.124978 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_terminal_mentioned_food_keywords"
[0m13:19:49.125168 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m13:19:49.125276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.125811 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m13:19:49.125923 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m13:19:49.126037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_terminal_mentioned_food_keywords, now test.air_travel.not_null_Airport_Review_id.715ca7a304)
[0m13:19:49.126169 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m13:19:49.127354 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m13:19:49.127549 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m13:19:49.127652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.128168 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m13:19:49.128279 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m13:19:49.128389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Review_id.715ca7a304, now test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9)
[0m13:19:49.128489 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m13:19:49.129974 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9"
[0m13:19:49.130187 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m13:19:49.130297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.130871 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m13:19:49.130990 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m13:19:49.131121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9, now test.air_travel.unique_Airport_Review_id.690fe37ba9)
[0m13:19:49.131236 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m13:19:49.132265 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m13:19:49.132449 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m13:19:49.132547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.133067 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m13:19:49.133181 [debug] [Thread-1 (]: Began running node model.air_travel.carrier_flight_delays
[0m13:19:49.133303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Review_id.690fe37ba9, now model.air_travel.carrier_flight_delays)
[0m13:19:49.133404 [debug] [Thread-1 (]: Began compiling node model.air_travel.carrier_flight_delays
[0m13:19:49.134668 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.carrier_flight_delays"
[0m13:19:49.134843 [debug] [Thread-1 (]: Began executing node model.air_travel.carrier_flight_delays
[0m13:19:49.134962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.135553 [debug] [Thread-1 (]: Finished running node model.air_travel.carrier_flight_delays
[0m13:19:49.135681 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:19:49.135801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.carrier_flight_delays, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m13:19:49.135904 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:19:49.137363 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m13:19:49.137547 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:19:49.137651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.138156 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:19:49.138266 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:19:49.138373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3)
[0m13:19:49.138473 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:19:49.140144 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m13:19:49.140328 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:19:49.140429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.140951 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:19:49.141062 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m13:19:49.141173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3, now test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4)
[0m13:19:49.141275 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m13:19:49.142540 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"
[0m13:19:49.142731 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m13:19:49.142844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.143403 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m13:19:49.143524 [debug] [Thread-1 (]: Began running node model.air_travel.Route_Equipment
[0m13:19:49.143653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4, now model.air_travel.Route_Equipment)
[0m13:19:49.143786 [debug] [Thread-1 (]: Began compiling node model.air_travel.Route_Equipment
[0m13:19:49.144766 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Route_Equipment"
[0m13:19:49.145143 [debug] [Thread-1 (]: Began executing node model.air_travel.Route_Equipment
[0m13:19:49.145255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.145800 [debug] [Thread-1 (]: Finished running node model.air_travel.Route_Equipment
[0m13:19:49.145918 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:19:49.146068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Route_Equipment, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m13:19:49.146203 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:19:49.147757 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m13:19:49.147962 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:19:49.148076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.148610 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:19:49.148723 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:19:49.148838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e)
[0m13:19:49.148939 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:19:49.150412 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m13:19:49.150765 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:19:49.150883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.151413 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:19:49.151523 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:19:49.151652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e, now test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052)
[0m13:19:49.151766 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:19:49.153172 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m13:19:49.153350 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:19:49.153452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.153971 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:19:49.154093 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:19:49.154208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052, now test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df)
[0m13:19:49.154309 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:19:49.155857 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m13:19:49.156044 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:19:49.156159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.156685 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:19:49.156800 [debug] [Thread-1 (]: Began running node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m13:19:49.156909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df, now model.air_travel.foot_traffic_starbucks_airports_monthly)
[0m13:19:49.157012 [debug] [Thread-1 (]: Began compiling node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m13:19:49.157895 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.foot_traffic_starbucks_airports_monthly"
[0m13:19:49.158213 [debug] [Thread-1 (]: Began executing node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m13:19:49.158327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.158835 [debug] [Thread-1 (]: Finished running node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m13:19:49.158945 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_tsa_checkpoint_terminal
[0m13:19:49.159054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.foot_traffic_starbucks_airports_monthly, now model.air_travel.tmp_tsa_checkpoint_terminal)
[0m13:19:49.159152 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_tsa_checkpoint_terminal
[0m13:19:49.160114 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_tsa_checkpoint_terminal"
[0m13:19:49.160481 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_tsa_checkpoint_terminal
[0m13:19:49.160595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.161118 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_tsa_checkpoint_terminal
[0m13:19:49.161233 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:19:49.161354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_tsa_checkpoint_terminal, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m13:19:49.161503 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:19:49.163239 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m13:19:49.163441 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:19:49.163547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.164074 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:19:49.164186 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:19:49.164295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a)
[0m13:19:49.164424 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:19:49.165920 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"
[0m13:19:49.166102 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:19:49.166203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.166731 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:19:49.166847 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m13:19:49.166957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a, now model.air_travel.tmp_airport_terminal_food_keywords_category)
[0m13:19:49.167058 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m13:19:49.167983 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_terminal_food_keywords_category"
[0m13:19:49.168158 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m13:19:49.168264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.168846 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m13:19:49.168973 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:19:49.169103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_terminal_food_keywords_category, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m13:19:49.169236 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:19:49.171741 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m13:19:49.171945 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:19:49.172050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.172580 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:19:49.172705 [debug] [Thread-1 (]: Began running node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m13:19:49.172820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now model.air_travel.foot_traffic_starbucks_terminals_monthly)
[0m13:19:49.172996 [debug] [Thread-1 (]: Began compiling node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m13:19:49.174099 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.foot_traffic_starbucks_terminals_monthly"
[0m13:19:49.174302 [debug] [Thread-1 (]: Began executing node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m13:19:49.174418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.174962 [debug] [Thread-1 (]: Finished running node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m13:19:49.175081 [debug] [Thread-1 (]: Began running node model.air_travel.food_category_comparison
[0m13:19:49.175198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.foot_traffic_starbucks_terminals_monthly, now model.air_travel.food_category_comparison)
[0m13:19:49.175312 [debug] [Thread-1 (]: Began compiling node model.air_travel.food_category_comparison
[0m13:19:49.176445 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.food_category_comparison"
[0m13:19:49.176841 [debug] [Thread-1 (]: Began executing node model.air_travel.food_category_comparison
[0m13:19:49.177029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:49.177707 [debug] [Thread-1 (]: Finished running node model.air_travel.food_category_comparison
[0m13:19:49.178146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:49.178277 [debug] [MainThread]: Connection 'model.air_travel.food_category_comparison' was properly closed.
[0m13:19:49.181690 [debug] [MainThread]: Command end result
[0m13:19:49.219750 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:19:49.220533 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:19:49.223800 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:19:49.225081 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:19:49.225183 [info ] [MainThread]: Building catalog
[0m13:19:49.228988 [debug] [ThreadPool]: Acquiring new bigquery connection 'cs378-fa2025.information_schema'
[0m13:19:49.236592 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_int`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Route_Equipment')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Country')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('TSA_Traffic')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Establishment')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Aircraft')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Concessions')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Food_Beverage')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Flight_Delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Flight_Routes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Review')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airline')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:19:49.236913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:49.809517 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ce762798-6cd8-4bad-b385-191e43ca0b1a&page=queryresults
[0m13:19:51.569479 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_stg`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airports')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airport_maps')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('flight_delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('aircrafts')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('tsa_traffic')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airlines')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('countries')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('flight_routes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airport_reviews')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:19:51.570199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:52.062434 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:88058050-5701-44ba-b887-18a46f0344d5&page=queryresults
[0m13:19:53.394433 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_tmp`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_llm')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_sub_categories_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_unique')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_vector_search_results')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_inference_results')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_broad_categories_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airline_country_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_broad_categories_frequency')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_duplicates')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_all')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_inference_results_embeddings')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_refined')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_raw_categories')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_terminal_mentioned_food_keywords')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_country_closest_match')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_duplicates_embeddings')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_country_iso_codes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_terminal_food_keywords_category')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_aircraft_icao')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_canonical_categories')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_country_iso_codes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_tsa_checkpoint_terminal')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:19:53.395409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:53.904467 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:15c30961-2ef4-4d61-935f-d6ff832fc17c&page=queryresults
[0m13:19:55.423107 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`air_travel_raw`.__TABLES__ tables
    left join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airports')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airlines')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airport_maps')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('aircrafts')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('flight_delays')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('flight_routes')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('countries')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('tsa_traffic')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airport_reviews')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:19:55.423984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:55.873076 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0cfc58cd-f59a-4ba5-90ce-149d234c870d&page=queryresults
[0m13:19:57.551422 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_mrt`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('foot_traffic_starbucks_airports_monthly')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('aircraft_flight_delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('passenger_sentiment_airports_top_kpis')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('food_category_comparison')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('carrier_flight_delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('foot_traffic_starbucks_terminals_monthly')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:19:57.552301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:58.002615 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d453ef24-2601-4dc9-b642-d674eedeb8ba&page=queryresults
[0m13:19:59.440546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:59.450842 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/scohen/UTCS/378/dbt/air_travel/target/catalog.json
[0m13:19:59.469144 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:19:59.469911 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:19:59.470023 [info ] [MainThread]: Catalog written to /Users/scohen/UTCS/378/dbt/air_travel/target/catalog.json
[0m13:19:59.471878 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 12.952473, "process_in_blocks": "0", "process_kernel_time": 0.308305, "process_mem_max_rss": "391856128", "process_out_blocks": "0", "process_user_time": 2.429689}
[0m13:19:59.472055 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:19:59.472024 after 12.95 seconds
[0m13:19:59.472158 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:19:59.472241 [debug] [MainThread]: Connection 'cs378-fa2025.information_schema' was properly closed.
[0m13:19:59.472342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5b8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ebb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ebb800>]}
[0m13:19:59.472458 [debug] [MainThread]: Flushing usage events
[0m13:19:59.684094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:04.185232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7ebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7eb9d0>]}


============================== 13:20:04.186839 | 1f7aa402-6fc8-49dc-864c-c96a024dca67 ==============================
[0m13:20:04.186839 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:20:04.187078 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'quiet': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve --port 8181', 'version_check': 'True', 'log_cache_events': 'False', 'empty': 'None', 'debug': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m13:20:05.030768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f7aa402-6fc8-49dc-864c-c96a024dca67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb44c30>]}
[0m13:20:05.050788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f7aa402-6fc8-49dc-864c-c96a024dca67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12383e360>]}
[0m13:25:05.830631 [error] [MainThread]: Encountered an error:

[0m13:25:05.836526 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m13:25:05.841216 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 301.6574, "process_in_blocks": "0", "process_kernel_time": 0.204293, "process_mem_max_rss": "375635968", "process_out_blocks": "0", "process_user_time": 1.253291}
[0m13:25:05.842289 [debug] [MainThread]: Command `dbt docs serve` failed at 13:25:05.842153 after 301.66 seconds
[0m13:25:05.842725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b12450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b12350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123aeaa80>]}
[0m13:25:05.843082 [debug] [MainThread]: Flushing usage events
[0m13:25:06.075266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:25.068050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce186e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc639d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc63750>]}


============================== 13:25:25.069659 | 63a54f51-1eed-4ab1-a0f7-e05f73a47c64 ==============================
[0m13:25:25.069659 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:25:25.069900 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_format': 'default', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'invocation_command': 'dbt run --select aircraft_flight_delays', 'introspect': 'True', 'empty': 'False', 'printer_width': '80'}
[0m13:25:25.930266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63a54f51-1eed-4ab1-a0f7-e05f73a47c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfbcc30>]}
[0m13:25:25.950150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63a54f51-1eed-4ab1-a0f7-e05f73a47c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bbe360>]}
[0m13:25:25.950381 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:25:26.029154 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:25:26.078107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:25:26.078392 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/mrt/aircraft_flight_delays.sql
[0m13:25:26.163973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63a54f51-1eed-4ab1-a0f7-e05f73a47c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123fdab50>]}
[0m13:25:26.199286 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:25:26.200118 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:25:26.207336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63a54f51-1eed-4ab1-a0f7-e05f73a47c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bce8a0>]}
[0m13:25:26.207501 [info ] [MainThread]: Found 49 models, 37 data tests, 9 sources, 630 macros
[0m13:25:26.207630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63a54f51-1eed-4ab1-a0f7-e05f73a47c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244299b0>]}
[0m13:25:26.208492 [info ] [MainThread]: 
[0m13:25:26.208621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:26.208714 [info ] [MainThread]: 
[0m13:25:26.208891 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:25:26.209223 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m13:25:26.209376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:26.634417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m13:25:26.634757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:26.942274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_stg)
[0m13:25:26.943063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:27.236207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:25:27.238155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:27.552571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:25:27.554687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:27.864789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63a54f51-1eed-4ab1-a0f7-e05f73a47c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124414460>]}
[0m13:25:27.865469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:27.869469 [debug] [Thread-1 (]: Began running node model.air_travel.aircraft_flight_delays
[0m13:25:27.869937 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_mrt.aircraft_flight_delays ......... [RUN]
[0m13:25:27.870301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.aircraft_flight_delays)
[0m13:25:27.870574 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircraft_flight_delays
[0m13:25:27.878392 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircraft_flight_delays"
[0m13:25:27.879177 [debug] [Thread-1 (]: Began executing node model.air_travel.aircraft_flight_delays
[0m13:25:27.888968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:28.180544 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.aircraft_flight_delays"
[0m13:25:28.181459 [debug] [Thread-1 (]: On model.air_travel.aircraft_flight_delays: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.aircraft_flight_delays"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_mrt`.`aircraft_flight_delays`
      
    
    

    
    OPTIONS()
    as (
      with delayed_flights as (
    select ac.name as aircraft, ac.icao as aircraft_code, 
        count(*) aircraft_delay_flights
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays` fd
    join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al
        on fd.airline_id = al.id
    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap
        on fd.airport_icao = ap.icao
    join `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment` re
        on al.id = re.airline_id and ap.icao = re.dest_airport_icao
    join `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft` ac
        on re.icao_equipment = ac.icao
    where carrier_delay_min > 0
    and weather_delay_min = 0
    group by ac.name, ac.icao
    order by ac.name
),
total_flights as (
    select ac.name as aircraft, ac.icao as aircraft_code, count(*) aircraft_total_flights
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays` fd
    join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al
    on fd.airline_id = al.id
    join `cs378-fa2025`.`dbt_air_travel_int`.`Airport` ap
    on fd.airport_icao = ap.icao
    join `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment` re
    on al.id = re.airline_id and ap.icao = re.dest_airport_icao
    join `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft` ac
    on re.icao_equipment = ac.icao
    group by ac.name, ac.icao
    order by ac.name
)

select aircraft, aircraft_code, aircraft_delay_flights, aircraft_total_flights, round(aircraft_delay_flights / aircraft_total_flights * 100) as aircraft_delay_rate
from delayed_flights
join total_flights
using (aircraft, aircraft_code)
order by aircraft_delay_rate desc
    );
  
[0m13:25:28.781432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:dbe12366-bfbf-43d4-b324-0ddcefe36d80&page=queryresults
[0m13:25:31.056732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63a54f51-1eed-4ab1-a0f7-e05f73a47c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245ca750>]}
[0m13:25:31.057164 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_mrt.aircraft_flight_delays .... [[32mCREATE TABLE (0.0 rows, 379.4 KiB processed)[0m in 3.19s]
[0m13:25:31.057488 [debug] [Thread-1 (]: Finished running node model.air_travel.aircraft_flight_delays
[0m13:25:31.058185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:31.059132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:31.059292 [debug] [MainThread]: Connection 'model.air_travel.aircraft_flight_delays' was properly closed.
[0m13:25:31.059443 [info ] [MainThread]: 
[0m13:25:31.059602 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m13:25:31.059935 [debug] [MainThread]: Command end result
[0m13:25:31.081770 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:25:31.082866 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:25:31.085458 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:25:31.085587 [info ] [MainThread]: 
[0m13:25:31.085752 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:31.085861 [info ] [MainThread]: 
[0m13:25:31.085981 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:25:31.088040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.043243, "process_in_blocks": "0", "process_kernel_time": 0.277289, "process_mem_max_rss": "393314304", "process_out_blocks": "0", "process_user_time": 1.898381}
[0m13:25:31.088227 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:31.088191 after 6.04 seconds
[0m13:25:31.088374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ac3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245951d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245942d0>]}
[0m13:25:31.088509 [debug] [MainThread]: Flushing usage events
[0m13:25:31.293944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:36.481454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b073c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0739d0>]}


============================== 13:25:36.483071 | 134a78ab-1736-482c-ac16-deecc3276c63 ==============================
[0m13:25:36.483071 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:25:36.483313 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs generate', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'quiet': 'False', 'version_check': 'True', 'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'introspect': 'True', 'no_print': 'None', 'empty': 'None', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:25:37.291384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '134a78ab-1736-482c-ac16-deecc3276c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ccc30>]}
[0m13:25:37.310742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '134a78ab-1736-482c-ac16-deecc3276c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1210c2360>]}
[0m13:25:37.310947 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:25:37.386948 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m13:25:37.434238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:37.434378 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:37.451001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '134a78ab-1736-482c-ac16-deecc3276c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214d7d50>]}
[0m13:25:37.458157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '134a78ab-1736-482c-ac16-deecc3276c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121831400>]}
[0m13:25:37.458324 [info ] [MainThread]: Found 49 models, 37 data tests, 9 sources, 630 macros
[0m13:25:37.458460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '134a78ab-1736-482c-ac16-deecc3276c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121186b30>]}
[0m13:25:37.459909 [info ] [MainThread]: 
[0m13:25:37.460041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:37.460137 [info ] [MainThread]: 
[0m13:25:37.460313 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:25:37.462493 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_stg'
[0m13:25:37.462657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:37.721550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m13:25:37.723825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:37.996376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m13:25:37.997556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:38.293287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m13:25:38.297108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:38.577081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '134a78ab-1736-482c-ac16-deecc3276c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121837ad0>]}
[0m13:25:38.577745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:38.582139 [debug] [Thread-1 (]: Began running node model.air_travel.aircrafts
[0m13:25:38.582773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now model.air_travel.aircrafts)
[0m13:25:38.583150 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircrafts
[0m13:25:38.591260 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircrafts"
[0m13:25:38.591926 [debug] [Thread-1 (]: Began executing node model.air_travel.aircrafts
[0m13:25:38.592186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.593578 [debug] [Thread-1 (]: Finished running node model.air_travel.aircrafts
[0m13:25:38.593835 [debug] [Thread-1 (]: Began running node model.air_travel.airlines
[0m13:25:38.594158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircrafts, now model.air_travel.airlines)
[0m13:25:38.594496 [debug] [Thread-1 (]: Began compiling node model.air_travel.airlines
[0m13:25:38.596593 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airlines"
[0m13:25:38.596978 [debug] [Thread-1 (]: Began executing node model.air_travel.airlines
[0m13:25:38.597173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.598234 [debug] [Thread-1 (]: Finished running node model.air_travel.airlines
[0m13:25:38.598447 [debug] [Thread-1 (]: Began running node model.air_travel.airport_maps
[0m13:25:38.598696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airlines, now model.air_travel.airport_maps)
[0m13:25:38.598963 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_maps
[0m13:25:38.600485 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_maps"
[0m13:25:38.600803 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_maps
[0m13:25:38.600984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.601894 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_maps
[0m13:25:38.602077 [debug] [Thread-1 (]: Began running node model.air_travel.airport_reviews
[0m13:25:38.602269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_maps, now model.air_travel.airport_reviews)
[0m13:25:38.602463 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_reviews
[0m13:25:38.604019 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_reviews"
[0m13:25:38.604318 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_reviews
[0m13:25:38.604485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.605366 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_reviews
[0m13:25:38.605547 [debug] [Thread-1 (]: Began running node model.air_travel.airports
[0m13:25:38.605739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_reviews, now model.air_travel.airports)
[0m13:25:38.605952 [debug] [Thread-1 (]: Began compiling node model.air_travel.airports
[0m13:25:38.607475 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airports"
[0m13:25:38.607805 [debug] [Thread-1 (]: Began executing node model.air_travel.airports
[0m13:25:38.607979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.608922 [debug] [Thread-1 (]: Finished running node model.air_travel.airports
[0m13:25:38.609108 [debug] [Thread-1 (]: Began running node model.air_travel.countries
[0m13:25:38.609285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airports, now model.air_travel.countries)
[0m13:25:38.609455 [debug] [Thread-1 (]: Began compiling node model.air_travel.countries
[0m13:25:38.610929 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.countries"
[0m13:25:38.611187 [debug] [Thread-1 (]: Began executing node model.air_travel.countries
[0m13:25:38.611338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.612147 [debug] [Thread-1 (]: Finished running node model.air_travel.countries
[0m13:25:38.612309 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m13:25:38.612476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.countries, now model.air_travel.flight_delays)
[0m13:25:38.612643 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m13:25:38.613890 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m13:25:38.614146 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m13:25:38.614297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.615095 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m13:25:38.615244 [debug] [Thread-1 (]: Began running node model.air_travel.flight_routes
[0m13:25:38.615400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_delays, now model.air_travel.flight_routes)
[0m13:25:38.615555 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_routes
[0m13:25:38.616871 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_routes"
[0m13:25:38.617105 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_routes
[0m13:25:38.617243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.617976 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_routes
[0m13:25:38.618127 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:25:38.618280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_routes, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m13:25:38.618435 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:25:38.619208 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m13:25:38.619440 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:25:38.619581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.620295 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m13:25:38.620441 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_traffic
[0m13:25:38.620589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_canonical_categories, now model.air_travel.tsa_traffic)
[0m13:25:38.620727 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_traffic
[0m13:25:38.621978 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_traffic"
[0m13:25:38.622197 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_traffic
[0m13:25:38.622334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.623041 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_traffic
[0m13:25:38.623182 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_aircraft_icao
[0m13:25:38.623333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tsa_traffic, now model.air_travel.tmp_aircraft_icao)
[0m13:25:38.623491 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_aircraft_icao
[0m13:25:38.624567 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_aircraft_icao"
[0m13:25:38.624798 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_aircraft_icao
[0m13:25:38.624927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.625628 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_aircraft_icao
[0m13:25:38.625779 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m13:25:38.625932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_aircraft_icao, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m13:25:38.626083 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m13:25:38.631360 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m13:25:38.631619 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m13:25:38.631753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.632447 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m13:25:38.632586 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m13:25:38.632728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc, now test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d)
[0m13:25:38.632855 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m13:25:38.634555 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m13:25:38.634784 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m13:25:38.634913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.635589 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m13:25:38.635732 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m13:25:38.635869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d, now model.air_travel.tmp_airport_establishment_unique)
[0m13:25:38.636001 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m13:25:38.637156 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m13:25:38.637369 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m13:25:38.637491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.638121 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m13:25:38.638255 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m13:25:38.638392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_unique, now test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510)
[0m13:25:38.638540 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m13:25:38.640303 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m13:25:38.640517 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m13:25:38.640640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.641252 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m13:25:38.641383 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m13:25:38.641522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510, now test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587)
[0m13:25:38.641647 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m13:25:38.643505 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m13:25:38.643712 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m13:25:38.643834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.644455 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m13:25:38.644587 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_llm
[0m13:25:38.644712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587, now model.air_travel.tmp_airport_llm)
[0m13:25:38.644831 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_llm
[0m13:25:38.645791 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_llm"
[0m13:25:38.646223 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_llm
[0m13:25:38.646338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.646931 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_llm
[0m13:25:38.647061 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m13:25:38.647191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_llm, now test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0)
[0m13:25:38.647320 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m13:25:38.649022 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m13:25:38.649218 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m13:25:38.649333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.649919 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m13:25:38.650047 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_country_iso_codes
[0m13:25:38.650168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0, now model.air_travel.tmp_country_iso_codes)
[0m13:25:38.650283 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_country_iso_codes
[0m13:25:38.651216 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_country_iso_codes"
[0m13:25:38.651408 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_country_iso_codes
[0m13:25:38.651523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.652104 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_country_iso_codes
[0m13:25:38.652228 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m13:25:38.652355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_country_iso_codes, now test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414)
[0m13:25:38.652480 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m13:25:38.654215 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m13:25:38.654595 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m13:25:38.654713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.655286 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m13:25:38.655412 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m13:25:38.655539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414, now test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823)
[0m13:25:38.655653 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m13:25:38.657213 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m13:25:38.657412 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m13:25:38.657522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.658087 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m13:25:38.658210 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m13:25:38.658329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823, now test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81)
[0m13:25:38.658439 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m13:25:38.660132 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m13:25:38.660318 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m13:25:38.660430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.660982 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m13:25:38.661103 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m13:25:38.661220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81, now test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee)
[0m13:25:38.661332 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m13:25:38.662813 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m13:25:38.663174 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m13:25:38.663292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.663866 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m13:25:38.663991 [debug] [Thread-1 (]: Began running node model.air_travel.Aircraft
[0m13:25:38.664112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee, now model.air_travel.Aircraft)
[0m13:25:38.664223 [debug] [Thread-1 (]: Began compiling node model.air_travel.Aircraft
[0m13:25:38.665338 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Aircraft"
[0m13:25:38.665656 [debug] [Thread-1 (]: Began executing node model.air_travel.Aircraft
[0m13:25:38.665768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.666321 [debug] [Thread-1 (]: Finished running node model.air_travel.Aircraft
[0m13:25:38.666441 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:25:38.666564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Aircraft, now model.air_travel.tmp_airport_establishment_raw_categories)
[0m13:25:38.666696 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:25:38.667494 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m13:25:38.667679 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:25:38.667788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.668331 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_raw_categories
[0m13:25:38.668447 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m13:25:38.668568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_raw_categories, now model.air_travel.tmp_airport_all)
[0m13:25:38.668691 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_all
[0m13:25:38.669719 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_all"
[0m13:25:38.669909 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_all
[0m13:25:38.670019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.670579 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m13:25:38.670695 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m13:25:38.670816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_all, now model.air_travel.Country)
[0m13:25:38.670939 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m13:25:38.671822 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m13:25:38.672007 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m13:25:38.672111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.672656 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m13:25:38.672776 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:25:38.672900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Country, now test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd)
[0m13:25:38.673026 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:25:38.676579 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m13:25:38.676784 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:25:38.676888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.677416 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m13:25:38.677533 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:25:38.677643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd, now model.air_travel.tmp_airport_establishment_broad_categories_mapped)
[0m13:25:38.677745 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:25:38.678656 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_mapped"
[0m13:25:38.678839 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:25:38.678941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.679450 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m13:25:38.679558 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates
[0m13:25:38.679667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_broad_categories_mapped, now model.air_travel.tmp_airport_duplicates)
[0m13:25:38.679777 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates
[0m13:25:38.680720 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates"
[0m13:25:38.681081 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates
[0m13:25:38.681182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.681685 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates
[0m13:25:38.681794 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airline_country_mapped
[0m13:25:38.681905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates, now model.air_travel.tmp_airline_country_mapped)
[0m13:25:38.682034 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airline_country_mapped
[0m13:25:38.682967 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airline_country_mapped"
[0m13:25:38.683143 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airline_country_mapped
[0m13:25:38.683243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.683747 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airline_country_mapped
[0m13:25:38.683855 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:25:38.683962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airline_country_mapped, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m13:25:38.684077 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:25:38.686811 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m13:25:38.686994 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:25:38.687094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.687616 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m13:25:38.687726 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:25:38.687835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m13:25:38.687931 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:25:38.689835 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m13:25:38.690011 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:25:38.690110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.690631 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m13:25:38.690747 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m13:25:38.690856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Country_iso_code.5e9388f08c, now model.air_travel.tmp_airport_establishment_broad_categories_frequency)
[0m13:25:38.690960 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m13:25:38.691701 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_frequency"
[0m13:25:38.691872 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m13:25:38.691973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.692496 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m13:25:38.692620 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m13:25:38.692744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_broad_categories_frequency, now model.air_travel.tmp_airport_establishment_sub_categories_mapped)
[0m13:25:38.692856 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m13:25:38.693762 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_sub_categories_mapped"
[0m13:25:38.694081 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m13:25:38.694196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.695878 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m13:25:38.695992 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:25:38.696112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_sub_categories_mapped, now model.air_travel.tmp_airport_duplicates_embeddings)
[0m13:25:38.696246 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:25:38.697084 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m13:25:38.697255 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:25:38.697355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.697853 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates_embeddings
[0m13:25:38.697960 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results
[0m13:25:38.698071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates_embeddings, now model.air_travel.tmp_airport_inference_results)
[0m13:25:38.698169 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results
[0m13:25:38.698960 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results"
[0m13:25:38.699132 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results
[0m13:25:38.699231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.699727 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results
[0m13:25:38.699836 [debug] [Thread-1 (]: Began running node model.air_travel.Airline
[0m13:25:38.699954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results, now model.air_travel.Airline)
[0m13:25:38.700077 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airline
[0m13:25:38.778080 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airline"
[0m13:25:38.778454 [debug] [Thread-1 (]: Began executing node model.air_travel.Airline
[0m13:25:38.778573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.779239 [debug] [Thread-1 (]: Finished running node model.air_travel.Airline
[0m13:25:38.779366 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Establishment
[0m13:25:38.779508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airline, now model.air_travel.Airport_Establishment)
[0m13:25:38.779671 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Establishment
[0m13:25:38.780903 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Establishment"
[0m13:25:38.781151 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Establishment
[0m13:25:38.781269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.781866 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Establishment
[0m13:25:38.781986 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:25:38.782108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Establishment, now model.air_travel.tmp_airport_inference_results_embeddings)
[0m13:25:38.782226 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:25:38.783291 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results_embeddings"
[0m13:25:38.783513 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:25:38.783634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.784269 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results_embeddings
[0m13:25:38.784395 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:25:38.784538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results_embeddings, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m13:25:38.784653 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:25:38.786105 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m13:25:38.786313 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:25:38.786416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.786956 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m13:25:38.787068 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:25:38.787184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26)
[0m13:25:38.787286 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:25:38.789778 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m13:25:38.789971 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:25:38.790080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.790660 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m13:25:38.790787 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m13:25:38.790916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26, now test.air_travel.unique_Airline_id.cb196c2622)
[0m13:25:38.791033 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m13:25:38.792349 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m13:25:38.792532 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m13:25:38.792635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.793177 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m13:25:38.793292 [debug] [Thread-1 (]: Began running node model.air_travel.Food_Beverage
[0m13:25:38.793401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now model.air_travel.Food_Beverage)
[0m13:25:38.793502 [debug] [Thread-1 (]: Began compiling node model.air_travel.Food_Beverage
[0m13:25:38.794345 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Food_Beverage"
[0m13:25:38.794518 [debug] [Thread-1 (]: Began executing node model.air_travel.Food_Beverage
[0m13:25:38.794619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.795155 [debug] [Thread-1 (]: Finished running node model.air_travel.Food_Beverage
[0m13:25:38.795272 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:25:38.795418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Food_Beverage, now test.air_travel.not_null_Airport_Establishment_business.fa42968b3c)
[0m13:25:38.795535 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:25:38.796835 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m13:25:38.797189 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:25:38.797291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.797826 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m13:25:38.797940 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:25:38.798051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Establishment_business.fa42968b3c, now test.air_travel.unique_Airport_Establishment_business.c0ba13e1af)
[0m13:25:38.798154 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:25:38.799237 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m13:25:38.799409 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:25:38.799518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.800090 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m13:25:38.800204 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_vector_search_results
[0m13:25:38.800315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Establishment_business.c0ba13e1af, now model.air_travel.tmp_airport_vector_search_results)
[0m13:25:38.800417 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_vector_search_results
[0m13:25:38.801499 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_vector_search_results"
[0m13:25:38.801903 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_vector_search_results
[0m13:25:38.802017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.802573 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_vector_search_results
[0m13:25:38.802694 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:25:38.802827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_vector_search_results, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965)
[0m13:25:38.802960 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:25:38.804563 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m13:25:38.804925 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:25:38.805045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.805607 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m13:25:38.805718 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:25:38.805830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965, now test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496)
[0m13:25:38.805932 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:25:38.807511 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"
[0m13:25:38.807682 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:25:38.807807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.808378 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m13:25:38.808491 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m13:25:38.808602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496, now model.air_travel.tmp_airport_refined)
[0m13:25:38.808703 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_refined
[0m13:25:38.809713 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_refined"
[0m13:25:38.809886 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_refined
[0m13:25:38.809984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.810500 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m13:25:38.810684 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_iso_codes
[0m13:25:38.810857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_refined, now model.air_travel.tmp_airport_country_iso_codes)
[0m13:25:38.811008 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_iso_codes
[0m13:25:38.812126 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_iso_codes"
[0m13:25:38.812309 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_iso_codes
[0m13:25:38.812414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.812959 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_iso_codes
[0m13:25:38.813164 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_closest_match
[0m13:25:38.813288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_country_iso_codes, now model.air_travel.tmp_airport_country_closest_match)
[0m13:25:38.813404 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_closest_match
[0m13:25:38.814313 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_closest_match"
[0m13:25:38.814516 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_closest_match
[0m13:25:38.814630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.815174 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_closest_match
[0m13:25:38.815370 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m13:25:38.815499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_country_closest_match, now model.air_travel.Airport)
[0m13:25:38.815616 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m13:25:38.816803 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m13:25:38.816997 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m13:25:38.817109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.817649 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m13:25:38.817901 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Concessions
[0m13:25:38.818077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport, now model.air_travel.Airport_Concessions)
[0m13:25:38.818212 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Concessions
[0m13:25:38.819194 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Concessions"
[0m13:25:38.819396 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Concessions
[0m13:25:38.819502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.820067 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Concessions
[0m13:25:38.820181 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Review
[0m13:25:38.820320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Concessions, now model.air_travel.Airport_Review)
[0m13:25:38.820434 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Review
[0m13:25:38.821481 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Review"
[0m13:25:38.821667 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Review
[0m13:25:38.821766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.822298 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Review
[0m13:25:38.822407 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Delays
[0m13:25:38.822529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Review, now model.air_travel.Flight_Delays)
[0m13:25:38.822664 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Delays
[0m13:25:38.823613 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Delays"
[0m13:25:38.823923 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Delays
[0m13:25:38.824086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.824733 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Delays
[0m13:25:38.824855 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Routes
[0m13:25:38.824983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Flight_Delays, now model.air_travel.Flight_Routes)
[0m13:25:38.825116 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Routes
[0m13:25:38.826381 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Routes"
[0m13:25:38.826569 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Routes
[0m13:25:38.826673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.827245 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Routes
[0m13:25:38.827369 [debug] [Thread-1 (]: Began running node model.air_travel.TSA_Traffic
[0m13:25:38.827496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Flight_Routes, now model.air_travel.TSA_Traffic)
[0m13:25:38.827630 [debug] [Thread-1 (]: Began compiling node model.air_travel.TSA_Traffic
[0m13:25:38.828521 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.TSA_Traffic"
[0m13:25:38.828705 [debug] [Thread-1 (]: Began executing node model.air_travel.TSA_Traffic
[0m13:25:38.828806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.829329 [debug] [Thread-1 (]: Finished running node model.air_travel.TSA_Traffic
[0m13:25:38.829437 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:25:38.829566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.TSA_Traffic, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m13:25:38.829711 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:25:38.831009 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m13:25:38.831192 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:25:38.831303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.831862 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m13:25:38.831977 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m13:25:38.832086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0)
[0m13:25:38.832189 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m13:25:38.834776 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m13:25:38.834942 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m13:25:38.835047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.835573 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m13:25:38.835684 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:25:38.835792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m13:25:38.835894 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:25:38.836968 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m13:25:38.837144 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:25:38.837243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.837767 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m13:25:38.837882 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:25:38.837995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m13:25:38.838110 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:25:38.840158 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m13:25:38.840350 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:25:38.840456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.840988 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m13:25:38.841114 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m13:25:38.841246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1)
[0m13:25:38.841363 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m13:25:38.842747 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"
[0m13:25:38.842922 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m13:25:38.843027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.843574 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m13:25:38.843688 [debug] [Thread-1 (]: Began running node model.air_travel.passenger_sentiment_airports_top_kpis
[0m13:25:38.843799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1, now model.air_travel.passenger_sentiment_airports_top_kpis)
[0m13:25:38.843901 [debug] [Thread-1 (]: Began compiling node model.air_travel.passenger_sentiment_airports_top_kpis
[0m13:25:38.844953 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.passenger_sentiment_airports_top_kpis"
[0m13:25:38.845126 [debug] [Thread-1 (]: Began executing node model.air_travel.passenger_sentiment_airports_top_kpis
[0m13:25:38.845229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.845758 [debug] [Thread-1 (]: Finished running node model.air_travel.passenger_sentiment_airports_top_kpis
[0m13:25:38.845869 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m13:25:38.845976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.passenger_sentiment_airports_top_kpis, now model.air_travel.tmp_airport_terminal_mentioned_food_keywords)
[0m13:25:38.846079 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m13:25:38.846884 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_terminal_mentioned_food_keywords"
[0m13:25:38.847053 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m13:25:38.847155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.847702 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m13:25:38.847811 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m13:25:38.847923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_terminal_mentioned_food_keywords, now test.air_travel.not_null_Airport_Review_id.715ca7a304)
[0m13:25:38.848044 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m13:25:38.849352 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m13:25:38.849562 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m13:25:38.849677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.850279 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m13:25:38.850397 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m13:25:38.850517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Review_id.715ca7a304, now test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9)
[0m13:25:38.850621 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m13:25:38.851945 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9"
[0m13:25:38.852143 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m13:25:38.852249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.852825 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m13:25:38.852951 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m13:25:38.853079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9, now test.air_travel.unique_Airport_Review_id.690fe37ba9)
[0m13:25:38.853188 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m13:25:38.854414 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m13:25:38.854778 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m13:25:38.854896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.855439 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m13:25:38.855557 [debug] [Thread-1 (]: Began running node model.air_travel.carrier_flight_delays
[0m13:25:38.855664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Review_id.690fe37ba9, now model.air_travel.carrier_flight_delays)
[0m13:25:38.855783 [debug] [Thread-1 (]: Began compiling node model.air_travel.carrier_flight_delays
[0m13:25:38.856934 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.carrier_flight_delays"
[0m13:25:38.857293 [debug] [Thread-1 (]: Began executing node model.air_travel.carrier_flight_delays
[0m13:25:38.857398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.857967 [debug] [Thread-1 (]: Finished running node model.air_travel.carrier_flight_delays
[0m13:25:38.858090 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:25:38.858214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.carrier_flight_delays, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m13:25:38.858318 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:25:38.859977 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m13:25:38.860158 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:25:38.860265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.860801 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m13:25:38.860917 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:25:38.861029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3)
[0m13:25:38.861136 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:25:38.862581 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m13:25:38.862754 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:25:38.862858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.863378 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m13:25:38.863489 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m13:25:38.863597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3, now test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4)
[0m13:25:38.863698 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m13:25:38.865212 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"
[0m13:25:38.865541 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m13:25:38.865649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.866214 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m13:25:38.866342 [debug] [Thread-1 (]: Began running node model.air_travel.Route_Equipment
[0m13:25:38.866468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4, now model.air_travel.Route_Equipment)
[0m13:25:38.866578 [debug] [Thread-1 (]: Began compiling node model.air_travel.Route_Equipment
[0m13:25:38.867326 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Route_Equipment"
[0m13:25:38.867498 [debug] [Thread-1 (]: Began executing node model.air_travel.Route_Equipment
[0m13:25:38.867596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.868104 [debug] [Thread-1 (]: Finished running node model.air_travel.Route_Equipment
[0m13:25:38.868215 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:25:38.868361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Route_Equipment, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m13:25:38.868475 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:25:38.870229 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m13:25:38.870550 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:25:38.870668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.871214 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m13:25:38.871323 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:25:38.871431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e)
[0m13:25:38.871534 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:25:38.872825 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m13:25:38.873138 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:25:38.873255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.873798 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m13:25:38.873909 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:25:38.874016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e, now test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052)
[0m13:25:38.874118 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:25:38.875693 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m13:25:38.875862 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:25:38.875965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.876476 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m13:25:38.876588 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:25:38.876698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052, now test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df)
[0m13:25:38.876799 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:25:38.878142 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m13:25:38.878482 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:25:38.878595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.879136 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m13:25:38.879249 [debug] [Thread-1 (]: Began running node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m13:25:38.879354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df, now model.air_travel.foot_traffic_starbucks_airports_monthly)
[0m13:25:38.879454 [debug] [Thread-1 (]: Began compiling node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m13:25:38.880520 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.foot_traffic_starbucks_airports_monthly"
[0m13:25:38.880857 [debug] [Thread-1 (]: Began executing node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m13:25:38.880968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.881513 [debug] [Thread-1 (]: Finished running node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m13:25:38.881621 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_tsa_checkpoint_terminal
[0m13:25:38.881728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.foot_traffic_starbucks_airports_monthly, now model.air_travel.tmp_tsa_checkpoint_terminal)
[0m13:25:38.881826 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_tsa_checkpoint_terminal
[0m13:25:38.882631 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_tsa_checkpoint_terminal"
[0m13:25:38.882812 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_tsa_checkpoint_terminal
[0m13:25:38.882923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.883455 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_tsa_checkpoint_terminal
[0m13:25:38.883568 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:25:38.883688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_tsa_checkpoint_terminal, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m13:25:38.883814 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:25:38.885640 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m13:25:38.885810 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:25:38.885912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.886424 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m13:25:38.886536 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:25:38.886644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a)
[0m13:25:38.886743 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:25:38.888014 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"
[0m13:25:38.888327 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:25:38.888443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.888983 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m13:25:38.889097 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m13:25:38.889202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a, now model.air_travel.tmp_airport_terminal_food_keywords_category)
[0m13:25:38.889304 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m13:25:38.890467 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_terminal_food_keywords_category"
[0m13:25:38.890653 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m13:25:38.890754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.891272 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m13:25:38.891382 [debug] [Thread-1 (]: Began running node model.air_travel.aircraft_flight_delays
[0m13:25:38.891520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_terminal_food_keywords_category, now model.air_travel.aircraft_flight_delays)
[0m13:25:38.891640 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircraft_flight_delays
[0m13:25:38.893006 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircraft_flight_delays"
[0m13:25:38.893175 [debug] [Thread-1 (]: Began executing node model.air_travel.aircraft_flight_delays
[0m13:25:38.893277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.893796 [debug] [Thread-1 (]: Finished running node model.air_travel.aircraft_flight_delays
[0m13:25:38.893911 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:25:38.894021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircraft_flight_delays, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m13:25:38.894124 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:25:38.896542 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m13:25:38.896721 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:25:38.896827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.897353 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m13:25:38.897466 [debug] [Thread-1 (]: Began running node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m13:25:38.897574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now model.air_travel.foot_traffic_starbucks_terminals_monthly)
[0m13:25:38.897676 [debug] [Thread-1 (]: Began compiling node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m13:25:38.898714 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.foot_traffic_starbucks_terminals_monthly"
[0m13:25:38.898897 [debug] [Thread-1 (]: Began executing node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m13:25:38.899000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.899527 [debug] [Thread-1 (]: Finished running node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m13:25:38.899639 [debug] [Thread-1 (]: Began running node model.air_travel.food_category_comparison
[0m13:25:38.899746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.foot_traffic_starbucks_terminals_monthly, now model.air_travel.food_category_comparison)
[0m13:25:38.899847 [debug] [Thread-1 (]: Began compiling node model.air_travel.food_category_comparison
[0m13:25:38.900870 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.food_category_comparison"
[0m13:25:38.901050 [debug] [Thread-1 (]: Began executing node model.air_travel.food_category_comparison
[0m13:25:38.901152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:38.901670 [debug] [Thread-1 (]: Finished running node model.air_travel.food_category_comparison
[0m13:25:38.902023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:38.902124 [debug] [MainThread]: Connection 'model.air_travel.food_category_comparison' was properly closed.
[0m13:25:38.905243 [debug] [MainThread]: Command end result
[0m13:25:38.941964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:25:38.942837 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:25:38.946078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m13:25:38.946607 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:25:38.946694 [info ] [MainThread]: Building catalog
[0m13:25:38.950377 [debug] [ThreadPool]: Acquiring new bigquery connection 'cs378-fa2025.information_schema'
[0m13:25:38.957341 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_stg`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('flight_routes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('tsa_traffic')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airports')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airport_maps')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('countries')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airlines')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('aircrafts')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airport_reviews')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('flight_delays')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:25:38.957691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:39.431016 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7d369736-3248-4d19-99f7-5e6a68727b72&page=queryresults
[0m13:25:40.941764 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_int`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Aircraft')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Review')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Route_Equipment')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airline')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Food_Beverage')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Establishment')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Flight_Delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('TSA_Traffic')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Flight_Routes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Country')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Concessions')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:25:40.942444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:41.364732 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:cc2cbc8a-fd25-4563-9a87-aa1bb9289cf6&page=queryresults
[0m13:25:43.029812 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_tmp`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_vector_search_results')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_country_closest_match')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_broad_categories_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_country_iso_codes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_duplicates_embeddings')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_all')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_broad_categories_frequency')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_country_iso_codes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_terminal_food_keywords_category')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_inference_results_embeddings')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_refined')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_terminal_mentioned_food_keywords')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_raw_categories')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_unique')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_tsa_checkpoint_terminal')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airline_country_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_llm')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_sub_categories_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_canonical_categories')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_aircraft_icao')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_duplicates')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_inference_results')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:25:43.030767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:43.527795 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1064dd5f-5057-4f56-9234-624289ccf7ae&page=queryresults
[0m13:25:44.965434 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`air_travel_raw`.__TABLES__ tables
    left join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airport_maps')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('aircrafts')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airports')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('flight_routes')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('tsa_traffic')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('countries')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airport_reviews')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airlines')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('flight_delays')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:25:44.966130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:45.370260 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e71f5b97-f973-4fa0-a4c6-541008152a2d&page=queryresults
[0m13:25:46.913258 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_mrt`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('foot_traffic_starbucks_terminals_monthly')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('food_category_comparison')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('foot_traffic_starbucks_airports_monthly')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('aircraft_flight_delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('carrier_flight_delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('passenger_sentiment_airports_top_kpis')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:25:46.913757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:47.419020 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:13bb8009-1792-4cb8-a3ac-71c6ea3295fd&page=queryresults
[0m13:25:48.976658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:48.986640 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/scohen/UTCS/378/dbt/air_travel/target/catalog.json
[0m13:25:49.004434 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m13:25:49.005390 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m13:25:49.005525 [info ] [MainThread]: Catalog written to /Users/scohen/UTCS/378/dbt/air_travel/target/catalog.json
[0m13:25:49.007380 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 12.54939, "process_in_blocks": "0", "process_kernel_time": 0.251676, "process_mem_max_rss": "391512064", "process_out_blocks": "0", "process_user_time": 2.355083}
[0m13:25:49.007561 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:25:49.007528 after 12.55 seconds
[0m13:25:49.007664 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:25:49.007756 [debug] [MainThread]: Connection 'cs378-fa2025.information_schema' was properly closed.
[0m13:25:49.007872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af78ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219f99c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219fbb70>]}
[0m13:25:49.008002 [debug] [MainThread]: Flushing usage events
[0m13:25:49.200912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:54.151758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1c86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d013c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0139d0>]}


============================== 13:25:54.153376 | d39b0c4b-69bb-4c23-9736-518d193eae72 ==============================
[0m13:25:54.153376 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m13:25:54.153619 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve --port 8181', 'empty': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'use_colors': 'True', 'quiet': 'False'}
[0m13:25:55.063364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd39b0c4b-69bb-4c23-9736-518d193eae72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c36cc30>]}
[0m13:25:55.084081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd39b0c4b-69bb-4c23-9736-518d193eae72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bffa360>]}
[0m13:33:39.865452 [error] [MainThread]: Encountered an error:

[0m13:33:39.870546 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Users/scohen/UTCS/378/dbt/dbt-env/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m13:33:39.876087 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 465.74658, "process_in_blocks": "0", "process_kernel_time": 0.210499, "process_mem_max_rss": "371277824", "process_out_blocks": "0", "process_user_time": 1.329184}
[0m13:33:39.878014 [debug] [MainThread]: Command `dbt docs serve` failed at 13:33:39.877714 after 465.75 seconds
[0m13:33:39.878523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c2ce450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c2ce350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c2a6a80>]}
[0m13:33:39.878902 [debug] [MainThread]: Flushing usage events
[0m13:33:40.134821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:33.885830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ec6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b037750>]}


============================== 14:19:33.887978 | aea5ef70-c785-4475-8f3d-1df556c90255 ==============================
[0m14:19:33.887978 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m14:19:33.888259 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt test --select models/int/Aircraft.sql models/int/Airline.sql models/int/Airport.sql models/int/Airport_Concessions.sql models/int/Airport_Establishment.sql models/int/Airport_Review.sql models/int/Country.sql models/int/Flight_Delays.sql models/int/Flight_Routes.sql models/int/Food_Beverage.sql models/int/Route_Equipment.sql models/int/TSA_Traffic.sql models/int/schema.yml', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80', 'quiet': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'empty': 'None', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True'}
[0m14:19:34.865411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aea5ef70-c785-4475-8f3d-1df556c90255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a390c30>]}
[0m14:19:34.887983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aea5ef70-c785-4475-8f3d-1df556c90255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fc2360>]}
[0m14:19:34.888467 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:19:34.979182 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m14:19:35.037436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:19:35.037649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:19:35.057971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aea5ef70-c785-4475-8f3d-1df556c90255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213e3d50>]}
[0m14:19:35.100605 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:19:35.101784 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:19:35.115508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aea5ef70-c785-4475-8f3d-1df556c90255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218696d0>]}
[0m14:19:35.115761 [info ] [MainThread]: Found 49 models, 37 data tests, 9 sources, 630 macros
[0m14:19:35.115896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea5ef70-c785-4475-8f3d-1df556c90255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217e3070>]}
[0m14:19:35.129043 [info ] [MainThread]: 
[0m14:19:35.129236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:35.129325 [info ] [MainThread]: 
[0m14:19:35.129554 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:19:35.132326 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_int'
[0m14:19:35.132586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:35.426729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m14:19:35.427541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:35.716970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m14:19:35.717929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:35.995983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m14:19:35.997796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:36.276834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea5ef70-c785-4475-8f3d-1df556c90255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121831230>]}
[0m14:19:36.277246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:36.279287 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m14:19:36.279585 [info ] [Thread-1 (]: 1 of 28 START test dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name  [RUN]
[0m14:19:36.279824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd)
[0m14:19:36.279972 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m14:19:36.288735 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m14:19:36.289263 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m14:19:36.297321 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m14:19:36.297727 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        icao, iata, name
    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
    group by icao, iata, name
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:19:36.297922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:37.089672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e58fc54d-2604-4ca1-85cc-6e3fc2fca62c&page=queryresults
[0m14:19:37.574691 [info ] [Thread-1 (]: 1 of 28 PASS dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name . [[32mPASS[0m in 1.29s]
[0m14:19:37.575010 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m14:19:37.575220 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m14:19:37.575692 [info ] [Thread-1 (]: 2 of 28 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m14:19:37.576006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m14:19:37.576159 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m14:19:37.578804 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m14:19:37.579355 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m14:19:37.581091 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m14:19:37.581794 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airport_icao, terminal, business, location
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    group by airport_icao, terminal, business, location
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:19:37.582076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:38.048191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e9a8ac7b-fec6-4a09-bfd3-6e06cef02376&page=queryresults
[0m14:19:38.503804 [info ] [Thread-1 (]: 2 of 28 PASS dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[32mPASS[0m in 0.93s]
[0m14:19:38.504648 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m14:19:38.505013 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m14:19:38.505396 [info ] [Thread-1 (]: 3 of 28 START test dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [RUN]
[0m14:19:38.505939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m14:19:38.506300 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m14:19:38.511135 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m14:19:38.512189 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m14:19:38.514595 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m14:19:38.515409 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_month, airline_id, airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    group by event_month, airline_id, airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:19:38.515789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:38.977868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ff298ed5-98d1-42d2-9f0b-038e74b96ba1&page=queryresults
[0m14:19:39.385898 [info ] [Thread-1 (]: 3 of 28 PASS dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [[32mPASS[0m in 0.88s]
[0m14:19:39.386381 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m14:19:39.386625 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m14:19:39.386894 [info ] [Thread-1 (]: 4 of 28 START test dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [RUN]
[0m14:19:39.387196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m14:19:39.387416 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m14:19:39.390528 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m14:19:39.391071 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m14:19:39.392613 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m14:19:39.393023 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    group by airline_id, source_airport_icao, dest_airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:19:39.393241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:39.896027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c7d2a5d1-500f-47aa-931c-941b2235b512&page=queryresults
[0m14:19:40.277318 [info ] [Thread-1 (]: 4 of 28 PASS dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [[32mPASS[0m in 0.89s]
[0m14:19:40.278276 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m14:19:40.278790 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m14:19:40.279177 [info ] [Thread-1 (]: 5 of 28 START test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [RUN]
[0m14:19:40.279602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965)
[0m14:19:40.279921 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m14:19:40.284761 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m14:19:40.285535 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m14:19:40.287493 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m14:19:40.288200 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        business, menu_item
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    group by business, menu_item
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:19:40.288568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:40.880561 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c3e0422b-d260-4f31-b3ba-8ad149891bb4&page=queryresults
[0m14:19:41.304140 [info ] [Thread-1 (]: 5 of 28 PASS dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [[32mPASS[0m in 1.02s]
[0m14:19:41.304879 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m14:19:41.305906 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:19:41.306403 [info ] [Thread-1 (]: 6 of 28 START test dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [RUN]
[0m14:19:41.306978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m14:19:41.307312 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:19:41.311781 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m14:19:41.312492 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:19:41.314083 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m14:19:41.314622 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:19:41.314836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:41.871672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:eb09f0d5-5539-44e4-81dc-c71d6f99def7&page=queryresults
[0m14:19:42.272462 [info ] [Thread-1 (]: 6 of 28 PASS dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [[32mPASS[0m in 0.97s]
[0m14:19:42.273218 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:19:42.273574 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m14:19:42.273915 [info ] [Thread-1 (]: 7 of 28 START test dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [RUN]
[0m14:19:42.274331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m14:19:42.274643 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m14:19:42.278800 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m14:19:42.279438 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m14:19:42.283812 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m14:19:42.284519 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_date, event_hour, airport_icao, security_checkpoint
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    group by event_date, event_hour, airport_icao, security_checkpoint
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:19:42.284812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:42.708900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:575547ac-a0c3-4f6c-b0fc-ae09a0f2ca5b&page=queryresults
[0m14:19:43.145620 [info ] [Thread-1 (]: 7 of 28 PASS dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [[32mPASS[0m in 0.87s]
[0m14:19:43.146439 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m14:19:43.146926 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m14:19:43.147345 [info ] [Thread-1 (]: 8 of 28 START test not_null_Airline_id ......................................... [RUN]
[0m14:19:43.147931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m14:19:43.148259 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m14:19:43.153499 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m14:19:43.154162 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m14:19:43.258295 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m14:19:43.258804 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m14:19:43.258984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:43.754810 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f148250c-99a6-451c-81b8-85a28af90f67&page=queryresults
[0m14:19:44.193427 [info ] [Thread-1 (]: 8 of 28 PASS not_null_Airline_id ............................................... [[32mPASS[0m in 1.05s]
[0m14:19:44.194322 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m14:19:44.194738 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m14:19:44.195098 [info ] [Thread-1 (]: 9 of 28 START test not_null_Airport_Establishment_business ..................... [RUN]
[0m14:19:44.195531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_Establishment_business.fa42968b3c)
[0m14:19:44.195829 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m14:19:44.199582 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m14:19:44.200181 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m14:19:44.201783 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m14:19:44.202308 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Establishment_business.fa42968b3c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select business
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
where business is null



  
  
      
    ) dbt_internal_test
[0m14:19:44.202526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:44.681171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7eb1a293-b766-4773-aaa2-6514eacff730&page=queryresults
[0m14:19:45.196137 [info ] [Thread-1 (]: 9 of 28 PASS not_null_Airport_Establishment_business ........................... [[32mPASS[0m in 1.00s]
[0m14:19:45.196876 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m14:19:45.197285 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m14:19:45.197691 [info ] [Thread-1 (]: 10 of 28 START test not_null_Airport_Review_id ................................. [RUN]
[0m14:19:45.198364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Establishment_business.fa42968b3c, now test.air_travel.not_null_Airport_Review_id.715ca7a304)
[0m14:19:45.198831 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m14:19:45.202292 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m14:19:45.203289 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m14:19:45.205285 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m14:19:45.205843 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Review_id.715ca7a304: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Review_id.715ca7a304"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
where id is null



  
  
      
    ) dbt_internal_test
[0m14:19:45.206075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:45.646929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:eb5128a5-fe14-47ef-835c-d7ee5cbea417&page=queryresults
[0m14:19:46.138047 [info ] [Thread-1 (]: 10 of 28 PASS not_null_Airport_Review_id ....................................... [[32mPASS[0m in 0.94s]
[0m14:19:46.138897 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m14:19:46.139222 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m14:19:46.139559 [info ] [Thread-1 (]: 11 of 28 START test not_null_Airport_icao ...................................... [RUN]
[0m14:19:46.140021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Review_id.715ca7a304, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m14:19:46.140313 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m14:19:46.143810 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m14:19:46.144520 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m14:19:46.146422 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m14:19:46.146962 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m14:19:46.147175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:46.651512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:cca167f2-9b79-4f33-9216-80dd7007a7fe&page=queryresults
[0m14:19:47.045701 [info ] [Thread-1 (]: 11 of 28 PASS not_null_Airport_icao ............................................ [[32mPASS[0m in 0.91s]
[0m14:19:47.046563 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m14:19:47.047016 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m14:19:47.047437 [info ] [Thread-1 (]: 12 of 28 START test not_null_Country_iso_code .................................. [RUN]
[0m14:19:47.048042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m14:19:47.048518 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m14:19:47.051124 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m14:19:47.051656 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m14:19:47.053094 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m14:19:47.053510 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m14:19:47.053695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:47.528903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3949d403-75f0-4d85-af13-4cfda5a44552&page=queryresults
[0m14:19:47.925326 [info ] [Thread-1 (]: 12 of 28 PASS not_null_Country_iso_code ........................................ [[32mPASS[0m in 0.88s]
[0m14:19:47.926173 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m14:19:47.926642 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m14:19:47.927072 [info ] [Thread-1 (]: 13 of 28 START test relationships_Airline_country_code__iso_code__ref_Country_ . [RUN]
[0m14:19:47.927590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26)
[0m14:19:47.927943 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m14:19:47.933709 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m14:19:47.934317 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m14:19:47.935697 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m14:19:47.936059 [debug] [Thread-1 (]: On test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:19:47.936269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:48.669638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:94b9f502-d12a-44e6-9f3b-989ef7c7264f&page=queryresults
[0m14:19:49.071563 [info ] [Thread-1 (]: 13 of 28 PASS relationships_Airline_country_code__iso_code__ref_Country_ ....... [[32mPASS[0m in 1.14s]
[0m14:19:49.074368 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m14:19:49.075059 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m14:19:49.075379 [info ] [Thread-1 (]: 14 of 28 START test relationships_Airport_Concessions_airport_icao__icao__ref_Airport_  [RUN]
[0m14:19:49.075726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26, now test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1)
[0m14:19:49.075932 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m14:19:49.079582 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"
[0m14:19:49.080362 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m14:19:49.082053 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"
[0m14:19:49.082725 [debug] [Thread-1 (]: On test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:19:49.082965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:49.503275 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:36befa57-0999-41c8-8207-ca620ff02974&page=queryresults
[0m14:19:49.871617 [info ] [Thread-1 (]: 14 of 28 PASS relationships_Airport_Concessions_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 0.80s]
[0m14:19:49.872529 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m14:19:49.872927 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m14:19:49.873346 [info ] [Thread-1 (]: 15 of 28 START test relationships_Airport_Review_airport_icao__icao__ref_Airport_  [RUN]
[0m14:19:49.873797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1, now test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9)
[0m14:19:49.874131 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m14:19:49.879028 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9"
[0m14:19:49.879654 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m14:19:49.881115 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9"
[0m14:19:49.881638 [debug] [Thread-1 (]: On test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:19:49.881868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:50.476418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:385f62d9-204f-49d9-b8e9-4cff07dd90de&page=queryresults
[0m14:19:50.888424 [info ] [Thread-1 (]: 15 of 28 PASS relationships_Airport_Review_airport_icao__icao__ref_Airport_ .... [[32mPASS[0m in 1.01s]
[0m14:19:50.889465 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m14:19:50.889980 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m14:19:50.890479 [info ] [Thread-1 (]: 16 of 28 START test relationships_Airport_country_code__iso_code__ref_Country_ . [RUN]
[0m14:19:50.890964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9, now test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0)
[0m14:19:50.891429 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m14:19:50.895451 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m14:19:50.896139 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m14:19:50.897920 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m14:19:50.898528 [debug] [Thread-1 (]: On test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:19:50.898769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:51.541410 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:096f346e-e508-4126-9060-c2b3da6d04be&page=queryresults
[0m14:19:51.900610 [info ] [Thread-1 (]: 16 of 28 PASS relationships_Airport_country_code__iso_code__ref_Country_ ....... [[32mPASS[0m in 1.01s]
[0m14:19:51.901221 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m14:19:51.901535 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m14:19:51.901866 [info ] [Thread-1 (]: 17 of 28 START test relationships_Flight_Delays_airline_id__id__ref_Airline_ ... [RUN]
[0m14:19:51.902244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0, now test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3)
[0m14:19:51.902606 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m14:19:51.907679 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m14:19:51.908382 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m14:19:51.909764 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m14:19:51.910309 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:19:51.910519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:52.417382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:420f0dfd-dd85-4008-b956-00cd57526ac3&page=queryresults
[0m14:19:52.840269 [info ] [Thread-1 (]: 17 of 28 PASS relationships_Flight_Delays_airline_id__id__ref_Airline_ ......... [[32mPASS[0m in 0.94s]
[0m14:19:52.841040 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m14:19:52.841390 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m14:19:52.841698 [info ] [Thread-1 (]: 18 of 28 START test relationships_Flight_Delays_airport_icao__icao__ref_Airport_  [RUN]
[0m14:19:52.842042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3, now test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4)
[0m14:19:52.842328 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m14:19:52.847597 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"
[0m14:19:52.848210 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m14:19:52.849597 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"
[0m14:19:52.850552 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:19:52.850963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:53.421402 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:966c449e-b723-49aa-a200-6039d62a06a6&page=queryresults
[0m14:19:53.859775 [info ] [Thread-1 (]: 18 of 28 PASS relationships_Flight_Delays_airport_icao__icao__ref_Airport_ ..... [[32mPASS[0m in 1.02s]
[0m14:19:53.860463 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m14:19:53.860821 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m14:19:53.861189 [info ] [Thread-1 (]: 19 of 28 START test relationships_Flight_Routes_airline_id__id__ref_Airline_ ... [RUN]
[0m14:19:53.861652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4, now test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e)
[0m14:19:53.861989 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m14:19:53.866101 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m14:19:53.866732 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m14:19:53.868158 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m14:19:53.868602 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:19:53.868819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:54.262797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4c7906b5-72b5-4211-8f9f-4fe7ca35b04c&page=queryresults
[0m14:19:54.702713 [info ] [Thread-1 (]: 19 of 28 PASS relationships_Flight_Routes_airline_id__id__ref_Airline_ ......... [[32mPASS[0m in 0.84s]
[0m14:19:54.703520 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m14:19:54.703890 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m14:19:54.704323 [info ] [Thread-1 (]: 20 of 28 START test relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_  [RUN]
[0m14:19:54.704804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e, now test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052)
[0m14:19:54.705107 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m14:19:54.712446 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m14:19:54.713066 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m14:19:54.714399 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m14:19:54.714837 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dest_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where dest_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:19:54.715085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:55.305280 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f9fc3298-8497-4619-ae23-971e67350d61&page=queryresults
[0m14:19:55.704172 [info ] [Thread-1 (]: 20 of 28 PASS relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 1.00s]
[0m14:19:55.705017 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m14:19:55.705417 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m14:19:55.705789 [info ] [Thread-1 (]: 21 of 28 START test relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_  [RUN]
[0m14:19:55.706236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052, now test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df)
[0m14:19:55.706550 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m14:19:55.710502 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m14:19:55.711042 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m14:19:55.712771 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m14:19:55.713184 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select source_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where source_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:19:55.713401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:56.178813 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b8379da0-0f26-400b-bb09-7e951c362071&page=queryresults
[0m14:19:56.515360 [info ] [Thread-1 (]: 21 of 28 PASS relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 0.81s]
[0m14:19:56.516086 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m14:19:56.516447 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m14:19:56.516956 [info ] [Thread-1 (]: 22 of 28 START test relationships_Food_Beverage_business__business__ref_Airport_Establishment_  [RUN]
[0m14:19:56.517542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df, now test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496)
[0m14:19:56.517889 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m14:19:56.522367 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"
[0m14:19:56.522941 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m14:19:56.524482 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"
[0m14:19:56.525047 [debug] [Thread-1 (]: On test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select business as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    where business is not null
),

parent as (
    select business as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:19:56.525403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:56.956604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:93acfcbe-67d9-4b99-88a1-bdaf5335389f&page=queryresults
[0m14:19:57.396026 [info ] [Thread-1 (]: 22 of 28 PASS relationships_Food_Beverage_business__business__ref_Airport_Establishment_  [[32mPASS[0m in 0.88s]
[0m14:19:57.396787 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m14:19:57.397237 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m14:19:57.397663 [info ] [Thread-1 (]: 23 of 28 START test relationships_TSA_Traffic_airport_icao__icao__ref_Airport_ . [RUN]
[0m14:19:57.398097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496, now test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a)
[0m14:19:57.398413 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m14:19:57.402599 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"
[0m14:19:57.403358 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m14:19:57.404650 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"
[0m14:19:57.405498 [debug] [Thread-1 (]: On test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:19:57.405980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:57.788577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0d0ed931-d6b1-41a0-9436-824f1ef5a60f&page=queryresults
[0m14:19:58.145444 [info ] [Thread-1 (]: 23 of 28 PASS relationships_TSA_Traffic_airport_icao__icao__ref_Airport_ ....... [[32mPASS[0m in 0.75s]
[0m14:19:58.146448 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m14:19:58.146854 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m14:19:58.147258 [info ] [Thread-1 (]: 24 of 28 START test unique_Airline_id .......................................... [RUN]
[0m14:19:58.147722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a, now test.air_travel.unique_Airline_id.cb196c2622)
[0m14:19:58.148054 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m14:19:58.154033 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m14:19:58.154596 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m14:19:58.155873 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m14:19:58.156280 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:19:58.156534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:58.560476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:cff9c4d4-4147-4ad4-a2e4-34cedcd75a92&page=queryresults
[0m14:19:58.968080 [info ] [Thread-1 (]: 24 of 28 PASS unique_Airline_id ................................................ [[32mPASS[0m in 0.82s]
[0m14:19:58.969119 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m14:19:58.969484 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m14:19:58.969867 [info ] [Thread-1 (]: 25 of 28 START test unique_Airport_Establishment_business ...................... [RUN]
[0m14:19:58.970364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_Establishment_business.c0ba13e1af)
[0m14:19:58.970872 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m14:19:58.973702 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m14:19:58.974229 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m14:19:58.975559 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m14:19:58.976257 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Establishment_business.c0ba13e1af: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select business as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
  where business is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:19:58.976609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:59.421901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:40e1d879-a6ee-478c-8ca4-e9a9ccaee5c3&page=queryresults
[0m14:19:59.764172 [info ] [Thread-1 (]: 25 of 28 PASS unique_Airport_Establishment_business ............................ [[32mPASS[0m in 0.79s]
[0m14:19:59.764930 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m14:19:59.765412 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m14:19:59.765823 [info ] [Thread-1 (]: 26 of 28 START test unique_Airport_Review_id ................................... [RUN]
[0m14:19:59.766392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Establishment_business.c0ba13e1af, now test.air_travel.unique_Airport_Review_id.690fe37ba9)
[0m14:19:59.766750 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m14:19:59.770309 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m14:19:59.770863 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m14:19:59.772167 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m14:19:59.772601 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Review_id.690fe37ba9: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Review_id.690fe37ba9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:19:59.772813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:00.192565 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:f0191082-ecd0-46cd-a377-49ee100185cb&page=queryresults
[0m14:20:00.547523 [info ] [Thread-1 (]: 26 of 28 PASS unique_Airport_Review_id ......................................... [[32mPASS[0m in 0.78s]
[0m14:20:00.548567 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m14:20:00.548999 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m14:20:00.549498 [info ] [Thread-1 (]: 27 of 28 START test unique_Airport_icao ........................................ [RUN]
[0m14:20:00.549955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Review_id.690fe37ba9, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m14:20:00.550251 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m14:20:00.554956 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m14:20:00.555656 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m14:20:00.557091 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m14:20:00.557670 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:20:00.557906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:00.999013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:bdd6eace-8f01-4e62-aa59-9dda8adeb74b&page=queryresults
[0m14:20:01.331662 [info ] [Thread-1 (]: 27 of 28 PASS unique_Airport_icao .............................................. [[32mPASS[0m in 0.78s]
[0m14:20:01.332486 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m14:20:01.332858 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m14:20:01.333257 [info ] [Thread-1 (]: 28 of 28 START test unique_Country_iso_code .................................... [RUN]
[0m14:20:01.333769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m14:20:01.334152 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m14:20:01.337954 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m14:20:01.338776 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m14:20:01.340100 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m14:20:01.340606 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:20:01.340837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:01.801139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1a4633d7-bf6d-44fc-8de7-5d3cf702850c&page=queryresults
[0m14:20:02.167312 [info ] [Thread-1 (]: 28 of 28 PASS unique_Country_iso_code .......................................... [[32mPASS[0m in 0.83s]
[0m14:20:02.168178 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m14:20:02.169402 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:20:02.171117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:02.171381 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m14:20:02.171631 [info ] [MainThread]: 
[0m14:20:02.171883 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 27.04 seconds (27.04s).
[0m14:20:02.173593 [debug] [MainThread]: Command end result
[0m14:20:02.194462 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:20:02.195960 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:20:02.199991 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m14:20:02.200201 [info ] [MainThread]: 
[0m14:20:02.200380 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:02.200498 [info ] [MainThread]: 
[0m14:20:02.200626 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=28
[0m14:20:02.202758 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 28.345793, "process_in_blocks": "0", "process_kernel_time": 0.432476, "process_mem_max_rss": "392708096", "process_out_blocks": "0", "process_user_time": 3.547745}
[0m14:20:02.203033 [debug] [MainThread]: Command `dbt test` succeeded at 14:20:02.202993 after 28.35 seconds
[0m14:20:02.203244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af3cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121777800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121776830>]}
[0m14:20:02.203447 [debug] [MainThread]: Flushing usage events
[0m14:20:02.432066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:59.450198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c10c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf57750>]}


============================== 14:23:59.452462 | 66772df6-60b7-4763-ba87-023bd52f9d6b ==============================
[0m14:23:59.452462 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m14:23:59.452724 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'empty': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt test --select Route_Equipment', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False'}
[0m14:24:00.423618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66772df6-60b7-4763-ba87-023bd52f9d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2b0c30>]}
[0m14:24:00.445685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66772df6-60b7-4763-ba87-023bd52f9d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122dbe360>]}
[0m14:24:00.446074 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:24:00.534667 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m14:24:00.592453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:24:00.592993 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m14:24:00.747024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66772df6-60b7-4763-ba87-023bd52f9d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236cd050>]}
[0m14:24:00.882809 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:24:00.884047 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:24:00.896216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66772df6-60b7-4763-ba87-023bd52f9d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236a5f40>]}
[0m14:24:00.896437 [info ] [MainThread]: Found 49 models, 38 data tests, 9 sources, 630 macros
[0m14:24:00.896573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66772df6-60b7-4763-ba87-023bd52f9d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123713930>]}
[0m14:24:00.897467 [info ] [MainThread]: 
[0m14:24:00.897598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:00.897696 [info ] [MainThread]: 
[0m14:24:00.897887 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:24:00.900366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_int'
[0m14:24:00.900561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:01.237373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m14:24:01.239717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:01.535464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m14:24:01.537269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:01.853634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m14:24:01.854866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:02.122886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66772df6-60b7-4763-ba87-023bd52f9d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236afee0>]}
[0m14:24:02.123403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:02.126425 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:24:02.126715 [info ] [Thread-1 (]: 1 of 2 START test dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [RUN]
[0m14:24:02.126983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m14:24:02.127194 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:24:02.136445 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m14:24:02.137350 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:24:02.151504 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m14:24:02.152212 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:24:02.152545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:02.694555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:783efcd6-771a-4418-b45a-5af7e312132f&page=queryresults
[0m14:24:03.261043 [info ] [Thread-1 (]: 1 of 2 PASS dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [[32mPASS[0m in 1.13s]
[0m14:24:03.261717 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:24:03.261932 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m14:24:03.262170 [info ] [Thread-1 (]: 2 of 2 START test relationships_Route_Equipment_airline_id__id__ref_Airline_ ... [RUN]
[0m14:24:03.262432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9)
[0m14:24:03.262586 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m14:24:03.265156 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"
[0m14:24:03.265616 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m14:24:03.266755 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"
[0m14:24:03.267017 [debug] [Thread-1 (]: On test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:24:03.267205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:03.906245 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:98b56536-051c-4e85-b369-11abfd0356bd&page=queryresults
[0m14:24:04.359169 [error] [Thread-1 (]: 2 of 2 FAIL 503 relationships_Route_Equipment_airline_id__id__ref_Airline_ ..... [[31mFAIL 503[0m in 1.10s]
[0m14:24:04.359938 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m14:24:04.361305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:04.363935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:04.364401 [debug] [MainThread]: Connection 'test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9' was properly closed.
[0m14:24:04.364571 [info ] [MainThread]: 
[0m14:24:04.364754 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m14:24:04.365128 [debug] [MainThread]: Command end result
[0m14:24:04.390182 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:24:04.391654 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:24:04.395142 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m14:24:04.395266 [info ] [MainThread]: 
[0m14:24:04.395447 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:24:04.395591 [info ] [MainThread]: 
[0m14:24:04.395781 [error] [MainThread]: [31mFailure in test relationships_Route_Equipment_airline_id__id__ref_Airline_ (models/int/schema.yml)[0m
[0m14:24:04.395957 [error] [MainThread]:   Got 503 results, configured to fail if != 0
[0m14:24:04.396090 [info ] [MainThread]: 
[0m14:24:04.396251 [info ] [MainThread]:   compiled code at target/compiled/air_travel/models/int/schema.yml/relationships_Route_Equipment_airline_id__id__ref_Airline_.sql
[0m14:24:04.396393 [info ] [MainThread]: 
[0m14:24:04.396548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m14:24:04.399287 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.977359, "process_in_blocks": "0", "process_kernel_time": 0.319785, "process_mem_max_rss": "396804096", "process_out_blocks": "0", "process_user_time": 2.123326}
[0m14:24:04.399659 [debug] [MainThread]: Command `dbt test` failed at 14:24:04.399596 after 4.98 seconds
[0m14:24:04.399840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce5ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236626d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123662780>]}
[0m14:24:04.400007 [debug] [MainThread]: Flushing usage events
[0m14:24:04.607277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:30.471569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d4c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b979d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b97750>]}


============================== 14:33:30.473383 | 098e13a5-e655-45df-8402-f86533451cc7 ==============================
[0m14:33:30.473383 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m14:33:30.473652 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --select Route_Equipment', 'version_check': 'True', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'log_format': 'default', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_colors': 'True'}
[0m14:33:31.450643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '098e13a5-e655-45df-8402-f86533451cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef0c30>]}
[0m14:33:31.473438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '098e13a5-e655-45df-8402-f86533451cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fabe360>]}
[0m14:33:31.473801 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:33:31.563839 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m14:33:31.619374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:31.619860 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/Route_Equipment.sql
[0m14:33:31.774759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '098e13a5-e655-45df-8402-f86533451cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203d0b50>]}
[0m14:33:31.912832 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:33:31.913924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:33:31.921837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '098e13a5-e655-45df-8402-f86533451cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ffe37a0>]}
[0m14:33:31.922035 [info ] [MainThread]: Found 49 models, 38 data tests, 9 sources, 630 macros
[0m14:33:31.922164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '098e13a5-e655-45df-8402-f86533451cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12032d8d0>]}
[0m14:33:31.923052 [info ] [MainThread]: 
[0m14:33:31.923177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:31.923270 [info ] [MainThread]: 
[0m14:33:31.923449 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:33:31.923811 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025'
[0m14:33:31.923977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:32.276685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m14:33:32.277106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:32.608813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m14:33:32.610122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:32.862611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_int)
[0m14:33:32.865764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:33.187410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m14:33:33.189727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:33.447193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '098e13a5-e655-45df-8402-f86533451cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205260d0>]}
[0m14:33:33.447875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:33.451918 [debug] [Thread-1 (]: Began running node model.air_travel.Route_Equipment
[0m14:33:33.452390 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_air_travel_int.Route_Equipment ................ [RUN]
[0m14:33:33.452741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now model.air_travel.Route_Equipment)
[0m14:33:33.452941 [debug] [Thread-1 (]: Began compiling node model.air_travel.Route_Equipment
[0m14:33:33.457635 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Route_Equipment"
[0m14:33:33.458260 [debug] [Thread-1 (]: Began executing node model.air_travel.Route_Equipment
[0m14:33:33.468169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:33.753506 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_travel.Route_Equipment"
[0m14:33:33.754177 [debug] [Thread-1 (]: On model.air_travel.Route_Equipment: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "model.air_travel.Route_Equipment"} */

  
    

    create or replace table `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
      
    
    

    
    OPTIONS()
    as (
      with Route_Equipment as (
    select airline_id, source_airport_icao, dest_airport_icao, equipment, _data_source, _load_time
    from (
        select airline_id, source_airport_icao, dest_airport_icao, split(trim(equipment), ' ') as equipment_array,
            _data_source, _load_time
        from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
        where equipment is not null) r, unnest(r.equipment_array) as equipment
)

select distinct re.airline_id, re.source_airport_icao, re.dest_airport_icao,
    a.icao as icao_equipment, re._data_source, re._load_time
from Route_Equipment re join `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft` a
on re.equipment = a.iata
join `cs378-fa2025`.`dbt_air_travel_int`.`Airline` al 
on re.airline_id = al.id
    );
  
[0m14:33:34.131380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b7bf6b88-a8ed-450b-86b6-1af128b04262&page=queryresults
[0m14:33:36.500951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '098e13a5-e655-45df-8402-f86533451cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204eabd0>]}
[0m14:33:36.501532 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_air_travel_int.Route_Equipment ........... [[32mCREATE TABLE (15.1k rows, 663.3 KiB processed)[0m in 3.05s]
[0m14:33:36.501880 [debug] [Thread-1 (]: Finished running node model.air_travel.Route_Equipment
[0m14:33:36.502622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:33:36.503668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:36.503822 [debug] [MainThread]: Connection 'model.air_travel.Route_Equipment' was properly closed.
[0m14:33:36.503975 [info ] [MainThread]: 
[0m14:33:36.504127 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m14:33:36.504489 [debug] [MainThread]: Command end result
[0m14:33:36.530918 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:33:36.532217 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:33:36.535283 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m14:33:36.535472 [info ] [MainThread]: 
[0m14:33:36.535670 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:36.535800 [info ] [MainThread]: 
[0m14:33:36.535952 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:33:36.538267 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0946584, "process_in_blocks": "0", "process_kernel_time": 0.328833, "process_mem_max_rss": "395018240", "process_out_blocks": "0", "process_user_time": 2.152661}
[0m14:33:36.538468 [debug] [MainThread]: Command `dbt run` succeeded at 14:33:36.538428 after 6.09 seconds
[0m14:33:36.538633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204dbac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbc690>]}
[0m14:33:36.538787 [debug] [MainThread]: Flushing usage events
[0m14:33:36.743416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:15.590317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c61c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4679d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d467750>]}


============================== 14:34:15.592407 | 1bc819ac-9eb6-4d6c-ad4a-ebd602f48752 ==============================
[0m14:34:15.592407 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m14:34:15.592672 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'debug': 'False', 'target_path': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'static_parser': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select Route_Equipment', 'introspect': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs'}
[0m14:34:16.564152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bc819ac-9eb6-4d6c-ad4a-ebd602f48752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c0c30>]}
[0m14:34:16.586282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bc819ac-9eb6-4d6c-ad4a-ebd602f48752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233be360>]}
[0m14:34:16.586651 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:34:16.675537 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m14:34:16.732444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:34:16.732696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:34:16.751599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bc819ac-9eb6-4d6c-ad4a-ebd602f48752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237dbd50>]}
[0m14:34:16.793929 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:34:16.795105 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:34:16.808595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bc819ac-9eb6-4d6c-ad4a-ebd602f48752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c656d0>]}
[0m14:34:16.808834 [info ] [MainThread]: Found 49 models, 38 data tests, 9 sources, 630 macros
[0m14:34:16.808966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bc819ac-9eb6-4d6c-ad4a-ebd602f48752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123beb150>]}
[0m14:34:16.809887 [info ] [MainThread]: 
[0m14:34:16.810021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:16.810116 [info ] [MainThread]: 
[0m14:34:16.810308 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:34:16.812697 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_mrt'
[0m14:34:16.812857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:17.132223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m14:34:17.132976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:17.403228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_stg)
[0m14:34:17.406838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:17.723251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_int)
[0m14:34:17.725043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:17.979002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bc819ac-9eb6-4d6c-ad4a-ebd602f48752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c3add0>]}
[0m14:34:17.979550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:34:17.982483 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:34:17.982833 [info ] [Thread-1 (]: 1 of 2 START test dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [RUN]
[0m14:34:17.983190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m14:34:17.983432 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:34:17.995706 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m14:34:17.996365 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:34:18.007287 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m14:34:18.007953 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m14:34:18.008203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:18.664112 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b64a3c10-12ff-428b-85ab-c8a09b99c44a&page=queryresults
[0m14:34:19.120616 [info ] [Thread-1 (]: 1 of 2 PASS dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [[32mPASS[0m in 1.14s]
[0m14:34:19.120994 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m14:34:19.121155 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m14:34:19.121325 [info ] [Thread-1 (]: 2 of 2 START test relationships_Route_Equipment_airline_id__id__ref_Airline_ ... [RUN]
[0m14:34:19.121520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9)
[0m14:34:19.121648 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m14:34:19.124944 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"
[0m14:34:19.125399 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m14:34:19.126432 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"
[0m14:34:19.126674 [debug] [Thread-1 (]: On test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:34:19.126813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:19.817202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d3359d69-b33f-4719-ad57-fb82552f6fca&page=queryresults
[0m14:34:20.196607 [info ] [Thread-1 (]: 2 of 2 PASS relationships_Route_Equipment_airline_id__id__ref_Airline_ ......... [[32mPASS[0m in 1.07s]
[0m14:34:20.197476 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m14:34:20.198936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:34:20.201263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:20.201737 [debug] [MainThread]: Connection 'test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9' was properly closed.
[0m14:34:20.202082 [info ] [MainThread]: 
[0m14:34:20.202371 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m14:34:20.203434 [debug] [MainThread]: Command end result
[0m14:34:20.333666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m14:34:20.334680 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m14:34:20.337179 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m14:34:20.337295 [info ] [MainThread]: 
[0m14:34:20.337432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:20.337533 [info ] [MainThread]: 
[0m14:34:20.337652 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:34:20.339454 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.7776923, "process_in_blocks": "0", "process_kernel_time": 0.323521, "process_mem_max_rss": "392364032", "process_out_blocks": "0", "process_user_time": 1.987677}
[0m14:34:20.339633 [debug] [MainThread]: Command `dbt test` succeeded at 14:34:20.339599 after 4.78 seconds
[0m14:34:20.339771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d36ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b8bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b8a200>]}
[0m14:34:20.339897 [debug] [MainThread]: Flushing usage events
[0m14:34:20.525903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:06.759541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6a86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4f39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4f3750>]}


============================== 11:25:06.761253 | 6ed65bc6-a2cb-4e04-a3b1-37c0117c05c0 ==============================
[0m11:25:06.761253 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:25:06.761489 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --select Route_Equipment', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'partial_parse': 'True', 'empty': 'None', 'warn_error': 'None', 'introspect': 'True', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True'}
[0m11:25:07.635631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ed65bc6-a2cb-4e04-a3b1-37c0117c05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84cc30>]}
[0m11:25:07.655503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ed65bc6-a2cb-4e04-a3b1-37c0117c05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233c2360>]}
[0m11:25:07.655766 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:25:07.734217 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:25:07.788226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:25:07.788653 [debug] [MainThread]: Partial parsing: updated file: air_travel://models/int/schema.yml
[0m11:25:07.926587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ed65bc6-a2cb-4e04-a3b1-37c0117c05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cd5450>]}
[0m11:25:08.048641 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:25:08.049548 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:25:08.060951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ed65bc6-a2cb-4e04-a3b1-37c0117c05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ca5e50>]}
[0m11:25:08.061123 [info ] [MainThread]: Found 49 models, 41 data tests, 9 sources, 630 macros
[0m11:25:08.061253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ed65bc6-a2cb-4e04-a3b1-37c0117c05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c2bbd0>]}
[0m11:25:08.062187 [info ] [MainThread]: 
[0m11:25:08.062305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:25:08.062398 [info ] [MainThread]: 
[0m11:25:08.062582 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:25:08.064870 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_tmp'
[0m11:25:08.065049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:08.387934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m11:25:08.391725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:08.692082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:25:08.693687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:09.001507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:25:09.003577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:09.301121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ed65bc6-a2cb-4e04-a3b1-37c0117c05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cc6340>]}
[0m11:25:09.301656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:25:09.305456 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:25:09.305826 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [RUN]
[0m11:25:09.306200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m11:25:09.306504 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:25:09.317395 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m11:25:09.318767 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:25:09.332223 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m11:25:09.332680 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:25:09.332914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:10.189807 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:3a1ae58e-5fa0-4306-95c4-c08c903190f6&page=queryresults
[0m11:25:10.726945 [info ] [Thread-1 (]: 1 of 5 PASS dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [[32mPASS[0m in 1.42s]
[0m11:25:10.727727 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:25:10.728152 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:25:10.728623 [info ] [Thread-1 (]: 2 of 5 START test relationships_Route_Equipment_airline_id__id__ref_Airline_ ... [RUN]
[0m11:25:10.729175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9)
[0m11:25:10.729566 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:25:10.733093 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"
[0m11:25:10.734784 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:25:10.739561 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"
[0m11:25:10.740294 [debug] [Thread-1 (]: On test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:25:10.740634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:11.314843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:da8b2524-f6da-4e4d-b02c-e9562fa2e993&page=queryresults
[0m11:25:11.776659 [info ] [Thread-1 (]: 2 of 5 PASS relationships_Route_Equipment_airline_id__id__ref_Airline_ ......... [[32mPASS[0m in 1.05s]
[0m11:25:11.777710 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:25:11.778199 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:25:11.778938 [info ] [Thread-1 (]: 3 of 5 START test relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_  [RUN]
[0m11:25:11.779427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9, now test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842)
[0m11:25:11.779806 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:25:11.784702 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842"
[0m11:25:11.787107 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:25:11.789432 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842"
[0m11:25:11.790054 [debug] [Thread-1 (]: On test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dest_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    where dest_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:25:11.790362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:12.440853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:c4da6227-af24-4b5d-a72e-d95484f3b698&page=queryresults
[0m11:25:12.955149 [info ] [Thread-1 (]: 3 of 5 PASS relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 1.18s]
[0m11:25:12.956265 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:25:12.956765 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:25:12.957245 [info ] [Thread-1 (]: 4 of 5 START test relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_  [RUN]
[0m11:25:12.957790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842, now test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f)
[0m11:25:12.958174 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:25:12.963418 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f"
[0m11:25:12.964364 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:25:12.966681 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f"
[0m11:25:12.967563 [debug] [Thread-1 (]: On test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select icao_equipment as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    where icao_equipment is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:25:12.967978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:13.567256 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:597e11e5-2fe5-4bf7-ae39-09a5952bc307&page=queryresults
[0m11:25:14.083389 [info ] [Thread-1 (]: 4 of 5 PASS relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_ .. [[32mPASS[0m in 1.13s]
[0m11:25:14.084459 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:25:14.084990 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:25:14.085657 [info ] [Thread-1 (]: 5 of 5 START test relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_  [RUN]
[0m11:25:14.086213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f, now test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71)
[0m11:25:14.086577 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:25:14.091376 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71"
[0m11:25:14.092200 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:25:14.094737 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71"
[0m11:25:14.095335 [debug] [Thread-1 (]: On test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select source_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    where source_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:25:14.095636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:14.634634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4b3e88c4-4527-4c10-b159-add9331488ea&page=queryresults
[0m11:25:15.044786 [info ] [Thread-1 (]: 5 of 5 PASS relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 0.96s]
[0m11:25:15.045865 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:25:15.047504 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:25:15.049474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:15.049781 [debug] [MainThread]: Connection 'test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71' was properly closed.
[0m11:25:15.050087 [info ] [MainThread]: 
[0m11:25:15.050400 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.99 seconds (6.99s).
[0m11:25:15.051554 [debug] [MainThread]: Command end result
[0m11:25:15.081024 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:25:15.082288 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:25:15.085735 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:25:15.085901 [info ] [MainThread]: 
[0m11:25:15.086083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:15.086221 [info ] [MainThread]: 
[0m11:25:15.086379 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m11:25:15.088781 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.3546295, "process_in_blocks": "0", "process_kernel_time": 0.297122, "process_mem_max_rss": "395542528", "process_out_blocks": "0", "process_user_time": 2.195325}
[0m11:25:15.088992 [debug] [MainThread]: Command `dbt test` succeeded at 11:25:15.088952 after 8.35 seconds
[0m11:25:15.089188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3f8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c8ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c8e620>]}
[0m11:25:15.089322 [debug] [MainThread]: Flushing usage events
[0m11:25:15.423945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:26.353396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088086e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109653750>]}


============================== 11:25:26.355074 | b5dc201e-e028-4080-ae06-ff0b7f34c6aa ==============================
[0m11:25:26.355074 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:25:26.355322 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'profiles_dir': '/Users/scohen/.dbt', 'empty': 'None', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'debug': 'False'}
[0m11:25:27.181221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5dc201e-e028-4080-ae06-ff0b7f34c6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089acc30>]}
[0m11:25:27.201007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5dc201e-e028-4080-ae06-ff0b7f34c6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4c2360>]}
[0m11:25:27.201236 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:25:27.279179 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:25:27.328505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:25:27.328658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:25:27.345604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5dc201e-e028-4080-ae06-ff0b7f34c6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8cfd50>]}
[0m11:25:27.382422 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:25:27.383245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:25:27.394620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5dc201e-e028-4080-ae06-ff0b7f34c6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd716d0>]}
[0m11:25:27.394802 [info ] [MainThread]: Found 49 models, 41 data tests, 9 sources, 630 macros
[0m11:25:27.394924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5dc201e-e028-4080-ae06-ff0b7f34c6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcd73f0>]}
[0m11:25:27.396365 [info ] [MainThread]: 
[0m11:25:27.396497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:25:27.396593 [info ] [MainThread]: 
[0m11:25:27.396779 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:25:27.399071 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_tmp'
[0m11:25:27.399230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:27.682380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m11:25:27.686163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:27.971677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_int)
[0m11:25:27.972981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:28.250900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:25:28.252892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:28.515515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5dc201e-e028-4080-ae06-ff0b7f34c6aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd38fc0>]}
[0m11:25:28.516340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:25:28.520629 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m11:25:28.521197 [info ] [Thread-1 (]: 1 of 41 START test check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_  [RUN]
[0m11:25:28.521638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m11:25:28.521983 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m11:25:28.535274 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m11:25:28.537346 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m11:25:28.551130 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m11:25:28.551799 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`aircrafts`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`aircrafts` )

  
  
      
    ) dbt_internal_test
[0m11:25:28.552036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:29.543025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:5e0450dd-825b-49ea-a4e9-00da3b0f603c&page=queryresults
[0m11:25:30.060409 [info ] [Thread-1 (]: 1 of 41 PASS check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_ . [[32mPASS[0m in 1.54s]
[0m11:25:30.061221 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m11:25:30.061640 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m11:25:30.062112 [info ] [Thread-1 (]: 2 of 41 START test check_row_count_equals_airlines_source_air_travel_raw_airlines_  [RUN]
[0m11:25:30.062563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc, now test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d)
[0m11:25:30.062878 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m11:25:30.067239 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m11:25:30.068913 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m11:25:30.071233 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m11:25:30.072409 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airlines`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airlines` )

  
  
      
    ) dbt_internal_test
[0m11:25:30.072787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:30.876231 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:87cfb66a-bcfc-403e-9552-baf5f56cf1e7&page=queryresults
[0m11:25:31.325960 [info ] [Thread-1 (]: 2 of 41 PASS check_row_count_equals_airlines_source_air_travel_raw_airlines_ ... [[32mPASS[0m in 1.26s]
[0m11:25:31.327016 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m11:25:31.327516 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m11:25:31.328029 [info ] [Thread-1 (]: 3 of 41 START test check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_  [RUN]
[0m11:25:31.328564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d, now test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510)
[0m11:25:31.328926 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m11:25:31.334554 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m11:25:31.336430 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m11:25:31.338930 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m11:25:31.339878 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_maps`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_maps` )

  
  
      
    ) dbt_internal_test
[0m11:25:31.340256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:32.204615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1953484b-4ed3-4a93-8246-887da1dbc260&page=queryresults
[0m11:25:32.594269 [info ] [Thread-1 (]: 3 of 41 PASS check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_  [[32mPASS[0m in 1.27s]
[0m11:25:32.595320 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m11:25:32.595832 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m11:25:32.596293 [info ] [Thread-1 (]: 4 of 41 START test check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_  [RUN]
[0m11:25:32.596797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510, now test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587)
[0m11:25:32.597165 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m11:25:32.602437 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m11:25:32.603317 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m11:25:32.605605 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m11:25:32.606304 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airport_reviews`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airport_reviews` )

  
  
      
    ) dbt_internal_test
[0m11:25:32.606680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:33.536590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7a23733b-2b9e-4105-96cf-da91699323cf&page=queryresults
[0m11:25:33.914723 [info ] [Thread-1 (]: 4 of 41 PASS check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_  [[32mPASS[0m in 1.32s]
[0m11:25:33.915801 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m11:25:33.916327 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m11:25:33.916824 [info ] [Thread-1 (]: 5 of 41 START test check_row_count_equals_airports_source_air_travel_raw_airports_  [RUN]
[0m11:25:33.917354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587, now test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0)
[0m11:25:33.917714 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m11:25:33.923144 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m11:25:33.925078 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m11:25:33.927488 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m11:25:33.928271 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`airports`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`airports` )

  
  
      
    ) dbt_internal_test
[0m11:25:33.928664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:34.704818 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:783671e4-b8c4-4d81-9fc2-75d55dcd5721&page=queryresults
[0m11:25:35.094818 [info ] [Thread-1 (]: 5 of 41 PASS check_row_count_equals_airports_source_air_travel_raw_airports_ ... [[32mPASS[0m in 1.18s]
[0m11:25:35.095909 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m11:25:35.096406 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m11:25:35.096881 [info ] [Thread-1 (]: 6 of 41 START test check_row_count_equals_countries_source_air_travel_raw_countries_  [RUN]
[0m11:25:35.097405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0, now test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414)
[0m11:25:35.097783 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m11:25:35.103548 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m11:25:35.105449 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m11:25:35.110525 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m11:25:35.111248 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`countries`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`countries` )

  
  
      
    ) dbt_internal_test
[0m11:25:35.111560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:35.993622 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:060b80be-1770-46a1-8fa2-b792230b57dd&page=queryresults
[0m11:25:36.381332 [info ] [Thread-1 (]: 6 of 41 PASS check_row_count_equals_countries_source_air_travel_raw_countries_ . [[32mPASS[0m in 1.28s]
[0m11:25:36.382411 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m11:25:36.382889 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m11:25:36.383362 [info ] [Thread-1 (]: 7 of 41 START test check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_  [RUN]
[0m11:25:36.383862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414, now test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823)
[0m11:25:36.384222 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m11:25:36.388558 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m11:25:36.389647 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m11:25:36.502910 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m11:25:36.504302 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_delays`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_delays` )

  
  
      
    ) dbt_internal_test
[0m11:25:36.504463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:37.232542 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0c580ebd-8a5f-4f78-a17e-38dda3b13742&page=queryresults
[0m11:25:37.594966 [info ] [Thread-1 (]: 7 of 41 PASS check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_  [[32mPASS[0m in 1.21s]
[0m11:25:37.595984 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m11:25:37.596443 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m11:25:37.596884 [info ] [Thread-1 (]: 8 of 41 START test check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_  [RUN]
[0m11:25:37.597420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823, now test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81)
[0m11:25:37.598202 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m11:25:37.603411 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m11:25:37.604227 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m11:25:37.606651 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m11:25:37.607356 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`flight_routes`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`flight_routes` )

  
  
      
    ) dbt_internal_test
[0m11:25:37.607687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:38.656538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b4cd628a-2c93-4ae9-bdfb-150504b648e8&page=queryresults
[0m11:25:39.010853 [info ] [Thread-1 (]: 8 of 41 PASS check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_  [[32mPASS[0m in 1.41s]
[0m11:25:39.011809 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m11:25:39.012228 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m11:25:39.012698 [info ] [Thread-1 (]: 9 of 41 START test check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_  [RUN]
[0m11:25:39.013260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81, now test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee)
[0m11:25:39.013637 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m11:25:39.018384 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m11:25:39.020172 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m11:25:39.022484 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m11:25:39.023281 [debug] [Thread-1 (]: On test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
        select
            row_count
        from (
            select
                count(*) AS row_count
            from `cs378-fa2025`.`dbt_air_travel_stg`.`tsa_traffic`
        )
        where row_count <> ( select count(*) from `cs378-fa2025`.`air_travel_raw`.`tsa_traffic` )

  
  
      
    ) dbt_internal_test
[0m11:25:39.023722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:39.784390 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e525ac50-8d73-421c-9395-d27dab62bdb9&page=queryresults
[0m11:25:40.137066 [info ] [Thread-1 (]: 9 of 41 PASS check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_  [[32mPASS[0m in 1.12s]
[0m11:25:40.138074 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m11:25:40.138589 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:25:40.139114 [info ] [Thread-1 (]: 10 of 41 START test dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name  [RUN]
[0m11:25:40.139561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee, now test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd)
[0m11:25:40.139915 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:25:40.151070 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m11:25:40.152633 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:25:40.154221 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m11:25:40.154691 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        icao, iata, name
    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
    group by icao, iata, name
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:25:40.154976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:40.600969 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0bd619a1-c2b5-45d6-979e-e0749a11a595&page=queryresults
[0m11:25:41.217803 [info ] [Thread-1 (]: 10 of 41 PASS dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name  [[32mPASS[0m in 1.08s]
[0m11:25:41.218878 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:25:41.219379 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:25:41.219924 [info ] [Thread-1 (]: 11 of 41 START test dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [RUN]
[0m11:25:41.220634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m11:25:41.221132 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:25:41.227477 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m11:25:41.229668 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:25:41.231382 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m11:25:41.231851 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airport_icao, terminal, business, location
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    group by airport_icao, terminal, business, location
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:25:41.232137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:41.728099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:1e62b744-258b-4af6-971c-9721798e4033&page=queryresults
[0m11:25:42.104909 [info ] [Thread-1 (]: 11 of 41 PASS dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location  [[32mPASS[0m in 0.88s]
[0m11:25:42.106008 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:25:42.106557 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:25:42.107025 [info ] [Thread-1 (]: 12 of 41 START test dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [RUN]
[0m11:25:42.107533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m11:25:42.107984 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:25:42.113946 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m11:25:42.114643 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:25:42.116513 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m11:25:42.117167 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_month, airline_id, airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    group by event_month, airline_id, airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:25:42.117516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:42.597505 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:82cf3e68-c0d7-40e8-8634-d1b15096d96c&page=queryresults
[0m11:25:42.944004 [info ] [Thread-1 (]: 12 of 41 PASS dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao  [[32mPASS[0m in 0.84s]
[0m11:25:42.945039 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:25:42.945391 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:25:42.945728 [info ] [Thread-1 (]: 13 of 41 START test dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [RUN]
[0m11:25:42.946148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m11:25:42.946514 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:25:42.951852 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m11:25:42.952673 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:25:42.954474 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m11:25:42.954943 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    group by airline_id, source_airport_icao, dest_airport_icao
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:25:42.955240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:43.468982 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b9de3dd7-8c28-4acb-9534-267ce55b2363&page=queryresults
[0m11:25:43.819591 [info ] [Thread-1 (]: 13 of 41 PASS dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao  [[32mPASS[0m in 0.87s]
[0m11:25:43.820636 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:25:43.821128 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:25:43.821557 [info ] [Thread-1 (]: 14 of 41 START test dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [RUN]
[0m11:25:43.822054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965)
[0m11:25:43.822427 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:25:43.828699 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m11:25:43.830517 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:25:43.832297 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m11:25:43.832869 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        business, menu_item
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    group by business, menu_item
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:25:43.833183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:44.287622 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a12fb3f6-1426-4220-bd06-1c364f58cf8d&page=queryresults
[0m11:25:44.634884 [info ] [Thread-1 (]: 14 of 41 PASS dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item  [[32mPASS[0m in 0.81s]
[0m11:25:44.635892 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:25:44.636361 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:25:44.636878 [info ] [Thread-1 (]: 15 of 41 START test dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [RUN]
[0m11:25:44.637597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m11:25:44.638018 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:25:44.643524 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m11:25:44.644396 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:25:44.646226 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m11:25:44.646762 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    group by airline_id, source_airport_icao, dest_airport_icao, icao_equipment
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:25:44.647089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:45.106905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:687016c2-d6c9-493b-8392-d22e5ea24e42&page=queryresults
[0m11:25:45.460936 [info ] [Thread-1 (]: 15 of 41 PASS dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment  [[32mPASS[0m in 0.82s]
[0m11:25:45.462023 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:25:45.462540 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:25:45.463019 [info ] [Thread-1 (]: 16 of 41 START test dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [RUN]
[0m11:25:45.463544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m11:25:45.463920 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:25:45.471139 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m11:25:45.472120 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:25:45.474330 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m11:25:45.475206 [debug] [Thread-1 (]: On test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        event_date, event_hour, airport_icao, security_checkpoint
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    group by event_date, event_hour, airport_icao, security_checkpoint
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m11:25:45.475541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:45.926279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:265d1f7d-12fe-4310-b23d-2821fdba0da8&page=queryresults
[0m11:25:46.371855 [info ] [Thread-1 (]: 16 of 41 PASS dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint  [[32mPASS[0m in 0.91s]
[0m11:25:46.372986 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:25:46.373563 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:25:46.374008 [info ] [Thread-1 (]: 17 of 41 START test not_null_Airline_id ........................................ [RUN]
[0m11:25:46.374451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m11:25:46.374703 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:25:46.381913 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:25:46.383565 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:25:46.385152 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:25:46.385617 [debug] [Thread-1 (]: On test.air_travel.not_null_Airline_id.b0e38ad347: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airline_id.b0e38ad347"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
where id is null



  
  
      
    ) dbt_internal_test
[0m11:25:46.385898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:46.847431 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b2acca03-32d6-483f-b0e4-239a53a5e10f&page=queryresults
[0m11:25:47.181500 [info ] [Thread-1 (]: 17 of 41 PASS not_null_Airline_id .............................................. [[32mPASS[0m in 0.81s]
[0m11:25:47.182521 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:25:47.183003 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:25:47.183564 [info ] [Thread-1 (]: 18 of 41 START test not_null_Airport_Establishment_business .................... [RUN]
[0m11:25:47.184068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.not_null_Airport_Establishment_business.fa42968b3c)
[0m11:25:47.184416 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:25:47.188407 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m11:25:47.189187 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:25:47.190887 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m11:25:47.191412 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Establishment_business.fa42968b3c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select business
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
where business is null



  
  
      
    ) dbt_internal_test
[0m11:25:47.191742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:50.238967 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6243d142-2fdf-485e-847c-4866aad30c35&page=queryresults
[0m11:25:50.609304 [info ] [Thread-1 (]: 18 of 41 PASS not_null_Airport_Establishment_business .......................... [[32mPASS[0m in 3.42s]
[0m11:25:50.610276 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:25:50.610731 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:25:50.611176 [info ] [Thread-1 (]: 19 of 41 START test not_null_Airport_Review_id ................................. [RUN]
[0m11:25:50.611672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Establishment_business.fa42968b3c, now test.air_travel.not_null_Airport_Review_id.715ca7a304)
[0m11:25:50.612023 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:25:50.616705 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m11:25:50.618640 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:25:50.620397 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m11:25:50.620940 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_Review_id.715ca7a304: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_Review_id.715ca7a304"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
where id is null



  
  
      
    ) dbt_internal_test
[0m11:25:50.621378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:53.411423 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:bb0d078a-d685-467e-bdb1-add7dd23d493&page=queryresults
[0m11:25:53.739514 [info ] [Thread-1 (]: 19 of 41 PASS not_null_Airport_Review_id ....................................... [[32mPASS[0m in 3.13s]
[0m11:25:53.740343 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:25:53.740722 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:25:53.741114 [info ] [Thread-1 (]: 20 of 41 START test not_null_Airport_icao ...................................... [RUN]
[0m11:25:53.741550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Review_id.715ca7a304, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m11:25:53.741860 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:25:53.745880 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:25:53.746734 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:25:53.748728 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:25:53.749379 [debug] [Thread-1 (]: On test.air_travel.not_null_Airport_icao.8935ba5a96: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Airport_icao.8935ba5a96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select icao
from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
where icao is null



  
  
      
    ) dbt_internal_test
[0m11:25:53.749709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:54.179796 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:56bb0499-643e-43ae-8842-e954116c3f0f&page=queryresults
[0m11:25:54.611237 [info ] [Thread-1 (]: 20 of 41 PASS not_null_Airport_icao ............................................ [[32mPASS[0m in 0.87s]
[0m11:25:54.612382 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:25:54.612919 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:25:54.613375 [info ] [Thread-1 (]: 21 of 41 START test not_null_Country_iso_code .................................. [RUN]
[0m11:25:54.613919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m11:25:54.614275 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:25:54.618053 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:25:54.618789 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:25:54.620555 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:25:54.621262 [debug] [Thread-1 (]: On test.air_travel.not_null_Country_iso_code.b04a30e1a4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.not_null_Country_iso_code.b04a30e1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select iso_code
from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
where iso_code is null



  
  
      
    ) dbt_internal_test
[0m11:25:54.621636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:57.396962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:85ff1f82-38aa-4eaa-b51b-2b9c6aa1ae9b&page=queryresults
[0m11:25:57.742072 [info ] [Thread-1 (]: 21 of 41 PASS not_null_Country_iso_code ........................................ [[32mPASS[0m in 3.13s]
[0m11:25:57.743077 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:25:57.743572 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:25:57.744044 [info ] [Thread-1 (]: 22 of 41 START test relationships_Airline_country_code__iso_code__ref_Country_ . [RUN]
[0m11:25:57.744554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26)
[0m11:25:57.744915 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:25:57.753328 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m11:25:57.754570 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:25:57.756902 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m11:25:57.757455 [debug] [Thread-1 (]: On test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:25:57.757767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:58.419521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:199a22b2-23ab-44d0-b804-ecbb0ae4994d&page=queryresults
[0m11:25:58.784198 [info ] [Thread-1 (]: 22 of 41 PASS relationships_Airline_country_code__iso_code__ref_Country_ ....... [[32mPASS[0m in 1.04s]
[0m11:25:58.785054 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:25:58.785401 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m11:25:58.785807 [info ] [Thread-1 (]: 23 of 41 START test relationships_Airport_Concessions_airport_icao__icao__ref_Airport_  [RUN]
[0m11:25:58.786254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26, now test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1)
[0m11:25:58.786575 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m11:25:58.791028 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"
[0m11:25:58.793348 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m11:25:58.795302 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"
[0m11:25:58.795734 [debug] [Thread-1 (]: On test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Concessions`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:25:58.795979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:59.239178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d3db18cb-128f-4459-aa11-1a620776c4c8&page=queryresults
[0m11:25:59.591874 [info ] [Thread-1 (]: 23 of 41 PASS relationships_Airport_Concessions_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 0.81s]
[0m11:25:59.592893 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m11:25:59.593406 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m11:25:59.593948 [info ] [Thread-1 (]: 24 of 41 START test relationships_Airport_Review_airport_icao__icao__ref_Airport_  [RUN]
[0m11:25:59.594507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1, now test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9)
[0m11:25:59.595153 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m11:25:59.599929 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9"
[0m11:25:59.601667 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m11:25:59.604097 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9"
[0m11:25:59.604667 [debug] [Thread-1 (]: On test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:25:59.604985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:00.160588 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:4956a6c7-7346-480f-bc5f-9b5092954a8a&page=queryresults
[0m11:26:00.513554 [info ] [Thread-1 (]: 24 of 41 PASS relationships_Airport_Review_airport_icao__icao__ref_Airport_ .... [[32mPASS[0m in 0.92s]
[0m11:26:00.514660 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m11:26:00.515150 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:26:00.515592 [info ] [Thread-1 (]: 25 of 41 START test relationships_Airport_country_code__iso_code__ref_Country_ . [RUN]
[0m11:26:00.516194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9, now test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0)
[0m11:26:00.516778 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:26:00.521524 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m11:26:00.523333 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:26:00.525984 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m11:26:00.526777 [debug] [Thread-1 (]: On test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select country_code as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
    where country_code is not null
),

parent as (
    select iso_code as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:00.527088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:01.085712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e3279893-7b0d-4cd0-994f-33a97f6c2a1d&page=queryresults
[0m11:26:01.413497 [info ] [Thread-1 (]: 25 of 41 PASS relationships_Airport_country_code__iso_code__ref_Country_ ....... [[32mPASS[0m in 0.90s]
[0m11:26:01.414324 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:26:01.414677 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m11:26:01.415048 [info ] [Thread-1 (]: 26 of 41 START test relationships_Flight_Delays_airline_id__id__ref_Airline_ ... [RUN]
[0m11:26:01.415506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0, now test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3)
[0m11:26:01.415862 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m11:26:01.421050 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m11:26:01.422950 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m11:26:01.425228 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m11:26:01.425778 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:01.426087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:02.037914 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:9322b279-eb4c-4fbf-b178-268e988efba4&page=queryresults
[0m11:26:02.441456 [info ] [Thread-1 (]: 26 of 41 PASS relationships_Flight_Delays_airline_id__id__ref_Airline_ ......... [[32mPASS[0m in 1.03s]
[0m11:26:02.442465 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m11:26:02.442904 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m11:26:02.443354 [info ] [Thread-1 (]: 27 of 41 START test relationships_Flight_Delays_airport_icao__icao__ref_Airport_  [RUN]
[0m11:26:02.443754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3, now test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4)
[0m11:26:02.443935 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m11:26:02.447434 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"
[0m11:26:02.448103 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m11:26:02.450202 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"
[0m11:26:02.450760 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Delays`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:02.451091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:03.027299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:92c3ae56-b0b9-4161-95ce-08baafae148a&page=queryresults
[0m11:26:03.376608 [info ] [Thread-1 (]: 27 of 41 PASS relationships_Flight_Delays_airport_icao__icao__ref_Airport_ ..... [[32mPASS[0m in 0.93s]
[0m11:26:03.377095 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m11:26:03.377339 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m11:26:03.377583 [info ] [Thread-1 (]: 28 of 41 START test relationships_Flight_Routes_airline_id__id__ref_Airline_ ... [RUN]
[0m11:26:03.377836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4, now test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e)
[0m11:26:03.378034 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m11:26:03.380845 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m11:26:03.382279 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m11:26:03.383915 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m11:26:03.384358 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:03.384599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:03.948991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:e019aa14-25f6-44c7-b92a-fcfd8fc7844f&page=queryresults
[0m11:26:04.273488 [info ] [Thread-1 (]: 28 of 41 PASS relationships_Flight_Routes_airline_id__id__ref_Airline_ ......... [[32mPASS[0m in 0.90s]
[0m11:26:04.274526 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m11:26:04.275027 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m11:26:04.275506 [info ] [Thread-1 (]: 29 of 41 START test relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_  [RUN]
[0m11:26:04.276050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e, now test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052)
[0m11:26:04.276421 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m11:26:04.281522 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m11:26:04.283985 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m11:26:04.286496 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m11:26:04.287199 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dest_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where dest_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:04.287519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:04.883540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:b8a80671-ee40-46a8-8dcc-62f592c3bd3c&page=queryresults
[0m11:26:05.261197 [info ] [Thread-1 (]: 29 of 41 PASS relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 0.98s]
[0m11:26:05.262307 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m11:26:05.262847 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m11:26:05.263325 [info ] [Thread-1 (]: 30 of 41 START test relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_  [RUN]
[0m11:26:05.263912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052, now test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df)
[0m11:26:05.264316 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m11:26:05.269434 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m11:26:05.270319 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m11:26:05.276118 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m11:26:05.276789 [debug] [Thread-1 (]: On test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select source_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Flight_Routes`
    where source_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:05.277103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:05.792417 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:51b8f837-c3eb-48ab-abe4-096d863bf8ef&page=queryresults
[0m11:26:06.152724 [info ] [Thread-1 (]: 30 of 41 PASS relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 0.89s]
[0m11:26:06.153810 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m11:26:06.154317 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m11:26:06.154820 [info ] [Thread-1 (]: 31 of 41 START test relationships_Food_Beverage_business__business__ref_Airport_Establishment_  [RUN]
[0m11:26:06.155324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df, now test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496)
[0m11:26:06.155763 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m11:26:06.160153 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"
[0m11:26:06.161881 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m11:26:06.164205 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"
[0m11:26:06.165163 [debug] [Thread-1 (]: On test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select business as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Food_Beverage`
    where business is not null
),

parent as (
    select business as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:06.165524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:06.611868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:a669eb8f-ab33-48d6-8ed4-bce5f9af2a8d&page=queryresults
[0m11:26:06.958081 [info ] [Thread-1 (]: 31 of 41 PASS relationships_Food_Beverage_business__business__ref_Airport_Establishment_  [[32mPASS[0m in 0.80s]
[0m11:26:06.959186 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m11:26:06.959687 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:26:06.960145 [info ] [Thread-1 (]: 32 of 41 START test relationships_Route_Equipment_airline_id__id__ref_Airline_ . [RUN]
[0m11:26:06.960660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496, now test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9)
[0m11:26:06.961107 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:26:06.965688 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"
[0m11:26:06.966410 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:26:06.968668 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"
[0m11:26:06.969387 [debug] [Thread-1 (]: On test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airline_id as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    where airline_id is not null
),

parent as (
    select id as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:06.969746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:07.430896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6151174c-54ec-43fb-9982-e2c4c98a1ef7&page=queryresults
[0m11:26:07.787556 [info ] [Thread-1 (]: 32 of 41 PASS relationships_Route_Equipment_airline_id__id__ref_Airline_ ....... [[32mPASS[0m in 0.83s]
[0m11:26:07.788557 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:26:07.788985 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:26:07.789418 [info ] [Thread-1 (]: 33 of 41 START test relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_  [RUN]
[0m11:26:07.789895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9, now test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842)
[0m11:26:07.790484 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:26:07.794759 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842"
[0m11:26:07.795615 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:26:07.797800 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842"
[0m11:26:07.798349 [debug] [Thread-1 (]: On test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dest_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    where dest_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:07.798612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:08.453403 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:2c1537d0-d7b2-4139-84e9-218822c4c868&page=queryresults
[0m11:26:08.802781 [info ] [Thread-1 (]: 33 of 41 PASS relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 1.01s]
[0m11:26:08.803813 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:26:08.804292 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:26:08.804762 [info ] [Thread-1 (]: 34 of 41 START test relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_  [RUN]
[0m11:26:08.805356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842, now test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f)
[0m11:26:08.805895 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:26:08.811031 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f"
[0m11:26:08.811814 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:26:08.814061 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f"
[0m11:26:08.814749 [debug] [Thread-1 (]: On test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select icao_equipment as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    where icao_equipment is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Aircraft`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:08.815110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:09.239889 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:76c2a5f1-3426-4b8c-8392-64df584257d5&page=queryresults
[0m11:26:09.556785 [info ] [Thread-1 (]: 34 of 41 PASS relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_  [[32mPASS[0m in 0.75s]
[0m11:26:09.557761 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:26:09.558210 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:26:09.558660 [info ] [Thread-1 (]: 35 of 41 START test relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_  [RUN]
[0m11:26:09.559153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f, now test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71)
[0m11:26:09.559666 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:26:09.565032 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71"
[0m11:26:09.565969 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:26:09.568438 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71"
[0m11:26:09.569296 [debug] [Thread-1 (]: On test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select source_airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Route_Equipment`
    where source_airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:09.569698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:10.041582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:7d959df6-cea6-44fe-9ae0-3909042be092&page=queryresults
[0m11:26:10.354652 [info ] [Thread-1 (]: 35 of 41 PASS relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_  [[32mPASS[0m in 0.80s]
[0m11:26:10.355695 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:26:10.356201 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m11:26:10.356684 [info ] [Thread-1 (]: 36 of 41 START test relationships_TSA_Traffic_airport_icao__icao__ref_Airport_ . [RUN]
[0m11:26:10.357459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71, now test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a)
[0m11:26:10.357865 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m11:26:10.363005 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"
[0m11:26:10.365361 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m11:26:10.368562 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"
[0m11:26:10.369260 [debug] [Thread-1 (]: On test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select airport_icao as from_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`TSA_Traffic`
    where airport_icao is not null
),

parent as (
    select icao as to_field
    from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m11:26:10.369584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:10.912342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d10571a3-0b64-4a43-91d6-c7d084f714cb&page=queryresults
[0m11:26:11.242171 [info ] [Thread-1 (]: 36 of 41 PASS relationships_TSA_Traffic_airport_icao__icao__ref_Airport_ ....... [[32mPASS[0m in 0.88s]
[0m11:26:11.243209 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m11:26:11.243678 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:26:11.244187 [info ] [Thread-1 (]: 37 of 41 START test unique_Airline_id .......................................... [RUN]
[0m11:26:11.244696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a, now test.air_travel.unique_Airline_id.cb196c2622)
[0m11:26:11.245184 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m11:26:11.251814 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:26:11.252721 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m11:26:11.255252 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:26:11.255812 [debug] [Thread-1 (]: On test.air_travel.unique_Airline_id.cb196c2622: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airline_id.cb196c2622"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airline`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:26:11.256102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:11.733015 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ffbc211a-3902-460f-9732-e77c14403c50&page=queryresults
[0m11:26:12.283580 [info ] [Thread-1 (]: 37 of 41 PASS unique_Airline_id ................................................ [[32mPASS[0m in 1.04s]
[0m11:26:12.284585 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:26:12.285050 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:26:12.285503 [info ] [Thread-1 (]: 38 of 41 START test unique_Airport_Establishment_business ...................... [RUN]
[0m11:26:12.286081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now test.air_travel.unique_Airport_Establishment_business.c0ba13e1af)
[0m11:26:12.286648 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:26:12.290547 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m11:26:12.291294 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:26:12.293063 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m11:26:12.293618 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Establishment_business.c0ba13e1af: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select business as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Establishment`
  where business is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:26:12.294024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:12.857626 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:90d485f5-c136-4a93-9f2c-f1075aa4f76b&page=queryresults
[0m11:26:13.227786 [info ] [Thread-1 (]: 38 of 41 PASS unique_Airport_Establishment_business ............................ [[32mPASS[0m in 0.94s]
[0m11:26:13.228813 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:26:13.229308 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:26:13.229798 [info ] [Thread-1 (]: 39 of 41 START test unique_Airport_Review_id ................................... [RUN]
[0m11:26:13.230319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Establishment_business.c0ba13e1af, now test.air_travel.unique_Airport_Review_id.690fe37ba9)
[0m11:26:13.230679 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:26:13.235067 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m11:26:13.236109 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:26:13.238132 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m11:26:13.239264 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_Review_id.690fe37ba9: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_Review_id.690fe37ba9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport_Review`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:26:13.239728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:13.781213 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:97e4be7d-6600-4c17-9aab-54377d5a5bbc&page=queryresults
[0m11:26:14.115952 [info ] [Thread-1 (]: 39 of 41 PASS unique_Airport_Review_id ......................................... [[32mPASS[0m in 0.89s]
[0m11:26:14.116955 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:26:14.117435 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:26:14.117891 [info ] [Thread-1 (]: 40 of 41 START test unique_Airport_icao ........................................ [RUN]
[0m11:26:14.118454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Review_id.690fe37ba9, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m11:26:14.118877 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:26:14.122782 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:26:14.124524 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:26:14.126496 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:26:14.127095 [debug] [Thread-1 (]: On test.air_travel.unique_Airport_icao.8928a8a965: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Airport_icao.8928a8a965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select icao as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Airport`
  where icao is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:26:14.127439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:14.546996 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:d368ed9b-2d69-4803-b0a6-c710423877a9&page=queryresults
[0m11:26:14.846086 [info ] [Thread-1 (]: 40 of 41 PASS unique_Airport_icao .............................................. [[32mPASS[0m in 0.73s]
[0m11:26:14.847176 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:26:14.847642 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:26:14.848104 [info ] [Thread-1 (]: 41 of 41 START test unique_Country_iso_code .................................... [RUN]
[0m11:26:14.848615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m11:26:14.849115 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:26:14.852903 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:26:14.853633 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:26:14.855350 [debug] [Thread-1 (]: Writing runtime sql for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:26:14.855928 [debug] [Thread-1 (]: On test.air_travel.unique_Country_iso_code.5e9388f08c: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "node_id": "test.air_travel.unique_Country_iso_code.5e9388f08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select iso_code as unique_field
  from `cs378-fa2025`.`dbt_air_travel_int`.`Country`
  where iso_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:26:14.856263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:15.431423 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:fc0bf847-becb-44b8-8b7e-0f0243c993cd&page=queryresults
[0m11:26:15.792669 [info ] [Thread-1 (]: 41 of 41 PASS unique_Country_iso_code .......................................... [[32mPASS[0m in 0.94s]
[0m11:26:15.793804 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:26:15.795729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:26:15.797712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:15.798097 [debug] [MainThread]: Connection 'test.air_travel.unique_Country_iso_code.5e9388f08c' was properly closed.
[0m11:26:15.798368 [info ] [MainThread]: 
[0m11:26:15.798620 [info ] [MainThread]: Finished running 41 data tests in 0 hours 0 minutes and 48.40 seconds (48.40s).
[0m11:26:15.803612 [debug] [MainThread]: Command end result
[0m11:26:15.833837 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:26:15.835085 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:26:15.839433 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:26:15.839593 [info ] [MainThread]: 
[0m11:26:15.839759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:26:15.839892 [info ] [MainThread]: 
[0m11:26:15.840030 [info ] [MainThread]: Done. PASS=41 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=41
[0m11:26:15.842356 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 49.51327, "process_in_blocks": "0", "process_kernel_time": 0.398755, "process_mem_max_rss": "391823360", "process_out_blocks": "0", "process_user_time": 4.647689}
[0m11:26:15.842572 [debug] [MainThread]: Command `dbt test` succeeded at 11:26:15.842529 after 49.51 seconds
[0m11:26:15.842742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109558ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc9f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc9ef10>]}
[0m11:26:15.842914 [debug] [MainThread]: Flushing usage events
[0m11:26:16.057916 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:36.870501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5ec6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b437c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4379d0>]}


============================== 11:27:36.872236 | c8af0f83-53ea-4435-b583-885b8d532de2 ==============================
[0m11:27:36.872236 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:27:36.872507 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'printer_width': '80', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'introspect': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'use_colors': 'True', 'profiles_dir': '/Users/scohen/.dbt', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt docs generate', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'debug': 'False'}
[0m11:27:37.804677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8af0f83-53ea-4435-b583-885b8d532de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a790c30>]}
[0m11:27:37.826125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8af0f83-53ea-4435-b583-885b8d532de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213c2360>]}
[0m11:27:37.826396 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m11:27:37.908929 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m11:27:37.962822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:27:37.963017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:27:37.980393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8af0f83-53ea-4435-b583-885b8d532de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217dbd50>]}
[0m11:27:37.988196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8af0f83-53ea-4435-b583-885b8d532de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b45400>]}
[0m11:27:37.988365 [info ] [MainThread]: Found 49 models, 41 data tests, 9 sources, 630 macros
[0m11:27:37.988498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8af0f83-53ea-4435-b583-885b8d532de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121486b30>]}
[0m11:27:37.990039 [info ] [MainThread]: 
[0m11:27:37.990179 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:27:37.990271 [info ] [MainThread]: 
[0m11:27:37.990445 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:27:37.992675 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cs378-fa2025_dbt_air_travel_int'
[0m11:27:37.992830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:38.293698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_int, now list_cs378-fa2025_dbt_air_travel_stg)
[0m11:27:38.295632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:38.566866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_stg, now list_cs378-fa2025_dbt_air_travel_mrt)
[0m11:27:38.568418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:38.859589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_mrt, now list_cs378-fa2025_dbt_air_travel_tmp)
[0m11:27:38.860945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:39.156100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8af0f83-53ea-4435-b583-885b8d532de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b4b930>]}
[0m11:27:39.156773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:27:39.160330 [debug] [Thread-1 (]: Began running node model.air_travel.aircrafts
[0m11:27:39.160740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cs378-fa2025_dbt_air_travel_tmp, now model.air_travel.aircrafts)
[0m11:27:39.161052 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircrafts
[0m11:27:39.169117 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircrafts"
[0m11:27:39.169799 [debug] [Thread-1 (]: Began executing node model.air_travel.aircrafts
[0m11:27:39.170047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.171271 [debug] [Thread-1 (]: Finished running node model.air_travel.aircrafts
[0m11:27:39.171506 [debug] [Thread-1 (]: Began running node model.air_travel.airlines
[0m11:27:39.171818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircrafts, now model.air_travel.airlines)
[0m11:27:39.172126 [debug] [Thread-1 (]: Began compiling node model.air_travel.airlines
[0m11:27:39.174214 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airlines"
[0m11:27:39.174888 [debug] [Thread-1 (]: Began executing node model.air_travel.airlines
[0m11:27:39.175089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.176143 [debug] [Thread-1 (]: Finished running node model.air_travel.airlines
[0m11:27:39.176362 [debug] [Thread-1 (]: Began running node model.air_travel.airport_maps
[0m11:27:39.176609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airlines, now model.air_travel.airport_maps)
[0m11:27:39.176848 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_maps
[0m11:27:39.178319 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_maps"
[0m11:27:39.178779 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_maps
[0m11:27:39.178958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.179917 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_maps
[0m11:27:39.180115 [debug] [Thread-1 (]: Began running node model.air_travel.airport_reviews
[0m11:27:39.180324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_maps, now model.air_travel.airport_reviews)
[0m11:27:39.180522 [debug] [Thread-1 (]: Began compiling node model.air_travel.airport_reviews
[0m11:27:39.182165 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airport_reviews"
[0m11:27:39.182650 [debug] [Thread-1 (]: Began executing node model.air_travel.airport_reviews
[0m11:27:39.182805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.183652 [debug] [Thread-1 (]: Finished running node model.air_travel.airport_reviews
[0m11:27:39.183819 [debug] [Thread-1 (]: Began running node model.air_travel.airports
[0m11:27:39.184008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airport_reviews, now model.air_travel.airports)
[0m11:27:39.184160 [debug] [Thread-1 (]: Began compiling node model.air_travel.airports
[0m11:27:39.185411 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.airports"
[0m11:27:39.185677 [debug] [Thread-1 (]: Began executing node model.air_travel.airports
[0m11:27:39.185834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.186649 [debug] [Thread-1 (]: Finished running node model.air_travel.airports
[0m11:27:39.186812 [debug] [Thread-1 (]: Began running node model.air_travel.countries
[0m11:27:39.187005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.airports, now model.air_travel.countries)
[0m11:27:39.187156 [debug] [Thread-1 (]: Began compiling node model.air_travel.countries
[0m11:27:39.188574 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.countries"
[0m11:27:39.188973 [debug] [Thread-1 (]: Began executing node model.air_travel.countries
[0m11:27:39.189124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.189922 [debug] [Thread-1 (]: Finished running node model.air_travel.countries
[0m11:27:39.190100 [debug] [Thread-1 (]: Began running node model.air_travel.flight_delays
[0m11:27:39.190290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.countries, now model.air_travel.flight_delays)
[0m11:27:39.190440 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_delays
[0m11:27:39.191575 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_delays"
[0m11:27:39.192010 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_delays
[0m11:27:39.192184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.192997 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_delays
[0m11:27:39.193164 [debug] [Thread-1 (]: Began running node model.air_travel.flight_routes
[0m11:27:39.193338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_delays, now model.air_travel.flight_routes)
[0m11:27:39.193502 [debug] [Thread-1 (]: Began compiling node model.air_travel.flight_routes
[0m11:27:39.194789 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.flight_routes"
[0m11:27:39.195054 [debug] [Thread-1 (]: Began executing node model.air_travel.flight_routes
[0m11:27:39.195201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.195939 [debug] [Thread-1 (]: Finished running node model.air_travel.flight_routes
[0m11:27:39.196091 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m11:27:39.196264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.flight_routes, now model.air_travel.tmp_airport_establishment_canonical_categories)
[0m11:27:39.196411 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_canonical_categories
[0m11:27:39.197187 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_canonical_categories"
[0m11:27:39.197428 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_canonical_categories
[0m11:27:39.197568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.198299 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_canonical_categories
[0m11:27:39.198445 [debug] [Thread-1 (]: Began running node model.air_travel.tsa_traffic
[0m11:27:39.198587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_canonical_categories, now model.air_travel.tsa_traffic)
[0m11:27:39.198716 [debug] [Thread-1 (]: Began compiling node model.air_travel.tsa_traffic
[0m11:27:39.199886 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tsa_traffic"
[0m11:27:39.200246 [debug] [Thread-1 (]: Began executing node model.air_travel.tsa_traffic
[0m11:27:39.200378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.201055 [debug] [Thread-1 (]: Finished running node model.air_travel.tsa_traffic
[0m11:27:39.201195 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_aircraft_icao
[0m11:27:39.201349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tsa_traffic, now model.air_travel.tmp_aircraft_icao)
[0m11:27:39.201478 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_aircraft_icao
[0m11:27:39.202542 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_aircraft_icao"
[0m11:27:39.202909 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_aircraft_icao
[0m11:27:39.203040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.203719 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_aircraft_icao
[0m11:27:39.203871 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m11:27:39.204036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_aircraft_icao, now test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc)
[0m11:27:39.204187 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m11:27:39.209631 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc"
[0m11:27:39.209916 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m11:27:39.210057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.210785 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc
[0m11:27:39.210930 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m11:27:39.211084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_aircrafts_source_air_travel_raw_aircrafts_.1ab6a071cc, now test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d)
[0m11:27:39.211214 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m11:27:39.212924 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d"
[0m11:27:39.213155 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m11:27:39.213284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.213932 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d
[0m11:27:39.214069 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_unique
[0m11:27:39.214200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airlines_source_air_travel_raw_airlines_.c935bac69d, now model.air_travel.tmp_airport_establishment_unique)
[0m11:27:39.214323 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_unique
[0m11:27:39.215470 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_unique"
[0m11:27:39.215676 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_unique
[0m11:27:39.215797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.216442 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_unique
[0m11:27:39.216576 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m11:27:39.216713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_unique, now test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510)
[0m11:27:39.216841 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m11:27:39.218584 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510"
[0m11:27:39.218801 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m11:27:39.218922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.219527 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510
[0m11:27:39.219656 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m11:27:39.219789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_maps_source_air_travel_raw_airport_maps_.673fd74510, now test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587)
[0m11:27:39.219909 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m11:27:39.221743 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587"
[0m11:27:39.221985 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m11:27:39.222108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.222709 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587
[0m11:27:39.222837 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_llm
[0m11:27:39.222961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airport_reviews_source_air_travel_raw_airport_reviews_.1f37c79587, now model.air_travel.tmp_airport_llm)
[0m11:27:39.223075 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_llm
[0m11:27:39.224066 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_llm"
[0m11:27:39.224272 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_llm
[0m11:27:39.224383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.224962 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_llm
[0m11:27:39.225084 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m11:27:39.225223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_llm, now test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0)
[0m11:27:39.225341 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m11:27:39.227019 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0"
[0m11:27:39.227226 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m11:27:39.227340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.227920 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0
[0m11:27:39.228043 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_country_iso_codes
[0m11:27:39.228162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_airports_source_air_travel_raw_airports_.d2056cd0a0, now model.air_travel.tmp_country_iso_codes)
[0m11:27:39.228270 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_country_iso_codes
[0m11:27:39.229181 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_country_iso_codes"
[0m11:27:39.229521 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_country_iso_codes
[0m11:27:39.229641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.230238 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_country_iso_codes
[0m11:27:39.230363 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m11:27:39.230496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_country_iso_codes, now test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414)
[0m11:27:39.230622 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m11:27:39.232426 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414"
[0m11:27:39.232625 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m11:27:39.232740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.233327 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414
[0m11:27:39.233450 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m11:27:39.233575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_countries_source_air_travel_raw_countries_.ca67372414, now test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823)
[0m11:27:39.233686 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m11:27:39.235255 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823"
[0m11:27:39.235450 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m11:27:39.235561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.236126 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823
[0m11:27:39.236249 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m11:27:39.236370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_delays_source_air_travel_raw_flight_delays_.f0f74c1823, now test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81)
[0m11:27:39.236481 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m11:27:39.238163 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81"
[0m11:27:39.238359 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m11:27:39.238472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.239046 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81
[0m11:27:39.239166 [debug] [Thread-1 (]: Began running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m11:27:39.239285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_flight_routes_source_air_travel_raw_flight_routes_.f39ca79f81, now test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee)
[0m11:27:39.239397 [debug] [Thread-1 (]: Began compiling node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m11:27:39.240875 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee"
[0m11:27:39.241069 [debug] [Thread-1 (]: Began executing node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m11:27:39.241178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.241729 [debug] [Thread-1 (]: Finished running node test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee
[0m11:27:39.241853 [debug] [Thread-1 (]: Began running node model.air_travel.Aircraft
[0m11:27:39.241966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.check_row_count_equals_tsa_traffic_source_air_travel_raw_tsa_traffic_.e72cd5dbee, now model.air_travel.Aircraft)
[0m11:27:39.242088 [debug] [Thread-1 (]: Began compiling node model.air_travel.Aircraft
[0m11:27:39.243264 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Aircraft"
[0m11:27:39.243627 [debug] [Thread-1 (]: Began executing node model.air_travel.Aircraft
[0m11:27:39.243735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.244290 [debug] [Thread-1 (]: Finished running node model.air_travel.Aircraft
[0m11:27:39.244412 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_raw_categories
[0m11:27:39.244542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Aircraft, now model.air_travel.tmp_airport_establishment_raw_categories)
[0m11:27:39.244668 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_raw_categories
[0m11:27:39.245491 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_raw_categories"
[0m11:27:39.245773 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_raw_categories
[0m11:27:39.245883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.246453 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_raw_categories
[0m11:27:39.246573 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_all
[0m11:27:39.246706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_raw_categories, now model.air_travel.tmp_airport_all)
[0m11:27:39.246840 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_all
[0m11:27:39.247875 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_all"
[0m11:27:39.248253 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_all
[0m11:27:39.248363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.248943 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_all
[0m11:27:39.249062 [debug] [Thread-1 (]: Began running node model.air_travel.Country
[0m11:27:39.249183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_all, now model.air_travel.Country)
[0m11:27:39.249308 [debug] [Thread-1 (]: Began compiling node model.air_travel.Country
[0m11:27:39.250214 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Country"
[0m11:27:39.250518 [debug] [Thread-1 (]: Began executing node model.air_travel.Country
[0m11:27:39.250627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.251197 [debug] [Thread-1 (]: Finished running node model.air_travel.Country
[0m11:27:39.251319 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:27:39.251446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Country, now test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd)
[0m11:27:39.251574 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:27:39.255142 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd"
[0m11:27:39.255351 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:27:39.255471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.256029 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd
[0m11:27:39.256142 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m11:27:39.256253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Aircraft_icao__iata__name.d65681a3fd, now model.air_travel.tmp_airport_establishment_broad_categories_mapped)
[0m11:27:39.256355 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m11:27:39.257280 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_mapped"
[0m11:27:39.257552 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m11:27:39.257658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.258182 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_mapped
[0m11:27:39.258289 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates
[0m11:27:39.258408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_broad_categories_mapped, now model.air_travel.tmp_airport_duplicates)
[0m11:27:39.258521 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates
[0m11:27:39.259521 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates"
[0m11:27:39.259785 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates
[0m11:27:39.259892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.260501 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates
[0m11:27:39.260626 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airline_country_mapped
[0m11:27:39.260741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates, now model.air_travel.tmp_airline_country_mapped)
[0m11:27:39.260874 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airline_country_mapped
[0m11:27:39.261848 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airline_country_mapped"
[0m11:27:39.262030 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airline_country_mapped
[0m11:27:39.262129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.262651 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airline_country_mapped
[0m11:27:39.262757 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:27:39.262887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airline_country_mapped, now test.air_travel.not_null_Country_iso_code.b04a30e1a4)
[0m11:27:39.263011 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:27:39.265750 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Country_iso_code.b04a30e1a4"
[0m11:27:39.265928 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:27:39.266029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.266563 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Country_iso_code.b04a30e1a4
[0m11:27:39.266674 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:27:39.266785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Country_iso_code.b04a30e1a4, now test.air_travel.unique_Country_iso_code.5e9388f08c)
[0m11:27:39.266883 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:27:39.268836 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Country_iso_code.5e9388f08c"
[0m11:27:39.269043 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:27:39.269142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.269673 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Country_iso_code.5e9388f08c
[0m11:27:39.269797 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m11:27:39.269921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Country_iso_code.5e9388f08c, now model.air_travel.tmp_airport_establishment_broad_categories_frequency)
[0m11:27:39.270037 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m11:27:39.270772 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_broad_categories_frequency"
[0m11:27:39.271082 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m11:27:39.271189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.271717 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_broad_categories_frequency
[0m11:27:39.271825 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m11:27:39.271938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_broad_categories_frequency, now model.air_travel.tmp_airport_establishment_sub_categories_mapped)
[0m11:27:39.272041 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m11:27:39.273003 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_establishment_sub_categories_mapped"
[0m11:27:39.273314 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m11:27:39.273427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.275330 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_establishment_sub_categories_mapped
[0m11:27:39.275457 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_duplicates_embeddings
[0m11:27:39.275587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_establishment_sub_categories_mapped, now model.air_travel.tmp_airport_duplicates_embeddings)
[0m11:27:39.275722 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_duplicates_embeddings
[0m11:27:39.276618 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_duplicates_embeddings"
[0m11:27:39.276945 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_duplicates_embeddings
[0m11:27:39.277062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.277612 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_duplicates_embeddings
[0m11:27:39.277719 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results
[0m11:27:39.277863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_duplicates_embeddings, now model.air_travel.tmp_airport_inference_results)
[0m11:27:39.278032 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results
[0m11:27:39.279161 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results"
[0m11:27:39.279589 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results
[0m11:27:39.279717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.280428 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results
[0m11:27:39.280568 [debug] [Thread-1 (]: Began running node model.air_travel.Airline
[0m11:27:39.280717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results, now model.air_travel.Airline)
[0m11:27:39.280860 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airline
[0m11:27:39.367279 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airline"
[0m11:27:39.368500 [debug] [Thread-1 (]: Began executing node model.air_travel.Airline
[0m11:27:39.368640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.369329 [debug] [Thread-1 (]: Finished running node model.air_travel.Airline
[0m11:27:39.369461 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Establishment
[0m11:27:39.369636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airline, now model.air_travel.Airport_Establishment)
[0m11:27:39.369832 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Establishment
[0m11:27:39.371027 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Establishment"
[0m11:27:39.371261 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Establishment
[0m11:27:39.371373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.371957 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Establishment
[0m11:27:39.372078 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_inference_results_embeddings
[0m11:27:39.372212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Establishment, now model.air_travel.tmp_airport_inference_results_embeddings)
[0m11:27:39.372355 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_inference_results_embeddings
[0m11:27:39.373240 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_inference_results_embeddings"
[0m11:27:39.373587 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_inference_results_embeddings
[0m11:27:39.373724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.374298 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_inference_results_embeddings
[0m11:27:39.374417 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:27:39.374559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_inference_results_embeddings, now test.air_travel.not_null_Airline_id.b0e38ad347)
[0m11:27:39.374675 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:27:39.376130 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airline_id.b0e38ad347"
[0m11:27:39.376346 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:27:39.376468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.377028 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airline_id.b0e38ad347
[0m11:27:39.377140 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:27:39.377253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airline_id.b0e38ad347, now test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26)
[0m11:27:39.377354 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:27:39.379814 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26"
[0m11:27:39.380007 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:27:39.380118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.380719 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26
[0m11:27:39.380844 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:27:39.380978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airline_country_code__iso_code__ref_Country_.078a60fd26, now test.air_travel.unique_Airline_id.cb196c2622)
[0m11:27:39.381093 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airline_id.cb196c2622
[0m11:27:39.382438 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airline_id.cb196c2622"
[0m11:27:39.382627 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airline_id.cb196c2622
[0m11:27:39.382730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.383267 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airline_id.cb196c2622
[0m11:27:39.383384 [debug] [Thread-1 (]: Began running node model.air_travel.Food_Beverage
[0m11:27:39.383500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airline_id.cb196c2622, now model.air_travel.Food_Beverage)
[0m11:27:39.383626 [debug] [Thread-1 (]: Began compiling node model.air_travel.Food_Beverage
[0m11:27:39.384465 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Food_Beverage"
[0m11:27:39.384634 [debug] [Thread-1 (]: Began executing node model.air_travel.Food_Beverage
[0m11:27:39.384733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.385301 [debug] [Thread-1 (]: Finished running node model.air_travel.Food_Beverage
[0m11:27:39.385419 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:27:39.385576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Food_Beverage, now test.air_travel.not_null_Airport_Establishment_business.fa42968b3c)
[0m11:27:39.385692 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:27:39.386911 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Establishment_business.fa42968b3c"
[0m11:27:39.387103 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:27:39.387215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.387758 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Establishment_business.fa42968b3c
[0m11:27:39.387870 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:27:39.387983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Establishment_business.fa42968b3c, now test.air_travel.unique_Airport_Establishment_business.c0ba13e1af)
[0m11:27:39.388090 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:27:39.389116 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Establishment_business.c0ba13e1af"
[0m11:27:39.389279 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:27:39.389378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.389912 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Establishment_business.c0ba13e1af
[0m11:27:39.390023 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_vector_search_results
[0m11:27:39.390130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Establishment_business.c0ba13e1af, now model.air_travel.tmp_airport_vector_search_results)
[0m11:27:39.390233 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_vector_search_results
[0m11:27:39.391288 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_vector_search_results"
[0m11:27:39.391584 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_vector_search_results
[0m11:27:39.391702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.392261 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_vector_search_results
[0m11:27:39.392382 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:27:39.392519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_vector_search_results, now test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965)
[0m11:27:39.392650 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:27:39.394218 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965"
[0m11:27:39.394403 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:27:39.394505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.395025 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965
[0m11:27:39.395138 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m11:27:39.395248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Food_Beverage_business__menu_item.6e6bb0a965, now test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496)
[0m11:27:39.395352 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m11:27:39.396869 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496"
[0m11:27:39.397041 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m11:27:39.397144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.397662 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496
[0m11:27:39.397787 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_refined
[0m11:27:39.397911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Food_Beverage_business__business__ref_Airport_Establishment_.fd59593496, now model.air_travel.tmp_airport_refined)
[0m11:27:39.398023 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_refined
[0m11:27:39.398969 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_refined"
[0m11:27:39.399144 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_refined
[0m11:27:39.399246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.399774 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_refined
[0m11:27:39.400016 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_iso_codes
[0m11:27:39.400149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_refined, now model.air_travel.tmp_airport_country_iso_codes)
[0m11:27:39.400262 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_iso_codes
[0m11:27:39.401303 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_iso_codes"
[0m11:27:39.401464 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_iso_codes
[0m11:27:39.401569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.402134 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_iso_codes
[0m11:27:39.402298 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_country_closest_match
[0m11:27:39.402436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_country_iso_codes, now model.air_travel.tmp_airport_country_closest_match)
[0m11:27:39.402558 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_country_closest_match
[0m11:27:39.403469 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_country_closest_match"
[0m11:27:39.403918 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_country_closest_match
[0m11:27:39.404060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.404701 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_country_closest_match
[0m11:27:39.404899 [debug] [Thread-1 (]: Began running node model.air_travel.Airport
[0m11:27:39.405046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_country_closest_match, now model.air_travel.Airport)
[0m11:27:39.405154 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport
[0m11:27:39.406286 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport"
[0m11:27:39.406566 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport
[0m11:27:39.406669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.407212 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport
[0m11:27:39.407471 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Concessions
[0m11:27:39.407644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport, now model.air_travel.Airport_Concessions)
[0m11:27:39.407762 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Concessions
[0m11:27:39.408744 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Concessions"
[0m11:27:39.408912 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Concessions
[0m11:27:39.409012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.409530 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Concessions
[0m11:27:39.409638 [debug] [Thread-1 (]: Began running node model.air_travel.Airport_Review
[0m11:27:39.409773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Concessions, now model.air_travel.Airport_Review)
[0m11:27:39.409902 [debug] [Thread-1 (]: Began compiling node model.air_travel.Airport_Review
[0m11:27:39.410908 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Airport_Review"
[0m11:27:39.411235 [debug] [Thread-1 (]: Began executing node model.air_travel.Airport_Review
[0m11:27:39.411335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.411848 [debug] [Thread-1 (]: Finished running node model.air_travel.Airport_Review
[0m11:27:39.411953 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Delays
[0m11:27:39.412075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Airport_Review, now model.air_travel.Flight_Delays)
[0m11:27:39.412209 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Delays
[0m11:27:39.413113 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Delays"
[0m11:27:39.413438 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Delays
[0m11:27:39.413549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.414130 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Delays
[0m11:27:39.414246 [debug] [Thread-1 (]: Began running node model.air_travel.Flight_Routes
[0m11:27:39.414376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Flight_Delays, now model.air_travel.Flight_Routes)
[0m11:27:39.414504 [debug] [Thread-1 (]: Began compiling node model.air_travel.Flight_Routes
[0m11:27:39.415612 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Flight_Routes"
[0m11:27:39.415868 [debug] [Thread-1 (]: Began executing node model.air_travel.Flight_Routes
[0m11:27:39.415967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.416497 [debug] [Thread-1 (]: Finished running node model.air_travel.Flight_Routes
[0m11:27:39.416617 [debug] [Thread-1 (]: Began running node model.air_travel.TSA_Traffic
[0m11:27:39.416750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Flight_Routes, now model.air_travel.TSA_Traffic)
[0m11:27:39.416884 [debug] [Thread-1 (]: Began compiling node model.air_travel.TSA_Traffic
[0m11:27:39.417715 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.TSA_Traffic"
[0m11:27:39.418080 [debug] [Thread-1 (]: Began executing node model.air_travel.TSA_Traffic
[0m11:27:39.418191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.418782 [debug] [Thread-1 (]: Finished running node model.air_travel.TSA_Traffic
[0m11:27:39.418917 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:27:39.419058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.TSA_Traffic, now test.air_travel.not_null_Airport_icao.8935ba5a96)
[0m11:27:39.419219 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:27:39.420508 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_icao.8935ba5a96"
[0m11:27:39.420701 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:27:39.420800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.421326 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_icao.8935ba5a96
[0m11:27:39.421437 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:27:39.421547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_icao.8935ba5a96, now test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0)
[0m11:27:39.421656 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:27:39.424398 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0"
[0m11:27:39.424634 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:27:39.424755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.425326 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0
[0m11:27:39.425440 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:27:39.425554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_country_code__iso_code__ref_Country_.b3116a34d0, now test.air_travel.unique_Airport_icao.8928a8a965)
[0m11:27:39.425656 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:27:39.426828 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_icao.8928a8a965"
[0m11:27:39.427013 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:27:39.427119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.427643 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_icao.8928a8a965
[0m11:27:39.427760 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:27:39.427871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_icao.8928a8a965, now test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46)
[0m11:27:39.427975 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:27:39.429919 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46"
[0m11:27:39.430118 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:27:39.430241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.430860 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46
[0m11:27:39.430977 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m11:27:39.431089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Airport_Concessions_airport_icao__terminal__business__location.a0b1769c46, now test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1)
[0m11:27:39.431191 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m11:27:39.432552 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1"
[0m11:27:39.432730 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m11:27:39.432834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.433394 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1
[0m11:27:39.433520 [debug] [Thread-1 (]: Began running node model.air_travel.passenger_sentiment_airports_top_kpis
[0m11:27:39.433659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_Concessions_airport_icao__icao__ref_Airport_.5925cf1da1, now model.air_travel.passenger_sentiment_airports_top_kpis)
[0m11:27:39.433794 [debug] [Thread-1 (]: Began compiling node model.air_travel.passenger_sentiment_airports_top_kpis
[0m11:27:39.435046 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.passenger_sentiment_airports_top_kpis"
[0m11:27:39.435424 [debug] [Thread-1 (]: Began executing node model.air_travel.passenger_sentiment_airports_top_kpis
[0m11:27:39.435536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.436095 [debug] [Thread-1 (]: Finished running node model.air_travel.passenger_sentiment_airports_top_kpis
[0m11:27:39.436211 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m11:27:39.436326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.passenger_sentiment_airports_top_kpis, now model.air_travel.tmp_airport_terminal_mentioned_food_keywords)
[0m11:27:39.436430 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m11:27:39.437317 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_terminal_mentioned_food_keywords"
[0m11:27:39.437624 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m11:27:39.437745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.438320 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_terminal_mentioned_food_keywords
[0m11:27:39.438431 [debug] [Thread-1 (]: Began running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:27:39.438561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_terminal_mentioned_food_keywords, now test.air_travel.not_null_Airport_Review_id.715ca7a304)
[0m11:27:39.438693 [debug] [Thread-1 (]: Began compiling node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:27:39.440059 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.not_null_Airport_Review_id.715ca7a304"
[0m11:27:39.440254 [debug] [Thread-1 (]: Began executing node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:27:39.440357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.440913 [debug] [Thread-1 (]: Finished running node test.air_travel.not_null_Airport_Review_id.715ca7a304
[0m11:27:39.441027 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m11:27:39.441136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.not_null_Airport_Review_id.715ca7a304, now test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9)
[0m11:27:39.441239 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m11:27:39.442584 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9"
[0m11:27:39.442758 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m11:27:39.442864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.443425 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9
[0m11:27:39.443550 [debug] [Thread-1 (]: Began running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:27:39.443672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Airport_Review_airport_icao__icao__ref_Airport_.b2921dd7a9, now test.air_travel.unique_Airport_Review_id.690fe37ba9)
[0m11:27:39.443774 [debug] [Thread-1 (]: Began compiling node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:27:39.445001 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.unique_Airport_Review_id.690fe37ba9"
[0m11:27:39.445182 [debug] [Thread-1 (]: Began executing node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:27:39.445284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.445840 [debug] [Thread-1 (]: Finished running node test.air_travel.unique_Airport_Review_id.690fe37ba9
[0m11:27:39.445956 [debug] [Thread-1 (]: Began running node model.air_travel.carrier_flight_delays
[0m11:27:39.446065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.unique_Airport_Review_id.690fe37ba9, now model.air_travel.carrier_flight_delays)
[0m11:27:39.446166 [debug] [Thread-1 (]: Began compiling node model.air_travel.carrier_flight_delays
[0m11:27:39.447263 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.carrier_flight_delays"
[0m11:27:39.447530 [debug] [Thread-1 (]: Began executing node model.air_travel.carrier_flight_delays
[0m11:27:39.447635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.448159 [debug] [Thread-1 (]: Finished running node model.air_travel.carrier_flight_delays
[0m11:27:39.448270 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:27:39.448396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.carrier_flight_delays, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608)
[0m11:27:39.448524 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:27:39.450368 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608"
[0m11:27:39.450586 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:27:39.450702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.451303 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608
[0m11:27:39.451423 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m11:27:39.451538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Delays_event_month__airline_id__airport_icao.a68a30a608, now test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3)
[0m11:27:39.451642 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m11:27:39.453283 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3"
[0m11:27:39.453469 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m11:27:39.453573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.454095 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3
[0m11:27:39.454205 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m11:27:39.454315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airline_id__id__ref_Airline_.b90e29dec3, now test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4)
[0m11:27:39.454416 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m11:27:39.455891 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4"
[0m11:27:39.456073 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m11:27:39.456177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.456730 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4
[0m11:27:39.456843 [debug] [Thread-1 (]: Began running node model.air_travel.Route_Equipment
[0m11:27:39.456950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Delays_airport_icao__icao__ref_Airport_.9cd2fb27c4, now model.air_travel.Route_Equipment)
[0m11:27:39.457055 [debug] [Thread-1 (]: Began compiling node model.air_travel.Route_Equipment
[0m11:27:39.457949 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.Route_Equipment"
[0m11:27:39.458420 [debug] [Thread-1 (]: Began executing node model.air_travel.Route_Equipment
[0m11:27:39.458529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.459032 [debug] [Thread-1 (]: Finished running node model.air_travel.Route_Equipment
[0m11:27:39.459144 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:27:39.459277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.Route_Equipment, now test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365)
[0m11:27:39.459424 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:27:39.461199 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365"
[0m11:27:39.461373 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:27:39.461479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.462028 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365
[0m11:27:39.462138 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m11:27:39.462246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Flight_Routes_airline_id__source_airport_icao__dest_airport_icao.9dd03e9365, now test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e)
[0m11:27:39.462353 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m11:27:39.463635 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e"
[0m11:27:39.463821 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m11:27:39.463935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.464540 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e
[0m11:27:39.464672 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m11:27:39.464797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_airline_id__id__ref_Airline_.bea7cf3f3e, now test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052)
[0m11:27:39.464900 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m11:27:39.466500 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052"
[0m11:27:39.466686 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m11:27:39.466790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.467355 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052
[0m11:27:39.467470 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m11:27:39.467596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_dest_airport_icao__icao__ref_Airport_.eb2d420052, now test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df)
[0m11:27:39.467719 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m11:27:39.469229 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df"
[0m11:27:39.469434 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m11:27:39.469544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.470109 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df
[0m11:27:39.470231 [debug] [Thread-1 (]: Began running node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m11:27:39.470346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Flight_Routes_source_airport_icao__icao__ref_Airport_.c900a8a4df, now model.air_travel.foot_traffic_starbucks_airports_monthly)
[0m11:27:39.470454 [debug] [Thread-1 (]: Began compiling node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m11:27:39.471582 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.foot_traffic_starbucks_airports_monthly"
[0m11:27:39.472020 [debug] [Thread-1 (]: Began executing node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m11:27:39.472145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.472752 [debug] [Thread-1 (]: Finished running node model.air_travel.foot_traffic_starbucks_airports_monthly
[0m11:27:39.472867 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_tsa_checkpoint_terminal
[0m11:27:39.472980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.foot_traffic_starbucks_airports_monthly, now model.air_travel.tmp_tsa_checkpoint_terminal)
[0m11:27:39.473083 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_tsa_checkpoint_terminal
[0m11:27:39.473965 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_tsa_checkpoint_terminal"
[0m11:27:39.474146 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_tsa_checkpoint_terminal
[0m11:27:39.474252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.474766 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_tsa_checkpoint_terminal
[0m11:27:39.474878 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:27:39.474996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_tsa_checkpoint_terminal, now test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6)
[0m11:27:39.475129 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:27:39.477084 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6"
[0m11:27:39.477290 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:27:39.477397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.477963 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6
[0m11:27:39.478086 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m11:27:39.478201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_TSA_Traffic_event_date__event_hour__airport_icao__security_checkpoint.a7ec4853e6, now test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a)
[0m11:27:39.478308 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m11:27:39.479576 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a"
[0m11:27:39.479751 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m11:27:39.479855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.480361 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a
[0m11:27:39.480473 [debug] [Thread-1 (]: Began running node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m11:27:39.480583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_TSA_Traffic_airport_icao__icao__ref_Airport_.660094639a, now model.air_travel.tmp_airport_terminal_food_keywords_category)
[0m11:27:39.480686 [debug] [Thread-1 (]: Began compiling node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m11:27:39.481947 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.tmp_airport_terminal_food_keywords_category"
[0m11:27:39.482180 [debug] [Thread-1 (]: Began executing node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m11:27:39.482305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.483002 [debug] [Thread-1 (]: Finished running node model.air_travel.tmp_airport_terminal_food_keywords_category
[0m11:27:39.483184 [debug] [Thread-1 (]: Began running node model.air_travel.aircraft_flight_delays
[0m11:27:39.483339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.tmp_airport_terminal_food_keywords_category, now model.air_travel.aircraft_flight_delays)
[0m11:27:39.483479 [debug] [Thread-1 (]: Began compiling node model.air_travel.aircraft_flight_delays
[0m11:27:39.485098 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.aircraft_flight_delays"
[0m11:27:39.485458 [debug] [Thread-1 (]: Began executing node model.air_travel.aircraft_flight_delays
[0m11:27:39.485577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.486138 [debug] [Thread-1 (]: Finished running node model.air_travel.aircraft_flight_delays
[0m11:27:39.486264 [debug] [Thread-1 (]: Began running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:27:39.486392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.aircraft_flight_delays, now test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a)
[0m11:27:39.486509 [debug] [Thread-1 (]: Began compiling node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:27:39.489501 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a"
[0m11:27:39.489724 [debug] [Thread-1 (]: Began executing node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:27:39.489838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.490391 [debug] [Thread-1 (]: Finished running node test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a
[0m11:27:39.490509 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:27:39.490622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.dbt_utils_unique_combination_of_columns_Route_Equipment_airline_id__source_airport_icao__dest_airport_icao__icao_equipment.078188217a, now test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9)
[0m11:27:39.490728 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:27:39.492070 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9"
[0m11:27:39.492261 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:27:39.492367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.493193 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9
[0m11:27:39.493322 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:27:39.493437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Route_Equipment_airline_id__id__ref_Airline_.bdaecd24b9, now test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842)
[0m11:27:39.493554 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:27:39.494998 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842"
[0m11:27:39.495186 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:27:39.495290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.495817 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842
[0m11:27:39.495930 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:27:39.496040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Route_Equipment_dest_airport_icao__icao__ref_Airport_.f1e8f4e842, now test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f)
[0m11:27:39.496145 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:27:39.497697 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f"
[0m11:27:39.497875 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:27:39.497980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.498500 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f
[0m11:27:39.498613 [debug] [Thread-1 (]: Began running node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:27:39.498722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Route_Equipment_icao_equipment__icao__ref_Aircraft_.b4621bea9f, now test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71)
[0m11:27:39.498826 [debug] [Thread-1 (]: Began compiling node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:27:39.500187 [debug] [Thread-1 (]: Writing injected SQL for node "test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71"
[0m11:27:39.500360 [debug] [Thread-1 (]: Began executing node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:27:39.500463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.501225 [debug] [Thread-1 (]: Finished running node test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71
[0m11:27:39.501404 [debug] [Thread-1 (]: Began running node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m11:27:39.501563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.air_travel.relationships_Route_Equipment_source_airport_icao__icao__ref_Airport_.508080ef71, now model.air_travel.foot_traffic_starbucks_terminals_monthly)
[0m11:27:39.501722 [debug] [Thread-1 (]: Began compiling node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m11:27:39.503250 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.foot_traffic_starbucks_terminals_monthly"
[0m11:27:39.503467 [debug] [Thread-1 (]: Began executing node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m11:27:39.503574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.504143 [debug] [Thread-1 (]: Finished running node model.air_travel.foot_traffic_starbucks_terminals_monthly
[0m11:27:39.504259 [debug] [Thread-1 (]: Began running node model.air_travel.food_category_comparison
[0m11:27:39.504372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.air_travel.foot_traffic_starbucks_terminals_monthly, now model.air_travel.food_category_comparison)
[0m11:27:39.504499 [debug] [Thread-1 (]: Began compiling node model.air_travel.food_category_comparison
[0m11:27:39.505511 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_travel.food_category_comparison"
[0m11:27:39.505843 [debug] [Thread-1 (]: Began executing node model.air_travel.food_category_comparison
[0m11:27:39.505964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:39.506559 [debug] [Thread-1 (]: Finished running node model.air_travel.food_category_comparison
[0m11:27:39.506957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:27:39.507070 [debug] [MainThread]: Connection 'model.air_travel.food_category_comparison' was properly closed.
[0m11:27:39.510499 [debug] [MainThread]: Command end result
[0m11:27:39.548622 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:27:39.549604 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:27:39.553177 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/scohen/UTCS/378/dbt/air_travel/target/run_results.json
[0m11:27:39.553797 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m11:27:39.553901 [info ] [MainThread]: Building catalog
[0m11:27:39.557811 [debug] [ThreadPool]: Acquiring new bigquery connection 'cs378-fa2025.information_schema'
[0m11:27:39.566014 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_tmp`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airline_country_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_broad_categories_frequency')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_inference_results')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_canonical_categories')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_sub_categories_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_raw_categories')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_vector_search_results')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_refined')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_broad_categories_mapped')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_tsa_checkpoint_terminal')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_country_iso_codes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_llm')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_duplicates_embeddings')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_establishment_unique')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_country_iso_codes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_inference_results_embeddings')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_all')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_duplicates')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_terminal_food_keywords_category')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_terminal_mentioned_food_keywords')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_aircraft_icao')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_tmp')
                            and upper(table_name) = upper('tmp_airport_country_closest_match')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_tmp`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m11:27:39.566464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:40.003087 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:25fe2436-5aab-452f-9b1a-9de72d6b7ff3&page=queryresults
[0m11:27:41.494255 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`air_travel_raw`.__TABLES__ tables
    left join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('tsa_traffic')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('countries')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('aircrafts')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('flight_routes')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airport_maps')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airlines')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('flight_delays')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airport_reviews')
                            ) or (
                                upper(table_schema) = upper('air_travel_raw')
                            and upper(table_name) = upper('airports')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`air_travel_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m11:27:41.495011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:42.150470 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:ca36b49c-ede6-4ba6-9a0a-28c2bcce9f6f&page=queryresults
[0m11:27:44.041328 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_int`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Concessions')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Aircraft')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Route_Equipment')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Country')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Flight_Delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Review')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Food_Beverage')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airport_Establishment')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Airline')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('TSA_Traffic')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_int')
                            and upper(table_name) = upper('Flight_Routes')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_int`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m11:27:44.042247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:44.507371 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:109269eb-249d-4afa-90d5-2fb1f8485c06&page=queryresults
[0m11:27:45.899486 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_stg`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('tsa_traffic')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airport_maps')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('flight_routes')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('aircrafts')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airport_reviews')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airlines')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('airports')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('flight_delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_stg')
                            and upper(table_name) = upper('countries')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_stg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m11:27:45.900397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:46.350703 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:6133d6e0-1c54-49ae-9c30-8cf7246a1a9c&page=queryresults
[0m11:27:47.731051 [debug] [ThreadPool]: On cs378-fa2025.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "air_travel", "target_name": "dev", "connection_name": "cs378-fa2025.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cs378-fa2025`.`dbt_air_travel_mrt`.__TABLES__ tables
    left join `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('food_category_comparison')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('passenger_sentiment_airports_top_kpis')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('aircraft_flight_delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('foot_traffic_starbucks_terminals_monthly')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('carrier_flight_delays')
                            ) or (
                                upper(table_schema) = upper('dbt_air_travel_mrt')
                            and upper(table_name) = upper('foot_traffic_starbucks_airports_monthly')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.COLUMNS columns
    join `cs378-fa2025`.`dbt_air_travel_mrt`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m11:27:47.731943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:48.193510 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cs378-fa2025&j=bq:us-central1:0f2ca314-d41e-4c59-8ff2-85b4b3ff58ba&page=queryresults
[0m11:27:49.647045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:27:49.657368 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/scohen/UTCS/378/dbt/air_travel/target/catalog.json
[0m11:27:49.676156 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/manifest.json
[0m11:27:49.676890 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/scohen/UTCS/378/dbt/air_travel/target/semantic_manifest.json
[0m11:27:49.676991 [info ] [MainThread]: Catalog written to /Users/scohen/UTCS/378/dbt/air_travel/target/catalog.json
[0m11:27:49.678868 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 12.833566, "process_in_blocks": "0", "process_kernel_time": 0.322496, "process_mem_max_rss": "394838016", "process_out_blocks": "0", "process_user_time": 2.484699}
[0m11:27:49.679049 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:27:49.679018 after 12.83 seconds
[0m11:27:49.679171 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:27:49.679252 [debug] [MainThread]: Connection 'cs378-fa2025.information_schema' was properly closed.
[0m11:27:49.679351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b33ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d03e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d03b70>]}
[0m11:27:49.679463 [debug] [MainThread]: Flushing usage events
[0m11:27:49.898997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:56.437840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc406e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da8bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da8b9d0>]}


============================== 11:27:56.439510 | 3bf4be54-22b4-42ed-b298-72d572c1542a ==============================
[0m11:27:56.439510 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m11:27:56.439757 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_path': '/Users/scohen/UTCS/378/dbt/air_travel/logs', 'partial_parse': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'invocation_command': 'dbt docs serve --port 8181', 'static_parser': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'profiles_dir': '/Users/scohen/.dbt', 'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'empty': 'None', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True'}
[0m11:27:57.281696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bf4be54-22b4-42ed-b298-72d572c1542a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cde4c30>]}
[0m11:27:57.301485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bf4be54-22b4-42ed-b298-72d572c1542a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ac2360>]}
